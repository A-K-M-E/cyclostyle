(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Ipfs = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Ipfs=(()=>{var aAe=Object.create;var Cm=Object.defineProperty;var cAe=Object.getOwnPropertyDescriptor;var uAe=Object.getOwnPropertyNames;var lAe=Object.getPrototypeOf,fAe=Object.prototype.hasOwnProperty;var yk=t=>Cm(t,"__esModule",{value:!0});var Wo=t=>{if(typeof require!="undefined")return require(t);throw new Error('Dynamic require of "'+t+'" is not supported')};var Ge=(t,e)=>()=>(t&&(e=t(t=0)),e);var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Gt=(t,e)=>{yk(t);for(var r in e)Cm(t,r,{get:e[r],enumerable:!0})},dAe=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of uAe(e))!fAe.call(t,i)&&i!=="default"&&Cm(t,i,{get:()=>e[i],enumerable:!(r=cAe(e,i))||r.enumerable});return t},gk=t=>dAe(yk(Cm(t!=null?aAe(lAe(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var vk=p(Om=>{f();"use strict";Om.byteLength=pAe;Om.toByteArray=gAe;Om.fromByteArray=vAe;var Yo=[],bs=[],hAe=typeof Uint8Array!="undefined"?Uint8Array:Array,W3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Dl=0,bk=W3.length;Dl<bk;++Dl)Yo[Dl]=W3[Dl],bs[W3.charCodeAt(Dl)]=Dl;var Dl,bk;bs["-".charCodeAt(0)]=62;bs["_".charCodeAt(0)]=63;function mk(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function pAe(t){var e=mk(t),r=e[0],i=e[1];return(r+i)*3/4-i}function yAe(t,e,r){return(e+r)*3/4-r}function gAe(t){var e,r=mk(t),i=r[0],n=r[1],s=new hAe(yAe(t,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=bs[t.charCodeAt(c)]<<18|bs[t.charCodeAt(c+1)]<<12|bs[t.charCodeAt(c+2)]<<6|bs[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=bs[t.charCodeAt(c)]<<2|bs[t.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=bs[t.charCodeAt(c)]<<10|bs[t.charCodeAt(c+1)]<<4|bs[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function bAe(t){return Yo[t>>18&63]+Yo[t>>12&63]+Yo[t>>6&63]+Yo[t&63]}function mAe(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),n.push(bAe(i));return n.join("")}function vAe(t){for(var e,r=t.length,i=r%3,n=[],s=16383,o=0,a=r-i;o<a;o+=s)n.push(mAe(t,o,o+s>a?a:o+s));return i===1?(e=t[r-1],n.push(Yo[e>>2]+Yo[e<<4&63]+"==")):i===2&&(e=(t[r-2]<<8)+t[r-1],n.push(Yo[e>>10]+Yo[e>>4&63]+Yo[e<<2&63]+"=")),n.join("")}});var wk=p(Y3=>{f();Y3.read=function(t,e,r,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?n-1:0,h=r?-1:1,y=t[e+d];for(d+=h,s=y&(1<<-l)-1,y>>=-l,l+=a;l>0;s=s*256+t[e+d],d+=h,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=o*256+t[e+d],d+=h,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(y?-1:1)*o*Math.pow(2,s-i)};Y3.write=function(t,e,r,i,n,s){var o,a,c,u=s*8-n-1,l=(1<<u)-1,d=l>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:s-1,g=i?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=l?(a=0,o=l):o+d>=1?(a=(e*c-1)*Math.pow(2,n),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;t[r+y]=a&255,y+=g,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;t[r+y]=o&255,y+=g,o/=256,u-=8);t[r+y-g]|=m*128}});var Ut=p(Md=>{f();"use strict";var X3=vk(),Nd=wk(),_k=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Md.Buffer=le;Md.SlowBuffer=AAe;Md.INSPECT_MAX_BYTES=50;var km=2147483647;Md.kMaxLength=km;le.TYPED_ARRAY_SUPPORT=wAe();!le.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function wAe(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(le.prototype,"parent",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.buffer}});Object.defineProperty(le.prototype,"offset",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.byteOffset}});function uc(t){if(t>km)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,le.prototype),e}function le(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Q3(t)}return Ek(t,e,r)}le.poolSize=8192;function Ek(t,e,r){if(typeof t=="string")return EAe(t,e);if(ArrayBuffer.isView(t))return SAe(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Xo(t,ArrayBuffer)||t&&Xo(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Xo(t,SharedArrayBuffer)||t&&Xo(t.buffer,SharedArrayBuffer)))return J3(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=t.valueOf&&t.valueOf();if(i!=null&&i!==t)return le.from(i,e,r);let n=xAe(t);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return le.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}le.from=function(t,e,r){return Ek(t,e,r)};Object.setPrototypeOf(le.prototype,Uint8Array.prototype);Object.setPrototypeOf(le,Uint8Array);function Sk(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function _Ae(t,e,r){return Sk(t),t<=0?uc(t):e!==void 0?typeof r=="string"?uc(t).fill(e,r):uc(t).fill(e):uc(t)}le.alloc=function(t,e,r){return _Ae(t,e,r)};function Q3(t){return Sk(t),uc(t<0?0:ex(t)|0)}le.allocUnsafe=function(t){return Q3(t)};le.allocUnsafeSlow=function(t){return Q3(t)};function EAe(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!le.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=xk(t,e)|0,i=uc(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function Z3(t){let e=t.length<0?0:ex(t.length)|0,r=uc(e);for(let i=0;i<e;i+=1)r[i]=t[i]&255;return r}function SAe(t){if(Xo(t,Uint8Array)){let e=new Uint8Array(t);return J3(e.buffer,e.byteOffset,e.byteLength)}return Z3(t)}function J3(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&r===void 0?i=new Uint8Array(t):r===void 0?i=new Uint8Array(t,e):i=new Uint8Array(t,e,r),Object.setPrototypeOf(i,le.prototype),i}function xAe(t){if(le.isBuffer(t)){let e=ex(t.length)|0,r=uc(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||ix(t.length)?uc(0):Z3(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Z3(t.data)}function ex(t){if(t>=km)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+km.toString(16)+" bytes");return t|0}function AAe(t){return+t!=t&&(t=0),le.alloc(+t)}le.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==le.prototype};le.compare=function(e,r){if(Xo(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),Xo(r,Uint8Array)&&(r=le.from(r,r.offset,r.byteLength)),!le.isBuffer(e)||!le.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let i=e.length,n=r.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==r[s]){i=e[s],n=r[s];break}return i<n?-1:n<i?1:0};le.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};le.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return le.alloc(0);let i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;let n=le.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){let o=e[i];if(Xo(o,Uint8Array))s+o.length>n.length?(le.isBuffer(o)||(o=le.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(le.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function xk(t,e){if(le.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Xo(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&r===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return rx(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Bk(t).length;default:if(n)return i?-1:rx(t).length;e=(""+e).toLowerCase(),n=!0}}le.byteLength=xk;function IAe(t,e,r){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return BAe(this,e,r);case"utf8":case"utf-8":return Tk(this,e,r);case"ascii":return NAe(this,e,r);case"latin1":case"binary":return DAe(this,e,r);case"base64":return kAe(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return MAe(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}le.prototype._isBuffer=!0;function Bl(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}le.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)Bl(this,r,r+1);return this};le.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)Bl(this,r,r+3),Bl(this,r+1,r+2);return this};le.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)Bl(this,r,r+7),Bl(this,r+1,r+6),Bl(this,r+2,r+5),Bl(this,r+3,r+4);return this};le.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Tk(this,0,e):IAe.apply(this,arguments)};le.prototype.toLocaleString=le.prototype.toString;le.prototype.equals=function(e){if(!le.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:le.compare(this,e)===0};le.prototype.inspect=function(){let e="",r=Md.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};_k&&(le.prototype[_k]=le.prototype.inspect);le.prototype.compare=function(e,r,i,n,s){if(Xo(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),!le.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-r,c=Math.min(o,a),u=this.slice(n,s),l=e.slice(r,i);for(let d=0;d<c;++d)if(u[d]!==l[d]){o=u[d],a=l[d];break}return o<a?-1:a<o?1:0};function Ak(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,ix(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=le.from(e,i)),le.isBuffer(e))return e.length===0?-1:Ik(t,e,r,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Ik(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function Ik(t,e,r,i,n){let s=1,o=t.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function c(l,d){return s===1?l[d]:l.readUInt16BE(d*s)}let u;if(n){let l=-1;for(u=r;u<o;u++)if(c(t,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(r+a>o&&(r=o-a),u=r;u>=0;u--){let l=!0;for(let d=0;d<a;d++)if(c(t,u+d)!==c(e,d)){l=!1;break}if(l)return u}return-1}le.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};le.prototype.indexOf=function(e,r,i){return Ak(this,e,r,i,!0)};le.prototype.lastIndexOf=function(e,r,i){return Ak(this,e,r,i,!1)};function TAe(t,e,r,i){r=Number(r)||0;let n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(ix(a))return o;t[r+o]=a}return o}function RAe(t,e,r,i){return qm(rx(e,t.length-r),t,r,i)}function PAe(t,e,r,i){return qm(KAe(e),t,r,i)}function CAe(t,e,r,i){return qm(Bk(e),t,r,i)}function OAe(t,e,r,i){return qm(jAe(e,t.length-r),t,r,i)}le.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return TAe(this,e,r,i);case"utf8":case"utf-8":return RAe(this,e,r,i);case"ascii":case"latin1":case"binary":return PAe(this,e,r,i);case"base64":return CAe(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return OAe(this,e,r,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function kAe(t,e,r){return e===0&&r===t.length?X3.fromByteArray(t):X3.fromByteArray(t.slice(e,r))}function Tk(t,e,r){r=Math.min(t.length,r);let i=[],n=e;for(;n<r;){let s=t[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=r){let c,u,l,d;switch(a){case 1:s<128&&(o=s);break;case 2:c=t[n+1],(c&192)==128&&(d=(s&31)<<6|c&63,d>127&&(o=d));break;case 3:c=t[n+1],u=t[n+2],(c&192)==128&&(u&192)==128&&(d=(s&15)<<12|(c&63)<<6|u&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:c=t[n+1],u=t[n+2],l=t[n+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(d=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,d>65535&&d<1114112&&(o=d))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return qAe(i)}var Rk=4096;function qAe(t){let e=t.length;if(e<=Rk)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=Rk));return r}function NAe(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function DAe(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function BAe(t,e,r){let i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);let n="";for(let s=e;s<r;++s)n+=VAe[t[s]];return n}function MAe(t,e,r){let i=t.slice(e,r),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}le.prototype.slice=function(e,r){let i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);let n=this.subarray(e,r);return Object.setPrototypeOf(n,le.prototype),n};function Ai(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}le.prototype.readUintLE=le.prototype.readUIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ai(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return n};le.prototype.readUintBE=le.prototype.readUIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ai(e,r,this.length);let n=this[e+--r],s=1;for(;r>0&&(s*=256);)n+=this[e+--r]*s;return n};le.prototype.readUint8=le.prototype.readUInt8=function(e,r){return e=e>>>0,r||Ai(e,1,this.length),this[e]};le.prototype.readUint16LE=le.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||Ai(e,2,this.length),this[e]|this[e+1]<<8};le.prototype.readUint16BE=le.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||Ai(e,2,this.length),this[e]<<8|this[e+1]};le.prototype.readUint32LE=le.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||Ai(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};le.prototype.readUint32BE=le.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||Ai(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};le.prototype.readBigUInt64LE=uu(function(e){e=e>>>0,Bd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ty(e,this.length-8);let n=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});le.prototype.readBigUInt64BE=uu(function(e){e=e>>>0,Bd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ty(e,this.length-8);let n=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});le.prototype.readIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ai(e,r,this.length);let n=this[e],s=1,o=0;for(;++o<r&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*r)),n};le.prototype.readIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||Ai(e,r,this.length);let n=r,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};le.prototype.readInt8=function(e,r){return e=e>>>0,r||Ai(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};le.prototype.readInt16LE=function(e,r){e=e>>>0,r||Ai(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};le.prototype.readInt16BE=function(e,r){e=e>>>0,r||Ai(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};le.prototype.readInt32LE=function(e,r){return e=e>>>0,r||Ai(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};le.prototype.readInt32BE=function(e,r){return e=e>>>0,r||Ai(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};le.prototype.readBigInt64LE=uu(function(e){e=e>>>0,Bd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ty(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});le.prototype.readBigInt64BE=uu(function(e){e=e>>>0,Bd(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Ty(e,this.length-8);let n=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});le.prototype.readFloatLE=function(e,r){return e=e>>>0,r||Ai(e,4,this.length),Nd.read(this,e,!0,23,4)};le.prototype.readFloatBE=function(e,r){return e=e>>>0,r||Ai(e,4,this.length),Nd.read(this,e,!1,23,4)};le.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||Ai(e,8,this.length),Nd.read(this,e,!0,52,8)};le.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||Ai(e,8,this.length),Nd.read(this,e,!1,52,8)};function kn(t,e,r,i,n,s){if(!le.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}le.prototype.writeUintLE=le.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;kn(this,e,r,i,a,0)}let s=1,o=0;for(this[r]=e&255;++o<i&&(s*=256);)this[r+o]=e/s&255;return r+i};le.prototype.writeUintBE=le.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;kn(this,e,r,i,a,0)}let s=i-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+i};le.prototype.writeUint8=le.prototype.writeUInt8=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,1,255,0),this[r]=e&255,r+1};le.prototype.writeUint16LE=le.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};le.prototype.writeUint16BE=le.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};le.prototype.writeUint32LE=le.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};le.prototype.writeUint32BE=le.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function Pk(t,e,r,i,n){Dk(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function Ck(t,e,r,i,n){Dk(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}le.prototype.writeBigUInt64LE=uu(function(e,r=0){return Pk(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeBigUInt64BE=uu(function(e,r=0){return Ck(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);kn(this,e,r,i,c-1,-c)}let s=0,o=1,a=0;for(this[r]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+i};le.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);kn(this,e,r,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+i};le.prototype.writeInt8=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};le.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};le.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};le.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};le.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||kn(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};le.prototype.writeBigInt64LE=uu(function(e,r=0){return Pk(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});le.prototype.writeBigInt64BE=uu(function(e,r=0){return Ck(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ok(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function kk(t,e,r,i,n){return e=+e,r=r>>>0,n||Ok(t,e,r,4,34028234663852886e22,-34028234663852886e22),Nd.write(t,e,r,i,23,4),r+4}le.prototype.writeFloatLE=function(e,r,i){return kk(this,e,r,!0,i)};le.prototype.writeFloatBE=function(e,r,i){return kk(this,e,r,!1,i)};function qk(t,e,r,i,n){return e=+e,r=r>>>0,n||Ok(t,e,r,8,17976931348623157e292,-17976931348623157e292),Nd.write(t,e,r,i,52,8),r+8}le.prototype.writeDoubleLE=function(e,r,i){return qk(this,e,r,!0,i)};le.prototype.writeDoubleBE=function(e,r,i){return qk(this,e,r,!1,i)};le.prototype.copy=function(e,r,i,n){if(!le.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),r),s};le.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!le.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<i;++s)this[s]=e;else{let o=le.isBuffer(e)?e:le.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=o[s%a]}return this};var Dd={};function tx(t,e,r){Dd[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}tx("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);tx("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);tx("ERR_OUT_OF_RANGE",function(t,e,r){let i=`The value of "${t}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=Nk(String(r)):typeof r=="bigint"&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=Nk(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function Nk(t){let e="",r=t.length,i=t[0]==="-"?1:0;for(;r>=i+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function LAe(t,e,r){Bd(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&Ty(e,t.length-(r+1))}function Dk(t,e,r,i,n,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${r}${o}`,new Dd.ERR_OUT_OF_RANGE("value",a,t)}LAe(i,n,s)}function Bd(t,e){if(typeof t!="number")throw new Dd.ERR_INVALID_ARG_TYPE(e,"number",t)}function Ty(t,e,r){throw Math.floor(t)!==t?(Bd(t,r),new Dd.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new Dd.ERR_BUFFER_OUT_OF_BOUNDS:new Dd.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var UAe=/[^+/0-9A-Za-z-_]/g;function FAe(t){if(t=t.split("=")[0],t=t.trim().replace(UAe,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function rx(t,e){e=e||1/0;let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function KAe(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function jAe(t,e){let r,i,n,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}function Bk(t){return X3.toByteArray(FAe(t))}function qm(t,e,r,i){let n;for(n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function Xo(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function ix(t){return t!==t}var VAe=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let i=r*16;for(let n=0;n<16;++n)e[i+n]=t[r]+t[n]}return e}();function uu(t){return typeof BigInt=="undefined"?zAe:t}function zAe(){throw new Error("BigInt not supported")}});var Kk=p((K3t,Fk)=>{f();var Xr=Fk.exports={},Qo,Zo;function nx(){throw new Error("setTimeout has not been defined")}function sx(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Qo=setTimeout:Qo=nx}catch(t){Qo=nx}try{typeof clearTimeout=="function"?Zo=clearTimeout:Zo=sx}catch(t){Zo=sx}})();function Mk(t){if(Qo===setTimeout)return setTimeout(t,0);if((Qo===nx||!Qo)&&setTimeout)return Qo=setTimeout,setTimeout(t,0);try{return Qo(t,0)}catch(e){try{return Qo.call(null,t,0)}catch(r){return Qo.call(this,t,0)}}}function HAe(t){if(Zo===clearTimeout)return clearTimeout(t);if((Zo===sx||!Zo)&&clearTimeout)return Zo=clearTimeout,clearTimeout(t);try{return Zo(t)}catch(e){try{return Zo.call(null,t)}catch(r){return Zo.call(this,t)}}}var lc=[],Ld=!1,Ml,Nm=-1;function $Ae(){!Ld||!Ml||(Ld=!1,Ml.length?lc=Ml.concat(lc):Nm=-1,lc.length&&Lk())}function Lk(){if(!Ld){var t=Mk($Ae);Ld=!0;for(var e=lc.length;e;){for(Ml=lc,lc=[];++Nm<e;)Ml&&Ml[Nm].run();Nm=-1,e=lc.length}Ml=null,Ld=!1,HAe(t)}}Xr.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];lc.push(new Uk(t,e)),lc.length===1&&!Ld&&Mk(Lk)};function Uk(t,e){this.fun=t,this.array=e}Uk.prototype.run=function(){this.fun.apply(null,this.array)};Xr.title="browser";Xr.browser=!0;Xr.env={};Xr.argv=[];Xr.version="";Xr.versions={};function fc(){}Xr.on=fc;Xr.addListener=fc;Xr.once=fc;Xr.off=fc;Xr.removeListener=fc;Xr.removeAllListeners=fc;Xr.emit=fc;Xr.prependListener=fc;Xr.prependOnceListener=fc;Xr.listeners=function(t){return[]};Xr.binding=function(t){throw new Error("process.binding is not supported")};Xr.cwd=function(){return"/"};Xr.chdir=function(t){throw new Error("process.chdir is not supported")};Xr.umask=function(){return 0}});var Buffer,process,f=Ge(()=>{({Buffer}=Ut()),process=Kk()});var ox=p(()=>{f()});var ax=p(Dm=>{f();"use strict";var jk=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};Dm.TimeoutError=jk;var Vk=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};Dm.AbortError=Vk;var zk=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};Dm.HTTPError=zk});var cx=p(($3t,Hk)=>{f();function GAe(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}Hk.exports=GAe});var Py=p((G3t,$k)=>{f();"use strict";var WAe=cx(),Bm=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Ry=WAe(),YAe=Bm&&!Ry,XAe=Ry&&!Bm,QAe=Ry&&Bm,ZAe=typeof Wo=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!Ry,JAe=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,eIe=typeof process!="undefined"&&typeof process.env!="undefined"&&!1,tIe=typeof navigator!="undefined"&&navigator.product==="ReactNative";$k.exports={isTest:eIe,isElectron:Ry,isElectronMain:XAe,isElectronRenderer:QAe,isNode:ZAe,isBrowser:YAe,isWebWorker:JAe,isEnvWithDom:Bm,isReactNative:tIe}});var Gk=p(()=>{f()});var Cy=p((Ud,Wk)=>{f();"use strict";var rIe=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof dc!="undefined")return dc;throw new Error("unable to locate global object")},dc=rIe();Wk.exports=Ud=dc.fetch;dc.fetch&&(Ud.default=dc.fetch.bind(dc));Ud.Headers=dc.Headers;Ud.Request=dc.Request;Ud.Response=dc.Response});var lx=p((X3t,ux)=>{f();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?ux.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:ux.exports={default:Cy().default,Headers:Cy().Headers,Request:Cy().Request,Response:Cy().Response}});var Yk=p((Q3t,fx)=>{f();"use strict";var{isElectronMain:iIe}=Py();iIe?fx.exports=Gk():fx.exports=lx()});var Jk=p((Z3t,Zk)=>{f();"use strict";var{TimeoutError:nIe,AbortError:sIe}=ax(),{Response:Xk,Request:oIe,Headers:dx,default:aIe}=Yk(),cIe=(t,e={})=>{let r=new XMLHttpRequest;r.open(e.method||"GET",t.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<1/0&&(r.timeout=i),e.overrideMimeType!=null&&r.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new dx(n))r.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>r.abort()),e.onUploadProgress&&(r.upload.onprogress=e.onUploadProgress),r.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(Xk.error());break}case"load":{s(new Qk(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:fIe(r.getAllResponseHeaders())}));break}case"timeout":{o(new nIe);break}case"abort":{o(new sIe);break}default:break}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(e.body)})},uIe=aIe,lIe=(t,e={})=>e.onUploadProgress!=null?cIe(t,e):uIe(t,e),fIe=t=>{let e=new dx;for(let r of t.trim().split(/[\r\n]+/)){let i=r.indexOf(": ");i>0&&e.set(r.slice(0,i),r.slice(i+1))}return e},Qk=class extends Xk{constructor(e,r,i){super(r,i);Object.defineProperty(this,"url",{value:e})}};Zk.exports={fetch:lIe,Request:oIe,Headers:dx}});var tq=p((J3t,eq)=>{f();"use strict";eq.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var hr=p((sq,oq)=>{f();"use strict";var Mm=tq(),{hasOwnProperty:rq}=Object.prototype,{propertyIsEnumerable:dIe}=Object,Fd=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),hIe=sq,iq={concatArrays:!1,ignoreUndefined:!1},Lm=t=>{let e=[];for(let r in t)rq.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let i of r)dIe.call(t,i)&&e.push(i)}return e};function Kd(t){return Array.isArray(t)?pIe(t):Mm(t)?yIe(t):t}function pIe(t){let e=t.slice(0,0);return Lm(t).forEach(r=>{Fd(e,r,Kd(t[r]))}),e}function yIe(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Lm(t).forEach(r=>{Fd(e,r,Kd(t[r]))}),e}var nq=(t,e,r,i)=>(r.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?Fd(t,n,hx(t[n],e[n],i)):Fd(t,n,Kd(e[n])))}),t),gIe=(t,e,r)=>{let i=t.slice(0,0),n=0;return[t,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!rq.call(s,a)||(o.push(String(a)),s===t?Fd(i,n++,s[a]):Fd(i,n++,Kd(s[a])));i=nq(i,s,Lm(s).filter(a=>!o.includes(a)),r)}),i};function hx(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?gIe(t,e,r):!Mm(e)||!Mm(t)?Kd(e):nq(t,e,Lm(e),r)}oq.exports=function(...t){let e=hx(Kd(iq),this!==hIe&&this||{},iq),r={_:{}};for(let i of t)if(i!==void 0){if(!Mm(i))throw new TypeError("`"+i+"` is not an Option Object");r=hx(r,{_:i},e)}return r._}});var px=p((ext,uq)=>{f();"use strict";var bIe=typeof navigator!="undefined"&&navigator.product==="ReactNative";function mIe(){return bIe?"http://localhost":self.location.protocol+"//"+self.location.host}var Oy=self.URL,aq=mIe(),cq=class{constructor(e="",r=aq){this.super=new Oy(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Oy.createObjectURL(e)}static revokeObjectURL(e){Oy.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function vIe(t){if(typeof t=="string")return new Oy(t).toString();if(!(t instanceof Oy)){let e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",i=t.port?":"+t.port:"",n=t.protocol?t.protocol+"//":"",s=t.host||"",o=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"",l=t.path||u+a;return`${n}${e||r}${s||o+i}${l}${c}`}}uq.exports={URLWithLegacySupport:cq,URLSearchParams:self.URLSearchParams,defaultBase:aq,format:vIe}});var dq=p((txt,fq)=>{f();"use strict";var{URLWithLegacySupport:lq,format:wIe}=px();fq.exports=(t,e={},r={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(r[n]||i||n)+":";let s;try{s=new lq(t)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new lq(t,wIe(o)).toString()}});var Um=p((rxt,hq)=>{f();"use strict";var{URLWithLegacySupport:_Ie,format:EIe,URLSearchParams:SIe,defaultBase:xIe}=px(),AIe=dq();hq.exports={URL:_Ie,URLSearchParams:SIe,format:EIe,relative:AIe,defaultBase:xIe}});var Ll=p((ixt,Fm)=>{f();"use strict";var{AbortController:pq,AbortSignal:IIe}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;Fm.exports=pq;Fm.exports.AbortSignal=IIe;Fm.exports.default=pq});var Qi=p((nxt,yq)=>{f();"use strict";var Km;globalThis.AbortController&&globalThis.AbortSignal?Km=globalThis:Km=Ll();yq.exports={AbortController:Km.AbortController,AbortSignal:Km.AbortSignal}});var Ul=p((sxt,yx)=>{f();var{AbortController:TIe}=Qi();function gq(t){let e=new TIe;function r(){e.abort();for(let i of t)!i||!i.removeEventListener||i.removeEventListener("abort",r)}for(let i of t)if(!(!i||!i.addEventListener)){if(i.aborted){r();break}i.addEventListener("abort",r)}return e.signal}yx.exports=gq;yx.exports.anySignal=gq});var ky=p((oxt,Eq)=>{f();"use strict";var{fetch:RIe,Request:PIe,Headers:CIe}=Jk(),{TimeoutError:gx,HTTPError:bq}=ax(),mq=hr().bind({ignoreUndefined:!0}),{URL:vq,URLSearchParams:wq}=Um(),{AbortController:OIe}=Qi(),kIe=Ul(),qIe=(t,e,r)=>{if(e===void 0)return t;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new gx),r.abort())},e),c=u=>d=>{if(clearTimeout(a),n()){o(new gx);return}u(d)};t.then(c(s),c(o))})},NIe={throwHttpErrors:!0,credentials:"same-origin"},bn=class{constructor(e={}){this.opts=mq(NIe,e)}async fetch(e,r={}){let i=mq(this.opts,r),n=new CIe(i.headers);if(typeof e!="string"&&!(e instanceof vq||e instanceof PIe))throw new TypeError("`resource` must be a string, URL, or Request");let s=new vq(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new wq(i.searchParams)):s.search=new wq(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let u=new OIe,l=kIe([u.signal,i.signal]),d=await qIe(RIe(s.toString(),{...i,signal:l,timeout:void 0,headers:n}),i.timeout,u);if(!d.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(d),new bq(d);return d.iterator=function(){return _q(d.body)},d.ndjson=async function*(){for await(let h of DIe(d.iterator()))r.transform?yield r.transform(h):yield h},d}post(e,r={}){return this.fetch(e,{...r,method:"POST"})}get(e,r={}){return this.fetch(e,{...r,method:"GET"})}put(e,r={}){return this.fetch(e,{...r,method:"PUT"})}delete(e,r={}){return this.fetch(e,{...r,method:"DELETE"})}options(e,r={}){return this.fetch(e,{...r,method:"OPTIONS"})}},DIe=async function*(t){let e=new TextDecoder,r="";for await(let i of t){r+=e.decode(i,{stream:!0});let n=r.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}r=n[n.length-1]}r+=e.decode(),r=r.trim(),r.length!==0&&(yield JSON.parse(r))},_q=t=>{if(LIe(t)){let e=t[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(r){return t.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:r})}}}}}if(MIe(t)){let e=t.getReader();return async function*(){try{for(;;){let{done:r,value:i}=await e.read();if(r)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(BIe(t))return t;throw new TypeError("Body can't be converted to AsyncIterable")},BIe=t=>typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function",MIe=t=>t&&typeof t.getReader=="function",LIe=t=>Object.prototype.hasOwnProperty.call(t,"readable")&&Object.prototype.hasOwnProperty.call(t,"writable");bn.HTTPError=bq;bn.TimeoutError=gx;bn.streamToAsyncIterator=_q;bn.post=(t,e)=>new bn(e).post(t,e);bn.get=(t,e)=>new bn(e).get(t,e);bn.put=(t,e)=>new bn(e).put(t,e);bn.delete=(t,e)=>new bn(e).delete(t,e);bn.options=(t,e)=>new bn(e).options(t,e);Eq.exports=bn});var bx=p((axt,Sq)=>{f();"use strict";var UIe=ky(),FIe=(t,e)=>({path:decodeURIComponent(new URL(t).pathname.split("/").pop()||""),content:KIe(t,e)});async function*KIe(t,e){yield*(await new UIe().get(t,e)).iterator()}Sq.exports=FIe});function Aq(t,e,r){e=e||[],r=r||0;for(var i=r;t>=HIe;)e[r++]=t&255|xq,t/=128;for(;t&zIe;)e[r++]=t&255|xq,t>>>=7;return e[r]=t|0,Aq.bytes=r-i+1,e}function mx(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw mx.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&Iq)<<i:(s&Iq)*Math.pow(2,i),i+=7}while(s>=GIe);return mx.bytes=n-e,r}var jIe,xq,VIe,zIe,HIe,$Ie,GIe,Iq,WIe,YIe,XIe,QIe,ZIe,JIe,e4e,t4e,r4e,i4e,n4e,s4e,qy,Tq=Ge(()=>{f();jIe=Aq,xq=128,VIe=127,zIe=~VIe,HIe=Math.pow(2,31);$Ie=mx,GIe=128,Iq=127;WIe=Math.pow(2,7),YIe=Math.pow(2,14),XIe=Math.pow(2,21),QIe=Math.pow(2,28),ZIe=Math.pow(2,35),JIe=Math.pow(2,42),e4e=Math.pow(2,49),t4e=Math.pow(2,56),r4e=Math.pow(2,63),i4e=function(t){return t<WIe?1:t<YIe?2:t<XIe?3:t<QIe?4:t<ZIe?5:t<JIe?6:t<e4e?7:t<t4e?8:t<r4e?9:10},n4e={encode:jIe,decode:$Ie,encodingLength:i4e},s4e=n4e,qy=s4e});var Ny={};Gt(Ny,{decode:()=>jd,encodeTo:()=>Fl,encodingLength:()=>Kl});var jd,Fl,Kl,jm=Ge(()=>{f();Tq();jd=t=>[qy.decode(t),qy.decode.bytes],Fl=(t,e,r=0)=>(qy.encode(t,e,r),e),Kl=t=>qy.encodingLength(t)});var jl={};Gt(jl,{coerce:()=>ao,empty:()=>Rq,equals:()=>vx,fromHex:()=>a4e,fromString:()=>wx,isBinary:()=>c4e,toHex:()=>o4e,toString:()=>_x});var Rq,o4e,a4e,vx,ao,c4e,wx,_x,lu=Ge(()=>{f();Rq=new Uint8Array(0),o4e=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),""),a4e=t=>{let e=t.match(/../g);return e?new Uint8Array(e.map(r=>parseInt(r,16))):Rq},vx=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ao=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},c4e=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t),wx=t=>new TextEncoder().encode(t),_x=t=>new TextDecoder().decode(t)});var mn={};Gt(mn,{Digest:()=>zd,create:()=>Dy,decode:()=>Vd,equals:()=>Ex});var Dy,Vd,Ex,zd,vn=Ge(()=>{f();lu();jm();Dy=(t,e)=>{let r=e.byteLength,i=Kl(t),n=i+Kl(r),s=new Uint8Array(n+r);return Fl(t,s,0),Fl(r,s,i),s.set(e,n),new zd(t,r,e,s)},Vd=t=>{let e=ao(t),[r,i]=jd(e),[n,s]=jd(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new zd(r,n,o,e)},Ex=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&vx(t.bytes,e.bytes),zd=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}});function u4e(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var m=0,E=0,v=0,A=g.length;v!==A&&g[v]===0;)v++,m++;for(var R=(A-v)*l+1>>>0,F=new Uint8Array(R);v!==A;){for(var q=g[v],N=0,z=R-1;(q!==0||N<E)&&z!==-1;z--,N++)q+=256*F[z]>>>0,F[z]=q%a>>>0,q=q/a>>>0;if(q!==0)throw new Error("Non-zero carry");E=N,v++}for(var G=R-E;G!==R&&F[G]===0;)G++;for(var Y=c.repeat(m);G<R;++G)Y+=t.charAt(F[G]);return Y}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var m=0;if(g[m]!==" "){for(var E=0,v=0;g[m]===c;)E++,m++;for(var A=(g.length-m)*u+1>>>0,R=new Uint8Array(A);g[m];){var F=r[g.charCodeAt(m)];if(F===255)return;for(var q=0,N=A-1;(F!==0||q<v)&&N!==-1;N--,q++)F+=a*R[N]>>>0,R[N]=F%256>>>0,F=F/256>>>0;if(F!==0)throw new Error("Non-zero carry");v=q,m++}if(g[m]!==" "){for(var z=A-v;z!==A&&R[z]===0;)z++;for(var G=new Uint8Array(E+(A-z)),Y=E;z!==A;)G[Y++]=R[z++];return G}}}function y(g){var m=h(g);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:y}}var l4e,f4e,Pq,Cq=Ge(()=>{f();l4e=u4e,f4e=l4e,Pq=f4e});var Oq,kq,Vm,qq,zm,fu,d4e,h4e,Lr,Jo=Ge(()=>{f();Cq();lu();Oq=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},kq=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let r={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new Vm(r)}},Vm=class{constructor(e){this.decoders=e}or(e){let r=e.decoders||{[e.prefix]:e};return new Vm({...this.decoders,...r})}decode(e){let r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},qq=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Oq(e,r,i),this.decoder=new kq(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},zm=({name:t,prefix:e,encode:r,decode:i})=>new qq(t,e,r,i),fu=({prefix:t,name:e,alphabet:r})=>{let{encode:i,decode:n}=Pq(r,e);return zm({prefix:t,name:e,encode:i,decode:s=>ao(n(s))})},d4e=(t,e,r,i)=>{let n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let d=n[t[l]];if(d===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},h4e=(t,e,r)=>{let i=e[e.length-1]==="=",n=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Lr=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>zm({prefix:e,name:t,encode(n){return h4e(n,i,r)},decode(n){return d4e(n,i,r,t)}})});var Qr={};Gt(Qr,{base58btc:()=>ea,base58flickr:()=>p4e});var ea,p4e,Zr=Ge(()=>{f();Jo();ea=fu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),p4e=fu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Zi={};Gt(Zi,{base32:()=>Hd,base32hex:()=>m4e,base32hexpad:()=>w4e,base32hexpadupper:()=>_4e,base32hexupper:()=>v4e,base32pad:()=>g4e,base32padupper:()=>b4e,base32upper:()=>y4e,base32z:()=>E4e});var Hd,y4e,g4e,b4e,m4e,v4e,w4e,_4e,E4e,Ji=Ge(()=>{f();Jo();Hd=Lr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),y4e=Lr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),g4e=Lr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),b4e=Lr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),m4e=Lr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),v4e=Lr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),w4e=Lr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_4e=Lr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),E4e=Lr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var ke={};Gt(ke,{CID:()=>rt});var rt,S4e,x4e,A4e,By,I4e,Nq,Dq,Hm,$m,T4e,R4e,P4e,Ae=Ge(()=>{f();jm();vn();Zr();Ji();lu();rt=class{constructor(e,r,i,n){this.code=r,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:$m,byteLength:$m,code:Hm,version:Hm,multihash:Hm,bytes:Hm,_baseCache:$m,asCID:$m})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==By)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==I4e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return rt.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,i=Dy(e,r);return rt.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ex(this.multihash,e.multihash)}toString(e){let{bytes:r,version:i,_baseCache:n}=this;switch(i){case 0:return x4e(r,n,e||ea.encoder);default:return A4e(r,n,e||Hd.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return R4e(/^0\.0/,P4e),!!(e&&(e[Dq]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof rt)return e;if(e!=null&&e.asCID===e){let{version:r,code:i,multihash:n,bytes:s}=e;return new rt(r,i,n,s||Nq(r,i,n.bytes))}else if(e!=null&&e[Dq]===!0){let{version:r,multihash:i,code:n}=e,s=Vd(i);return rt.create(r,n,s)}else return null}static create(e,r,i){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==By)throw new Error(`Version 0 CID must use dag-pb (code: ${By}) block encoding`);return new rt(e,r,i,i.bytes)}case 1:{let n=Nq(e,r,i.bytes);return new rt(e,r,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return rt.create(0,By,e)}static createV1(e,r){return rt.create(1,e,r)}static decode(e){let[r,i]=rt.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=rt.inspectBytes(e),i=r.size-r.multihashSize,n=ao(e.subarray(i,i+r.multihashSize));if(n.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=n.subarray(r.multihashSize-r.digestSize),o=new zd(r.multihashCode,r.digestSize,s,n);return[r.version===0?rt.createV0(o):rt.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,i=()=>{let[d,h]=jd(e.subarray(r));return r+=h,d},n=i(),s=By;if(n===18?(n=0,r=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=r,a=i(),c=i(),u=r+c,l=u-o;return{version:n,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[i,n]=S4e(e,r),s=rt.decode(n);return s._baseCache.set(i,e),s}},S4e=(t,e)=>{switch(t[0]){case"Q":{let r=e||ea;return[ea.prefix,r.decode(`${ea.prefix}${t}`)]}case ea.prefix:{let r=e||ea;return[ea.prefix,r.decode(t)]}case Hd.prefix:{let r=e||Hd;return[Hd.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},x4e=(t,e,r)=>{let{prefix:i}=r;if(i!==ea.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let n=e.get(i);if(n==null){let s=r.encode(t).slice(1);return e.set(i,s),s}else return n},A4e=(t,e,r)=>{let{prefix:i}=r,n=e.get(i);if(n==null){let s=r.encode(t);return e.set(i,s),s}else return n},By=112,I4e=18,Nq=(t,e,r)=>{let i=Kl(t),n=i+Kl(e),s=new Uint8Array(n+r.byteLength);return Fl(t,s,0),Fl(e,s,i),s.set(r,n),s},Dq=Symbol.for("@ipld/js-cid/CID"),Hm={writable:!1,configurable:!1,enumerable:!0},$m={writable:!1,enumerable:!1,configurable:!1},T4e="0.0.0-dev",R4e=(t,e)=>{if(t.test(T4e))console.warn(e);else throw new Error(e)},P4e=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Gm={};Gt(Gm,{base36:()=>C4e,base36upper:()=>O4e});var C4e,O4e,Sx=Ge(()=>{f();Jo();C4e=fu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),O4e=fu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var $d={};Gt($d,{base64:()=>k4e,base64pad:()=>q4e,base64url:()=>N4e,base64urlpad:()=>D4e});var k4e,q4e,N4e,D4e,My=Ge(()=>{f();Jo();k4e=Lr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),q4e=Lr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),N4e=Lr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),D4e=Lr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var Wm={};Gt(Wm,{base16:()=>B4e,base16upper:()=>M4e});var B4e,M4e,xx=Ge(()=>{f();Jo();B4e=Lr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),M4e=Lr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var Mq=p((Ixt,Bq)=>{f();"use strict";Bq.exports=L4e;function L4e(t,e){for(var r=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(a,c){r[i]=function(l){if(s)if(s=!1,l)c(l);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];a.apply(null,d)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var Kq=p(Fq=>{f();"use strict";var Ym=Fq;Ym.length=function(e){var r=e.length;if(!r)return 0;for(var i=0;--r%4>1&&e.charAt(r)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Gd=new Array(64),Lq=new Array(123);for(co=0;co<64;)Lq[Gd[co]=co<26?co+65:co<52?co+71:co<62?co-4:co-59|43]=co++;var co;Ym.encode=function(e,r,i){for(var n=null,s=[],o=0,a=0,c;r<i;){var u=e[r++];switch(a){case 0:s[o++]=Gd[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=Gd[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=Gd[c|u>>6],s[o++]=Gd[u&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Gd[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Uq="invalid encoding";Ym.decode=function(e,r,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=Lq[c])===void 0)throw Error(Uq);switch(s){case 0:o=c,s=1;break;case 1:r[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(Uq);return i-n};Ym.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Vq=p((Rxt,jq)=>{f();"use strict";jq.exports=Xm;function Xm(){this._listeners={}}Xm.prototype.on=function(e,r,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:i||this}),this};Xm.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===r?i.splice(n,1):++n;return this};Xm.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,i)}return this}});var Xq=p((Pxt,Yq)=>{f();"use strict";Yq.exports=zq(zq);function zq(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),i=r[3]===128;function n(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=i?n:s,t.writeFloatBE=i?s:n;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=i?o:a,t.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,Hq),t.writeFloatBE=e.bind(null,$q);function r(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,Gq),t.readFloatBE=r.bind(null,Wq)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),i=r[7]===128;function n(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=i?n:s,t.writeDoubleBE=i?s:n;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=i?o:a,t.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,i(l>>>0,a,c+n),i((u<<31|l/4294967296)>>>0,a,c+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),l=o*Math.pow(2,-d),i(l*4503599627370496>>>0,a,c+n),i((u<<31|d+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,Hq,0,4),t.writeDoubleBE=e.bind(null,$q,4,0);function r(i,n,s,o,a){var c=i(o,a+n),u=i(o,a+s),l=(u>>31)*2+1,d=u>>>20&2047,h=4294967296*(u&1048575)+c;return d===2047?h?NaN:l*(1/0):d===0?l*5e-324*h:l*Math.pow(2,d-1075)*(h+4503599627370496)}t.readDoubleLE=r.bind(null,Gq,0,4),t.readDoubleBE=r.bind(null,Wq,4,0)}(),t}function Hq(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function $q(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Gq(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Wq(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Qq=p((exports,module)=>{f();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Jq=p(Zq=>{f();"use strict";var Ax=Zq;Ax.length=function(e){for(var r=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?r+=1:i<2048?r+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,r+=4):r+=3;return r};Ax.read=function(e,r,i){var n=i-r;if(n<1)return"";for(var s=null,o=[],a=0,c;r<i;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Ax.write=function(e,r,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128);return i-n}});var tN=p((Oxt,eN)=>{f();"use strict";eN.exports=U4e;function U4e(t,e,r){var i=r||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return t(c);o+c>i&&(s=t(i),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var iN=p((kxt,rN)=>{f();"use strict";rN.exports=Ii;var Ly=hu();function Ii(t,e){this.lo=t>>>0,this.hi=e>>>0}var Vl=Ii.zero=new Ii(0,0);Vl.toNumber=function(){return 0};Vl.zzEncode=Vl.zzDecode=function(){return this};Vl.length=function(){return 1};var F4e=Ii.zeroHash="\0\0\0\0\0\0\0\0";Ii.fromNumber=function(e){if(e===0)return Vl;var r=e<0;r&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return r&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Ii(i,n)};Ii.from=function(e){if(typeof e=="number")return Ii.fromNumber(e);if(Ly.isString(e))if(Ly.Long)e=Ly.Long.fromString(e);else return Ii.fromNumber(parseInt(e,10));return e.low||e.high?new Ii(e.low>>>0,e.high>>>0):Vl};Ii.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,i=~this.hi>>>0;return r||(i=i+1>>>0),-(r+i*4294967296)}return this.lo+this.hi*4294967296};Ii.prototype.toLong=function(e){return Ly.Long?new Ly.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var du=String.prototype.charCodeAt;Ii.fromHash=function(e){return e===F4e?Vl:new Ii((du.call(e,0)|du.call(e,1)<<8|du.call(e,2)<<16|du.call(e,3)<<24)>>>0,(du.call(e,4)|du.call(e,5)<<8|du.call(e,6)<<16|du.call(e,7)<<24)>>>0)};Ii.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Ii.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Ii.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Ii.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:i<128?9:10}});var hu=p(Ix=>{f();"use strict";var He=Ix;He.asPromise=Mq();He.base64=Kq();He.EventEmitter=Vq();He.float=Xq();He.inquire=Qq();He.utf8=Jq();He.pool=tN();He.LongBits=iN();He.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);He.global=He.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Ix;He.emptyArray=Object.freeze?Object.freeze([]):[];He.emptyObject=Object.freeze?Object.freeze({}):{};He.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};He.isString=function(e){return typeof e=="string"||e instanceof String};He.isObject=function(e){return e&&typeof e=="object"};He.isset=He.isSet=function(e,r){var i=e[r];return i!=null&&e.hasOwnProperty(r)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};He.Buffer=function(){try{var t=He.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();He._Buffer_from=null;He._Buffer_allocUnsafe=null;He.newBuffer=function(e){return typeof e=="number"?He.Buffer?He._Buffer_allocUnsafe(e):new He.Array(e):He.Buffer?He._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};He.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;He.Long=He.global.dcodeIO&&He.global.dcodeIO.Long||He.global.Long||He.inquire("long");He.key2Re=/^true|false|0|1$/;He.key32Re=/^-?(?:0|[1-9][0-9]*)$/;He.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;He.longToHash=function(e){return e?He.LongBits.from(e).toHash():He.LongBits.zeroHash};He.longFromHash=function(e,r){var i=He.LongBits.fromHash(e);return He.Long?He.Long.fromBits(i.lo,i.hi,r):i.toNumber(Boolean(r))};function nN(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;++n)(t[i[n]]===void 0||!r)&&(t[i[n]]=e[i[n]]);return t}He.merge=nN;He.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function sN(t){function e(r,i){if(!(this instanceof e))return new e(r,i);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&nN(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}He.newError=sN;He.ProtocolError=sN("ProtocolError");He.oneOfGetter=function(e){for(var r={},i=0;i<e.length;++i)r[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(r[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};He.oneOfSetter=function(e){return function(r){for(var i=0;i<e.length;++i)e[i]!==r&&delete this[e[i]]}};He.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};He._configure=function(){var t=He.Buffer;if(!t){He._Buffer_from=He._Buffer_allocUnsafe=null;return}He._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,i){return new t(r,i)},He._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var qx=p((Nxt,uN)=>{f();"use strict";uN.exports=Ct;var ms=hu(),Tx,Qm=ms.LongBits,oN=ms.base64,aN=ms.utf8;function Uy(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Rx(){}function K4e(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Ct(){this.len=0,this.head=new Uy(Rx,0,0),this.tail=this.head,this.states=null}var cN=function(){return ms.Buffer?function(){return(Ct.create=function(){return new Tx})()}:function(){return new Ct}};Ct.create=cN();Ct.alloc=function(e){return new ms.Array(e)};ms.Array!==Array&&(Ct.alloc=ms.pool(Ct.alloc,ms.Array.prototype.subarray));Ct.prototype._push=function(e,r,i){return this.tail=this.tail.next=new Uy(e,r,i),this.len+=r,this};function Px(t,e,r){e[r]=t&255}function j4e(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Cx(t,e){this.len=t,this.next=void 0,this.val=e}Cx.prototype=Object.create(Uy.prototype);Cx.prototype.fn=j4e;Ct.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Cx((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ct.prototype.int32=function(e){return e<0?this._push(Ox,10,Qm.fromNumber(e)):this.uint32(e)};Ct.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ox(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Ct.prototype.uint64=function(e){var r=Qm.from(e);return this._push(Ox,r.length(),r)};Ct.prototype.int64=Ct.prototype.uint64;Ct.prototype.sint64=function(e){var r=Qm.from(e).zzEncode();return this._push(Ox,r.length(),r)};Ct.prototype.bool=function(e){return this._push(Px,1,e?1:0)};function kx(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Ct.prototype.fixed32=function(e){return this._push(kx,4,e>>>0)};Ct.prototype.sfixed32=Ct.prototype.fixed32;Ct.prototype.fixed64=function(e){var r=Qm.from(e);return this._push(kx,4,r.lo)._push(kx,4,r.hi)};Ct.prototype.sfixed64=Ct.prototype.fixed64;Ct.prototype.float=function(e){return this._push(ms.float.writeFloatLE,4,e)};Ct.prototype.double=function(e){return this._push(ms.float.writeDoubleLE,8,e)};var V4e=ms.Array.prototype.set?function(e,r,i){r.set(e,i)}:function(e,r,i){for(var n=0;n<e.length;++n)r[i+n]=e[n]};Ct.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Px,1,0);if(ms.isString(e)){var i=Ct.alloc(r=oN.length(e));oN.decode(e,i,0),e=i}return this.uint32(r)._push(V4e,r,e)};Ct.prototype.string=function(e){var r=aN.length(e);return r?this.uint32(r)._push(aN.write,r,e):this._push(Px,1,0)};Ct.prototype.fork=function(){return this.states=new K4e(this),this.head=this.tail=new Uy(Rx,0,0),this.len=0,this};Ct.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Uy(Rx,0,0),this.len=0),this};Ct.prototype.ldelim=function(){var e=this.head,r=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=r,this.len+=i),this};Ct.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,r,i),i+=e.len,e=e.next;return r};Ct._configure=function(t){Tx=t,Ct.create=cN(),Tx._configure()}});var dN=p((Dxt,fN)=>{f();"use strict";fN.exports=ta;var lN=qx();(ta.prototype=Object.create(lN.prototype)).constructor=ta;var pu=hu();function ta(){lN.call(this)}ta._configure=function(){ta.alloc=pu._Buffer_allocUnsafe,ta.writeBytesBuffer=pu.Buffer&&pu.Buffer.prototype instanceof Uint8Array&&pu.Buffer.prototype.set.name==="set"?function(e,r,i){r.set(e,i)}:function(e,r,i){if(e.copy)e.copy(r,i,0,e.length);else for(var n=0;n<e.length;)r[i++]=e[n++]}};ta.prototype.bytes=function(e){pu.isString(e)&&(e=pu._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(ta.writeBytesBuffer,r,e),this};function z4e(t,e,r){t.length<40?pu.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}ta.prototype.string=function(e){var r=pu.Buffer.byteLength(e);return this.uint32(r),r&&this._push(z4e,r,e),this};ta._configure()});var Bx=p((Bxt,bN)=>{f();"use strict";bN.exports=Jr;var ra=hu(),Nx,hN=ra.LongBits,H4e=ra.utf8;function uo(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Jr(t){this.buf=t,this.pos=0,this.len=t.length}var pN=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Jr(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Jr(e);throw Error("illegal buffer")},yN=function(){return ra.Buffer?function(r){return(Jr.create=function(n){return ra.Buffer.isBuffer(n)?new Nx(n):pN(n)})(r)}:pN};Jr.create=yN();Jr.prototype._slice=ra.Array.prototype.subarray||ra.Array.prototype.slice;Jr.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,uo(this,10);return e}}();Jr.prototype.int32=function(){return this.uint32()|0};Jr.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Dx(){var t=new hN(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw uo(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw uo(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Jr.prototype.bool=function(){return this.uint32()!==0};function Zm(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Jr.prototype.fixed32=function(){if(this.pos+4>this.len)throw uo(this,4);return Zm(this.buf,this.pos+=4)};Jr.prototype.sfixed32=function(){if(this.pos+4>this.len)throw uo(this,4);return Zm(this.buf,this.pos+=4)|0};function gN(){if(this.pos+8>this.len)throw uo(this,8);return new hN(Zm(this.buf,this.pos+=4),Zm(this.buf,this.pos+=4))}Jr.prototype.float=function(){if(this.pos+4>this.len)throw uo(this,4);var e=ra.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Jr.prototype.double=function(){if(this.pos+8>this.len)throw uo(this,4);var e=ra.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Jr.prototype.bytes=function(){var e=this.uint32(),r=this.pos,i=this.pos+e;if(i>this.len)throw uo(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,i):r===i?new this.buf.constructor(0):this._slice.call(this.buf,r,i)};Jr.prototype.string=function(){var e=this.bytes();return H4e.read(e,0,e.length)};Jr.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw uo(this,e);this.pos+=e}else do if(this.pos>=this.len)throw uo(this);while(this.buf[this.pos++]&128);return this};Jr.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Jr._configure=function(t){Nx=t,Jr.create=yN(),Nx._configure();var e=ra.Long?"toLong":"toNumber";ra.merge(Jr.prototype,{int64:function(){return Dx.call(this)[e](!1)},uint64:function(){return Dx.call(this)[e](!0)},sint64:function(){return Dx.call(this).zzDecode()[e](!1)},fixed64:function(){return gN.call(this)[e](!0)},sfixed64:function(){return gN.call(this)[e](!1)}})}});var _N=p((Mxt,wN)=>{f();"use strict";wN.exports=zl;var mN=Bx();(zl.prototype=Object.create(mN.prototype)).constructor=zl;var vN=hu();function zl(t){mN.call(this,t)}zl._configure=function(){vN.Buffer&&(zl.prototype._slice=vN.Buffer.prototype.slice)};zl.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};zl._configure()});var SN=p((Lxt,EN)=>{f();"use strict";EN.exports=Fy;var Mx=hu();(Fy.prototype=Object.create(Mx.EventEmitter.prototype)).constructor=Fy;function Fy(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Mx.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}Fy.prototype.rpcCall=function t(e,r,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return Mx.asPromise(t,o,e,r,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof i))try{u=i[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};Fy.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var AN=p(xN=>{f();"use strict";var $4e=xN;$4e.Service=SN()});var TN=p((Fxt,IN)=>{f();"use strict";IN.exports={}});var CN=p(PN=>{f();"use strict";var qn=PN;qn.build="minimal";qn.Writer=qx();qn.BufferWriter=dN();qn.Reader=Bx();qn.BufferReader=_N();qn.util=hu();qn.rpc=AN();qn.roots=TN();qn.configure=RN;function RN(){qn.util._configure(),qn.Writer._configure(qn.BufferWriter),qn.Reader._configure(qn.BufferReader)}RN()});var Ti=p((jxt,ON)=>{f();"use strict";ON.exports=CN()});var ev=p((Vxt,qN)=>{f();"use strict";var Hl=Ti(),Jm=Hl.Reader,kN=Hl.Writer,en=Hl.util,vs=Hl.roots["libp2p-crypto-keys"]||(Hl.roots["libp2p-crypto-keys"]={});vs.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();vs.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=en.newBuffer([]),t.encode=function(r,i){return i||(i=kN.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Jm||(r=Jm.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new vs.PublicKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw en.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw en.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof vs.PublicKey)return r;var i=new vs.PublicKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?en.base64.decode(r.Data,i.Data=en.newBuffer(en.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=en.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?vs.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?en.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Hl.util.toJSONOptions)},t}();vs.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=en.newBuffer([]),t.encode=function(r,i){return i||(i=kN.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Jm||(r=Jm.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new vs.PrivateKey;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw en.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw en.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof vs.PrivateKey)return r;var i=new vs.PrivateKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?en.base64.decode(r.Data,i.Data=en.newBuffer(en.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=en.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?vs.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?en.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Hl.util.toJSONOptions)},t}();qN.exports=vs});var lt=p((zxt,NN)=>{f();NN.exports={options:{usePureJavaScript:!1}}});var MN=p((Hxt,BN)=>{f();var Lx={};BN.exports=Lx;var DN={};Lx.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(t instanceof Uint8Array))i=G4e(t,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<t.length;++n){for(var c=0,u=t[n];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(n=0;t[n]===0&&n<t.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(r){var l=new RegExp(".{1,"+r+"}","g");i=i.match(l).join(`\r
`)}return i};Lx.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=DN[e];if(!r){r=DN[e]=[];for(var i=0;i<e.length;++i)r[e.charCodeAt(i)]=i}t=t.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<t.length;i++){var a=r[t.charCodeAt(i)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*n,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function G4e(t,e){var r=0,i=e.length,n=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=n;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Wt=p(($xt,KN)=>{f();var LN=lt(),UN=MN(),re=KN.exports=LN.util=LN.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){re.nextTick=process.nextTick,typeof setImmediate=="function"?re.setImmediate=setImmediate:re.setImmediate=re.nextTick;return}if(typeof setImmediate=="function"){re.setImmediate=function(){return setImmediate.apply(void 0,arguments)},re.nextTick=function(a){return setImmediate(a)};return}if(re.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,t="forge.setImmediate",e=[];re.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=re.setImmediate;re.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}re.nextTick=re.setImmediate})();re.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;re.globalScope=function(){return re.isNodejs?globalThis:typeof self=="undefined"?window:self}();re.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};re.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};re.isArrayBufferView=function(t){return t&&re.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Ky(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}re.ByteBuffer=Ux;function Ux(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(re.isArrayBuffer(t)||re.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Ux||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}re.ByteStringBuffer=Ux;var W4e=4096;re.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>W4e&&(this.data.substr(0,1),this._constructedStringLength=0)};re.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};re.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};re.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};re.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};re.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};re.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(re.encodeUtf8(t))};re.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};re.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};re.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};re.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};re.ByteStringBuffer.prototype.putInt=function(t,e){Ky(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};re.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};re.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};re.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};re.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};re.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};re.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};re.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};re.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};re.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};re.ByteStringBuffer.prototype.getInt=function(t){Ky(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};re.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};re.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};re.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};re.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};re.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};re.ByteStringBuffer.prototype.copy=function(){var t=re.createBuffer(this.data);return t.read=this.read,t};re.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};re.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};re.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};re.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};re.ByteStringBuffer.prototype.toString=function(){return re.decodeUtf8(this.bytes())};function Y4e(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=re.isArrayBuffer(t),i=re.isArrayBufferView(t);if(r||i){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}re.DataBuffer=Y4e;re.DataBuffer.prototype.length=function(){return this.write-this.read};re.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};re.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this};re.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};re.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};re.DataBuffer.prototype.putBytes=function(t,e){if(re.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=r.byteLength-r.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(r),this.write+=i,this}if(re.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof re.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&re.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var n=new Uint8Array(t.data.byteLength,this.write);return n.set(r),this.write+=r.byteLength,this}if(t instanceof re.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=re.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=re.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};re.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};re.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};re.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};re.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};re.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};re.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};re.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};re.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};re.DataBuffer.prototype.putInt=function(t,e){Ky(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};re.DataBuffer.prototype.putSignedInt=function(t,e){return Ky(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};re.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};re.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};re.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};re.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};re.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};re.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};re.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};re.DataBuffer.prototype.getInt=function(t){Ky(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};re.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};re.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};re.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};re.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};re.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};re.DataBuffer.prototype.copy=function(){return new re.DataBuffer(this)};re.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};re.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};re.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};re.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};re.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return re.binary.raw.encode(e);if(t==="hex")return re.binary.hex.encode(e);if(t==="base64")return re.binary.base64.encode(e);if(t==="utf8")return re.text.utf8.decode(e);if(t==="utf16")return re.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};re.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=re.encodeUtf8(t)),new re.ByteBuffer(t)};re.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};re.xorBytes=function(t,e,r){for(var i="",n="",s="",o=0,a=0;r>0;--r,++o)n=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};re.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};re.bytesToHex=function(t){return re.createBuffer(t).toHex()};re.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var yu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",gu=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],FN="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";re.encode64=function(t,e){for(var r="",i="",n,s,o,a=0;a<t.length;)n=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=yu.charAt(n>>2),r+=yu.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=yu.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":yu.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};re.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,i,n,s,o=0;o<t.length;)r=gu[t.charCodeAt(o++)-43],i=gu[t.charCodeAt(o++)-43],n=gu[t.charCodeAt(o++)-43],s=gu[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};re.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};re.decodeUtf8=function(t){return decodeURIComponent(escape(t))};re.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:UN.encode,decode:UN.decode}};re.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};re.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};re.binary.hex.encode=re.bytesToHex;re.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var n=0,s=r;for(t.length&1&&(n=1,i[s++]=parseInt(t[0],16));n<t.length;n+=2)i[s++]=parseInt(t.substr(n,2),16);return e?s-r:i};re.binary.base64.encode=function(t,e){for(var r="",i="",n,s,o,a=0;a<t.byteLength;)n=t[a++],s=t[a++],o=t[a++],r+=yu.charAt(n>>2),r+=yu.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=yu.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":yu.charAt(o&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};re.binary.base64.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var n,s,o,a,c=0,u=r;c<t.length;)n=gu[t.charCodeAt(c++)-43],s=gu[t.charCodeAt(c++)-43],o=gu[t.charCodeAt(c++)-43],a=gu[t.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,o!==64&&(i[u++]=(s&15)<<4|o>>2,a!==64&&(i[u++]=(o&3)<<6|a));return e?u-r:i.subarray(0,u)};re.binary.base58.encode=function(t,e){return re.binary.baseN.encode(t,FN,e)};re.binary.base58.decode=function(t,e){return re.binary.baseN.decode(t,FN,e)};re.text={utf8:{},utf16:{}};re.text.utf8.encode=function(t,e,r){t=re.encodeUtf8(t);var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};re.text.utf8.decode=function(t){return re.decodeUtf8(String.fromCharCode.apply(null,t))};re.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length*2));var n=new Uint16Array(i.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)n[o++]=t.charCodeAt(a),s+=2;return e?s-r:i};re.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};re.deflate=function(t,e,r){if(e=re.decode64(t.deflate(re.encode64(e)).rval),r){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};re.inflate=function(t,e,r){var i=t.inflate(re.encode64(e)).rval;return i===null?null:re.decode64(i)};var Fx=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var i;if(r===null?i=t.removeItem(e):(r=re.encode64(JSON.stringify(r)),i=t.setItem(e,r)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},Kx=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(re.decode64(r))),r},X4e=function(t,e,r,i){var n=Kx(t,e);n===null&&(n={}),n[r]=i,Fx(t,e,n)},Q4e=function(t,e,r){var i=Kx(t,e);return i!==null&&(i=r in i?i[r]:null),i},Z4e=function(t,e,r){var i=Kx(t,e);if(i!==null&&r in i){delete i[r];var n=!0;for(var s in i){n=!1;break}n&&(i=null),Fx(t,e,i)}},J4e=function(t,e){Fx(t,e,null)},tv=function(t,e,r){var i=null;typeof r=="undefined"&&(r=["web","flash"]);var n,s=!1,o=null;for(var a in r){n=r[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=t.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};re.setItem=function(t,e,r,i,n){tv(X4e,arguments,n)};re.getItem=function(t,e,r,i){return tv(Q4e,arguments,i)};re.removeItem=function(t,e,r,i){tv(Z4e,arguments,i)};re.clearItems=function(t,e,r){tv(J4e,arguments,r)};re.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),i=r===null?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var rv=null;re.getQueryVariables=function(t){var e=function(i){for(var n={},s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,u;a>0?(c=s[o].substring(0,a),u=s[o].substring(a+1)):(c=s[o],u=null),c in n||(n[c]=[]),!(c in Object.prototype)&&u!==null&&n[c].push(unescape(u))}return n},r;return typeof t=="undefined"?(rv===null&&(typeof window!="undefined"&&window.location&&window.location.search?rv=e(window.location.search.substring(1)):rv={}),r=rv):r=e(t),r};re.parseFragment=function(t){var e=t,r="",i=t.indexOf("?");i>0&&(e=t.substring(0,i),r=t.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=r===""?{}:re.getQueryVariables(r);return{pathString:e,queryString:r,path:n,query:s}};re.makeRequest=function(t){var e=re.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,o=r.getQuery(i);return o?s=o[o.length-1]:s=n,s}};return r};re.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var i=jQuery.param(e||{});return r=r||"",t+(i.length>0?"?"+i:"")+(r.length>0?"#"+r:"")};re.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};re.format=function(t){for(var e=/%./g,r,i,n=0,s=[],o=0;r=e.exec(t);){i=t.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};re.formatNumber=function(t,e,r,i){var n=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-u).toFixed(s).slice(2):"")};re.formatSize=function(t){return t>=1073741824?t=re.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=re.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=re.formatNumber(t/1024,0)+" KiB":t=re.formatNumber(t,0)+" bytes",t};re.bytesFromIP=function(t){return t.indexOf(".")!==-1?re.bytesFromIPv4(t):t.indexOf(":")!==-1?re.bytesFromIPv6(t):null};re.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=re.createBuffer(),r=0;r<t.length;++r){var i=parseInt(t[r],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};re.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,i=re.createBuffer(),n=0;n<8;++n){if(!t[n]||t[n].length===0){i.fillWithByte(0,r),r=0;continue}var s=re.hexToBytes(t[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};re.bytesToIP=function(t){return t.length===4?re.bytesToIPv4(t):t.length===16?re.bytesToIPv6(t):null};re.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};re.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],i=0,n=0;n<t.length;n+=2){for(var s=re.bytesToHex(t[n]+t[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[i].end-r[i].start&&(i=r.length-1))}e.push(s)}if(r.length>0){var c=r[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};re.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in re&&!t.update)return e(null,re.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return re.cores=navigator.hardwareConcurrency,e(null,re.cores);if(typeof Worker=="undefined")return re.cores=1,e(null,re.cores);if(typeof Blob=="undefined")return re.cores=2,e(null,re.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,d){return l+d},0)/o.length);return re.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,re.cores)}n(c,function(l,d){o.push(s(c,d)),i(o,a-1,c)})}function n(o,a){for(var c=[],u=[],l=0;l<o;++l){var d=new Worker(r);d.addEventListener("message",function(h){if(u.push(h.data),u.length===o){for(var y=0;y<o;++y)c[y].terminate();a(null,u)}}),c.push(d)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],d=c[u]=[],h=0;h<o;++h)if(u!==h){var y=a[h];(l.st>y.st&&l.st<y.et||y.st>l.st&&y.st<l.et)&&d.push(h)}return c.reduce(function(g,m){return Math.max(g,m.length)},0)}}});var Wd=p((Gxt,jN)=>{f();var jy=lt();jy.pki=jy.pki||{};var jx=jN.exports=jy.pki.oids=jy.oids=jy.oids||{};function xe(t,e){jx[t]=e,jx[e]=t}function jt(t,e){jx[t]=e}xe("1.2.840.113549.1.1.1","rsaEncryption");xe("1.2.840.113549.1.1.4","md5WithRSAEncryption");xe("1.2.840.113549.1.1.5","sha1WithRSAEncryption");xe("1.2.840.113549.1.1.7","RSAES-OAEP");xe("1.2.840.113549.1.1.8","mgf1");xe("1.2.840.113549.1.1.9","pSpecified");xe("1.2.840.113549.1.1.10","RSASSA-PSS");xe("1.2.840.113549.1.1.11","sha256WithRSAEncryption");xe("1.2.840.113549.1.1.12","sha384WithRSAEncryption");xe("1.2.840.113549.1.1.13","sha512WithRSAEncryption");xe("1.3.101.112","EdDSA25519");xe("1.2.840.10040.4.3","dsa-with-sha1");xe("1.3.14.3.2.7","desCBC");xe("1.3.14.3.2.26","sha1");xe("2.16.840.1.101.3.4.2.1","sha256");xe("2.16.840.1.101.3.4.2.2","sha384");xe("2.16.840.1.101.3.4.2.3","sha512");xe("1.2.840.113549.2.5","md5");xe("1.2.840.113549.1.7.1","data");xe("1.2.840.113549.1.7.2","signedData");xe("1.2.840.113549.1.7.3","envelopedData");xe("1.2.840.113549.1.7.4","signedAndEnvelopedData");xe("1.2.840.113549.1.7.5","digestedData");xe("1.2.840.113549.1.7.6","encryptedData");xe("1.2.840.113549.1.9.1","emailAddress");xe("1.2.840.113549.1.9.2","unstructuredName");xe("1.2.840.113549.1.9.3","contentType");xe("1.2.840.113549.1.9.4","messageDigest");xe("1.2.840.113549.1.9.5","signingTime");xe("1.2.840.113549.1.9.6","counterSignature");xe("1.2.840.113549.1.9.7","challengePassword");xe("1.2.840.113549.1.9.8","unstructuredAddress");xe("1.2.840.113549.1.9.14","extensionRequest");xe("1.2.840.113549.1.9.20","friendlyName");xe("1.2.840.113549.1.9.21","localKeyId");xe("1.2.840.113549.1.9.22.1","x509Certificate");xe("1.2.840.113549.1.12.10.1.1","keyBag");xe("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");xe("1.2.840.113549.1.12.10.1.3","certBag");xe("1.2.840.113549.1.12.10.1.4","crlBag");xe("1.2.840.113549.1.12.10.1.5","secretBag");xe("1.2.840.113549.1.12.10.1.6","safeContentsBag");xe("1.2.840.113549.1.5.13","pkcs5PBES2");xe("1.2.840.113549.1.5.12","pkcs5PBKDF2");xe("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");xe("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");xe("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");xe("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");xe("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");xe("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");xe("1.2.840.113549.2.7","hmacWithSHA1");xe("1.2.840.113549.2.8","hmacWithSHA224");xe("1.2.840.113549.2.9","hmacWithSHA256");xe("1.2.840.113549.2.10","hmacWithSHA384");xe("1.2.840.113549.2.11","hmacWithSHA512");xe("1.2.840.113549.3.7","des-EDE3-CBC");xe("2.16.840.1.101.3.4.1.2","aes128-CBC");xe("2.16.840.1.101.3.4.1.22","aes192-CBC");xe("2.16.840.1.101.3.4.1.42","aes256-CBC");xe("2.5.4.3","commonName");xe("2.5.4.5","serialName");xe("2.5.4.6","countryName");xe("2.5.4.7","localityName");xe("2.5.4.8","stateOrProvinceName");xe("2.5.4.9","streetAddress");xe("2.5.4.10","organizationName");xe("2.5.4.11","organizationalUnitName");xe("2.5.4.13","description");xe("2.5.4.15","businessCategory");xe("2.5.4.17","postalCode");xe("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");xe("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");xe("2.16.840.1.113730.1.1","nsCertType");xe("2.16.840.1.113730.1.13","nsComment");jt("2.5.29.1","authorityKeyIdentifier");jt("2.5.29.2","keyAttributes");jt("2.5.29.3","certificatePolicies");jt("2.5.29.4","keyUsageRestriction");jt("2.5.29.5","policyMapping");jt("2.5.29.6","subtreesConstraint");jt("2.5.29.7","subjectAltName");jt("2.5.29.8","issuerAltName");jt("2.5.29.9","subjectDirectoryAttributes");jt("2.5.29.10","basicConstraints");jt("2.5.29.11","nameConstraints");jt("2.5.29.12","policyConstraints");jt("2.5.29.13","basicConstraints");xe("2.5.29.14","subjectKeyIdentifier");xe("2.5.29.15","keyUsage");jt("2.5.29.16","privateKeyUsagePeriod");xe("2.5.29.17","subjectAltName");xe("2.5.29.18","issuerAltName");xe("2.5.29.19","basicConstraints");jt("2.5.29.20","cRLNumber");jt("2.5.29.21","cRLReason");jt("2.5.29.22","expirationDate");jt("2.5.29.23","instructionCode");jt("2.5.29.24","invalidityDate");jt("2.5.29.25","cRLDistributionPoints");jt("2.5.29.26","issuingDistributionPoint");jt("2.5.29.27","deltaCRLIndicator");jt("2.5.29.28","issuingDistributionPoint");jt("2.5.29.29","certificateIssuer");jt("2.5.29.30","nameConstraints");xe("2.5.29.31","cRLDistributionPoints");xe("2.5.29.32","certificatePolicies");jt("2.5.29.33","policyMappings");jt("2.5.29.34","policyConstraints");xe("2.5.29.35","authorityKeyIdentifier");jt("2.5.29.36","policyConstraints");xe("2.5.29.37","extKeyUsage");jt("2.5.29.46","freshestCRL");jt("2.5.29.54","inhibitAnyPolicy");xe("1.3.6.1.4.1.11129.2.4.2","timestampList");xe("1.3.6.1.5.5.7.1.1","authorityInfoAccess");xe("1.3.6.1.5.5.7.3.1","serverAuth");xe("1.3.6.1.5.5.7.3.2","clientAuth");xe("1.3.6.1.5.5.7.3.3","codeSigning");xe("1.3.6.1.5.5.7.3.4","emailProtection");xe("1.3.6.1.5.5.7.3.8","timeStamping")});var hc=p((Wxt,zN)=>{f();var pr=lt();Wt();Wd();var Be=zN.exports=pr.asn1=pr.asn1||{};Be.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Be.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Be.create=function(t,e,r,i,n){if(pr.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:t,type:e,constructed:r,composed:r||pr.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=Be.copy(a)),a};Be.copy=function(t,e){var r;if(pr.util.isArray(t)){r=[];for(var i=0;i<t.length;++i)r.push(Be.copy(t[i],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Be.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Be.equals=function(t,e,r){if(pr.util.isArray(t)){if(!pr.util.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!Be.equals(t[i],e[i]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var n=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Be.equals(t.value,e.value);return r&&r.includeBitStringContents&&(n=n&&t.bitStringContents===e.bitStringContents),n};Be.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,i=e&128;return i?r=t.getInt((e&127)<<3):r=e,r}};function Vy(t,e,r){if(r>e){var i=new Error("Too few bytes to parse DER.");throw i.available=t.length(),i.remaining=e,i.requested=r,i}}var e5e=function(t,e){var r=t.getByte();if(e--,r!==128){var i,n=r&128;if(!n)i=r;else{var s=r&127;Vy(t,e,s),i=t.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};Be.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=pr.util.createBuffer(t)),iv(t,t.length(),0,e)};function iv(t,e,r,i){var n;Vy(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;n=t.length();var c=e5e(t,e);if(e-=n-t.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,d,h=(s&32)==32;if(h)if(l=[],c===void 0)for(;;){if(Vy(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}n=t.length(),l.push(iv(t,e,r+1,i)),e-=n-t.length()}else for(;c>0;)n=t.length(),l.push(iv(t,c,r+1,i)),e-=n-t.length(),c-=n-t.length();if(l===void 0&&o===Be.Class.UNIVERSAL&&a===Be.Type.BITSTRING&&(d=t.bytes(c)),l===void 0&&i.decodeBitStrings&&o===Be.Class.UNIVERSAL&&a===Be.Type.BITSTRING&&c>1){var y=t.read,g=e,m=0;if(a===Be.Type.BITSTRING&&(Vy(t,e,1),m=t.getByte(),e--),m===0)try{n=t.length();var E={verbose:i.verbose,strict:!0,decodeBitStrings:!0},v=iv(t,e,r+1,E),A=n-t.length();e-=A,a==Be.Type.BITSTRING&&A++;var R=v.tagClass;A===c&&(R===Be.Class.UNIVERSAL||R===Be.Class.CONTEXT_SPECIFIC)&&(l=[v])}catch(q){}l===void 0&&(t.read=y,e=g)}if(l===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Be.Type.BMPSTRING)for(l="";c>0;c-=2)Vy(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c)}var F=d===void 0?null:{bitStringContents:d};return Be.create(o,a,h,l,F)}Be.toDer=function(t){var e=pr.util.createBuffer(),r=t.tagClass|t.type,i=pr.util.createBuffer(),n=!1;if("bitStringContents"in t&&(n=!0,t.original&&(n=Be.equals(t,t.original))),n)i.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:i.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&i.putBuffer(Be.toDer(t.value[s]))}else if(t.type===Be.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)i.putInt16(t.value.charCodeAt(s));else t.type===Be.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?i.putBytes(t.value.substr(1)):i.putBytes(t.value);if(e.putByte(r),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};Be.oidToDer=function(t){var e=t.split("."),r=pr.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)r.putByte(n[c])}return r};Be.derToOid=function(t){var e;typeof t=="string"&&(t=pr.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var i=0;t.length()>0;)r=t.getByte(),i=i<<7,r&128?i+=r&127:(e+="."+(i+r),i=0);return e};Be.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(t.substr(2,2),10)-1,n=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),d=parseInt(t.substr(u+4,2),10),h=l*60+d;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};Be.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),i=parseInt(t.substr(4,2),10)-1,n=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var d=t.length-5,h=t.charAt(d);if(h==="+"||h==="-"){var y=parseInt(t.substr(d+1,2),10),g=parseInt(t.substr(d+4,2),10);u=y*60+g,u*=6e4,h==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(r,i,n),e.setHours(s,o,a,c)),e};Be.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};Be.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};Be.integerToDer=function(t){var e=pr.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Be.derToInteger=function(t){typeof t=="string"&&(t=pr.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Be.validate=function(t,e,r,i){var n=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&pr.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,t.value[s]&&(n=Be.validate(t.value[s],e.value[o],r,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(n&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else i&&(t.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return n};var VN=/[^\\u0000-\\u00ff]/;Be.prettyPrint=function(t,e,r){var i="";e=e||0,r=r||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*r;++s)n+=" ";switch(i+=n+"Tag: ",t.tagClass){case Be.Class.UNIVERSAL:i+="Universal:";break;case Be.Class.APPLICATION:i+="Application:";break;case Be.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case Be.Class.PRIVATE:i+="Private:";break}if(t.tagClass===Be.Class.UNIVERSAL)switch(i+=t.type,t.type){case Be.Type.NONE:i+=" (None)";break;case Be.Type.BOOLEAN:i+=" (Boolean)";break;case Be.Type.INTEGER:i+=" (Integer)";break;case Be.Type.BITSTRING:i+=" (Bit string)";break;case Be.Type.OCTETSTRING:i+=" (Octet string)";break;case Be.Type.NULL:i+=" (Null)";break;case Be.Type.OID:i+=" (Object Identifier)";break;case Be.Type.ODESC:i+=" (Object Descriptor)";break;case Be.Type.EXTERNAL:i+=" (External or Instance of)";break;case Be.Type.REAL:i+=" (Real)";break;case Be.Type.ENUMERATED:i+=" (Enumerated)";break;case Be.Type.EMBEDDED:i+=" (Embedded PDV)";break;case Be.Type.UTF8:i+=" (UTF8)";break;case Be.Type.ROID:i+=" (Relative Object Identifier)";break;case Be.Type.SEQUENCE:i+=" (Sequence)";break;case Be.Type.SET:i+=" (Set)";break;case Be.Type.PRINTABLESTRING:i+=" (Printable String)";break;case Be.Type.IA5String:i+=" (IA5String (ASCII))";break;case Be.Type.UTCTIME:i+=" (UTC time)";break;case Be.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case Be.Type.BMPSTRING:i+=" (BMP String)";break}else i+=t.type;if(i+=`
`,i+=n+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=Be.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",t.type===Be.Type.OID){var c=Be.derToOid(t.value);i+=c,pr.pki&&pr.pki.oids&&c in pr.pki.oids&&(i+=" ("+pr.pki.oids[c]+") ")}if(t.type===Be.Type.INTEGER)try{i+=Be.derToInteger(t.value)}catch(l){i+="0x"+pr.util.bytesToHex(t.value)}else if(t.type===Be.Type.BITSTRING){if(t.value.length>1?i+="0x"+pr.util.bytesToHex(t.value.slice(1)):i+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else t.type===Be.Type.OCTETSTRING?(VN.test(t.value)||(i+="("+t.value+") "),i+="0x"+pr.util.bytesToHex(t.value)):t.type===Be.Type.UTF8?i+=pr.util.decodeUtf8(t.value):t.type===Be.Type.PRINTABLESTRING||t.type===Be.Type.IA5String?i+=t.value:VN.test(t.value)?i+="0x"+pr.util.bytesToHex(t.value):t.value.length===0?i+="[null]":i+=t.value}return i}});var zx=p((Yxt,HN)=>{f();var Ri=lt();Wt();HN.exports=Ri.cipher=Ri.cipher||{};Ri.cipher.algorithms=Ri.cipher.algorithms||{};Ri.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ri.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ri.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ri.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ri.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ri.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ri.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ri.cipher.algorithms[t]=e};Ri.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ri.cipher.algorithms?Ri.cipher.algorithms[t]:null};var Vx=Ri.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Vx.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ri.util.createBuffer(),this.output=t.output||Ri.util.createBuffer(),this.mode.start(e)};Vx.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Vx.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var $x=p((Xxt,$N)=>{f();var Pi=lt();Wt();Pi.cipher=Pi.cipher||{};var gt=$N.exports=Pi.cipher.modes=Pi.cipher.modes||{};gt.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};gt.ecb.prototype.start=function(t){};gt.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};gt.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};gt.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};gt.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};gt.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};gt.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=nv(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};gt.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};gt.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};gt.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};gt.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};gt.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Pi.util.createBuffer(),this._partialBytes=0};gt.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=nv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};gt.cfb.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};gt.cfb.prototype.decrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};gt.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Pi.util.createBuffer(),this._partialBytes=0};gt.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=nv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};gt.ofb.prototype.encrypt=function(t,e,r){var i=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};gt.ofb.prototype.decrypt=gt.ofb.prototype.encrypt;gt.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Pi.util.createBuffer(),this._partialBytes=0};gt.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=nv(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};gt.ctr.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}sv(this._inBlock)};gt.ctr.prototype.decrypt=gt.ctr.prototype.encrypt;gt.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Pi.util.createBuffer(),this._partialBytes=0,this._R=3774873600};gt.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Pi.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Pi.util.createBuffer(t.additionalData):r=Pi.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Pi.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Hx(i*8)))}this._inBlock=this._j0.slice(0),sv(this._inBlock),this._partialBytes=0,r=Pi.util.createBuffer(r),this._aDataLength=Hx(r.length()*8);var n=r.length()%this.blockSize;for(n&&r.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};gt.gcm.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s<=0||r){if(r){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),sv(this._inBlock)};gt.gcm.prototype.decrypt=function(t,e,r){var i=t.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),sv(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};gt.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Pi.util.createBuffer();var i=this._aDataLength.concat(Hx(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};gt.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=t[n/32|0]&1<<31-n%32;s&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i)}return r};gt.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,i=3;i>0;--i)e[i]=t[i]>>>1|(t[i-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};gt.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var i=r/8|0,n=t[i]>>>(7-r%8)*4&15,s=this._m[r][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};gt.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};gt.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,i=4*r,n=16*r,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,u=(i-1-o%i)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};gt.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,i=r>>>1,n=new Array(r);n[i]=t.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<r;++s){var u=n[s^i];n[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return n};function nv(t,e){if(typeof t=="string"&&(t=Pi.util.createBuffer(t)),Pi.util.isArray(t)&&t.length>4){var r=t;t=Pi.util.createBuffer();for(var i=0;i<r.length;++i)t.putByte(r[i])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Pi.util.isArray(t)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(t.getInt32());t=n}return t}function sv(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Hx(t){return[t/4294967296|0,t&4294967295]}});var Qd=p((Qxt,XN)=>{f();var rr=lt();zx();$x();Wt();XN.exports=rr.aes=rr.aes||{};rr.aes.startEncrypting=function(t,e,r,i){var n=ov({key:t,output:r,decrypt:!1,mode:i});return n.start(e),n};rr.aes.createEncryptionCipher=function(t,e){return ov({key:t,output:null,decrypt:!1,mode:e})};rr.aes.startDecrypting=function(t,e,r,i){var n=ov({key:t,output:r,decrypt:!0,mode:i});return n.start(e),n};rr.aes.createDecryptionCipher=function(t,e){return ov({key:t,output:null,decrypt:!0,mode:e})};rr.aes.Algorithm=function(t,e){Gx||WN();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return Yx(r._w,i,n,!1)},decrypt:function(i,n){return Yx(r._w,i,n,!0)}}}),r._init=!1};rr.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=rr.util.createBuffer(e);else if(rr.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=rr.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(!rr.util.isArray(e)){r=e,e=[];var n=r.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(r.getInt32())}}if(!rr.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=YN(e,t.decrypt&&!o),this._init=!0}};rr.aes._expandKey=function(t,e){return Gx||WN(),YN(t,e)};rr.aes._updateBlock=Yx;Yd("AES-ECB",rr.cipher.modes.ecb);Yd("AES-CBC",rr.cipher.modes.cbc);Yd("AES-CFB",rr.cipher.modes.cfb);Yd("AES-OFB",rr.cipher.modes.ofb);Yd("AES-CTR",rr.cipher.modes.ctr);Yd("AES-GCM",rr.cipher.modes.gcm);function Yd(t,e){var r=function(){return new rr.aes.Algorithm(t,e)};rr.cipher.registerAlgorithm(t,r)}var Gx=!1,Xd=4,wn,Wx,GN,$l,lo;function WN(){Gx=!0,GN=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;wn=new Array(256),Wx=new Array(256),$l=new Array(4),lo=new Array(4);for(var e=0;e<4;++e)$l[e]=new Array(256),lo[e]=new Array(256);for(var r=0,i=0,n,s,o,a,c,u,l,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,wn[r]=a,Wx[a]=r,c=t[a],n=t[r],s=t[n],o=t[s],u=c<<24^a<<16^a<<8^(a^c),l=(n^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^n^o);for(var d=0;d<4;++d)$l[d][r]=u,lo[d][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=i=1:(r=n^t[t[t[n^o]]],i^=t[t[i]])}}function YN(t,e){for(var r=t.slice(0),i,n=1,s=r.length,o=s+6+1,a=Xd*o,c=s;c<a;++c)i=r[c-1],c%s==0?(i=wn[i>>>16&255]<<24^wn[i>>>8&255]<<16^wn[i&255]<<8^wn[i>>>24]^GN[n]<<24,n++):s>6&&c%s==4&&(i=wn[i>>>24]<<24^wn[i>>>16&255]<<16^wn[i>>>8&255]<<8^wn[i&255]),r[c]=r[c-s]^i;if(e){var u,l=lo[0],d=lo[1],h=lo[2],y=lo[3],g=r.slice(0);a=r.length;for(var c=0,m=a-Xd;c<a;c+=Xd,m-=Xd)if(c===0||c===a-Xd)g[c]=r[m],g[c+1]=r[m+3],g[c+2]=r[m+2],g[c+3]=r[m+1];else for(var E=0;E<Xd;++E)u=r[m+E],g[c+(3&-E)]=l[wn[u>>>24]]^d[wn[u>>>16&255]]^h[wn[u>>>8&255]]^y[wn[u&255]];r=g}return r}function Yx(t,e,r,i){var n=t.length/4-1,s,o,a,c,u;i?(s=lo[0],o=lo[1],a=lo[2],c=lo[3],u=Wx):(s=$l[0],o=$l[1],a=$l[2],c=$l[3],u=wn);var l,d,h,y,g,m,E;l=e[0]^t[0],d=e[i?3:1]^t[1],h=e[2]^t[2],y=e[i?1:3]^t[3];for(var v=3,A=1;A<n;++A)g=s[l>>>24]^o[d>>>16&255]^a[h>>>8&255]^c[y&255]^t[++v],m=s[d>>>24]^o[h>>>16&255]^a[y>>>8&255]^c[l&255]^t[++v],E=s[h>>>24]^o[y>>>16&255]^a[l>>>8&255]^c[d&255]^t[++v],y=s[y>>>24]^o[l>>>16&255]^a[d>>>8&255]^c[h&255]^t[++v],l=g,d=m,h=E;r[0]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[h>>>8&255]<<8^u[y&255]^t[++v],r[i?3:1]=u[d>>>24]<<24^u[h>>>16&255]<<16^u[y>>>8&255]<<8^u[l&255]^t[++v],r[2]=u[h>>>24]<<24^u[y>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^t[++v],r[i?1:3]=u[y>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[h&255]^t[++v]}function ov(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,i;t.decrypt?i=rr.cipher.createDecipher(r,t.key):i=rr.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof rr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var cv=p((Zxt,ZN)=>{f();var yr=lt();zx();$x();Wt();ZN.exports=yr.des=yr.des||{};yr.des.startEncrypting=function(t,e,r,i){var n=av({key:t,output:r,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};yr.des.createEncryptionCipher=function(t,e){return av({key:t,output:null,decrypt:!1,mode:e})};yr.des.startDecrypting=function(t,e,r,i){var n=av({key:t,output:r,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};yr.des.createDecryptionCipher=function(t,e){return av({key:t,output:null,decrypt:!0,mode:e})};yr.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return QN(r._keys,i,n,!1)},decrypt:function(i,n){return QN(r._keys,i,n,!0)}}}),r._init=!1};yr.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=yr.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=u5e(e),this._init=!0}};ia("DES-ECB",yr.cipher.modes.ecb);ia("DES-CBC",yr.cipher.modes.cbc);ia("DES-CFB",yr.cipher.modes.cfb);ia("DES-OFB",yr.cipher.modes.ofb);ia("DES-CTR",yr.cipher.modes.ctr);ia("3DES-ECB",yr.cipher.modes.ecb);ia("3DES-CBC",yr.cipher.modes.cbc);ia("3DES-CFB",yr.cipher.modes.cfb);ia("3DES-OFB",yr.cipher.modes.ofb);ia("3DES-CTR",yr.cipher.modes.ctr);function ia(t,e){var r=function(){return new yr.des.Algorithm(t,e)};yr.cipher.registerAlgorithm(t,r)}var t5e=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],r5e=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],i5e=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],n5e=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],s5e=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],o5e=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],a5e=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],c5e=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function u5e(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=t.length()>8?3:1,E=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,R,F=0;F<m;F++){var q=t.getInt32(),N=t.getInt32();R=(q>>>4^N)&252645135,N^=R,q^=R<<4,R=(N>>>-16^q)&65535,q^=R,N^=R<<-16,R=(q>>>2^N)&858993459,N^=R,q^=R<<2,R=(N>>>-16^q)&65535,q^=R,N^=R<<-16,R=(q>>>1^N)&1431655765,N^=R,q^=R<<1,R=(N>>>8^q)&16711935,q^=R,N^=R<<8,R=(q>>>1^N)&1431655765,N^=R,q^=R<<1,R=q<<8|N>>>20&240,q=N<<24|N<<8&16711680|N>>>8&65280|N>>>24&240,N=R;for(var z=0;z<v.length;++z){v[z]?(q=q<<2|q>>>26,N=N<<2|N>>>26):(q=q<<1|q>>>27,N=N<<1|N>>>27),q&=-15,N&=-15;var G=e[q>>>28]|r[q>>>24&15]|i[q>>>20&15]|n[q>>>16&15]|s[q>>>12&15]|o[q>>>8&15]|a[q>>>4&15],Y=c[N>>>28]|u[N>>>24&15]|l[N>>>20&15]|d[N>>>16&15]|h[N>>>12&15]|y[N>>>8&15]|g[N>>>4&15];R=(Y>>>16^G)&65535,E[A++]=G^R,E[A++]=Y^R<<16}}return E}function QN(t,e,r,i){var n=t.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var l=s[u+1],d=s[u+2],h=s[u];h!=l;h+=d){var y=c^t[h],g=(c>>>4|c<<28)^t[h+1];o=a,a=c,c=o^(r5e[y>>>24&63]|n5e[y>>>16&63]|o5e[y>>>8&63]|c5e[y&63]|t5e[g>>>24&63]|i5e[g>>>16&63]|s5e[g>>>8&63]|a5e[g&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function av(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,i;t.decrypt?i=yr.cipher.createDecipher(r,t.key):i=yr.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof yr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var bu=p((Jxt,JN)=>{f();var uv=lt();JN.exports=uv.md=uv.md||{};uv.md.algorithms=uv.md.algorithms||{}});var tD=p((e6t,eD)=>{f();var pc=lt();bu();Wt();var l5e=eD.exports=pc.hmac=pc.hmac||{};l5e.create=function(){var t=null,e=null,r=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in pc.md.algorithms)e=pc.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=pc.util.createBuffer(o);else if(pc.util.isArray(o)){var a=o;o=pc.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=pc.util.createBuffer(),i=pc.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),i.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),i.putByte(92);t=o,r=r.bytes(),i=i.bytes()}e.start(),e.update(r)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var Zd=p(()=>{f()});var Xx=p((i6t,rD)=>{f();var _n=lt();tD();bu();Wt();var f5e=_n.pkcs5=_n.pkcs5||{},yc;_n.util.isNodejs&&!_n.options.usePureJavaScript&&(yc=Zd());rD.exports=_n.pbkdf2=f5e.pbkdf2=function(t,e,r,i,n,s){if(typeof n=="function"&&(s=n,n=null),_n.util.isNodejs&&!_n.options.usePureJavaScript&&yc.pbkdf2&&(n===null||typeof n!="object")&&(yc.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?yc.pbkdf2Sync.length===4?yc.pbkdf2(t,e,r,i,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):yc.pbkdf2(t,e,r,i,n,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):yc.pbkdf2Sync.length===4?yc.pbkdf2Sync(t,e,r,i).toString("binary"):yc.pbkdf2Sync(t,e,r,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in _n.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=_n.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),u=i-(c-1)*o,l=_n.hmac.create();l.start(n,t);var d="",h,y,g;if(!s){for(var m=1;m<=c;++m){l.start(null,null),l.update(e),l.update(_n.util.int32ToBytes(m)),h=g=l.digest().getBytes();for(var E=2;E<=r;++E)l.start(null,null),l.update(g),y=l.digest().getBytes(),h=_n.util.xorBytes(h,y,o),g=y;d+=m<c?h:h.substr(0,u)}return d}var m=1,E;function v(){if(m>c)return s(null,d);l.start(null,null),l.update(e),l.update(_n.util.int32ToBytes(m)),h=g=l.digest().getBytes(),E=2,A()}function A(){if(E<=r)return l.start(null,null),l.update(g),y=l.digest().getBytes(),h=_n.util.xorBytes(h,y,o),g=y,++E,_n.util.setImmediate(A);d+=m<c?h:h.substr(0,u),++m,v()}v()}});var dv=p((n6t,nD)=>{f();var lv=lt();Wt();var iD=nD.exports=lv.pem=lv.pem||{};iD.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,i;if(t.procType&&(i={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=fv(i)),t.contentDomain&&(i={name:"Content-Domain",values:[t.contentDomain]},r+=fv(i)),t.dekInfo&&(i={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&i.values.push(t.dekInfo.parameters),r+=fv(i)),t.headers)for(var n=0;n<t.headers.length;++n)r+=fv(t.headers[n]);return t.procType&&(r+=`\r
`),r+=lv.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};iD.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=r.exec(t),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:lv.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(n),c=0;s&&c<a.length;){for(var u=a[c].replace(/\s+$/,""),l=c+1;l<a.length;++l){var d=a[l];if(!/\s/.test(d[0]))break;u+=d,c=l}if(s=u.match(i),s){for(var h={name:s[1],values:[]},y=s[2].split(","),g=0;g<y.length;++g)h.values.push(d5e(y[g]));if(o.procType)if(!o.contentDomain&&h.name==="Content-Domain")o.contentDomain=y[0]||"";else if(!o.dekInfo&&h.name==="DEK-Info"){if(h.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:y[0],parameters:y[1]||null}}else o.headers.push(h);else{if(h.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(h.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:y[0],type:y[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function fv(t){for(var e=t.name+": ",r=[],i=function(c,u){return" "+u},n=0;n<t.values.length;++n)r.push(t.values[n].replace(/^(\S+\r\n)/,i));e+=r.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function d5e(t){return t.replace(/^\s+/,"")}});var lD=p((s6t,uD)=>{f();var na=lt();bu();Wt();var sD=uD.exports=na.sha256=na.sha256||{};na.md.sha256=na.md.algorithms.sha256=sD;sD.create=function(){oD||h5e();var t=null,e=na.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=na.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=na.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),cD(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=na.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(Qx.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};cD(d,r,n);var h=na.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h.putInt32(d.h5),h.putInt32(d.h6),h.putInt32(d.h7),h},i};var Qx=null,oD=!1,aD=null;function h5e(){Qx=String.fromCharCode(128),Qx+=na.util.fillString(String.fromCharCode(0),64),aD=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],oD=!0}function cD(t,e,r){for(var i,n,s,o,a,c,u,l,d,h,y,g,m,E,v,A=r.length();A>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(l=t.h0,d=t.h1,h=t.h2,y=t.h3,g=t.h4,m=t.h5,E=t.h6,v=t.h7,u=0;u<64;++u)o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),a=E^g&(m^E),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&d|h&(l^d),i=v+o+a+aD[u]+e[u],n=s+c,v=E,E=m,m=g,g=y+i>>>0,y=h,h=d,d=l,l=i+n>>>0;t.h0=t.h0+l|0,t.h1=t.h1+d|0,t.h2=t.h2+h|0,t.h3=t.h3+y|0,t.h4=t.h4+g|0,t.h5=t.h5+m|0,t.h6=t.h6+E|0,t.h7=t.h7+v|0,A-=64}}});var dD=p((o6t,fD)=>{f();var sa=lt();Wt();var hv=null;sa.util.isNodejs&&!sa.options.usePureJavaScript&&!process.versions["node-webkit"]&&(hv=Zd());var p5e=fD.exports=sa.prng=sa.prng||{};p5e.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,i=new Array(32),n=0;n<32;++n)i[n]=r.create();e.pools=i,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var d=e.plugin.cipher,h=e.plugin.increment,y=e.plugin.formatKey,g=e.plugin.formatSeed,m=sa.util.createBuffer();e.key=null,E();function E(v){if(v)return l(v);if(m.length()>=u)return l(null,m.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return sa.util.nextTick(function(){s(E)});var A=d(e.key,e.seed);e.generated+=A.length,m.putBytes(A),e.key=y(d(e.key,h(e.seed))),e.seed=g(d(e.key,e.seed)),sa.util.setImmediate(E)}},e.generateSync=function(u){var l=e.plugin.cipher,d=e.plugin.increment,h=e.plugin.formatKey,y=e.plugin.formatSeed;e.key=null;for(var g=sa.util.createBuffer();g.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var m=l(e.key,e.seed);e.generated+=m.length,g.putBytes(m),e.key=h(l(e.key,d(e.seed))),e.seed=y(l(e.key,e.seed))}return g.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(d,h){if(d)return u(d);e.collect(h),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,d=0;d<32;++d)e.reseeds%l==0&&(u.update(e.pools[d].digest().getBytes()),e.pools[d].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var l=null,d=sa.util.globalScope,h=d.crypto||d.msCrypto;h&&h.getRandomValues&&(l=function(q){return h.getRandomValues(q)});var y=sa.util.createBuffer();if(l)for(;y.length()<u;){var g=Math.max(1,Math.min(u-y.length(),65536)/4),m=new Uint32Array(Math.floor(g));try{l(m);for(var E=0;E<m.length;++E)y.putInt32(m[E])}catch(q){if(!(typeof QuotaExceededError!="undefined"&&q instanceof QuotaExceededError))throw q}}if(y.length()<u)for(var v,A,R,F=Math.floor(Math.random()*65536);y.length()<u;){A=16807*(F&65535),v=16807*(F>>16),A+=(v&32767)<<16,A+=v>>15,A=(A&2147483647)+(A>>31),F=A&4294967295;for(var E=0;E<3;++E)R=F>>>(E<<3),R^=Math.floor(Math.random()*256),y.putByte(String.fromCharCode(R&255))}return y.getBytes(u)}return hv?(e.seedFile=function(u,l){hv.randomBytes(u,function(d,h){if(d)return l(d);l(null,h.toString())})},e.seedFileSync=function(u){return hv.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(d){l(d)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,d=0;d<l;++d)e.pools[e.pool].update(u.substr(d,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var d="",h=0;h<l;h+=8)d+=String.fromCharCode(u>>h&255);e.collect(d)},e.registerWorker=function(u){if(u===self)e.seedFile=function(d,h){function y(g){var m=g.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",y),h(m.forge.prng.err,m.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:d}}})};else{var l=function(d){var h=d.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(y,g){u.postMessage({forge:{prng:{err:y,bytes:g}}})})};u.addEventListener("message",l)}},e}});var mu=p((a6t,Zx)=>{f();var Ci=lt();Qd();lD();dD();Wt();(function(){if(Ci.random&&Ci.random.getBytes){Zx.exports=Ci.random;return}(function(t){var e={},r=new Array(4),i=Ci.util.createBuffer();e.formatKey=function(d){var h=Ci.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),Ci.aes._expandKey(d,!1)},e.formatSeed=function(d){var h=Ci.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),d},e.cipher=function(d,h){return Ci.aes._updateBlock(d,h,r,!1),i.putInt32(r[0]),i.putInt32(r[1]),i.putInt32(r[2]),i.putInt32(r[3]),i.getBytes()},e.increment=function(d){return++d[3],d},e.md=Ci.md.sha256;function n(){var d=Ci.prng.create(e);return d.getBytes=function(h,y){return d.generate(h,y)},d.getBytesSync=function(h){return d.generate(h)},d}var s=n(),o=null,a=Ci.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(d){return c.getRandomValues(d)}),Ci.options.usePureJavaScript||!Ci.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(d){}s.collect(u),u=null}t&&(t().mousemove(function(d){s.collectInt(d.clientX,16),s.collectInt(d.clientY,16)}),t().keypress(function(d){s.collectInt(d.charCode,8)}))}if(!Ci.random)Ci.random=s;else for(var l in s)Ci.random[l]=s[l];Ci.random.createInstance=n,Zx.exports=Ci.random})(typeof jQuery!="undefined"?jQuery:null)})()});var gD=p((c6t,yD)=>{f();var Nn=lt();Wt();var Jx=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],hD=[1,2,3,5],y5e=function(t,e){return t<<e&65535|(t&65535)>>16-e},g5e=function(t,e){return(t&65535)>>e|t<<16-e&65535};yD.exports=Nn.rc2=Nn.rc2||{};Nn.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Nn.util.createBuffer(t)),e=e||128;var r=t,i=t.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)r.putByte(Jx[r.at(a-1)+r.at(a-i)&255]);for(r.setAt(128-s,Jx[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Jx[r.at(a+1)^r.at(a+s)]);return r};var pD=function(t,e,r){var i=!1,n=null,s=null,o=null,a,c,u,l,d=[];for(t=Nn.rc2.expandKey(t,e),u=0;u<64;u++)d.push(t.getInt16Le());r?(a=function(g){for(u=0;u<4;u++)g[u]+=d[l]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),g[u]=y5e(g[u],hD[u]),l++},c=function(g){for(u=0;u<4;u++)g[u]+=d[g[(u+3)%4]&63]}):(a=function(g){for(u=3;u>=0;u--)g[u]=g5e(g[u],hD[u]),g[u]-=d[l]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),l--},c=function(g){for(u=3;u>=0;u--)g[u]-=d[g[(u+3)%4]&63]});var h=function(g){var m=[];for(u=0;u<4;u++){var E=n.getInt16Le();o!==null&&(r?E^=o.getInt16Le():o.putInt16Le(E)),m.push(E&65535)}l=r?0:63;for(var v=0;v<g.length;v++)for(var A=0;A<g[v][0];A++)g[v][1](m);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(m[u]):m[u]^=o.getInt16Le()),s.putInt16Le(m[u])},y=null;return y={start:function(g,m){g&&typeof g=="string"&&(g=Nn.util.createBuffer(g)),i=!1,n=Nn.util.createBuffer(),s=m||new Nn.util.createBuffer,o=g,y.output=s},update:function(g){for(i||n.putBuffer(g);n.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(g){var m=!0;if(r)if(g)m=g(8,n,!r);else{var E=n.length()===8?8:8-n.length();n.fillWithByte(E,E)}if(m&&(i=!0,y.update()),!r&&(m=n.length()===0,m))if(g)m=g(8,s,!r);else{var v=s.length(),A=s.at(v-1);A>v?m=!1:s.truncate(A)}return m}},y};Nn.rc2.startEncrypting=function(t,e,r){var i=Nn.rc2.createEncryptionCipher(t,128);return i.start(e,r),i};Nn.rc2.createEncryptionCipher=function(t,e){return pD(t,e,!0)};Nn.rc2.startDecrypting=function(t,e,r){var i=Nn.rc2.createDecryptionCipher(t,128);return i.start(e,r),i};Nn.rc2.createDecryptionCipher=function(t,e){return pD(t,e,!1)}});var Hy=p((u6t,xD)=>{f();var e6=lt();xD.exports=e6.jsbn=e6.jsbn||{};var gc,b5e=244837814094590,bD=(b5e&16777215)==15715070;function we(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}e6.jsbn.BigInteger=we;function Ot(){return new we(null)}function m5e(t,e,r,i,n,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[i]+n;n=Math.floor(o/67108864),r.data[i++]=o&67108863}return n}function v5e(t,e,r,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+r.data[i]+(n&1073741823),n=(c>>>30)+(l>>>15)+a*u+(n>>>30),r.data[i++]=c&1073741823}return n}function mD(t,e,r,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+r.data[i]+n,n=(c>>28)+(l>>14)+a*u,r.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(we.prototype.am=mD,gc=28):bD&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=v5e,gc=30):bD&&navigator.appName!="Netscape"?(we.prototype.am=m5e,gc=26):(we.prototype.am=mD,gc=28);we.prototype.DB=gc;we.prototype.DM=(1<<gc)-1;we.prototype.DV=1<<gc;var t6=52;we.prototype.FV=Math.pow(2,t6);we.prototype.F1=t6-gc;we.prototype.F2=2*gc-t6;var w5e="0123456789abcdefghijklmnopqrstuvwxyz",pv=new Array,Jd,ws;Jd="0".charCodeAt(0);for(ws=0;ws<=9;++ws)pv[Jd++]=ws;Jd="a".charCodeAt(0);for(ws=10;ws<36;++ws)pv[Jd++]=ws;Jd="A".charCodeAt(0);for(ws=10;ws<36;++ws)pv[Jd++]=ws;function vD(t){return w5e.charAt(t)}function wD(t,e){var r=pv[t.charCodeAt(e)];return r??-1}function _5e(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function E5e(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function vu(t){var e=Ot();return e.fromInt(t),e}function S5e(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var o=r==8?t[i]&255:wD(t,i);if(o<0){t.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&we.ZERO.subTo(this,this)}function x5e(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function A5e(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=vD(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=vD(i));return n?s:"0"}function I5e(){var t=Ot();return we.ZERO.subTo(this,t),t}function T5e(){return this.s<0?this.negate():this}function R5e(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function yv(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function P5e(){return this.t<=0?0:this.DB*(this.t-1)+yv(this.data[this.t-1]^this.s&this.DM)}function C5e(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function O5e(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function k5e(t,e){var r=t%this.DB,i=this.DB-r,n=(1<<i)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function q5e(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<n,e.data[o-r]=this.data[o]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}function N5e(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function D5e(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+r.t]=r.am(0,i.data[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&we.ZERO.subTo(e,e)}function B5e(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function M5e(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Ot());var s=Ot(),o=this.s,a=t.s,c=this.DB-yv(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,r)):(i.copyTo(s),n.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var d=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/d,y=(1<<this.F1)/d,g=1<<this.F2,m=r.t,E=m-u,v=e??Ot();for(s.dlShiftTo(E,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),we.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--E>=0;){var A=r.data[--m]==l?this.DM:Math.floor(r.data[m]*h+(r.data[m-1]+g)*y);if((r.data[m]+=s.am(0,A,r,E,0,u))<A)for(s.dlShiftTo(E,v),r.subTo(v,r);r.data[m]<--A;)r.subTo(v,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&we.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&we.ZERO.subTo(r,r)}}}function L5e(t){var e=Ot();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&t.subTo(e,e),e}function Gl(t){this.m=t}function U5e(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function F5e(t){return t}function K5e(t){t.divRemTo(this.m,null,t)}function j5e(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function V5e(t,e){t.squareTo(e),this.reduce(e)}Gl.prototype.convert=U5e;Gl.prototype.revert=F5e;Gl.prototype.reduce=K5e;Gl.prototype.mulTo=j5e;Gl.prototype.sqrTo=V5e;function z5e(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Wl(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function H5e(t){var e=Ot();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function $5e(t){var e=Ot();return t.copyTo(e),this.reduce(e),e}function G5e(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function W5e(t,e){t.squareTo(e),this.reduce(e)}function Y5e(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Wl.prototype.convert=H5e;Wl.prototype.revert=$5e;Wl.prototype.reduce=G5e;Wl.prototype.mulTo=Y5e;Wl.prototype.sqrTo=W5e;function X5e(){return(this.t>0?this.data[0]&1:this.s)==0}function Q5e(t,e){if(t>4294967295||t<1)return we.ONE;var r=Ot(),i=Ot(),n=e.convert(this),s=yv(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var o=r;r=i,i=o}return e.revert(r)}function Z5e(t,e){var r;return t<256||e.isEven()?r=new Gl(e):r=new Wl(e),this.exp(t,r)}we.prototype.copyTo=_5e;we.prototype.fromInt=E5e;we.prototype.fromString=S5e;we.prototype.clamp=x5e;we.prototype.dlShiftTo=C5e;we.prototype.drShiftTo=O5e;we.prototype.lShiftTo=k5e;we.prototype.rShiftTo=q5e;we.prototype.subTo=N5e;we.prototype.multiplyTo=D5e;we.prototype.squareTo=B5e;we.prototype.divRemTo=M5e;we.prototype.invDigit=z5e;we.prototype.isEven=X5e;we.prototype.exp=Q5e;we.prototype.toString=A5e;we.prototype.negate=I5e;we.prototype.abs=T5e;we.prototype.compareTo=R5e;we.prototype.bitLength=P5e;we.prototype.mod=L5e;we.prototype.modPowInt=Z5e;we.ZERO=vu(0);we.ONE=vu(1);function J5e(){var t=Ot();return this.copyTo(t),t}function eTe(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function tTe(){return this.t==0?this.s:this.data[0]<<24>>24}function rTe(){return this.t==0?this.s:this.data[0]<<16>>16}function iTe(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function nTe(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function sTe(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=vu(r),n=Ot(),s=Ot(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(t)+o}function oTe(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,o=0,a=0;a<t.length;++a){var c=wD(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&we.ZERO.subTo(this,this)}function aTe(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(we.ONE.shiftLeft(t-1),r6,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(we.ONE.shiftLeft(t-1),this);else{var i=new Array,n=t&7;i.length=(t>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function cTe(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,i,n=0;if(t-- >0)for(r<this.DB&&(i=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=i|this.s<<this.DB-r);t>=0;)r<8?(i=(this.data[t]&(1<<r)-1)<<8-r,i|=this.data[--t]>>(r+=this.DB-8)):(i=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function uTe(t){return this.compareTo(t)==0}function lTe(t){return this.compareTo(t)<0?this:t}function fTe(t){return this.compareTo(t)>0?this:t}function dTe(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;i<s;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function hTe(t,e){return t&e}function pTe(t){var e=Ot();return this.bitwiseTo(t,hTe,e),e}function r6(t,e){return t|e}function yTe(t){var e=Ot();return this.bitwiseTo(t,r6,e),e}function _D(t,e){return t^e}function gTe(t){var e=Ot();return this.bitwiseTo(t,_D,e),e}function ED(t,e){return t&~e}function bTe(t){var e=Ot();return this.bitwiseTo(t,ED,e),e}function mTe(){for(var t=Ot(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function vTe(t){var e=Ot();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function wTe(t){var e=Ot();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function _Te(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function ETe(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+_Te(this.data[t]);return this.s<0?this.t*this.DB:-1}function STe(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function xTe(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=STe(this.data[r]^e);return t}function ATe(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function ITe(t,e){var r=we.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function TTe(t){return this.changeBit(t,r6)}function RTe(t){return this.changeBit(t,ED)}function PTe(t){return this.changeBit(t,_D)}function CTe(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e.data[r++]=i:i<-1&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function OTe(t){var e=Ot();return this.addTo(t,e),e}function kTe(t){var e=Ot();return this.subTo(t,e),e}function qTe(t){var e=Ot();return this.multiplyTo(t,e),e}function NTe(t){var e=Ot();return this.divRemTo(t,e,null),e}function DTe(t){var e=Ot();return this.divRemTo(t,null,e),e}function BTe(t){var e=Ot(),r=Ot();return this.divRemTo(t,e,r),new Array(e,r)}function MTe(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function LTe(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function zy(){}function SD(t){return t}function UTe(t,e,r){t.multiplyTo(e,r)}function FTe(t,e){t.squareTo(e)}zy.prototype.convert=SD;zy.prototype.revert=SD;zy.prototype.mulTo=UTe;zy.prototype.sqrTo=FTe;function KTe(t){return this.exp(t,new zy)}function jTe(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,t.data[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t.data[i],r,i,0,e-i);r.clamp()}function VTe(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function eh(t){this.r2=Ot(),this.q3=Ot(),we.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function zTe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Ot();return t.copyTo(e),this.reduce(e),e}function HTe(t){return t}function $Te(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function GTe(t,e){t.squareTo(e),this.reduce(e)}function WTe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}eh.prototype.convert=zTe;eh.prototype.revert=HTe;eh.prototype.reduce=$Te;eh.prototype.mulTo=WTe;eh.prototype.sqrTo=GTe;function YTe(t,e){var r=t.bitLength(),i,n=vu(1),s;if(r<=0)return n;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6,r<8?s=new Gl(e):e.isEven()?s=new eh(e):s=new Wl(e);var o=new Array,a=3,c=i-1,u=(1<<i)-1;if(o[1]=s.convert(this),i>1){var l=Ot();for(s.sqrTo(o[1],l);a<=u;)o[a]=Ot(),s.mulTo(l,o[a-2],o[a]),a+=2}var d=t.t-1,h,y=!0,g=Ot(),m;for(r=yv(t.data[d])-1;d>=0;){for(r>=c?h=t.data[d]>>r-c&u:(h=(t.data[d]&(1<<r+1)-1)<<c-r,d>0&&(h|=t.data[d-1]>>this.DB+r-c)),a=i;(h&1)==0;)h>>=1,--a;if((r-=a)<0&&(r+=this.DB,--d),y)o[h].copyTo(n),y=!1;else{for(;a>1;)s.sqrTo(n,g),s.sqrTo(g,n),a-=2;a>0?s.sqrTo(n,g):(m=n,n=g,g=m),s.mulTo(g,o[h],n)}for(;d>=0&&(t.data[d]&1<<r)==0;)s.sqrTo(n,g),m=n,n=g,g=m,--r<0&&(r=this.DB-1,--d)}return s.revert(n)}function XTe(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function QTe(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function ZTe(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return we.ZERO;for(var r=t.clone(),i=this.clone(),n=vu(1),s=vu(0),o=vu(0),a=vu(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(r,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(we.ONE)!=0)return we.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var fo=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],JTe=(1<<26)/fo[fo.length-1];function eRe(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=fo[fo.length-1]){for(e=0;e<fo.length;++e)if(r.data[0]==fo[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<fo.length;){for(var i=fo[e],n=e+1;n<fo.length&&i<JTe;)i*=fo[n++];for(i=r.modInt(i);e<n;)if(i%fo[e++]==0)return!1}return r.millerRabin(t)}function tRe(t){var e=this.subtract(we.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var i=e.shiftRight(r),n=rRe(),s,o=0;o<t;++o){do s=new we(this.bitLength(),n);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(we.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(we.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function rRe(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=iTe;we.prototype.toRadix=sTe;we.prototype.fromRadix=oTe;we.prototype.fromNumber=aTe;we.prototype.bitwiseTo=dTe;we.prototype.changeBit=ITe;we.prototype.addTo=CTe;we.prototype.dMultiply=MTe;we.prototype.dAddOffset=LTe;we.prototype.multiplyLowerTo=jTe;we.prototype.multiplyUpperTo=VTe;we.prototype.modInt=QTe;we.prototype.millerRabin=tRe;we.prototype.clone=J5e;we.prototype.intValue=eTe;we.prototype.byteValue=tTe;we.prototype.shortValue=rTe;we.prototype.signum=nTe;we.prototype.toByteArray=cTe;we.prototype.equals=uTe;we.prototype.min=lTe;we.prototype.max=fTe;we.prototype.and=pTe;we.prototype.or=yTe;we.prototype.xor=gTe;we.prototype.andNot=bTe;we.prototype.not=mTe;we.prototype.shiftLeft=vTe;we.prototype.shiftRight=wTe;we.prototype.getLowestSetBit=ETe;we.prototype.bitCount=xTe;we.prototype.testBit=ATe;we.prototype.setBit=TTe;we.prototype.clearBit=RTe;we.prototype.flipBit=PTe;we.prototype.add=OTe;we.prototype.subtract=kTe;we.prototype.multiply=qTe;we.prototype.divide=NTe;we.prototype.remainder=DTe;we.prototype.divideAndRemainder=BTe;we.prototype.modPow=YTe;we.prototype.modInverse=ZTe;we.prototype.pow=KTe;we.prototype.gcd=XTe;we.prototype.isProbablePrime=eRe});var PD=p((l6t,RD)=>{f();var oa=lt();bu();Wt();var AD=RD.exports=oa.sha1=oa.sha1||{};oa.md.sha1=oa.md.algorithms.sha1=AD;AD.create=function(){ID||iRe();var t=null,e=oa.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=oa.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=oa.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),TD(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=oa.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(i6.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};TD(d,r,n);var h=oa.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h},i};var i6=null,ID=!1;function iRe(){i6=String.fromCharCode(128),i6+=oa.util.fillString(String.fromCharCode(0),64),ID=!0}function TD(t,e,r){for(var i,n,s,o,a,c,u,l,d=r.length();d>=64;){for(n=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,l=0;l<16;++l)i=r.getInt32(),e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<20;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<32;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<40;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<60;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s&o|a&(s^o),i=(n<<5|n>>>27)+u+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<80;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;t.h0=t.h0+n|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,d-=64}}});var kD=p((f6t,OD)=>{f();var aa=lt();Wt();mu();PD();var CD=OD.exports=aa.pkcs1=aa.pkcs1||{};CD.encode_rsa_oaep=function(t,e,r){var i,n,s,o;typeof r=="string"?(i=r,n=arguments[3]||void 0,s=arguments[4]||void 0):r&&(i=r.label||void 0,n=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=aa.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var l=s.digest(),d="",h=c-e.length,y=0;y<h;y++)d+="\0";var g=l.getBytes()+d+""+e;if(!n)n=aa.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var m=gv(n,a-s.digestLength-1,o),E=aa.util.xorBytes(g,m,g.length),v=gv(E,s.digestLength,o),A=aa.util.xorBytes(n,v,n.length);return"\0"+A+E};CD.decode_rsa_oaep=function(t,e,r){var i,n,s;typeof r=="string"?(i=r,n=arguments[3]||void 0):r&&(i=r.label||void 0,n=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=e.length,E.expectedLength=o,E}if(n===void 0?n=aa.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),l=e.substring(1+n.digestLength),d=gv(l,n.digestLength,s),h=aa.util.xorBytes(u,d,u.length),y=gv(h,o-n.digestLength-1,s),g=aa.util.xorBytes(l,y,l.length),m=g.substring(0,n.digestLength),E=c!=="\0",v=0;v<n.digestLength;++v)E|=a.charAt(v)!==m.charAt(v);for(var A=1,R=n.digestLength,F=n.digestLength;F<g.length;F++){var q=g.charCodeAt(F),N=q&1^1,z=A?65534:0;E|=q&z,A=A&N,R+=A}if(E||g.charCodeAt(R)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(R+1)};function gv(t,e,r){r||(r=aa.md.sha1.create());for(var i="",n=Math.ceil(e/r.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),i+=r.digest().getBytes()}return i.substring(0,e)}});var qD=p((d6t,n6)=>{f();var wu=lt();Wt();Hy();mu();(function(){if(wu.prime){n6.exports=wu.prime;return}var t=n6.exports=wu.prime=wu.prime||{},e=wu.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(d,h){return d|h};t.generateProbablePrime=function(d,h,y){typeof h=="function"&&(y=h,h={}),h=h||{};var g=h.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var m=h.prng||wu.random,E={nextBytes:function(v){for(var A=m.getBytesSync(v.length),R=0;R<v.length;++R)v[R]=A.charCodeAt(R)}};if(g.name==="PRIMEINC")return s(d,E,g.options,y);throw new Error("Invalid prime generation algorithm: "+g.name)};function s(d,h,y,g){return"workers"in y?c(d,h,y,g):o(d,h,y,g)}function o(d,h,y,g){var m=u(d,h),E=0,v=l(m.bitLength());"millerRabinTests"in y&&(v=y.millerRabinTests);var A=10;"maxBlockTime"in y&&(A=y.maxBlockTime),a(m,d,h,E,v,A,g)}function a(d,h,y,g,m,E,v){var A=+new Date;do{if(d.bitLength()>h&&(d=u(h,y)),d.isProbablePrime(m))return v(null,d);d.dAddOffset(r[g++%8],0)}while(E<0||+new Date-A<E);wu.util.setImmediate(function(){a(d,h,y,g,m,E,v)})}function c(d,h,y,g){if(typeof Worker=="undefined")return o(d,h,y,g);var m=u(d,h),E=y.workers,v=y.workLoad||100,A=v*30/8,R=y.workerScript||"forge/prime.worker.js";if(E===-1)return wu.util.estimateCores(function(q,N){q&&(N=2),E=N-1,F()});F();function F(){E=Math.max(1,E);for(var q=[],N=0;N<E;++N)q[N]=new Worker(R);for(var z=E,N=0;N<E;++N)q[N].addEventListener("message",Y);var G=!1;function Y(P){if(!G){--z;var b=P.data;if(b.found){for(var w=0;w<q.length;++w)q[w].terminate();return G=!0,g(null,new e(b.prime,16))}m.bitLength()>d&&(m=u(d,h));var S=m.toString(16);P.target.postMessage({hex:S,workLoad:v}),m.dAddOffset(A,0)}}}}function u(d,h){var y=new e(d,h),g=d-1;return y.testBit(g)||y.bitwiseTo(e.ONE.shiftLeft(g),n,y),y.dAddOffset(31-y.mod(i).byteValue(),0),y}function l(d){return d<=100?27:d<=150?18:d<=200?15:d<=250?12:d<=300?9:d<=350?8:d<=400?7:d<=500?6:d<=600?5:d<=800?4:d<=1250?3:2}})()});var $y=p((h6t,FD)=>{f();var ot=lt();hc();Hy();Wd();kD();qD();mu();Wt();typeof Tt=="undefined"&&(Tt=ot.jsbn.BigInteger);var Tt,s6=ot.util.isNodejs?Zd():null,se=ot.asn1,_s=ot.util;ot.pki=ot.pki||{};FD.exports=ot.pki.rsa=ot.rsa=ot.rsa||{};var at=ot.pki,nRe=[6,4,2,4,2,4,6,2],sRe={name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},oRe={name:"RSAPrivateKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},aRe={name:"RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},cRe=ot.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},uRe=function(t){var e;if(t.algorithm in at.oids)e=at.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var i=se.oidToDer(e).getBytes(),n=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]),s=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]);s.value.push(se.create(se.Class.UNIVERSAL,se.Type.OID,!1,i)),s.value.push(se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,""));var o=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(s),n.value.push(o),se.toDer(n).getBytes()},ND=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Tt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Tt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new Tt(ot.util.bytesToHex(ot.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(Tt.ONE));t=t.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};at.rsa.encrypt=function(t,e,r){var i=r,n,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(i=r===2,n=DD(t,e,r)):(n=ot.util.createBuffer(),n.putBytes(t));for(var o=new Tt(n.toHex(),16),a=ND(o,e,i),c=a.toString(16),u=ot.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(ot.util.hexToBytes(c)),u.getBytes()};at.rsa.decrypt=function(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8);if(t.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=n,s}var o=new Tt(ot.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=ND(o,e,r),c=a.toString(16),u=ot.util.createBuffer(),l=n-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(ot.util.hexToBytes(c)),i!==!1?bv(u.getBytes(),e,r):u.getBytes()};at.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var i=r.prng||ot.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:n,eInt:e||65537,e:new Tt(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};at.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Tt(null);r.fromInt(30);for(var i=0,n=function(d,h){return d|h},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new Tt(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Tt.ONE.shiftLeft(u),n,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),i=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(fRe(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(nRe[i++%8],0):t.pqState===2?t.pqState=t.num.subtract(Tt.ONE).gcd(t.e).compareTo(Tt.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Tt.ONE),t.q1=t.q.subtract(Tt.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Tt.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:at.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:at.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};at.rsa.generateKeyPair=function(t,e,r,i){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(i=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,i=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(i=r,r=void 0):(i=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!ot.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(i){if(BD("generateKeyPair"))return s6.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return i(a);i(null,{privateKey:at.privateKeyFromPem(u),publicKey:at.publicKeyFromPem(c)})});if(MD("generateKey")&&MD("exportKey"))return _s.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:UD(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return _s.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=at.privateKeyFromAsn1(se.fromDer(ot.util.createBuffer(a)));i(null,{privateKey:c,publicKey:at.setRsaPublicKey(c.n,c.e)})}});if(LD("generateKey")&&LD("exportKey")){var n=_s.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:UD(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,u=_s.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var d=l.target.result,h=at.privateKeyFromAsn1(se.fromDer(ot.util.createBuffer(d)));i(null,{privateKey:h,publicKey:at.setRsaPublicKey(h.n,h.e)})},u.onerror=function(l){i(l)}},n.onerror=function(a){i(a)};return}}else if(BD("generateKeyPairSync")){var s=s6.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:at.privateKeyFromPem(s.privateKey),publicKey:at.publicKeyFromPem(s.publicKey)}}}var o=at.rsa.createKeyPairGenerationState(t,e,r);if(!i)return at.rsa.stepKeyPairGenerationState(o,0),o.keys;lRe(o,r,i)};at.setRsaPublicKey=at.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,u){return DD(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return ot.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,r,!0);return at.rsa.encrypt(o,r,!0)},r.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=bv(c,r,!0);var u=se.fromDer(c);return a===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=bv(c,r,!0),a===c}});var o=at.rsa.decrypt(n,r,!0,!1);return s.verify(i,o,r.n.bitLength())},r};at.setRsaPrivateKey=at.rsa.setPrivateKey=function(t,e,r,i,n,s,o,a){var c={n:t,e,d:r,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,d){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var h=at.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:bv};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(y,g){return ot.pkcs1.decode_rsa_oaep(g,y,d)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(h,c,!1)},c.sign=function(u,l){var d=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:uRe},d=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},d=1);var h=l.encode(u,c.n.bitLength());return at.rsa.encrypt(h,c,d)},c};at.wrapRsaPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(at.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,se.toDer(t).getBytes())])};at.privateKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,sRe,e,r)&&(t=se.fromDer(ot.util.createBuffer(e.privateKey))),e={},r=[],!se.validate(t,oRe,e,r)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=r,i}var n,s,o,a,c,u,l,d;return n=ot.util.createBuffer(e.privateKeyModulus).toHex(),s=ot.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=ot.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=ot.util.createBuffer(e.privateKeyPrime1).toHex(),c=ot.util.createBuffer(e.privateKeyPrime2).toHex(),u=ot.util.createBuffer(e.privateKeyExponent1).toHex(),l=ot.util.createBuffer(e.privateKeyExponent2).toHex(),d=ot.util.createBuffer(e.privateKeyCoefficient).toHex(),at.setRsaPrivateKey(new Tt(n,16),new Tt(s,16),new Tt(o,16),new Tt(a,16),new Tt(c,16),new Tt(u,16),new Tt(l,16),new Tt(d,16))};at.privateKeyToAsn1=at.privateKeyToRSAPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.e)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.d)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.p)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.q)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.dP)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.dQ)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.qInv))])};at.publicKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,cRe,e,r)){var i=se.derToOid(e.publicKeyOid);if(i!==at.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}t=e.rsaPublicKey}if(r=[],!se.validate(t,aRe,e,r)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=r,n}var s=ot.util.createBuffer(e.publicKeyModulus).toHex(),o=ot.util.createBuffer(e.publicKeyExponent).toHex();return at.setRsaPublicKey(new Tt(s,16),new Tt(o,16))};at.publicKeyToAsn1=at.publicKeyToSubjectPublicKeyInfo=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(at.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.BITSTRING,!1,[at.publicKeyToRSAPublicKey(t)])])};at.publicKeyToRSAPublicKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,ca(t.e))])};function DD(t,e,r){var i=ot.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(t.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=n-11,s}i.putByte(0),i.putByte(r);var o=n-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var u=0,l=ot.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:i.putByte(a);o=u}return i.putByte(0),i.putBytes(t),i}function bv(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8),s=ot.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function lRe(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){ot.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Tt.ONE).gcd(t.e).compareTo(Tt.ONE)!==0){t.p=null,n();return}if(t.q.subtract(Tt.ONE).gcd(t.e).compareTo(Tt.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(Tt.ONE),t.q1=t.q.subtract(Tt.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Tt.ONE)!==0){t.p=t.q=null,n();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:at.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:at.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function ca(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=ot.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function fRe(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function BD(t){return ot.util.isNodejs&&typeof s6[t]=="function"}function MD(t){return typeof _s.globalScope!="undefined"&&typeof _s.globalScope.crypto=="object"&&typeof _s.globalScope.crypto.subtle=="object"&&typeof _s.globalScope.crypto.subtle[t]=="function"}function LD(t){return typeof _s.globalScope!="undefined"&&typeof _s.globalScope.msCrypto=="object"&&typeof _s.globalScope.msCrypto.subtle=="object"&&typeof _s.globalScope.msCrypto.subtle[t]=="function"}function UD(t){for(var e=ot.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),i=0;i<e.length;++i)r[i]=e.charCodeAt(i);return r}});var o6=p((p6t,HD)=>{f();var Le=lt();Qd();hc();cv();bu();Wd();Xx();dv();mu();gD();$y();Wt();typeof KD=="undefined"&&(KD=Le.jsbn.BigInteger);var KD,fe=Le.asn1,ut=Le.pki=Le.pki||{};HD.exports=ut.pbe=Le.pbe=Le.pbe||{};var Yl=ut.oids,dRe={name:"EncryptedPrivateKeyInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},hRe={name:"PBES2Algorithms",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},pRe={name:"pkcs-12PbeParams",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"iterations"}]};ut.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i=Le.random.getBytesSync(r.saltSize),n=r.count,s=fe.integerToDer(n),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,d;switch(r.algorithm){case"aes128":o=16,u=16,l=Yl["aes128-CBC"],d=Le.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=Yl["aes192-CBC"],d=Le.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=Yl["aes256-CBC"],d=Le.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=Yl.desCBC,d=Le.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),g=zD(y),m=Le.pkcs5.pbkdf2(e,i,n,o,g),E=Le.random.getBytesSync(u),v=d(m);v.start(E),v.update(fe.toDer(t)),v.finish(),c=v.output.getBytes();var A=yRe(i,s,o,y);a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Yl.pkcs5PBES2).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Yl.pkcs5PBKDF2).getBytes()),A]),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(l).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,E)])])])}else if(r.algorithm==="3des"){o=24;var R=new Le.util.ByteBuffer(i),m=ut.pbe.generatePkcs12Key(e,R,1,n,o),E=ut.pbe.generatePkcs12Key(e,R,2,n,o),v=Le.des.createEncryptionCipher(m);v.start(E),v.update(fe.toDer(t)),v.finish(),c=v.output.getBytes(),a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Yl["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,i),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var F=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[a,fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,c)]);return F};ut.decryptPrivateKeyInfo=function(t,e){var r=null,i={},n=[];if(!fe.validate(t,dRe,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=fe.derToOid(i.encryptionOid),a=ut.pbe.getCipher(o,i.encryptionParams,e),c=Le.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(r=fe.fromDer(a.output)),r};ut.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:fe.toDer(t).getBytes()};return Le.pem.encode(r,{maxline:e})};ut.encryptedPrivateKeyFromPem=function(t){var e=Le.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return fe.fromDer(e.body)};ut.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var i=ut.wrapRsaPrivateKey(ut.privateKeyToAsn1(t));return i=ut.encryptPrivateKeyInfo(i,e,r),ut.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(r.algorithm){case"aes128":n="AES-128-CBC",o=16,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=Le.random.getBytesSync(16),a=Le.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=Le.random.getBytesSync(8),a=Le.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=Le.random.getBytesSync(8),a=Le.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=Le.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(fe.toDer(ut.privateKeyToAsn1(t))),l.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:Le.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return Le.pem.encode(d)};ut.decryptRsaPrivateKey=function(t,e){var r=null,i=Le.pem.decode(t)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=Le.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=Le.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=Le.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=Le.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=Le.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(d){return Le.rc2.createDecryptionCipher(d,40)};break;case"RC2-64-CBC":s=8,o=function(d){return Le.rc2.createDecryptionCipher(d,64)};break;case"RC2-128-CBC":s=16,o=function(d){return Le.rc2.createDecryptionCipher(d,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=Le.util.hexToBytes(i.dekInfo.parameters),c=Le.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(Le.util.createBuffer(i.body)),u.finish())r=u.output.getBytes();else return r}else r=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?r=ut.decryptPrivateKeyInfo(fe.fromDer(r),e):r=fe.fromDer(r),r!==null&&(r=ut.privateKeyFromAsn1(r)),r};ut.pbe.generatePkcs12Key=function(t,e,r,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in Le.md))throw new Error('"sha1" hash algorithm unavailable.');s=Le.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new Le.util.ByteBuffer,d=new Le.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)d.putInt16(t.charCodeAt(a));d.putInt16(0)}var h=d.length(),y=e.length(),g=new Le.util.ByteBuffer;g.fillWithByte(r,u);var m=u*Math.ceil(y/u),E=new Le.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(e.at(a%y));var v=u*Math.ceil(h/u),A=new Le.util.ByteBuffer;for(a=0;a<v;a++)A.putByte(d.at(a%h));var R=E;R.putBuffer(A);for(var F=Math.ceil(n/c),q=1;q<=F;q++){var N=new Le.util.ByteBuffer;N.putBytes(g.bytes()),N.putBytes(R.bytes());for(var z=0;z<i;z++)s.start(),s.update(N.getBytes()),N=s.digest();var G=new Le.util.ByteBuffer;for(a=0;a<u;a++)G.putByte(N.at(a%c));var Y=Math.ceil(y/u)+Math.ceil(h/u),P=new Le.util.ByteBuffer;for(o=0;o<Y;o++){var b=new Le.util.ByteBuffer(R.getBytes(u)),w=511;for(a=G.length()-1;a>=0;a--)w=w>>8,w+=G.at(a)+b.at(a),b.setAt(a,w&255);P.putBuffer(b)}R=P,l.putBuffer(N)}return l.truncate(l.length()-n),l};ut.pbe.getCipher=function(t,e,r){switch(t){case ut.oids.pkcs5PBES2:return ut.pbe.getCipherForPBES2(t,e,r);case ut.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ut.oids["pbewithSHAAnd40BitRC2-CBC"]:return ut.pbe.getCipherForPKCS12PBE(t,e,r);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=t,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};ut.pbe.getCipherForPBES2=function(t,e,r){var i={},n=[];if(!fe.validate(e,hRe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(t=fe.derToOid(i.kdfOid),t!==ut.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=fe.derToOid(i.encOid),t!==ut.oids["aes128-CBC"]&&t!==ut.oids["aes192-CBC"]&&t!==ut.oids["aes256-CBC"]&&t!==ut.oids["des-EDE3-CBC"]&&t!==ut.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=Le.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(ut.oids[t]){case"aes128-CBC":c=16,u=Le.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=Le.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=Le.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=Le.des.createDecryptionCipher;break;case"desCBC":c=8,u=Le.des.createDecryptionCipher;break}var l=VD(i.prfOid),d=Le.pkcs5.pbkdf2(r,o,a,c,l),h=i.encIv,y=u(d);return y.start(h),y};ut.pbe.getCipherForPKCS12PBE=function(t,e,r){var i={},n=[];if(!fe.validate(e,pRe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=Le.util.createBuffer(i.salt),a=Le.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(t){case ut.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=Le.des.startDecrypting;break;case ut.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(m,E){var v=Le.rc2.createDecryptionCipher(m,40);return v.start(E,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var d=VD(i.prfOid),h=ut.pbe.generatePkcs12Key(r,o,1,a,c,d);d.start();var y=ut.pbe.generatePkcs12Key(r,o,2,a,u,d);return l(h,y)};ut.pbe.opensslDeriveBytes=function(t,e,r,i){if(typeof i=="undefined"||i===null){if(!("md5"in Le.md))throw new Error('"md5" hash algorithm unavailable.');i=Le.md.md5.create()}e===null&&(e="");for(var n=[jD(i,t+e)],s=16,o=1;s<r;++o,s+=16)n.push(jD(i,n[o-1]+t+e));return n.join("").substr(0,r)};function jD(t,e){return t.start().update(e).digest().getBytes()}function VD(t){var e;if(!t)e="hmacWithSHA1";else if(e=ut.oids[fe.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return zD(e)}function zD(t){var e=Le.md;switch(t){case"hmacWithSHA224":e=Le.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function yRe(t,e,r,i){var n=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,t),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,Le.util.hexToBytes(r.toString(16))),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(ut.oids[i]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.NULL,!1,"")])),n}});var ae=p((y6t,GD)=>{f();"use strict";function $D(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function gRe(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return $D(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),$D(new n,r)}}GD.exports=gRe});var a6={};Gt(a6,{identity:()=>bRe});var bRe,WD=Ge(()=>{f();Jo();lu();bRe=zm({prefix:"\0",name:"identity",encode:t=>_x(t),decode:t=>wx(t)})});var c6={};Gt(c6,{base2:()=>mRe});var mRe,YD=Ge(()=>{f();Jo();mRe=Lr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var u6={};Gt(u6,{base8:()=>vRe});var vRe,XD=Ge(()=>{f();Jo();vRe=Lr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var l6={};Gt(l6,{base10:()=>wRe});var wRe,QD=Ge(()=>{f();Jo();wRe=fu({prefix:"9",name:"base10",alphabet:"0123456789"})});var Gy={};Gt(Gy,{Hasher:()=>f6,from:()=>th});var th,f6,mv=Ge(()=>{f();vn();th=({name:t,code:e,encode:r})=>new f6(t,e,r),f6=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}async digest(e){if(e instanceof Uint8Array){let r=await this.encode(e);return Dy(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var Ur={};Gt(Ur,{sha256:()=>_Re,sha512:()=>ERe});var ZD,_Re,ERe,ei=Ge(()=>{f();mv();ZD=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),_Re=th({name:"sha2-256",code:18,encode:ZD("SHA-256")}),ERe=th({name:"sha2-512",code:19,encode:ZD("SHA-512")})});var ua={};Gt(ua,{identity:()=>SRe});var SRe,bc=Ge(()=>{f();mv();lu();SRe=th({name:"identity",code:0,encode:t=>ao(t)})});var Zn={};Gt(Zn,{code:()=>ARe,decode:()=>TRe,encode:()=>IRe,name:()=>xRe});var JD,xRe,ARe,IRe,TRe,Es=Ge(()=>{f();lu();JD=t=>ao(t),{name:xRe,code:ARe,encode:IRe,decode:TRe}={name:"raw",code:85,decode:JD,encode:JD}});var vv={};Gt(vv,{code:()=>PRe,decode:()=>ORe,encode:()=>CRe,name:()=>RRe});var RRe,PRe,CRe,ORe,d6=Ge(()=>{f();({name:RRe,code:PRe,encode:CRe,decode:ORe}={name:"json",code:512,encode:t=>new TextEncoder().encode(JSON.stringify(t)),decode:t=>JSON.parse(new TextDecoder().decode(t))})});var rh={};Gt(rh,{CID:()=>rt,bytes:()=>jl,digest:()=>mn,hasher:()=>Gy,varint:()=>Ny});var _u=Ge(()=>{f();Ae();jm();lu();mv();vn()});var wv={};Gt(wv,{CID:()=>rt,bases:()=>kRe,bytes:()=>jl,codecs:()=>NRe,digest:()=>mn,hasher:()=>Gy,hashes:()=>qRe,varint:()=>Ny});var kRe,qRe,NRe,_v=Ge(()=>{f();WD();YD();XD();QD();xx();Ji();Sx();Zr();My();ei();bc();Es();d6();_u();kRe={...a6,...c6,...u6,...l6,...Wm,...Zi,...Gm,...Qr,...$d},qRe={...Ur,...ua},NRe={raw:Zn,json:vv}});var p6=p((R6t,iB)=>{f();"use strict";var{bases:eB}=(_v(),wv);function tB(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}var rB=tB("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),h6=tB("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),DRe={utf8:rB,"utf-8":rB,hex:eB.base16,latin1:h6,ascii:h6,binary:h6,...eB};iB.exports=DRe});var ct=p((P6t,nB)=>{f();"use strict";var BRe=p6();function MRe(t,e="utf8"){let r=BRe[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}nB.exports=MRe});var tn=p((C6t,sB)=>{f();"use strict";function LRe(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));let r=new Uint8Array(e),i=0;for(let n of t)r.set(n,i),i+=n.length;return r}sB.exports=LRe});var Wy=p(oB=>{f();"use strict";oB.get=(t=self)=>{let e=t.crypto||t.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var y6=p((k6t,cB)=>{f();"use strict";var URe=tn(),aB=ct(),FRe=Wy();function KRe({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=FRe.get();r*=8;async function a(u,l){let d=o.getRandomValues(new Uint8Array(n)),h=o.getRandomValues(new Uint8Array(e)),y={name:t,iv:h},g={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},m=await o.subtle.importKey("raw",aB(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),E=await o.subtle.deriveKey(g,m,{name:t,length:r},!0,["encrypt"]),v=await o.subtle.encrypt(y,E,u);return URe([d,y.iv,new Uint8Array(v)])}async function c(u,l){let d=u.slice(0,n),h=u.slice(n,n+e),y=u.slice(n+e),g={name:t,iv:h},m={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},E=await o.subtle.importKey("raw",aB(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(m,E,{name:t,length:r},!0,["decrypt"]),A=await o.subtle.decrypt(g,v,y);return new Uint8Array(A)}return{encrypt:a,decrypt:c}}cB.exports={create:KRe}});var lB=p((q6t,uB)=>{f();"use strict";var{base64:jRe}=(My(),$d),VRe=y6();uB.exports={import:async function(t,e){let r=jRe.decode(t);return await VRe.create().decrypt(r,e)}}});var ci=p((N6t,fB)=>{f();"use strict";function zRe(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}fB.exports=zRe});var Je=p((D6t,dB)=>{f();"use strict";var HRe=p6();function $Re(t,e="utf8"){let r=HRe[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}dB.exports=$Re});var Ev=p((B6t,gB)=>{f();var fr=lt();bu();Wt();var Yy=gB.exports=fr.sha512=fr.sha512||{};fr.md.sha512=fr.md.algorithms.sha512=Yy;var hB=fr.sha384=fr.sha512.sha384=fr.sha512.sha384||{};hB.create=function(){return Yy.create("SHA-384")};fr.md.sha384=fr.md.algorithms.sha384=hB;fr.sha512.sha256=fr.sha512.sha256||{create:function(){return Yy.create("SHA-512/256")}};fr.md["sha512/256"]=fr.md.algorithms["sha512/256"]=fr.sha512.sha256;fr.sha512.sha224=fr.sha512.sha224||{create:function(){return Yy.create("SHA-512/224")}};fr.md["sha512/224"]=fr.md.algorithms["sha512/224"]=fr.sha512.sha224;Yy.create=function(t){if(pB||GRe(),typeof t=="undefined"&&(t="SHA-512"),!(t in Xl))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Xl[t],r=null,i=fr.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);i=fr.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=fr.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var d=a.fullMessageLength.length-1;d>=0;--d)a.fullMessageLength[d]+=l[1],l[1]=l[0]+(a.fullMessageLength[d]/4294967296>>>0),a.fullMessageLength[d]=a.fullMessageLength[d]>>>0,l[0]=l[1]/4294967296>>>0;return i.putBytes(c),yB(r,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=fr.util.createBuffer();c.putBytes(i.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(g6.substr(0,a.blockLength-l));for(var d,h,y=a.fullMessageLength[0]*8,g=0;g<a.fullMessageLength.length-1;++g)d=a.fullMessageLength[g+1]*8,h=d/4294967296>>>0,y+=h,c.putInt32(y>>>0),y=d>>>0;c.putInt32(y);for(var m=new Array(r.length),g=0;g<r.length;++g)m[g]=r[g].slice(0);yB(m,n,c);var E=fr.util.createBuffer(),v;t==="SHA-512"?v=m.length:t==="SHA-384"?v=m.length-2:v=m.length-4;for(var g=0;g<v;++g)E.putInt32(m[g][0]),(g!==v-1||t!=="SHA-512/224")&&E.putInt32(m[g][1]);return E},a};var g6=null,pB=!1,b6=null,Xl=null;function GRe(){g6=String.fromCharCode(128),g6+=fr.util.fillString(String.fromCharCode(0),128),b6=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Xl={},Xl["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Xl["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Xl["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Xl["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],pB=!0}function yB(t,e,r){for(var i,n,s,o,a,c,u,l,d,h,y,g,m,E,v,A,R,F,q,N,z,G,Y,P,b,w,S,C,B,W,j,M,_,L,ce,X=r.length();X>=128;){for(B=0;B<16;++B)e[B][0]=r.getInt32()>>>0,e[B][1]=r.getInt32()>>>0;for(;B<80;++B)M=e[B-2],W=M[0],j=M[1],i=((W>>>19|j<<13)^(j>>>29|W<<3)^W>>>6)>>>0,n=((W<<13|j>>>19)^(j<<3|W>>>29)^(W<<26|j>>>6))>>>0,L=e[B-15],W=L[0],j=L[1],s=((W>>>1|j<<31)^(W>>>8|j<<24)^W>>>7)>>>0,o=((W<<31|j>>>1)^(W<<24|j>>>8)^(W<<25|j>>>7))>>>0,_=e[B-7],ce=e[B-16],j=n+_[1]+o+ce[1],e[B][0]=i+_[0]+s+ce[0]+(j/4294967296>>>0)>>>0,e[B][1]=j>>>0;for(m=t[0][0],E=t[0][1],v=t[1][0],A=t[1][1],R=t[2][0],F=t[2][1],q=t[3][0],N=t[3][1],z=t[4][0],G=t[4][1],Y=t[5][0],P=t[5][1],b=t[6][0],w=t[6][1],S=t[7][0],C=t[7][1],B=0;B<80;++B)u=((z>>>14|G<<18)^(z>>>18|G<<14)^(G>>>9|z<<23))>>>0,l=((z<<18|G>>>14)^(z<<14|G>>>18)^(G<<23|z>>>9))>>>0,d=(b^z&(Y^b))>>>0,h=(w^G&(P^w))>>>0,a=((m>>>28|E<<4)^(E>>>2|m<<30)^(E>>>7|m<<25))>>>0,c=((m<<4|E>>>28)^(E<<30|m>>>2)^(E<<25|m>>>7))>>>0,y=(m&v|R&(m^v))>>>0,g=(E&A|F&(E^A))>>>0,j=C+l+h+b6[B][1]+e[B][1],i=S+u+d+b6[B][0]+e[B][0]+(j/4294967296>>>0)>>>0,n=j>>>0,j=c+g,s=a+y+(j/4294967296>>>0)>>>0,o=j>>>0,S=b,C=w,b=Y,w=P,Y=z,P=G,j=N+n,z=q+i+(j/4294967296>>>0)>>>0,G=j>>>0,q=R,N=F,R=v,F=A,v=m,A=E,j=n+o,m=i+s+(j/4294967296>>>0)>>>0,E=j>>>0;j=t[0][1]+E,t[0][0]=t[0][0]+m+(j/4294967296>>>0)>>>0,t[0][1]=j>>>0,j=t[1][1]+A,t[1][0]=t[1][0]+v+(j/4294967296>>>0)>>>0,t[1][1]=j>>>0,j=t[2][1]+F,t[2][0]=t[2][0]+R+(j/4294967296>>>0)>>>0,t[2][1]=j>>>0,j=t[3][1]+N,t[3][0]=t[3][0]+q+(j/4294967296>>>0)>>>0,t[3][1]=j>>>0,j=t[4][1]+G,t[4][0]=t[4][0]+z+(j/4294967296>>>0)>>>0,t[4][1]=j>>>0,j=t[5][1]+P,t[5][0]=t[5][0]+Y+(j/4294967296>>>0)>>>0,t[5][1]=j>>>0,j=t[6][1]+w,t[6][0]=t[6][0]+b+(j/4294967296>>>0)>>>0,t[6][1]=j>>>0,j=t[7][1]+C,t[7][0]=t[7][0]+S+(j/4294967296>>>0)>>>0,t[7][1]=j>>>0,X-=128}}});var bB=p(m6=>{f();var WRe=lt();hc();var Oi=WRe.asn1;m6.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};m6.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Oi.Class.UNIVERSAL,type:Oi.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var T6=p((L6t,PB)=>{f();var ji=lt();Hy();mu();Ev();Wt();var mB=bB(),YRe=mB.publicKeyValidator,XRe=mB.privateKeyValidator;typeof vB=="undefined"&&(vB=ji.jsbn.BigInteger);var vB,v6=ji.util.ByteBuffer,Dn=typeof Buffer=="undefined"?Uint8Array:Buffer;ji.pki=ji.pki||{};PB.exports=ji.pki.ed25519=ji.ed25519=ji.ed25519||{};var bt=ji.ed25519;bt.constants={};bt.constants.PUBLIC_KEY_BYTE_LENGTH=32;bt.constants.PRIVATE_KEY_BYTE_LENGTH=64;bt.constants.SEED_BYTE_LENGTH=32;bt.constants.SIGN_BYTE_LENGTH=64;bt.constants.HASH_BYTE_LENGTH=64;bt.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=ji.random.getBytesSync(bt.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==bt.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+bt.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=mc({message:e,encoding:"binary"});for(var r=new Dn(bt.constants.PUBLIC_KEY_BYTE_LENGTH),i=new Dn(bt.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)i[n]=e[n];return e8e(r,i),{publicKey:r,privateKey:i}};bt.privateKeyFromAsn1=function(t){var e={},r=[],i=ji.asn1.validate(t,XRe,e,r);if(!i){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=ji.asn1.derToOid(e.privateKeyOid),o=ji.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.privateKey,c=mc({message:ji.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:c}};bt.publicKeyFromAsn1=function(t){var e={},r=[],i=ji.asn1.validate(t,YRe,e,r);if(!i){var n=new Error("Invalid Key.");throw n.errors=r,n}var s=ji.asn1.derToOid(e.publicKeyOid),o=ji.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.ed25519PublicKey;if(a.length!==bt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return mc({message:a,encoding:"binary"})};bt.publicKeyFromPrivateKey=function(t){t=t||{};var e=mc({message:t.privateKey,encoding:"binary"});if(e.length!==bt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+bt.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Dn(bt.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<r.length;++i)r[i]=e[32+i];return r};bt.sign=function(t){t=t||{};var e=mc(t),r=mc({message:t.privateKey,encoding:"binary"});if(r.length===bt.constants.SEED_BYTE_LENGTH){var i=bt.generateKeyPair({seed:r});r=i.privateKey}else if(r.length!==bt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+bt.constants.SEED_BYTE_LENGTH+" or "+bt.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new Dn(bt.constants.SIGN_BYTE_LENGTH+e.length);t8e(n,e,e.length,r);for(var s=new Dn(bt.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=n[o];return s};bt.verify=function(t){t=t||{};var e=mc(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=mc({message:t.signature,encoding:"binary"});if(r.length!==bt.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+bt.constants.SIGN_BYTE_LENGTH);var i=mc({message:t.publicKey,encoding:"binary"});if(i.length!==bt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+bt.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new Dn(bt.constants.SIGN_BYTE_LENGTH+e.length),s=new Dn(bt.constants.SIGN_BYTE_LENGTH+e.length),o;for(o=0;o<bt.constants.SIGN_BYTE_LENGTH;++o)n[o]=r[o];for(o=0;o<e.length;++o)n[o+bt.constants.SIGN_BYTE_LENGTH]=e[o];return r8e(s,n,n.length,i)>=0};function mc(t){var e=t.message;if(e instanceof Uint8Array||e instanceof Dn)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,r);e=new v6(e,r)}else if(!(e instanceof v6))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new Dn(e.length()),n=0;n<i.length;++n)i[n]=e.at(n);return i}var w6=Ye(),Sv=Ye([1]),QRe=Ye([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),ZRe=Ye([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),wB=Ye([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_B=Ye([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_6=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),JRe=Ye([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Xy(t,e){var r=ji.md.sha512.create(),i=new v6(t);r.update(i.getBytes(e),"binary");var n=r.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var s=new Dn(bt.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=n.charCodeAt(o);return s}function e8e(t,e){var r=[Ye(),Ye(),Ye(),Ye()],i,n=Xy(e,32);for(n[0]&=248,n[31]&=127,n[31]|=64,A6(r,n),x6(t,r),i=0;i<32;++i)e[i+32]=t[i];return 0}function t8e(t,e,r,i){var n,s,o=new Float64Array(64),a=[Ye(),Ye(),Ye(),Ye()],c=Xy(i,32);c[0]&=248,c[31]&=127,c[31]|=64;var u=r+64;for(n=0;n<r;++n)t[64+n]=e[n];for(n=0;n<32;++n)t[32+n]=c[32+n];var l=Xy(t.subarray(32),r+32);for(E6(l),A6(a,l),x6(t,a),n=32;n<64;++n)t[n]=i[n];var d=Xy(t,r+64);for(E6(d),n=32;n<64;++n)o[n]=0;for(n=0;n<32;++n)o[n]=l[n];for(n=0;n<32;++n)for(s=0;s<32;s++)o[n+s]+=d[n]*c[s];return EB(t.subarray(32),o),u}function r8e(t,e,r,i){var n,s,o=new Dn(32),a=[Ye(),Ye(),Ye(),Ye()],c=[Ye(),Ye(),Ye(),Ye()];if(s=-1,r<64||i8e(c,i))return-1;for(n=0;n<r;++n)t[n]=e[n];for(n=0;n<32;++n)t[n+32]=i[n];var u=Xy(t,r);if(E6(u),TB(a,c,u),A6(c,e.subarray(32)),S6(a,c),x6(o,a),r-=64,AB(e,0,o,0)){for(n=0;n<r;++n)t[n]=0;return-1}for(n=0;n<r;++n)t[n]=e[n+64];return s=r,s}function EB(t,e){var r,i,n,s;for(i=63;i>=32;--i){for(r=0,n=i-32,s=i-12;n<s;++n)e[n]+=r-16*e[i]*_6[n-(i-32)],r=e[n]+128>>8,e[n]-=r*256;e[n]+=r,e[i]=0}for(r=0,n=0;n<32;++n)e[n]+=r-(e[31]>>4)*_6[n],r=e[n]>>8,e[n]&=255;for(n=0;n<32;++n)e[n]-=r*_6[n];for(i=0;i<32;++i)e[i+1]+=e[i]>>8,t[i]=e[i]&255}function E6(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;EB(t,e)}function S6(t,e){var r=Ye(),i=Ye(),n=Ye(),s=Ye(),o=Ye(),a=Ye(),c=Ye(),u=Ye(),l=Ye();nh(r,t[1],t[0]),nh(l,e[1],e[0]),Yt(r,r,l),ih(i,t[0],t[1]),ih(l,e[0],e[1]),Yt(i,i,l),Yt(n,t[3],e[3]),Yt(n,n,ZRe),Yt(s,t[2],e[2]),ih(s,s,s),nh(o,i,r),nh(a,s,n),ih(c,s,n),ih(u,i,r),Yt(t[0],o,a),Yt(t[1],u,c),Yt(t[2],c,a),Yt(t[3],o,u)}function SB(t,e,r){for(var i=0;i<4;++i)RB(t[i],e[i],r)}function x6(t,e){var r=Ye(),i=Ye(),n=Ye();a8e(n,e[2]),Yt(r,e[0],n),Yt(i,e[1],n),xv(t,i),t[31]^=IB(r)<<7}function xv(t,e){var r,i,n,s=Ye(),o=Ye();for(r=0;r<16;++r)o[r]=e[r];for(I6(o),I6(o),I6(o),i=0;i<2;++i){for(s[0]=o[0]-65517,r=1;r<15;++r)s[r]=o[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,RB(o,s,1-n)}for(r=0;r<16;r++)t[2*r]=o[r]&255,t[2*r+1]=o[r]>>8}function i8e(t,e){var r=Ye(),i=Ye(),n=Ye(),s=Ye(),o=Ye(),a=Ye(),c=Ye();return Eu(t[2],Sv),n8e(t[1],e),Ql(n,t[1]),Yt(s,n,QRe),nh(n,n,t[2]),ih(s,t[2],s),Ql(o,s),Ql(a,o),Yt(c,a,o),Yt(r,c,n),Yt(r,r,s),s8e(r,r),Yt(r,r,n),Yt(r,r,s),Yt(r,r,s),Yt(t[0],r,s),Ql(i,t[0]),Yt(i,i,s),xB(i,n)&&Yt(t[0],t[0],JRe),Ql(i,t[0]),Yt(i,i,s),xB(i,n)?-1:(IB(t[0])===e[31]>>7&&nh(t[0],w6,t[0]),Yt(t[3],t[0],t[1]),0)}function n8e(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function s8e(t,e){var r=Ye(),i;for(i=0;i<16;++i)r[i]=e[i];for(i=250;i>=0;--i)Ql(r,r),i!==1&&Yt(r,r,e);for(i=0;i<16;++i)t[i]=r[i]}function xB(t,e){var r=new Dn(32),i=new Dn(32);return xv(r,t),xv(i,e),AB(r,0,i,0)}function AB(t,e,r,i){return o8e(t,e,r,i,32)}function o8e(t,e,r,i,n){var s,o=0;for(s=0;s<n;++s)o|=t[e+s]^r[i+s];return(1&o-1>>>8)-1}function IB(t){var e=new Dn(32);return xv(e,t),e[0]&1}function TB(t,e,r){var i,n;for(Eu(t[0],w6),Eu(t[1],Sv),Eu(t[2],Sv),Eu(t[3],w6),n=255;n>=0;--n)i=r[n/8|0]>>(n&7)&1,SB(t,e,i),S6(e,t),S6(t,t),SB(t,e,i)}function A6(t,e){var r=[Ye(),Ye(),Ye(),Ye()];Eu(r[0],wB),Eu(r[1],_B),Eu(r[2],Sv),Yt(r[3],wB,_B),TB(t,r,e)}function Eu(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}function a8e(t,e){var r=Ye(),i;for(i=0;i<16;++i)r[i]=e[i];for(i=253;i>=0;--i)Ql(r,r),i!==2&&i!==4&&Yt(r,r,e);for(i=0;i<16;++i)t[i]=r[i]}function I6(t){var e,r,i=1;for(e=0;e<16;++e)r=t[e]+i+65535,i=Math.floor(r/65536),t[e]=r-i*65536;t[0]+=i-1+37*(i-1)}function RB(t,e,r){for(var i,n=~(r-1),s=0;s<16;++s)i=n&(t[s]^e[s]),t[s]^=i,e[s]^=i}function Ye(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}function ih(t,e,r){for(var i=0;i<16;++i)t[i]=e[i]+r[i]}function nh(t,e,r){for(var i=0;i<16;++i)t[i]=e[i]-r[i]}function Ql(t,e){Yt(t,e,e)}function Yt(t,e,r){var i,n,s=0,o=0,a=0,c=0,u=0,l=0,d=0,h=0,y=0,g=0,m=0,E=0,v=0,A=0,R=0,F=0,q=0,N=0,z=0,G=0,Y=0,P=0,b=0,w=0,S=0,C=0,B=0,W=0,j=0,M=0,_=0,L=r[0],ce=r[1],X=r[2],ne=r[3],oe=r[4],he=r[5],pe=r[6],_e=r[7],k=r[8],K=r[9],$=r[10],Z=r[11],I=r[12],U=r[13],V=r[14],D=r[15];i=e[0],s+=i*L,o+=i*ce,a+=i*X,c+=i*ne,u+=i*oe,l+=i*he,d+=i*pe,h+=i*_e,y+=i*k,g+=i*K,m+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*D,i=e[1],o+=i*L,a+=i*ce,c+=i*X,u+=i*ne,l+=i*oe,d+=i*he,h+=i*pe,y+=i*_e,g+=i*k,m+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*D,i=e[2],a+=i*L,c+=i*ce,u+=i*X,l+=i*ne,d+=i*oe,h+=i*he,y+=i*pe,g+=i*_e,m+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,N+=i*D,i=e[3],c+=i*L,u+=i*ce,l+=i*X,d+=i*ne,h+=i*oe,y+=i*he,g+=i*pe,m+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,N+=i*V,z+=i*D,i=e[4],u+=i*L,l+=i*ce,d+=i*X,h+=i*ne,y+=i*oe,g+=i*he,m+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,N+=i*U,z+=i*V,G+=i*D,i=e[5],l+=i*L,d+=i*ce,h+=i*X,y+=i*ne,g+=i*oe,m+=i*he,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,N+=i*I,z+=i*U,G+=i*V,Y+=i*D,i=e[6],d+=i*L,h+=i*ce,y+=i*X,g+=i*ne,m+=i*oe,E+=i*he,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,N+=i*Z,z+=i*I,G+=i*U,Y+=i*V,P+=i*D,i=e[7],h+=i*L,y+=i*ce,g+=i*X,m+=i*ne,E+=i*oe,v+=i*he,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,N+=i*$,z+=i*Z,G+=i*I,Y+=i*U,P+=i*V,b+=i*D,i=e[8],y+=i*L,g+=i*ce,m+=i*X,E+=i*ne,v+=i*oe,A+=i*he,R+=i*pe,F+=i*_e,q+=i*k,N+=i*K,z+=i*$,G+=i*Z,Y+=i*I,P+=i*U,b+=i*V,w+=i*D,i=e[9],g+=i*L,m+=i*ce,E+=i*X,v+=i*ne,A+=i*oe,R+=i*he,F+=i*pe,q+=i*_e,N+=i*k,z+=i*K,G+=i*$,Y+=i*Z,P+=i*I,b+=i*U,w+=i*V,S+=i*D,i=e[10],m+=i*L,E+=i*ce,v+=i*X,A+=i*ne,R+=i*oe,F+=i*he,q+=i*pe,N+=i*_e,z+=i*k,G+=i*K,Y+=i*$,P+=i*Z,b+=i*I,w+=i*U,S+=i*V,C+=i*D,i=e[11],E+=i*L,v+=i*ce,A+=i*X,R+=i*ne,F+=i*oe,q+=i*he,N+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,P+=i*$,b+=i*Z,w+=i*I,S+=i*U,C+=i*V,B+=i*D,i=e[12],v+=i*L,A+=i*ce,R+=i*X,F+=i*ne,q+=i*oe,N+=i*he,z+=i*pe,G+=i*_e,Y+=i*k,P+=i*K,b+=i*$,w+=i*Z,S+=i*I,C+=i*U,B+=i*V,W+=i*D,i=e[13],A+=i*L,R+=i*ce,F+=i*X,q+=i*ne,N+=i*oe,z+=i*he,G+=i*pe,Y+=i*_e,P+=i*k,b+=i*K,w+=i*$,S+=i*Z,C+=i*I,B+=i*U,W+=i*V,j+=i*D,i=e[14],R+=i*L,F+=i*ce,q+=i*X,N+=i*ne,z+=i*oe,G+=i*he,Y+=i*pe,P+=i*_e,b+=i*k,w+=i*K,S+=i*$,C+=i*Z,B+=i*I,W+=i*U,j+=i*V,M+=i*D,i=e[15],F+=i*L,q+=i*ce,N+=i*X,z+=i*ne,G+=i*oe,Y+=i*he,P+=i*pe,b+=i*_e,w+=i*k,S+=i*K,C+=i*$,B+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*D,s+=38*q,o+=38*N,a+=38*z,c+=38*G,u+=38*Y,l+=38*P,d+=38*b,h+=38*w,y+=38*S,g+=38*C,m+=38*B,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=u,t[5]=l,t[6]=d,t[7]=h,t[8]=y,t[9]=g,t[10]=m,t[11]=E,t[12]=v,t[13]=A,t[14]=R,t[15]=F}});var OB=p((U6t,CB)=>{f();"use strict";var Av=65536;function c8e(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>Av)for(;r<t;)r+Av>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+Av)),r+=Av);else crypto.getRandomValues(e);return e}CB.exports=c8e});var Qy=p((F6t,kB)=>{f();"use strict";var u8e=OB(),l8e=ae();kB.exports=function(t){if(isNaN(t)||t<=0)throw l8e(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return u8e(t)}});var Iv=p(Zy=>{f();"use strict";Wt();Hy();var f8e=lt(),d8e=ct(),qB=Je(),NB=tn();Zy.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=NB([new Uint8Array(e-r.length),r])}return qB(r,"base64url")};Zy.base64urlToBigInteger=t=>{let e=Zy.base64urlToBuffer(t);return new f8e.jsbn.BigInteger(qB(e,"base16"),16)};Zy.base64urlToBuffer=(t,e)=>{let r=d8e(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=NB([new Uint8Array(e-r.length),r])}return r}});var MB=p(Jy=>{f();"use strict";hc();$y();var Su=lt(),{bigIntegerToUintBase64url:la,base64urlToBigInteger:fa}=Iv(),DB=ct(),BB=Je();Jy.pkcs1ToJwk=function(t){let e=Su.asn1.fromDer(BB(t,"ascii")),r=Su.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:la(r.n),e:la(r.e),d:la(r.d),p:la(r.p),q:la(r.q),dp:la(r.dP),dq:la(r.dQ),qi:la(r.qInv),alg:"RS256",kid:"2011-04-29"}};Jy.jwkToPkcs1=function(t){let e=Su.pki.privateKeyToAsn1({n:fa(t.n),e:fa(t.e),d:fa(t.d),p:fa(t.p),q:fa(t.q),dP:fa(t.dp),dQ:fa(t.dq),qInv:fa(t.qi)});return DB(Su.asn1.toDer(e).getBytes(),"ascii")};Jy.pkixToJwk=function(t){let e=Su.asn1.fromDer(BB(t,"ascii")),r=Su.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:la(r.n),e:la(r.e),alg:"RS256",kid:"2011-04-29"}};Jy.jwkToPkix=function(t){let e=Su.pki.publicKeyToAsn1({n:fa(t.n),e:fa(t.e)});return DB(Su.asn1.toDer(e).getBytes(),"ascii")}});var KB=p((V6t,FB)=>{f();"use strict";$y();var LB=lt(),{base64urlToBigInteger:h8e}=Iv();function UB(t,e){return e.map(r=>h8e(t[r]))}function p8e(t){return LB.pki.setRsaPrivateKey(...UB(t,["n","e","d","p","q","dp","dq","qi"]))}function y8e(t){return LB.pki.setRsaPublicKey(...UB(t,["n","e"]))}FB.exports={jwk2pub:y8e,jwk2priv:p8e}});var zB=p(wc=>{f();"use strict";var vc=Wy(),g8e=Qy(),b8e=Je(),m8e=ct();wc.utils=MB();wc.generateKey=async function(t){let e=await vc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await jB(e);return{privateKey:r[0],publicKey:r[1]}};wc.unmarshalPrivateKey=async function(t){let r=[await vc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await v8e(t)],i=await jB({privateKey:r[0],publicKey:r[1]});return{privateKey:i[0],publicKey:i[1]}};wc.getRandomValues=g8e;wc.hashAndSign=async function(t,e){let r=await vc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await vc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};wc.hashAndVerify=async function(t,e,r){let i=await vc.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return vc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,r)};function jB(t){return Promise.all([vc.get().subtle.exportKey("jwk",t.privateKey),vc.get().subtle.exportKey("jwk",t.publicKey)])}function v8e(t){return vc.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:w8e,jwk2priv:_8e}=KB();function VB(t,e,r,i){let n=e?w8e(t):_8e(t),s=b8e(Uint8Array.from(r),"ascii"),o=i(s,n);return m8e(o,"ascii")}wc.encrypt=function(t,e){return VB(t,!0,e,(r,i)=>i.encrypt(r))};wc.decrypt=function(t,e){return VB(t,!1,e,(r,i)=>i.decrypt(r))}});var Tv=p((H6t,HB)=>{f();"use strict";var{base64:E8e}=(My(),$d),S8e=y6();HB.exports={export:async function(t,e){let i=await S8e.create().encrypt(t,e);return E8e.encode(i)}}});var XB=p(($6t,YB)=>{f();"use strict";var{sha256:$B}=(ei(),Ur),GB=ae(),WB=ci(),x8e=Je();Ev();T6();var Rv=lt(),Ss=zB(),Pv=ev(),A8e=Tv(),Cv=class{constructor(e){this._key=e}async verify(e,r){return Ss.hashAndVerify(this._key,r,e)}marshal(){return Ss.utils.jwkToPkix(this._key)}get bytes(){return Pv.PublicKey.encode({Type:Pv.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Ss.encrypt(this._key,e)}equals(e){return WB(this.bytes,e.bytes)}async hash(){let{bytes:e}=await $B.digest(this.bytes);return e}},eg=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Ss.getRandomValues(16)}async sign(e){return Ss.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw GB(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Cv(this._publicKey)}decrypt(e){return Ss.decrypt(this._key,e)}marshal(){return Ss.utils.jwkToPkcs1(this._key)}get bytes(){return Pv.PrivateKey.encode({Type:Pv.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return WB(this.bytes,e.bytes)}async hash(){let{bytes:e}=await $B.digest(this.bytes);return e}async id(){let e=await this.public.hash();return x8e(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let i=new Rv.util.ByteBuffer(this.marshal()),n=Rv.asn1.fromDer(i),s=Rv.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Rv.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return A8e.export(this.bytes,e);throw GB(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function I8e(t){let e=Ss.utils.pkcs1ToJwk(t),r=await Ss.unmarshalPrivateKey(e);return new eg(r.privateKey,r.publicKey)}function T8e(t){let e=Ss.utils.pkixToJwk(t);return new Cv(e)}async function R8e(t){let e=await Ss.unmarshalPrivateKey(t);return new eg(e.privateKey,e.publicKey)}async function P8e(t){let e=await Ss.generateKey(t);return new eg(e.privateKey,e.publicKey)}YB.exports={RsaPublicKey:Cv,RsaPrivateKey:eg,unmarshalRsaPublicKey:T8e,unmarshalRsaPrivateKey:I8e,generateKeyPair:P8e,fromJwk:R8e}});var QB=p(Zl=>{f();"use strict";T6();var sh=lt();Zl.publicKeyLength=sh.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;Zl.privateKeyLength=sh.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;Zl.generateKey=async function(){return sh.pki.ed25519.generateKeyPair()};Zl.generateKeyFromSeed=async function(t){return sh.pki.ed25519.generateKeyPair({seed:t})};Zl.hashAndSign=async function(t,e){return sh.pki.ed25519.sign({message:e,privateKey:t})};Zl.hashAndVerify=async function(t,e,r){return sh.pki.ed25519.verify({signature:e,message:r,publicKey:t})}});var rM=p((W6t,tM)=>{f();"use strict";var ZB=ae(),JB=ci(),{sha256:eM}=(ei(),Ur),{base58btc:C8e}=(Zr(),Qr),{identity:O8e}=(bc(),ua),rn=QB(),Ov=ev(),k8e=Tv(),kv=class{constructor(e){this._key=ah(e,rn.publicKeyLength)}async verify(e,r){return rn.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return Ov.PublicKey.encode({Type:Ov.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return JB(this.bytes,e.bytes)}async hash(){let{bytes:e}=await eM.digest(this.bytes);return e}},oh=class{constructor(e,r){this._key=ah(e,rn.privateKeyLength),this._publicKey=ah(r,rn.publicKeyLength)}async sign(e){return rn.hashAndSign(this._key,e)}get public(){return new kv(this._publicKey)}marshal(){return this._key}get bytes(){return Ov.PrivateKey.encode({Type:Ov.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return JB(this.bytes,e.bytes)}async hash(){let{bytes:e}=await eM.digest(this.bytes);return e}async id(){let e=await O8e.digest(this.public.bytes);return C8e.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return k8e.export(this.bytes,e);throw ZB(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function q8e(t){if(t.length>rn.privateKeyLength){t=ah(t,rn.privateKeyLength+rn.publicKeyLength);let i=t.slice(0,rn.privateKeyLength),n=t.slice(rn.privateKeyLength,t.length);return new oh(i,n)}t=ah(t,rn.privateKeyLength);let e=t.slice(0,rn.privateKeyLength),r=t.slice(rn.publicKeyLength);return new oh(e,r)}function N8e(t){return t=ah(t,rn.publicKeyLength),new kv(t)}async function D8e(){let{privateKey:t,publicKey:e}=await rn.generateKey();return new oh(t,e)}async function B8e(t){let{privateKey:e,publicKey:r}=await rn.generateKeyFromSeed(t);return new oh(e,r)}function ah(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw ZB(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}tM.exports={Ed25519PublicKey:kv,Ed25519PrivateKey:oh,unmarshalEd25519PrivateKey:q8e,unmarshalEd25519PublicKey:N8e,generateKeyPair:D8e,generateKeyPairFromSeed:B8e}});var nM=p((Y6t,iM)=>{f();var Nt={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function xs(t,e){if(!t)throw new Error(e)}function Rt(t,e,r){if(xs(e instanceof Uint8Array,`Expected ${t} to be an Uint8Array`),r!==void 0)if(Array.isArray(r)){let i=r.join(", "),n=`Expected ${t} to be an Uint8Array with length [${i}]`;xs(r.includes(e.length),n)}else{let i=`Expected ${t} to be an Uint8Array with length ${r}`;xs(e.length===r,i)}}function Jl(t){xs(ch(t)==="Boolean","Expected compressed to be a Boolean")}function ho(t=r=>new Uint8Array(r),e){return typeof t=="function"&&(t=t(e)),Rt("output",t,e),t}function ch(t){return Object.prototype.toString.call(t).slice(8,-1)}iM.exports=t=>({contextRandomize(e){switch(xs(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&Rt("seed",e,32),t.contextRandomize(e)){case 1:throw new Error(Nt.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return Rt("private key",e,32),t.privateKeyVerify(e)===0},privateKeyNegate(e){switch(Rt("private key",e,32),t.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(Nt.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,r){switch(Rt("private key",e,32),Rt("tweak",r,32),t.privateKeyTweakAdd(e,r)){case 0:return e;case 1:throw new Error(Nt.TWEAK_ADD)}},privateKeyTweakMul(e,r){switch(Rt("private key",e,32),Rt("tweak",r,32),t.privateKeyTweakMul(e,r)){case 0:return e;case 1:throw new Error(Nt.TWEAK_MUL)}},publicKeyVerify(e){return Rt("public key",e,[33,65]),t.publicKeyVerify(e)===0},publicKeyCreate(e,r=!0,i){switch(Rt("private key",e,32),Jl(r),i=ho(i,r?33:65),t.publicKeyCreate(i,e)){case 0:return i;case 1:throw new Error(Nt.SECKEY_INVALID);case 2:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyConvert(e,r=!0,i){switch(Rt("public key",e,[33,65]),Jl(r),i=ho(i,r?33:65),t.publicKeyConvert(i,e)){case 0:return i;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyNegate(e,r=!0,i){switch(Rt("public key",e,[33,65]),Jl(r),i=ho(i,r?33:65),t.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.IMPOSSIBLE_CASE);case 3:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyCombine(e,r=!0,i){xs(Array.isArray(e),"Expected public keys to be an Array"),xs(e.length>0,"Expected public keys array will have more than zero items");for(let n of e)Rt("public key",n,[33,65]);switch(Jl(r),i=ho(i,r?33:65),t.publicKeyCombine(i,e)){case 0:return i;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.PUBKEY_COMBINE);case 3:throw new Error(Nt.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,r,i=!0,n){switch(Rt("public key",e,[33,65]),Rt("tweak",r,32),Jl(i),n=ho(n,i?33:65),t.publicKeyTweakAdd(n,e,r)){case 0:return n;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.TWEAK_ADD)}},publicKeyTweakMul(e,r,i=!0,n){switch(Rt("public key",e,[33,65]),Rt("tweak",r,32),Jl(i),n=ho(n,i?33:65),t.publicKeyTweakMul(n,e,r)){case 0:return n;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.TWEAK_MUL)}},signatureNormalize(e){switch(Rt("signature",e,64),t.signatureNormalize(e)){case 0:return e;case 1:throw new Error(Nt.SIG_PARSE)}},signatureExport(e,r){Rt("signature",e,64),r=ho(r,72);let i={output:r,outputlen:72};switch(t.signatureExport(i,e)){case 0:return r.slice(0,i.outputlen);case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.IMPOSSIBLE_CASE)}},signatureImport(e,r){switch(Rt("signature",e),r=ho(r,64),t.signatureImport(r,e)){case 0:return r;case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.IMPOSSIBLE_CASE)}},ecdsaSign(e,r,i={},n){Rt("message",e,32),Rt("private key",r,32),xs(ch(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Rt("options.data",i.data),i.noncefn!==void 0&&xs(ch(i.noncefn)==="Function","Expected options.noncefn to be a Function"),n=ho(n,64);let s={signature:n,recid:null};switch(t.ecdsaSign(s,e,r,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(Nt.SIGN);case 2:throw new Error(Nt.IMPOSSIBLE_CASE)}},ecdsaVerify(e,r,i){switch(Rt("signature",e,64),Rt("message",r,32),Rt("public key",i,[33,65]),t.ecdsaVerify(e,r,i)){case 0:return!0;case 3:return!1;case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.PUBKEY_PARSE)}},ecdsaRecover(e,r,i,n=!0,s){switch(Rt("signature",e,64),xs(ch(r)==="Number"&&r>=0&&r<=3,"Expected recovery id to be a Number within interval [0, 3]"),Rt("message",i,32),Jl(n),s=ho(s,n?33:65),t.ecdsaRecover(s,e,r,i)){case 0:return s;case 1:throw new Error(Nt.SIG_PARSE);case 2:throw new Error(Nt.RECOVER);case 3:throw new Error(Nt.IMPOSSIBLE_CASE)}},ecdh(e,r,i={},n){switch(Rt("public key",e,[33,65]),Rt("private key",r,32),xs(ch(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Rt("options.data",i.data),i.hashfn!==void 0?(xs(ch(i.hashfn)==="Function","Expected options.hashfn to be a Function"),i.xbuf!==void 0&&Rt("options.xbuf",i.xbuf,32),i.ybuf!==void 0&&Rt("options.ybuf",i.ybuf,32),Rt("output",n)):n=ho(n,32),t.ecdh(n,e,r,i.data,i.hashfn,i.xbuf,i.ybuf)){case 0:return n;case 1:throw new Error(Nt.PUBKEY_PARSE);case 2:throw new Error(Nt.ECDH)}}})});var sM=p((X6t,M8e)=>{M8e.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}});var oM=p(()=>{f()});var da=p((aM,R6)=>{f();(function(t,e){"use strict";function r(P,b){if(!P)throw new Error(b||"Assertion failed")}function i(P,b){P.super_=b;var w=function(){};w.prototype=b.prototype,P.prototype=new w,P.prototype.constructor=P}function n(P,b,w){if(n.isBN(P))return P;this.negative=0,this.words=null,this.length=0,this.red=null,P!==null&&((b==="le"||b==="be")&&(w=b,b=10),this._init(P||0,b||10,w||"be"))}typeof t=="object"?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;var s;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?s=window.Buffer:s=oM().Buffer}catch(P){}n.isBN=function(b){return b instanceof n?!0:b!==null&&typeof b=="object"&&b.constructor.wordSize===n.wordSize&&Array.isArray(b.words)},n.max=function(b,w){return b.cmp(w)>0?b:w},n.min=function(b,w){return b.cmp(w)<0?b:w},n.prototype._init=function(b,w,S){if(typeof b=="number")return this._initNumber(b,w,S);if(typeof b=="object")return this._initArray(b,w,S);w==="hex"&&(w=16),r(w===(w|0)&&w>=2&&w<=36),b=b.toString().replace(/\s+/g,"");var C=0;b[0]==="-"&&(C++,this.negative=1),C<b.length&&(w===16?this._parseHex(b,C,S):(this._parseBase(b,w,C),S==="le"&&this._initArray(this.toArray(),w,S)))},n.prototype._initNumber=function(b,w,S){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[b&67108863],this.length=1):b<4503599627370496?(this.words=[b&67108863,b/67108864&67108863],this.length=2):(r(b<9007199254740992),this.words=[b&67108863,b/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),w,S)},n.prototype._initArray=function(b,w,S){if(r(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var B,W,j=0;if(S==="be")for(C=b.length-1,B=0;C>=0;C-=3)W=b[C]|b[C-1]<<8|b[C-2]<<16,this.words[B]|=W<<j&67108863,this.words[B+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,B++);else if(S==="le")for(C=0,B=0;C<b.length;C+=3)W=b[C]|b[C+1]<<8|b[C+2]<<16,this.words[B]|=W<<j&67108863,this.words[B+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,B++);return this.strip()};function o(P,b){var w=P.charCodeAt(b);return w>=65&&w<=70?w-55:w>=97&&w<=102?w-87:w-48&15}function a(P,b,w){var S=o(P,w);return w-1>=b&&(S|=o(P,w-1)<<4),S}n.prototype._parseHex=function(b,w,S){this.length=Math.ceil((b.length-w)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var B=0,W=0,j;if(S==="be")for(C=b.length-1;C>=w;C-=2)j=a(b,w,C)<<B,this.words[W]|=j&67108863,B>=18?(B-=18,W+=1,this.words[W]|=j>>>26):B+=8;else{var M=b.length-w;for(C=M%2==0?w+1:w;C<b.length;C+=2)j=a(b,w,C)<<B,this.words[W]|=j&67108863,B>=18?(B-=18,W+=1,this.words[W]|=j>>>26):B+=8}this.strip()};function c(P,b,w,S){for(var C=0,B=Math.min(P.length,w),W=b;W<B;W++){var j=P.charCodeAt(W)-48;C*=S,j>=49?C+=j-49+10:j>=17?C+=j-17+10:C+=j}return C}n.prototype._parseBase=function(b,w,S){this.words=[0],this.length=1;for(var C=0,B=1;B<=67108863;B*=w)C++;C--,B=B/w|0;for(var W=b.length-S,j=W%C,M=Math.min(W,W-j)+S,_=0,L=S;L<M;L+=C)_=c(b,L,L+C,w),this.imuln(B),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_);if(j!==0){var ce=1;for(_=c(b,L,b.length,w),L=0;L<j;L++)ce*=w;this.imuln(ce),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_)}this.strip()},n.prototype.copy=function(b){b.words=new Array(this.length);for(var w=0;w<this.length;w++)b.words[w]=this.words[w];b.length=this.length,b.negative=this.negative,b.red=this.red},n.prototype.clone=function(){var b=new n(null);return this.copy(b),b},n.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(b,w){b=b||10,w=w|0||1;var S;if(b===16||b==="hex"){S="";for(var C=0,B=0,W=0;W<this.length;W++){var j=this.words[W],M=((j<<C|B)&16777215).toString(16);B=j>>>24-C&16777215,B!==0||W!==this.length-1?S=u[6-M.length]+M+S:S=M+S,C+=2,C>=26&&(C-=26,W--)}for(B!==0&&(S=B.toString(16)+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(b===(b|0)&&b>=2&&b<=36){var _=l[b],L=d[b];S="";var ce=this.clone();for(ce.negative=0;!ce.isZero();){var X=ce.modn(L).toString(b);ce=ce.idivn(L),ce.isZero()?S=X+S:S=u[_-X.length]+X+S}for(this.isZero()&&(S="0"+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=this.words[1]*67108864:this.length===3&&this.words[2]===1?b+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(b,w){return r(typeof s!="undefined"),this.toArrayLike(s,b,w)},n.prototype.toArray=function(b,w){return this.toArrayLike(Array,b,w)},n.prototype.toArrayLike=function(b,w,S){var C=this.byteLength(),B=S||Math.max(1,C);r(C<=B,"byte array longer than desired length"),r(B>0,"Requested array length <= 0"),this.strip();var W=w==="le",j=new b(B),M,_,L=this.clone();if(W){for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[_]=M;for(;_<B;_++)j[_]=0}else{for(_=0;_<B-C;_++)j[_]=0;for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[B-_-1]=M}return j},Math.clz32?n.prototype._countBits=function(b){return 32-Math.clz32(b)}:n.prototype._countBits=function(b){var w=b,S=0;return w>=4096&&(S+=13,w>>>=13),w>=64&&(S+=7,w>>>=7),w>=8&&(S+=4,w>>>=4),w>=2&&(S+=2,w>>>=2),S+w},n.prototype._zeroBits=function(b){if(b===0)return 26;var w=b,S=0;return(w&8191)==0&&(S+=13,w>>>=13),(w&127)==0&&(S+=7,w>>>=7),(w&15)==0&&(S+=4,w>>>=4),(w&3)==0&&(S+=2,w>>>=2),(w&1)==0&&S++,S},n.prototype.bitLength=function(){var b=this.words[this.length-1],w=this._countBits(b);return(this.length-1)*26+w};function h(P){for(var b=new Array(P.bitLength()),w=0;w<b.length;w++){var S=w/26|0,C=w%26;b[w]=(P.words[S]&1<<C)>>>C}return b}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,w=0;w<this.length;w++){var S=this._zeroBits(this.words[w]);if(b+=S,S!==26)break}return b},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},n.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var w=0;w<b.length;w++)this.words[w]=this.words[w]|b.words[w];return this.strip()},n.prototype.ior=function(b){return r((this.negative|b.negative)==0),this.iuor(b)},n.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},n.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},n.prototype.iuand=function(b){var w;this.length>b.length?w=b:w=this;for(var S=0;S<w.length;S++)this.words[S]=this.words[S]&b.words[S];return this.length=w.length,this.strip()},n.prototype.iand=function(b){return r((this.negative|b.negative)==0),this.iuand(b)},n.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},n.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},n.prototype.iuxor=function(b){var w,S;this.length>b.length?(w=this,S=b):(w=b,S=this);for(var C=0;C<S.length;C++)this.words[C]=w.words[C]^S.words[C];if(this!==w)for(;C<w.length;C++)this.words[C]=w.words[C];return this.length=w.length,this.strip()},n.prototype.ixor=function(b){return r((this.negative|b.negative)==0),this.iuxor(b)},n.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},n.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},n.prototype.inotn=function(b){r(typeof b=="number"&&b>=0);var w=Math.ceil(b/26)|0,S=b%26;this._expand(w),S>0&&w--;for(var C=0;C<w;C++)this.words[C]=~this.words[C]&67108863;return S>0&&(this.words[C]=~this.words[C]&67108863>>26-S),this.strip()},n.prototype.notn=function(b){return this.clone().inotn(b)},n.prototype.setn=function(b,w){r(typeof b=="number"&&b>=0);var S=b/26|0,C=b%26;return this._expand(S+1),w?this.words[S]=this.words[S]|1<<C:this.words[S]=this.words[S]&~(1<<C),this.strip()},n.prototype.iadd=function(b){var w;if(this.negative!==0&&b.negative===0)return this.negative=0,w=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,w=this.isub(b),b.negative=1,w._normSign();var S,C;this.length>b.length?(S=this,C=b):(S=b,C=this);for(var B=0,W=0;W<C.length;W++)w=(S.words[W]|0)+(C.words[W]|0)+B,this.words[W]=w&67108863,B=w>>>26;for(;B!==0&&W<S.length;W++)w=(S.words[W]|0)+B,this.words[W]=w&67108863,B=w>>>26;if(this.length=S.length,B!==0)this.words[this.length]=B,this.length++;else if(S!==this)for(;W<S.length;W++)this.words[W]=S.words[W];return this},n.prototype.add=function(b){var w;return b.negative!==0&&this.negative===0?(b.negative=0,w=this.sub(b),b.negative^=1,w):b.negative===0&&this.negative!==0?(this.negative=0,w=b.sub(this),this.negative=1,w):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},n.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var w=this.iadd(b);return b.negative=1,w._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var S=this.cmp(b);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var C,B;S>0?(C=this,B=b):(C=b,B=this);for(var W=0,j=0;j<B.length;j++)w=(C.words[j]|0)-(B.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;for(;W!==0&&j<C.length;j++)w=(C.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;if(W===0&&j<C.length&&C!==this)for(;j<C.length;j++)this.words[j]=C.words[j];return this.length=Math.max(this.length,j),C!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(b){return this.clone().isub(b)};function y(P,b,w){w.negative=b.negative^P.negative;var S=P.length+b.length|0;w.length=S,S=S-1|0;var C=P.words[0]|0,B=b.words[0]|0,W=C*B,j=W&67108863,M=W/67108864|0;w.words[0]=j;for(var _=1;_<S;_++){for(var L=M>>>26,ce=M&67108863,X=Math.min(_,b.length-1),ne=Math.max(0,_-P.length+1);ne<=X;ne++){var oe=_-ne|0;C=P.words[oe]|0,B=b.words[ne]|0,W=C*B+ce,L+=W/67108864|0,ce=W&67108863}w.words[_]=ce|0,M=L|0}return M!==0?w.words[_]=M|0:w.length--,w.strip()}var g=function(b,w,S){var C=b.words,B=w.words,W=S.words,j=0,M,_,L,ce=C[0]|0,X=ce&8191,ne=ce>>>13,oe=C[1]|0,he=oe&8191,pe=oe>>>13,_e=C[2]|0,k=_e&8191,K=_e>>>13,$=C[3]|0,Z=$&8191,I=$>>>13,U=C[4]|0,V=U&8191,D=U>>>13,Q=C[5]|0,ee=Q&8191,J=Q>>>13,ue=C[6]|0,ge=ue&8191,be=ue>>>13,Ke=C[7]|0,Te=Ke&8191,je=Ke>>>13,Ze=C[8]|0,ze=Ze&8191,Ve=Ze>>>13,ht=C[9]|0,Ht=ht&8191,er=ht>>>13,gn=B[0]|0,Kt=gn&8191,_t=gn>>>13,Yr=B[1]|0,it=Yr&8191,_r=Yr>>>13,vm=B[2]|0,Sr=vm&8191,xr=vm>>>13,wm=B[3]|0,Ar=wm&8191,Ir=wm>>>13,_m=B[4]|0,Tr=_m&8191,Rr=_m>>>13,Em=B[5]|0,Pr=Em&8191,Cr=Em>>>13,Sm=B[6]|0,Or=Sm&8191,kr=Sm>>>13,xm=B[7]|0,qr=xm&8191,Nr=xm>>>13,Am=B[8]|0,Dr=Am&8191,Br=Am>>>13,Im=B[9]|0,Mr=Im&8191,tr=Im>>>13;S.negative=b.negative^w.negative,S.length=19,M=Math.imul(X,Kt),_=Math.imul(X,_t),_=_+Math.imul(ne,Kt)|0,L=Math.imul(ne,_t);var qd=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(qd>>>26)|0,qd&=67108863,M=Math.imul(he,Kt),_=Math.imul(he,_t),_=_+Math.imul(pe,Kt)|0,L=Math.imul(pe,_t),M=M+Math.imul(X,it)|0,_=_+Math.imul(X,_r)|0,_=_+Math.imul(ne,it)|0,L=L+Math.imul(ne,_r)|0;var fy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(fy>>>26)|0,fy&=67108863,M=Math.imul(k,Kt),_=Math.imul(k,_t),_=_+Math.imul(K,Kt)|0,L=Math.imul(K,_t),M=M+Math.imul(he,it)|0,_=_+Math.imul(he,_r)|0,_=_+Math.imul(pe,it)|0,L=L+Math.imul(pe,_r)|0,M=M+Math.imul(X,Sr)|0,_=_+Math.imul(X,xr)|0,_=_+Math.imul(ne,Sr)|0,L=L+Math.imul(ne,xr)|0;var dy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(dy>>>26)|0,dy&=67108863,M=Math.imul(Z,Kt),_=Math.imul(Z,_t),_=_+Math.imul(I,Kt)|0,L=Math.imul(I,_t),M=M+Math.imul(k,it)|0,_=_+Math.imul(k,_r)|0,_=_+Math.imul(K,it)|0,L=L+Math.imul(K,_r)|0,M=M+Math.imul(he,Sr)|0,_=_+Math.imul(he,xr)|0,_=_+Math.imul(pe,Sr)|0,L=L+Math.imul(pe,xr)|0,M=M+Math.imul(X,Ar)|0,_=_+Math.imul(X,Ir)|0,_=_+Math.imul(ne,Ar)|0,L=L+Math.imul(ne,Ir)|0;var hy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(hy>>>26)|0,hy&=67108863,M=Math.imul(V,Kt),_=Math.imul(V,_t),_=_+Math.imul(D,Kt)|0,L=Math.imul(D,_t),M=M+Math.imul(Z,it)|0,_=_+Math.imul(Z,_r)|0,_=_+Math.imul(I,it)|0,L=L+Math.imul(I,_r)|0,M=M+Math.imul(k,Sr)|0,_=_+Math.imul(k,xr)|0,_=_+Math.imul(K,Sr)|0,L=L+Math.imul(K,xr)|0,M=M+Math.imul(he,Ar)|0,_=_+Math.imul(he,Ir)|0,_=_+Math.imul(pe,Ar)|0,L=L+Math.imul(pe,Ir)|0,M=M+Math.imul(X,Tr)|0,_=_+Math.imul(X,Rr)|0,_=_+Math.imul(ne,Tr)|0,L=L+Math.imul(ne,Rr)|0;var py=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(py>>>26)|0,py&=67108863,M=Math.imul(ee,Kt),_=Math.imul(ee,_t),_=_+Math.imul(J,Kt)|0,L=Math.imul(J,_t),M=M+Math.imul(V,it)|0,_=_+Math.imul(V,_r)|0,_=_+Math.imul(D,it)|0,L=L+Math.imul(D,_r)|0,M=M+Math.imul(Z,Sr)|0,_=_+Math.imul(Z,xr)|0,_=_+Math.imul(I,Sr)|0,L=L+Math.imul(I,xr)|0,M=M+Math.imul(k,Ar)|0,_=_+Math.imul(k,Ir)|0,_=_+Math.imul(K,Ar)|0,L=L+Math.imul(K,Ir)|0,M=M+Math.imul(he,Tr)|0,_=_+Math.imul(he,Rr)|0,_=_+Math.imul(pe,Tr)|0,L=L+Math.imul(pe,Rr)|0,M=M+Math.imul(X,Pr)|0,_=_+Math.imul(X,Cr)|0,_=_+Math.imul(ne,Pr)|0,L=L+Math.imul(ne,Cr)|0;var yy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(yy>>>26)|0,yy&=67108863,M=Math.imul(ge,Kt),_=Math.imul(ge,_t),_=_+Math.imul(be,Kt)|0,L=Math.imul(be,_t),M=M+Math.imul(ee,it)|0,_=_+Math.imul(ee,_r)|0,_=_+Math.imul(J,it)|0,L=L+Math.imul(J,_r)|0,M=M+Math.imul(V,Sr)|0,_=_+Math.imul(V,xr)|0,_=_+Math.imul(D,Sr)|0,L=L+Math.imul(D,xr)|0,M=M+Math.imul(Z,Ar)|0,_=_+Math.imul(Z,Ir)|0,_=_+Math.imul(I,Ar)|0,L=L+Math.imul(I,Ir)|0,M=M+Math.imul(k,Tr)|0,_=_+Math.imul(k,Rr)|0,_=_+Math.imul(K,Tr)|0,L=L+Math.imul(K,Rr)|0,M=M+Math.imul(he,Pr)|0,_=_+Math.imul(he,Cr)|0,_=_+Math.imul(pe,Pr)|0,L=L+Math.imul(pe,Cr)|0,M=M+Math.imul(X,Or)|0,_=_+Math.imul(X,kr)|0,_=_+Math.imul(ne,Or)|0,L=L+Math.imul(ne,kr)|0;var io=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(io>>>26)|0,io&=67108863,M=Math.imul(Te,Kt),_=Math.imul(Te,_t),_=_+Math.imul(je,Kt)|0,L=Math.imul(je,_t),M=M+Math.imul(ge,it)|0,_=_+Math.imul(ge,_r)|0,_=_+Math.imul(be,it)|0,L=L+Math.imul(be,_r)|0,M=M+Math.imul(ee,Sr)|0,_=_+Math.imul(ee,xr)|0,_=_+Math.imul(J,Sr)|0,L=L+Math.imul(J,xr)|0,M=M+Math.imul(V,Ar)|0,_=_+Math.imul(V,Ir)|0,_=_+Math.imul(D,Ar)|0,L=L+Math.imul(D,Ir)|0,M=M+Math.imul(Z,Tr)|0,_=_+Math.imul(Z,Rr)|0,_=_+Math.imul(I,Tr)|0,L=L+Math.imul(I,Rr)|0,M=M+Math.imul(k,Pr)|0,_=_+Math.imul(k,Cr)|0,_=_+Math.imul(K,Pr)|0,L=L+Math.imul(K,Cr)|0,M=M+Math.imul(he,Or)|0,_=_+Math.imul(he,kr)|0,_=_+Math.imul(pe,Or)|0,L=L+Math.imul(pe,kr)|0,M=M+Math.imul(X,qr)|0,_=_+Math.imul(X,Nr)|0,_=_+Math.imul(ne,qr)|0,L=L+Math.imul(ne,Nr)|0;var gy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(gy>>>26)|0,gy&=67108863,M=Math.imul(ze,Kt),_=Math.imul(ze,_t),_=_+Math.imul(Ve,Kt)|0,L=Math.imul(Ve,_t),M=M+Math.imul(Te,it)|0,_=_+Math.imul(Te,_r)|0,_=_+Math.imul(je,it)|0,L=L+Math.imul(je,_r)|0,M=M+Math.imul(ge,Sr)|0,_=_+Math.imul(ge,xr)|0,_=_+Math.imul(be,Sr)|0,L=L+Math.imul(be,xr)|0,M=M+Math.imul(ee,Ar)|0,_=_+Math.imul(ee,Ir)|0,_=_+Math.imul(J,Ar)|0,L=L+Math.imul(J,Ir)|0,M=M+Math.imul(V,Tr)|0,_=_+Math.imul(V,Rr)|0,_=_+Math.imul(D,Tr)|0,L=L+Math.imul(D,Rr)|0,M=M+Math.imul(Z,Pr)|0,_=_+Math.imul(Z,Cr)|0,_=_+Math.imul(I,Pr)|0,L=L+Math.imul(I,Cr)|0,M=M+Math.imul(k,Or)|0,_=_+Math.imul(k,kr)|0,_=_+Math.imul(K,Or)|0,L=L+Math.imul(K,kr)|0,M=M+Math.imul(he,qr)|0,_=_+Math.imul(he,Nr)|0,_=_+Math.imul(pe,qr)|0,L=L+Math.imul(pe,Nr)|0,M=M+Math.imul(X,Dr)|0,_=_+Math.imul(X,Br)|0,_=_+Math.imul(ne,Dr)|0,L=L+Math.imul(ne,Br)|0;var by=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(by>>>26)|0,by&=67108863,M=Math.imul(Ht,Kt),_=Math.imul(Ht,_t),_=_+Math.imul(er,Kt)|0,L=Math.imul(er,_t),M=M+Math.imul(ze,it)|0,_=_+Math.imul(ze,_r)|0,_=_+Math.imul(Ve,it)|0,L=L+Math.imul(Ve,_r)|0,M=M+Math.imul(Te,Sr)|0,_=_+Math.imul(Te,xr)|0,_=_+Math.imul(je,Sr)|0,L=L+Math.imul(je,xr)|0,M=M+Math.imul(ge,Ar)|0,_=_+Math.imul(ge,Ir)|0,_=_+Math.imul(be,Ar)|0,L=L+Math.imul(be,Ir)|0,M=M+Math.imul(ee,Tr)|0,_=_+Math.imul(ee,Rr)|0,_=_+Math.imul(J,Tr)|0,L=L+Math.imul(J,Rr)|0,M=M+Math.imul(V,Pr)|0,_=_+Math.imul(V,Cr)|0,_=_+Math.imul(D,Pr)|0,L=L+Math.imul(D,Cr)|0,M=M+Math.imul(Z,Or)|0,_=_+Math.imul(Z,kr)|0,_=_+Math.imul(I,Or)|0,L=L+Math.imul(I,kr)|0,M=M+Math.imul(k,qr)|0,_=_+Math.imul(k,Nr)|0,_=_+Math.imul(K,qr)|0,L=L+Math.imul(K,Nr)|0,M=M+Math.imul(he,Dr)|0,_=_+Math.imul(he,Br)|0,_=_+Math.imul(pe,Dr)|0,L=L+Math.imul(pe,Br)|0,M=M+Math.imul(X,Mr)|0,_=_+Math.imul(X,tr)|0,_=_+Math.imul(ne,Mr)|0,L=L+Math.imul(ne,tr)|0;var my=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(my>>>26)|0,my&=67108863,M=Math.imul(Ht,it),_=Math.imul(Ht,_r),_=_+Math.imul(er,it)|0,L=Math.imul(er,_r),M=M+Math.imul(ze,Sr)|0,_=_+Math.imul(ze,xr)|0,_=_+Math.imul(Ve,Sr)|0,L=L+Math.imul(Ve,xr)|0,M=M+Math.imul(Te,Ar)|0,_=_+Math.imul(Te,Ir)|0,_=_+Math.imul(je,Ar)|0,L=L+Math.imul(je,Ir)|0,M=M+Math.imul(ge,Tr)|0,_=_+Math.imul(ge,Rr)|0,_=_+Math.imul(be,Tr)|0,L=L+Math.imul(be,Rr)|0,M=M+Math.imul(ee,Pr)|0,_=_+Math.imul(ee,Cr)|0,_=_+Math.imul(J,Pr)|0,L=L+Math.imul(J,Cr)|0,M=M+Math.imul(V,Or)|0,_=_+Math.imul(V,kr)|0,_=_+Math.imul(D,Or)|0,L=L+Math.imul(D,kr)|0,M=M+Math.imul(Z,qr)|0,_=_+Math.imul(Z,Nr)|0,_=_+Math.imul(I,qr)|0,L=L+Math.imul(I,Nr)|0,M=M+Math.imul(k,Dr)|0,_=_+Math.imul(k,Br)|0,_=_+Math.imul(K,Dr)|0,L=L+Math.imul(K,Br)|0,M=M+Math.imul(he,Mr)|0,_=_+Math.imul(he,tr)|0,_=_+Math.imul(pe,Mr)|0,L=L+Math.imul(pe,tr)|0;var vy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(vy>>>26)|0,vy&=67108863,M=Math.imul(Ht,Sr),_=Math.imul(Ht,xr),_=_+Math.imul(er,Sr)|0,L=Math.imul(er,xr),M=M+Math.imul(ze,Ar)|0,_=_+Math.imul(ze,Ir)|0,_=_+Math.imul(Ve,Ar)|0,L=L+Math.imul(Ve,Ir)|0,M=M+Math.imul(Te,Tr)|0,_=_+Math.imul(Te,Rr)|0,_=_+Math.imul(je,Tr)|0,L=L+Math.imul(je,Rr)|0,M=M+Math.imul(ge,Pr)|0,_=_+Math.imul(ge,Cr)|0,_=_+Math.imul(be,Pr)|0,L=L+Math.imul(be,Cr)|0,M=M+Math.imul(ee,Or)|0,_=_+Math.imul(ee,kr)|0,_=_+Math.imul(J,Or)|0,L=L+Math.imul(J,kr)|0,M=M+Math.imul(V,qr)|0,_=_+Math.imul(V,Nr)|0,_=_+Math.imul(D,qr)|0,L=L+Math.imul(D,Nr)|0,M=M+Math.imul(Z,Dr)|0,_=_+Math.imul(Z,Br)|0,_=_+Math.imul(I,Dr)|0,L=L+Math.imul(I,Br)|0,M=M+Math.imul(k,Mr)|0,_=_+Math.imul(k,tr)|0,_=_+Math.imul(K,Mr)|0,L=L+Math.imul(K,tr)|0;var wy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(wy>>>26)|0,wy&=67108863,M=Math.imul(Ht,Ar),_=Math.imul(Ht,Ir),_=_+Math.imul(er,Ar)|0,L=Math.imul(er,Ir),M=M+Math.imul(ze,Tr)|0,_=_+Math.imul(ze,Rr)|0,_=_+Math.imul(Ve,Tr)|0,L=L+Math.imul(Ve,Rr)|0,M=M+Math.imul(Te,Pr)|0,_=_+Math.imul(Te,Cr)|0,_=_+Math.imul(je,Pr)|0,L=L+Math.imul(je,Cr)|0,M=M+Math.imul(ge,Or)|0,_=_+Math.imul(ge,kr)|0,_=_+Math.imul(be,Or)|0,L=L+Math.imul(be,kr)|0,M=M+Math.imul(ee,qr)|0,_=_+Math.imul(ee,Nr)|0,_=_+Math.imul(J,qr)|0,L=L+Math.imul(J,Nr)|0,M=M+Math.imul(V,Dr)|0,_=_+Math.imul(V,Br)|0,_=_+Math.imul(D,Dr)|0,L=L+Math.imul(D,Br)|0,M=M+Math.imul(Z,Mr)|0,_=_+Math.imul(Z,tr)|0,_=_+Math.imul(I,Mr)|0,L=L+Math.imul(I,tr)|0;var _y=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(_y>>>26)|0,_y&=67108863,M=Math.imul(Ht,Tr),_=Math.imul(Ht,Rr),_=_+Math.imul(er,Tr)|0,L=Math.imul(er,Rr),M=M+Math.imul(ze,Pr)|0,_=_+Math.imul(ze,Cr)|0,_=_+Math.imul(Ve,Pr)|0,L=L+Math.imul(Ve,Cr)|0,M=M+Math.imul(Te,Or)|0,_=_+Math.imul(Te,kr)|0,_=_+Math.imul(je,Or)|0,L=L+Math.imul(je,kr)|0,M=M+Math.imul(ge,qr)|0,_=_+Math.imul(ge,Nr)|0,_=_+Math.imul(be,qr)|0,L=L+Math.imul(be,Nr)|0,M=M+Math.imul(ee,Dr)|0,_=_+Math.imul(ee,Br)|0,_=_+Math.imul(J,Dr)|0,L=L+Math.imul(J,Br)|0,M=M+Math.imul(V,Mr)|0,_=_+Math.imul(V,tr)|0,_=_+Math.imul(D,Mr)|0,L=L+Math.imul(D,tr)|0;var Ey=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ey>>>26)|0,Ey&=67108863,M=Math.imul(Ht,Pr),_=Math.imul(Ht,Cr),_=_+Math.imul(er,Pr)|0,L=Math.imul(er,Cr),M=M+Math.imul(ze,Or)|0,_=_+Math.imul(ze,kr)|0,_=_+Math.imul(Ve,Or)|0,L=L+Math.imul(Ve,kr)|0,M=M+Math.imul(Te,qr)|0,_=_+Math.imul(Te,Nr)|0,_=_+Math.imul(je,qr)|0,L=L+Math.imul(je,Nr)|0,M=M+Math.imul(ge,Dr)|0,_=_+Math.imul(ge,Br)|0,_=_+Math.imul(be,Dr)|0,L=L+Math.imul(be,Br)|0,M=M+Math.imul(ee,Mr)|0,_=_+Math.imul(ee,tr)|0,_=_+Math.imul(J,Mr)|0,L=L+Math.imul(J,tr)|0;var Sy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Sy>>>26)|0,Sy&=67108863,M=Math.imul(Ht,Or),_=Math.imul(Ht,kr),_=_+Math.imul(er,Or)|0,L=Math.imul(er,kr),M=M+Math.imul(ze,qr)|0,_=_+Math.imul(ze,Nr)|0,_=_+Math.imul(Ve,qr)|0,L=L+Math.imul(Ve,Nr)|0,M=M+Math.imul(Te,Dr)|0,_=_+Math.imul(Te,Br)|0,_=_+Math.imul(je,Dr)|0,L=L+Math.imul(je,Br)|0,M=M+Math.imul(ge,Mr)|0,_=_+Math.imul(ge,tr)|0,_=_+Math.imul(be,Mr)|0,L=L+Math.imul(be,tr)|0;var xy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(xy>>>26)|0,xy&=67108863,M=Math.imul(Ht,qr),_=Math.imul(Ht,Nr),_=_+Math.imul(er,qr)|0,L=Math.imul(er,Nr),M=M+Math.imul(ze,Dr)|0,_=_+Math.imul(ze,Br)|0,_=_+Math.imul(Ve,Dr)|0,L=L+Math.imul(Ve,Br)|0,M=M+Math.imul(Te,Mr)|0,_=_+Math.imul(Te,tr)|0,_=_+Math.imul(je,Mr)|0,L=L+Math.imul(je,tr)|0;var hi=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(hi>>>26)|0,hi&=67108863,M=Math.imul(Ht,Dr),_=Math.imul(Ht,Br),_=_+Math.imul(er,Dr)|0,L=Math.imul(er,Br),M=M+Math.imul(ze,Mr)|0,_=_+Math.imul(ze,tr)|0,_=_+Math.imul(Ve,Mr)|0,L=L+Math.imul(Ve,tr)|0;var Ay=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ay>>>26)|0,Ay&=67108863,M=Math.imul(Ht,Mr),_=Math.imul(Ht,tr),_=_+Math.imul(er,Mr)|0,L=Math.imul(er,tr);var Iy=(j+M|0)+((_&8191)<<13)|0;return j=(L+(_>>>13)|0)+(Iy>>>26)|0,Iy&=67108863,W[0]=qd,W[1]=fy,W[2]=dy,W[3]=hy,W[4]=py,W[5]=yy,W[6]=io,W[7]=gy,W[8]=by,W[9]=my,W[10]=vy,W[11]=wy,W[12]=_y,W[13]=Ey,W[14]=Sy,W[15]=xy,W[16]=hi,W[17]=Ay,W[18]=Iy,j!==0&&(W[19]=j,S.length++),S};Math.imul||(g=y);function m(P,b,w){w.negative=b.negative^P.negative,w.length=P.length+b.length;for(var S=0,C=0,B=0;B<w.length-1;B++){var W=C;C=0;for(var j=S&67108863,M=Math.min(B,b.length-1),_=Math.max(0,B-P.length+1);_<=M;_++){var L=B-_,ce=P.words[L]|0,X=b.words[_]|0,ne=ce*X,oe=ne&67108863;W=W+(ne/67108864|0)|0,oe=oe+j|0,j=oe&67108863,W=W+(oe>>>26)|0,C+=W>>>26,W&=67108863}w.words[B]=j,S=W,W=C}return S!==0?w.words[B]=S:w.length--,w.strip()}function E(P,b,w){var S=new v;return S.mulp(P,b,w)}n.prototype.mulTo=function(b,w){var S,C=this.length+b.length;return this.length===10&&b.length===10?S=g(this,b,w):C<63?S=y(this,b,w):C<1024?S=m(this,b,w):S=E(this,b,w),S};function v(P,b){this.x=P,this.y=b}v.prototype.makeRBT=function(b){for(var w=new Array(b),S=n.prototype._countBits(b)-1,C=0;C<b;C++)w[C]=this.revBin(C,S,b);return w},v.prototype.revBin=function(b,w,S){if(b===0||b===S-1)return b;for(var C=0,B=0;B<w;B++)C|=(b&1)<<w-B-1,b>>=1;return C},v.prototype.permute=function(b,w,S,C,B,W){for(var j=0;j<W;j++)C[j]=w[b[j]],B[j]=S[b[j]]},v.prototype.transform=function(b,w,S,C,B,W){this.permute(W,b,w,S,C,B);for(var j=1;j<B;j<<=1)for(var M=j<<1,_=Math.cos(2*Math.PI/M),L=Math.sin(2*Math.PI/M),ce=0;ce<B;ce+=M)for(var X=_,ne=L,oe=0;oe<j;oe++){var he=S[ce+oe],pe=C[ce+oe],_e=S[ce+oe+j],k=C[ce+oe+j],K=X*_e-ne*k;k=X*k+ne*_e,_e=K,S[ce+oe]=he+_e,C[ce+oe]=pe+k,S[ce+oe+j]=he-_e,C[ce+oe+j]=pe-k,oe!==M&&(K=_*X-L*ne,ne=_*ne+L*X,X=K)}},v.prototype.guessLen13b=function(b,w){var S=Math.max(w,b)|1,C=S&1,B=0;for(S=S/2|0;S;S=S>>>1)B++;return 1<<B+1+C},v.prototype.conjugate=function(b,w,S){if(!(S<=1))for(var C=0;C<S/2;C++){var B=b[C];b[C]=b[S-C-1],b[S-C-1]=B,B=w[C],w[C]=-w[S-C-1],w[S-C-1]=-B}},v.prototype.normalize13b=function(b,w){for(var S=0,C=0;C<w/2;C++){var B=Math.round(b[2*C+1]/w)*8192+Math.round(b[2*C]/w)+S;b[C]=B&67108863,B<67108864?S=0:S=B/67108864|0}return b},v.prototype.convert13b=function(b,w,S,C){for(var B=0,W=0;W<w;W++)B=B+(b[W]|0),S[2*W]=B&8191,B=B>>>13,S[2*W+1]=B&8191,B=B>>>13;for(W=2*w;W<C;++W)S[W]=0;r(B===0),r((B&~8191)==0)},v.prototype.stub=function(b){for(var w=new Array(b),S=0;S<b;S++)w[S]=0;return w},v.prototype.mulp=function(b,w,S){var C=2*this.guessLen13b(b.length,w.length),B=this.makeRBT(C),W=this.stub(C),j=new Array(C),M=new Array(C),_=new Array(C),L=new Array(C),ce=new Array(C),X=new Array(C),ne=S.words;ne.length=C,this.convert13b(b.words,b.length,j,C),this.convert13b(w.words,w.length,L,C),this.transform(j,W,M,_,C,B),this.transform(L,W,ce,X,C,B);for(var oe=0;oe<C;oe++){var he=M[oe]*ce[oe]-_[oe]*X[oe];_[oe]=M[oe]*X[oe]+_[oe]*ce[oe],M[oe]=he}return this.conjugate(M,_,C),this.transform(M,_,ne,W,C,B),this.conjugate(ne,W,C),this.normalize13b(ne,C),S.negative=b.negative^w.negative,S.length=b.length+w.length,S.strip()},n.prototype.mul=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),this.mulTo(b,w)},n.prototype.mulf=function(b){var w=new n(null);return w.words=new Array(this.length+b.length),E(this,b,w)},n.prototype.imul=function(b){return this.clone().mulTo(b,this)},n.prototype.imuln=function(b){r(typeof b=="number"),r(b<67108864);for(var w=0,S=0;S<this.length;S++){var C=(this.words[S]|0)*b,B=(C&67108863)+(w&67108863);w>>=26,w+=C/67108864|0,w+=B>>>26,this.words[S]=B&67108863}return w!==0&&(this.words[S]=w,this.length++),this},n.prototype.muln=function(b){return this.clone().imuln(b)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(b){var w=h(b);if(w.length===0)return new n(1);for(var S=this,C=0;C<w.length&&w[C]===0;C++,S=S.sqr());if(++C<w.length)for(var B=S.sqr();C<w.length;C++,B=B.sqr())w[C]!==0&&(S=S.mul(B));return S},n.prototype.iushln=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=67108863>>>26-w<<26-w,B;if(w!==0){var W=0;for(B=0;B<this.length;B++){var j=this.words[B]&C,M=(this.words[B]|0)-j<<w;this.words[B]=M|W,W=j>>>26-w}W&&(this.words[B]=W,this.length++)}if(S!==0){for(B=this.length-1;B>=0;B--)this.words[B+S]=this.words[B];for(B=0;B<S;B++)this.words[B]=0;this.length+=S}return this.strip()},n.prototype.ishln=function(b){return r(this.negative===0),this.iushln(b)},n.prototype.iushrn=function(b,w,S){r(typeof b=="number"&&b>=0);var C;w?C=(w-w%26)/26:C=0;var B=b%26,W=Math.min((b-B)/26,this.length),j=67108863^67108863>>>B<<B,M=S;if(C-=W,C=Math.max(0,C),M){for(var _=0;_<W;_++)M.words[_]=this.words[_];M.length=W}if(W!==0)if(this.length>W)for(this.length-=W,_=0;_<this.length;_++)this.words[_]=this.words[_+W];else this.words[0]=0,this.length=1;var L=0;for(_=this.length-1;_>=0&&(L!==0||_>=C);_--){var ce=this.words[_]|0;this.words[_]=L<<26-B|ce>>>B,L=ce&j}return M&&L!==0&&(M.words[M.length++]=L),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(b,w,S){return r(this.negative===0),this.iushrn(b,w,S)},n.prototype.shln=function(b){return this.clone().ishln(b)},n.prototype.ushln=function(b){return this.clone().iushln(b)},n.prototype.shrn=function(b){return this.clone().ishrn(b)},n.prototype.ushrn=function(b){return this.clone().iushrn(b)},n.prototype.testn=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return!1;var B=this.words[S];return!!(B&C)},n.prototype.imaskn=function(b){r(typeof b=="number"&&b>=0);var w=b%26,S=(b-w)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(w!==0&&S++,this.length=Math.min(S,this.length),w!==0){var C=67108863^67108863>>>w<<w;this.words[this.length-1]&=C}return this.strip()},n.prototype.maskn=function(b){return this.clone().imaskn(b)},n.prototype.iaddn=function(b){return r(typeof b=="number"),r(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(this.words[0]|0)<b?(this.words[0]=b-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},n.prototype._iaddn=function(b){this.words[0]+=b;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},n.prototype.isubn=function(b){if(r(typeof b=="number"),r(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this.strip()},n.prototype.addn=function(b){return this.clone().iaddn(b)},n.prototype.subn=function(b){return this.clone().isubn(b)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(b,w,S){var C=b.length+S,B;this._expand(C);var W,j=0;for(B=0;B<b.length;B++){W=(this.words[B+S]|0)+j;var M=(b.words[B]|0)*w;W-=M&67108863,j=(W>>26)-(M/67108864|0),this.words[B+S]=W&67108863}for(;B<this.length-S;B++)W=(this.words[B+S]|0)+j,j=W>>26,this.words[B+S]=W&67108863;if(j===0)return this.strip();for(r(j===-1),j=0,B=0;B<this.length;B++)W=-(this.words[B]|0)+j,j=W>>26,this.words[B]=W&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(b,w){var S=this.length-b.length,C=this.clone(),B=b,W=B.words[B.length-1]|0,j=this._countBits(W);S=26-j,S!==0&&(B=B.ushln(S),C.iushln(S),W=B.words[B.length-1]|0);var M=C.length-B.length,_;if(w!=="mod"){_=new n(null),_.length=M+1,_.words=new Array(_.length);for(var L=0;L<_.length;L++)_.words[L]=0}var ce=C.clone()._ishlnsubmul(B,1,M);ce.negative===0&&(C=ce,_&&(_.words[M]=1));for(var X=M-1;X>=0;X--){var ne=(C.words[B.length+X]|0)*67108864+(C.words[B.length+X-1]|0);for(ne=Math.min(ne/W|0,67108863),C._ishlnsubmul(B,ne,X);C.negative!==0;)ne--,C.negative=0,C._ishlnsubmul(B,1,X),C.isZero()||(C.negative^=1);_&&(_.words[X]=ne)}return _&&_.strip(),C.strip(),w!=="div"&&S!==0&&C.iushrn(S),{div:_||null,mod:C}},n.prototype.divmod=function(b,w,S){if(r(!b.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var C,B,W;return this.negative!==0&&b.negative===0?(W=this.neg().divmod(b,w),w!=="mod"&&(C=W.div.neg()),w!=="div"&&(B=W.mod.neg(),S&&B.negative!==0&&B.iadd(b)),{div:C,mod:B}):this.negative===0&&b.negative!==0?(W=this.divmod(b.neg(),w),w!=="mod"&&(C=W.div.neg()),{div:C,mod:W.mod}):(this.negative&b.negative)!=0?(W=this.neg().divmod(b.neg(),w),w!=="div"&&(B=W.mod.neg(),S&&B.negative!==0&&B.isub(b)),{div:W.div,mod:B}):b.length>this.length||this.cmp(b)<0?{div:new n(0),mod:this}:b.length===1?w==="div"?{div:this.divn(b.words[0]),mod:null}:w==="mod"?{div:null,mod:new n(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new n(this.modn(b.words[0]))}:this._wordDiv(b,w)},n.prototype.div=function(b){return this.divmod(b,"div",!1).div},n.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},n.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},n.prototype.divRound=function(b){var w=this.divmod(b);if(w.mod.isZero())return w.div;var S=w.div.negative!==0?w.mod.isub(b):w.mod,C=b.ushrn(1),B=b.andln(1),W=S.cmp(C);return W<0||B===1&&W===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},n.prototype.modn=function(b){r(b<=67108863);for(var w=(1<<26)%b,S=0,C=this.length-1;C>=0;C--)S=(w*S+(this.words[C]|0))%b;return S},n.prototype.idivn=function(b){r(b<=67108863);for(var w=0,S=this.length-1;S>=0;S--){var C=(this.words[S]|0)+w*67108864;this.words[S]=C/b|0,w=C%b}return this.strip()},n.prototype.divn=function(b){return this.clone().idivn(b)},n.prototype.egcd=function(b){r(b.negative===0),r(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),B=new n(0),W=new n(0),j=new n(1),M=0;w.isEven()&&S.isEven();)w.iushrn(1),S.iushrn(1),++M;for(var _=S.clone(),L=w.clone();!w.isZero();){for(var ce=0,X=1;(w.words[0]&X)==0&&ce<26;++ce,X<<=1);if(ce>0)for(w.iushrn(ce);ce-- >0;)(C.isOdd()||B.isOdd())&&(C.iadd(_),B.isub(L)),C.iushrn(1),B.iushrn(1);for(var ne=0,oe=1;(S.words[0]&oe)==0&&ne<26;++ne,oe<<=1);if(ne>0)for(S.iushrn(ne);ne-- >0;)(W.isOdd()||j.isOdd())&&(W.iadd(_),j.isub(L)),W.iushrn(1),j.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(W),B.isub(j)):(S.isub(w),W.isub(C),j.isub(B))}return{a:W,b:j,gcd:S.iushln(M)}},n.prototype._invmp=function(b){r(b.negative===0),r(!b.isZero());var w=this,S=b.clone();w.negative!==0?w=w.umod(b):w=w.clone();for(var C=new n(1),B=new n(0),W=S.clone();w.cmpn(1)>0&&S.cmpn(1)>0;){for(var j=0,M=1;(w.words[0]&M)==0&&j<26;++j,M<<=1);if(j>0)for(w.iushrn(j);j-- >0;)C.isOdd()&&C.iadd(W),C.iushrn(1);for(var _=0,L=1;(S.words[0]&L)==0&&_<26;++_,L<<=1);if(_>0)for(S.iushrn(_);_-- >0;)B.isOdd()&&B.iadd(W),B.iushrn(1);w.cmp(S)>=0?(w.isub(S),C.isub(B)):(S.isub(w),B.isub(C))}var ce;return w.cmpn(1)===0?ce=C:ce=B,ce.cmpn(0)<0&&ce.iadd(b),ce},n.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var w=this.clone(),S=b.clone();w.negative=0,S.negative=0;for(var C=0;w.isEven()&&S.isEven();C++)w.iushrn(1),S.iushrn(1);do{for(;w.isEven();)w.iushrn(1);for(;S.isEven();)S.iushrn(1);var B=w.cmp(S);if(B<0){var W=w;w=S,S=W}else if(B===0||S.cmpn(1)===0)break;w.isub(S)}while(!0);return S.iushln(C)},n.prototype.invm=function(b){return this.egcd(b).a.umod(b)},n.prototype.isEven=function(){return(this.words[0]&1)==0},n.prototype.isOdd=function(){return(this.words[0]&1)==1},n.prototype.andln=function(b){return this.words[0]&b},n.prototype.bincn=function(b){r(typeof b=="number");var w=b%26,S=(b-w)/26,C=1<<w;if(this.length<=S)return this._expand(S+1),this.words[S]|=C,this;for(var B=C,W=S;B!==0&&W<this.length;W++){var j=this.words[W]|0;j+=B,B=j>>>26,j&=67108863,this.words[W]=j}return B!==0&&(this.words[W]=B,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(b){var w=b<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;this.strip();var S;if(this.length>1)S=1;else{w&&(b=-b),r(b<=67108863,"Number is too big");var C=this.words[0]|0;S=C===b?0:C<b?-1:1}return this.negative!==0?-S|0:S},n.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var w=this.ucmp(b);return this.negative!==0?-w|0:w},n.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var w=0,S=this.length-1;S>=0;S--){var C=this.words[S]|0,B=b.words[S]|0;if(C!==B){C<B?w=-1:C>B&&(w=1);break}}return w},n.prototype.gtn=function(b){return this.cmpn(b)===1},n.prototype.gt=function(b){return this.cmp(b)===1},n.prototype.gten=function(b){return this.cmpn(b)>=0},n.prototype.gte=function(b){return this.cmp(b)>=0},n.prototype.ltn=function(b){return this.cmpn(b)===-1},n.prototype.lt=function(b){return this.cmp(b)===-1},n.prototype.lten=function(b){return this.cmpn(b)<=0},n.prototype.lte=function(b){return this.cmp(b)<=0},n.prototype.eqn=function(b){return this.cmpn(b)===0},n.prototype.eq=function(b){return this.cmp(b)===0},n.red=function(b){return new G(b)},n.prototype.toRed=function(b){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(b){return this.red=b,this},n.prototype.forceRed=function(b){return r(!this.red,"Already a number in reduction context"),this._forceRed(b)},n.prototype.redAdd=function(b){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},n.prototype.redIAdd=function(b){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},n.prototype.redSub=function(b){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},n.prototype.redISub=function(b){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},n.prototype.redShl=function(b){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},n.prototype.redMul=function(b){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},n.prototype.redIMul=function(b){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(b){return r(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var A={k256:null,p224:null,p192:null,p25519:null};function R(P,b){this.name=P,this.p=new n(b,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var b=new n(null);return b.words=new Array(Math.ceil(this.n/13)),b},R.prototype.ireduce=function(b){var w=b,S;do this.split(w,this.tmp),w=this.imulK(w),w=w.iadd(this.tmp),S=w.bitLength();while(S>this.n);var C=S<this.n?-1:w.ucmp(this.p);return C===0?(w.words[0]=0,w.length=1):C>0?w.isub(this.p):w.strip!==void 0?w.strip():w._strip(),w},R.prototype.split=function(b,w){b.iushrn(this.n,0,w)},R.prototype.imulK=function(b){return b.imul(this.k)};function F(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(F,R),F.prototype.split=function(b,w){for(var S=4194303,C=Math.min(b.length,9),B=0;B<C;B++)w.words[B]=b.words[B];if(w.length=C,b.length<=9){b.words[0]=0,b.length=1;return}var W=b.words[9];for(w.words[w.length++]=W&S,B=10;B<b.length;B++){var j=b.words[B]|0;b.words[B-10]=(j&S)<<4|W>>>22,W=j}W>>>=22,b.words[B-10]=W,W===0&&b.length>10?b.length-=10:b.length-=9},F.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var w=0,S=0;S<b.length;S++){var C=b.words[S]|0;w+=C*977,b.words[S]=w&67108863,w=C*64+(w/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b};function q(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(q,R);function N(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(N,R);function z(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(z,R),z.prototype.imulK=function(b){for(var w=0,S=0;S<b.length;S++){var C=(b.words[S]|0)*19+w,B=C&67108863;C>>>=26,b.words[S]=B,w=C}return w!==0&&(b.words[b.length++]=w),b},n._prime=function(b){if(A[b])return A[b];var w;if(b==="k256")w=new F;else if(b==="p224")w=new q;else if(b==="p192")w=new N;else if(b==="p25519")w=new z;else throw new Error("Unknown prime "+b);return A[b]=w,w};function G(P){if(typeof P=="string"){var b=n._prime(P);this.m=b.p,this.prime=b}else r(P.gtn(1),"modulus must be greater than 1"),this.m=P,this.prime=null}G.prototype._verify1=function(b){r(b.negative===0,"red works only with positives"),r(b.red,"red works only with red numbers")},G.prototype._verify2=function(b,w){r((b.negative|w.negative)==0,"red works only with positives"),r(b.red&&b.red===w.red,"red works only with red numbers")},G.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},G.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},G.prototype.add=function(b,w){this._verify2(b,w);var S=b.add(w);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},G.prototype.iadd=function(b,w){this._verify2(b,w);var S=b.iadd(w);return S.cmp(this.m)>=0&&S.isub(this.m),S},G.prototype.sub=function(b,w){this._verify2(b,w);var S=b.sub(w);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},G.prototype.isub=function(b,w){this._verify2(b,w);var S=b.isub(w);return S.cmpn(0)<0&&S.iadd(this.m),S},G.prototype.shl=function(b,w){return this._verify1(b),this.imod(b.ushln(w))},G.prototype.imul=function(b,w){return this._verify2(b,w),this.imod(b.imul(w))},G.prototype.mul=function(b,w){return this._verify2(b,w),this.imod(b.mul(w))},G.prototype.isqr=function(b){return this.imul(b,b.clone())},G.prototype.sqr=function(b){return this.mul(b,b)},G.prototype.sqrt=function(b){if(b.isZero())return b.clone();var w=this.m.andln(3);if(r(w%2==1),w===3){var S=this.m.add(new n(1)).iushrn(2);return this.pow(b,S)}for(var C=this.m.subn(1),B=0;!C.isZero()&&C.andln(1)===0;)B++,C.iushrn(1);r(!C.isZero());var W=new n(1).toRed(this),j=W.redNeg(),M=this.m.subn(1).iushrn(1),_=this.m.bitLength();for(_=new n(2*_*_).toRed(this);this.pow(_,M).cmp(j)!==0;)_.redIAdd(j);for(var L=this.pow(_,C),ce=this.pow(b,C.addn(1).iushrn(1)),X=this.pow(b,C),ne=B;X.cmp(W)!==0;){for(var oe=X,he=0;oe.cmp(W)!==0;he++)oe=oe.redSqr();r(he<ne);var pe=this.pow(L,new n(1).iushln(ne-he-1));ce=ce.redMul(pe),L=pe.redSqr(),X=X.redMul(L),ne=he}return ce},G.prototype.invm=function(b){var w=b._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},G.prototype.pow=function(b,w){if(w.isZero())return new n(1).toRed(this);if(w.cmpn(1)===0)return b.clone();var S=4,C=new Array(1<<S);C[0]=new n(1).toRed(this),C[1]=b;for(var B=2;B<C.length;B++)C[B]=this.mul(C[B-1],b);var W=C[0],j=0,M=0,_=w.bitLength()%26;for(_===0&&(_=26),B=w.length-1;B>=0;B--){for(var L=w.words[B],ce=_-1;ce>=0;ce--){var X=L>>ce&1;if(W!==C[0]&&(W=this.sqr(W)),X===0&&j===0){M=0;continue}j<<=1,j|=X,M++,!(M!==S&&(B!==0||ce!==0))&&(W=this.mul(W,C[j]),M=0,j=0)}_=26}return W},G.prototype.convertTo=function(b){var w=b.umod(this.m);return w===b?w.clone():w},G.prototype.convertFrom=function(b){var w=b.clone();return w.red=null,w},n.mont=function(b){return new Y(b)};function Y(P){G.call(this,P),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(Y,G),Y.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},Y.prototype.convertFrom=function(b){var w=this.imod(b.mul(this.rinv));return w.red=null,w},Y.prototype.imul=function(b,w){if(b.isZero()||w.isZero())return b.words[0]=0,b.length=1,b;var S=b.imul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(C).iushrn(this.shift),W=B;return B.cmp(this.m)>=0?W=B.isub(this.m):B.cmpn(0)<0&&(W=B.iadd(this.m)),W._forceRed(this)},Y.prototype.mul=function(b,w){if(b.isZero()||w.isZero())return new n(0)._forceRed(this);var S=b.mul(w),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(C).iushrn(this.shift),W=B;return B.cmp(this.m)>=0?W=B.isub(this.m):B.cmpn(0)<0&&(W=B.iadd(this.m)),W._forceRed(this)},Y.prototype.invm=function(b){var w=this.imod(b._invmp(this.m).mul(this.r2));return w._forceRed(this)}})(typeof R6=="undefined"||R6,aM)});var xu=p((J6t,uM)=>{f();uM.exports=cM;function cM(t,e){if(!t)throw new Error(e||"Assertion failed")}cM.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)}});var P6=p(dM=>{f();"use strict";var qv=dM;function L8e(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t!="string"){for(var i=0;i<t.length;i++)r[i]=t[i]|0;return r}if(e==="hex"){t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!=0&&(t="0"+t);for(var i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(var i=0;i<t.length;i++){var n=t.charCodeAt(i),s=n>>8,o=n&255;s?r.push(s,o):r.push(o)}return r}qv.toArray=L8e;function lM(t){return t.length===1?"0"+t:t}qv.zero2=lM;function fM(t){for(var e="",r=0;r<t.length;r++)e+=lM(t[r].toString(16));return e}qv.toHex=fM;qv.encode=function(e,r){return r==="hex"?fM(e):e}});var Jn=p(hM=>{f();"use strict";var po=hM,U8e=da(),F8e=xu(),Nv=P6();po.assert=F8e;po.toArray=Nv.toArray;po.zero2=Nv.zero2;po.toHex=Nv.toHex;po.encode=Nv.encode;function K8e(t,e,r){var i=new Array(Math.max(t.bitLength(),r)+1);i.fill(0);for(var n=1<<e+1,s=t.clone(),o=0;o<i.length;o++){var a,c=s.andln(n-1);s.isOdd()?(c>(n>>1)-1?a=(n>>1)-c:a=c,s.isubn(a)):a=0,i[o]=a,s.iushrn(1)}return i}po.getNAF=K8e;function j8e(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var i=0,n=0,s;t.cmpn(-i)>0||e.cmpn(-n)>0;){var o=t.andln(3)+i&3,a=e.andln(3)+n&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)==0?c=0:(s=t.andln(7)+i&7,(s===3||s===5)&&a===2?c=-o:c=o),r[0].push(c);var u;(a&1)==0?u=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?u=-a:u=a),r[1].push(u),2*i===c+1&&(i=1-i),2*n===u+1&&(n=1-n),t.iushrn(1),e.iushrn(1)}return r}po.getJSF=j8e;function V8e(t,e,r){var i="_"+e;t.prototype[e]=function(){return this[i]!==void 0?this[i]:this[i]=r.call(this)}}po.cachedProperty=V8e;function z8e(t){return typeof t=="string"?po.toArray(t,"hex"):t}po.parseBytes=z8e;function H8e(t){return new U8e(t,"hex","le")}po.intFromLE=H8e});var q6=p((rAt,k6)=>{f();var C6;k6.exports=function(e){return C6||(C6=new Au(null)),C6.generate(e)};function Au(t){this.rand=t}k6.exports.Rand=Au;Au.prototype.generate=function(e){return this._rand(e)};Au.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),i=0;i<r.length;i++)r[i]=this.rand.getByte();return r};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Au.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Au.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(Au.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(O6=Zd(),typeof O6.randomBytes!="function")throw new Error("Not supported");Au.prototype._rand=function(e){return O6.randomBytes(e)}}catch(t){}var O6});var rg=p((iAt,pM)=>{f();"use strict";var ef=da(),tg=Jn(),Dv=tg.getNAF,$8e=tg.getJSF,Bv=tg.assert;function Iu(t,e){this.type=t,this.p=new ef(e.p,16),this.red=e.prime?ef.red(e.prime):ef.mont(this.p),this.zero=new ef(0).toRed(this.red),this.one=new ef(1).toRed(this.red),this.two=new ef(2).toRed(this.red),this.n=e.n&&new ef(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}pM.exports=Iu;Iu.prototype.point=function(){throw new Error("Not implemented")};Iu.prototype.validate=function(){throw new Error("Not implemented")};Iu.prototype._fixedNafMul=function(e,r){Bv(e.precomputed);var i=e._getDoubles(),n=Dv(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var u=a+i.step-1;u>=a;u--)c=(c<<1)+n[u];o.push(c)}for(var l=this.jpoint(null,null,null),d=this.jpoint(null,null,null),h=s;h>0;h--){for(a=0;a<o.length;a++)c=o[a],c===h?d=d.mixedAdd(i.points[a]):c===-h&&(d=d.mixedAdd(i.points[a].neg()));l=l.add(d)}return l.toP()};Iu.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=Dv(r,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var l=o[c];Bv(l!==0),e.type==="affine"?l>0?a=a.mixedAdd(s[l-1>>1]):a=a.mixedAdd(s[-l-1>>1].neg()):l>0?a=a.add(s[l-1>>1]):a=a.add(s[-l-1>>1].neg())}return e.type==="affine"?a.toP():a};Iu.prototype._wnafMulAdd=function(e,r,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,l,d,h;for(l=0;l<n;l++){h=r[l];var y=h._getNAFPoints(e);o[l]=y.wnd,a[l]=y.points}for(l=n-1;l>=1;l-=2){var g=l-1,m=l;if(o[g]!==1||o[m]!==1){c[g]=Dv(i[g],o[g],this._bitLength),c[m]=Dv(i[m],o[m],this._bitLength),u=Math.max(c[g].length,u),u=Math.max(c[m].length,u);continue}var E=[r[g],null,null,r[m]];r[g].y.cmp(r[m].y)===0?(E[1]=r[g].add(r[m]),E[2]=r[g].toJ().mixedAdd(r[m].neg())):r[g].y.cmp(r[m].y.redNeg())===0?(E[1]=r[g].toJ().mixedAdd(r[m]),E[2]=r[g].add(r[m].neg())):(E[1]=r[g].toJ().mixedAdd(r[m]),E[2]=r[g].toJ().mixedAdd(r[m].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],A=$8e(i[g],i[m]);for(u=Math.max(A[0].length,u),c[g]=new Array(u),c[m]=new Array(u),d=0;d<u;d++){var R=A[0][d]|0,F=A[1][d]|0;c[g][d]=v[(R+1)*3+(F+1)],c[m][d]=0,a[g]=E}}var q=this.jpoint(null,null,null),N=this._wnafT4;for(l=u;l>=0;l--){for(var z=0;l>=0;){var G=!0;for(d=0;d<n;d++)N[d]=c[d][l]|0,N[d]!==0&&(G=!1);if(!G)break;z++,l--}if(l>=0&&z++,q=q.dblp(z),l<0)break;for(d=0;d<n;d++){var Y=N[d];Y!==0&&(Y>0?h=a[d][Y-1>>1]:Y<0&&(h=a[d][-Y-1>>1].neg()),h.type==="affine"?q=q.mixedAdd(h):q=q.add(h))}}for(l=0;l<n;l++)a[l]=null;return s?q:q.toP()};function As(t,e){this.curve=t,this.type=e,this.precomputed=null}Iu.BasePoint=As;As.prototype.eq=function(){throw new Error("Not implemented")};As.prototype.validate=function(){return this.curve.validate(this)};Iu.prototype.decodePoint=function(e,r){e=tg.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*i){e[0]===6?Bv(e[e.length-1]%2==0):e[0]===7&&Bv(e[e.length-1]%2==1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};As.prototype.encodeCompressed=function(e){return this.encode(e,!0)};As.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};As.prototype.encode=function(e,r){return tg.encode(this._encode(r),e)};As.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};As.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};As.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}};As.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}};As.prototype._getBeta=function(){return null};As.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r}});var Vi=p((nAt,N6)=>{f();typeof Object.create=="function"?N6.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:N6.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}}});var gM=p((sAt,yM)=>{f();"use strict";var G8e=Jn(),Fr=da(),D6=Vi(),uh=rg(),W8e=G8e.assert;function Is(t){uh.call(this,"short",t),this.a=new Fr(t.a,16).toRed(this.red),this.b=new Fr(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}D6(Is,uh);yM.exports=Is;Is.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new Fr(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new Fr(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],W8e(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new Fr(a.a,16),b:new Fr(a.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}};Is.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:Fr.mont(e),i=new Fr(2).toRed(r).redInvm(),n=i.redNeg(),s=new Fr(3).toRed(r).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]};Is.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new Fr(1),o=new Fr(0),a=new Fr(0),c=new Fr(1),u,l,d,h,y,g,m,E=0,v,A;i.cmpn(0)!==0;){var R=n.div(i);v=n.sub(R.mul(i)),A=a.sub(R.mul(s));var F=c.sub(R.mul(o));if(!d&&v.cmp(r)<0)u=m.neg(),l=s,d=v.neg(),h=A;else if(d&&++E==2)break;m=v,n=i,i=v,a=s,s=A,c=o,o=F}y=v.neg(),g=A;var q=d.sqr().add(h.sqr()),N=y.sqr().add(g.sqr());return N.cmp(q)>=0&&(y=u,g=l),d.negative&&(d=d.neg(),h=h.neg()),y.negative&&(y=y.neg(),g=g.neg()),[{a:d,b:h},{a:y,b:g}]};Is.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),u=s.mul(i.b),l=o.mul(n.b),d=e.sub(a).sub(c),h=u.add(l).neg();return{k1:d,k2:h}};Is.prototype.pointFromX=function(e,r){e=new Fr(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)};Is.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};Is.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),c=e[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),n[o*2]=c,n[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var l=this._wnafMulAdd(1,n,s,o*2,i),d=0;d<o*2;d++)n[d]=null,s[d]=null;return l};function ki(t,e,r,i){uh.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Fr(e,16),this.y=new Fr(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}D6(ki,uh.BasePoint);Is.prototype.point=function(e,r,i){return new ki(this,e,r,i)};Is.prototype.pointFromJSON=function(e,r){return ki.fromJSON(this,e,r)};ki.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}};ki.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};ki.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=r[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n};ki.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};ki.prototype.isInfinity=function(){return this.inf};ki.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};ki.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};ki.prototype.getX=function(){return this.x.fromRed()};ki.prototype.getY=function(){return this.y.fromRed()};ki.prototype.mul=function(e){return e=new Fr(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};ki.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};ki.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};ki.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};ki.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r};ki.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function zi(t,e,r,i){uh.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Fr(0)):(this.x=new Fr(e,16),this.y=new Fr(r,16),this.z=new Fr(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}D6(zi,uh.BasePoint);Is.prototype.jpoint=function(e,r,i){return new zi(this,e,r,i)};zi.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)};zi.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};zi.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=c.redSqr(),d=l.redMul(c),h=n.redMul(l),y=u.redSqr().redIAdd(d).redISub(h).redISub(h),g=u.redMul(h.redISub(y)).redISub(o.redMul(d)),m=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(y,g,m)};zi.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),l=u.redMul(a),d=i.redMul(u),h=c.redSqr().redIAdd(l).redISub(d).redISub(d),y=c.redMul(d.redISub(h)).redISub(s.redMul(l)),g=this.z.redMul(a);return this.curve.jpoint(h,y,g)};zi.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),l=a.redAdd(a);for(r=0;r<e;r++){var d=o.redSqr(),h=l.redSqr(),y=h.redSqr(),g=d.redAdd(d).redIAdd(d).redIAdd(n.redMul(u)),m=o.redMul(h),E=g.redSqr().redISub(m.redAdd(m)),v=m.redISub(E),A=g.redMul(v);A=A.redIAdd(A).redISub(y);var R=l.redMul(c);r+1<e&&(u=u.redMul(y)),o=E,c=R,l=A}return this.curve.jpoint(o,l.redMul(s),c)};zi.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};zi.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),u=c.redSqr().redISub(a).redISub(a),l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),e=u,r=c.redMul(a.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),h=this.y.redSqr(),y=h.redSqr(),g=this.x.redAdd(h).redSqr().redISub(d).redISub(y);g=g.redIAdd(g);var m=d.redAdd(d).redIAdd(d),E=m.redSqr(),v=y.redIAdd(y);v=v.redIAdd(v),v=v.redIAdd(v),e=E.redISub(g).redISub(g),r=m.redMul(g.redISub(e)).redISub(v),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};zi.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);e=u;var l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),r=c.redMul(a.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),h=this.y.redSqr(),y=this.x.redMul(h),g=this.x.redSub(d).redMul(this.x.redAdd(d));g=g.redAdd(g).redIAdd(g);var m=y.redIAdd(y);m=m.redIAdd(m);var E=m.redAdd(m);e=g.redSqr().redISub(E),i=this.y.redAdd(this.z).redSqr().redISub(h).redISub(d);var v=h.redSqr();v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v),r=g.redMul(m.redISub(e)).redISub(v)}return this.curve.jpoint(e,r,i)};zi.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=r.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var l=u.redMul(a),d=c.redSqr().redISub(l.redAdd(l)),h=l.redISub(d),y=a.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=c.redMul(h).redISub(y),m=i.redAdd(i).redMul(n);return this.curve.jpoint(d,g,m)};zi.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var l=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),d=r.redMul(l);d=d.redIAdd(d),d=d.redIAdd(d);var h=this.x.redMul(c).redISub(d);h=h.redIAdd(h),h=h.redIAdd(h);var y=this.y.redMul(l.redMul(u.redISub(l)).redISub(a.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(h,y,g)};zi.prototype.mul=function(e,r){return e=new Fr(e,r),this.curve._wnafMul(this,e)};zi.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};zi.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};zi.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};zi.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var vM=p((oAt,mM)=>{f();"use strict";var lh=da(),bM=Vi(),Mv=rg(),Y8e=Jn();function fh(t){Mv.call(this,"mont",t),this.a=new lh(t.a,16).toRed(this.red),this.b=new lh(t.b,16).toRed(this.red),this.i4=new lh(4).toRed(this.red).redInvm(),this.two=new lh(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}bM(fh,Mv);mM.exports=fh;fh.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),n=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),s=n.redSqrt();return s.redSqr().cmp(n)===0};function qi(t,e,r){Mv.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new lh(e,16),this.z=new lh(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}bM(qi,Mv.BasePoint);fh.prototype.decodePoint=function(e,r){return this.point(Y8e.toArray(e,r),1)};fh.prototype.point=function(e,r){return new qi(this,e,r)};fh.prototype.pointFromJSON=function(e){return qi.fromJSON(this,e)};qi.prototype.precompute=function(){};qi.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};qi.fromJSON=function(e,r){return new qi(e,r[0],r[1]||e.one)};qi.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};qi.prototype.isInfinity=function(){return this.z.cmpn(0)===0};qi.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=r.redSub(n),o=r.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};qi.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};qi.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),c=s.redMul(n),u=r.z.redMul(a.redAdd(c).redSqr()),l=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,l)};qi.prototype.mul=function(e){for(var r=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};qi.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};qi.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};qi.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};qi.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};qi.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var EM=p((aAt,_M)=>{f();"use strict";var X8e=Jn(),_c=da(),wM=Vi(),Lv=rg(),Q8e=X8e.assert;function ha(t){this.twisted=(t.a|0)!=1,this.mOneA=this.twisted&&(t.a|0)==-1,this.extended=this.mOneA,Lv.call(this,"edwards",t),this.a=new _c(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new _c(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new _c(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Q8e(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)==1}wM(ha,Lv);_M.exports=ha;ha.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};ha.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};ha.prototype.jpoint=function(e,r,i,n){return this.point(e,r,i,n)};ha.prototype.pointFromX=function(e,r){e=new _c(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(e,a)};ha.prototype.pointFromY=function(e,r){e=new _c(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)};ha.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),n=r.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return n.cmp(s)===0};function ir(t,e,r,i,n){Lv.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new _c(e,16),this.y=new _c(r,16),this.z=i?new _c(i,16):this.curve.one,this.t=n&&new _c(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}wM(ir,Lv.BasePoint);ha.prototype.pointFromJSON=function(e){return ir.fromJSON(this,e)};ha.prototype.point=function(e,r,i,n){return new ir(this,e,r,i,n)};ir.fromJSON=function(e,r){return new ir(e,r[0],r[1],r[2])};ir.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ir.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};ir.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=n.redAdd(r),a=o.redSub(i),c=n.redSub(r),u=s.redMul(a),l=o.redMul(c),d=s.redMul(c),h=a.redMul(o);return this.curve.point(u,l,h,d)};ir.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(r);var l=a.redAdd(i);this.zOne?(n=e.redSub(r).redSub(i).redMul(l.redSub(this.curve.two)),s=l.redMul(a.redSub(i)),o=l.redSqr().redSub(l).redSub(l)):(c=this.z.redSqr(),u=l.redSub(c).redISub(c),n=e.redSub(r).redISub(i).redMul(u),s=l.redMul(a.redSub(i)),o=l.redMul(u))}else a=r.redAdd(i),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),n=this.curve._mulC(e.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(i)),o=a.redMul(u);return this.curve.point(n,s,o)};ir.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};ir.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(r),a=s.redSub(n),c=s.redAdd(n),u=i.redAdd(r),l=o.redMul(a),d=c.redMul(u),h=o.redMul(u),y=a.redMul(c);return this.curve.point(l,d,y,h)};ir.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),c=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),l=r.redMul(a).redMul(u),d,h;return this.curve.twisted?(d=r.redMul(c).redMul(s.redSub(this.curve._mulA(n))),h=a.redMul(c)):(d=r.redMul(c).redMul(s.redSub(n)),h=this.curve._mulC(a).redMul(c)),this.curve.point(l,d,h)};ir.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};ir.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};ir.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)};ir.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)};ir.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};ir.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};ir.prototype.getX=function(){return this.normalize(),this.x.fromRed()};ir.prototype.getY=function(){return this.normalize(),this.y.fromRed()};ir.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};ir.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}};ir.prototype.toP=ir.prototype.normalize;ir.prototype.mixedAdd=ir.prototype.add});var B6=p(SM=>{f();"use strict";var Uv=SM;Uv.base=rg();Uv.short=gM();Uv.mont=vM();Uv.edwards=EM()});var yo=p(Xt=>{f();"use strict";var Z8e=xu(),J8e=Vi();Xt.inherits=J8e;function ePe(t,e){return(t.charCodeAt(e)&64512)!=55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)==56320}function tPe(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):ePe(t,n)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128)}else for(n=0;n<t.length;n++)r[n]=t[n]|0;return r}Xt.toArray=tPe;function rPe(t){for(var e="",r=0;r<t.length;r++)e+=AM(t[r].toString(16));return e}Xt.toHex=rPe;function xM(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}Xt.htonl=xM;function iPe(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];e==="little"&&(n=xM(n)),r+=IM(n.toString(16))}return r}Xt.toHex32=iPe;function AM(t){return t.length===1?"0"+t:t}Xt.zero2=AM;function IM(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}Xt.zero8=IM;function nPe(t,e,r,i){var n=r-e;Z8e(n%4==0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:c=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=c>>>0}return s}Xt.join32=nPe;function sPe(t,e){for(var r=new Array(t.length*4),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];e==="big"?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=s&255):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=s&255)}return r}Xt.split32=sPe;function oPe(t,e){return t>>>e|t<<32-e}Xt.rotr32=oPe;function aPe(t,e){return t<<e|t>>>32-e}Xt.rotl32=aPe;function cPe(t,e){return t+e>>>0}Xt.sum32=cPe;function uPe(t,e,r){return t+e+r>>>0}Xt.sum32_3=uPe;function lPe(t,e,r,i){return t+e+r+i>>>0}Xt.sum32_4=lPe;function fPe(t,e,r,i,n){return t+e+r+i+n>>>0}Xt.sum32_5=fPe;function dPe(t,e,r,i){var n=t[e],s=t[e+1],o=i+s>>>0,a=(o<i?1:0)+r+n;t[e]=a>>>0,t[e+1]=o}Xt.sum64=dPe;function hPe(t,e,r,i){var n=e+i>>>0,s=(n<e?1:0)+t+r;return s>>>0}Xt.sum64_hi=hPe;function pPe(t,e,r,i){var n=e+i;return n>>>0}Xt.sum64_lo=pPe;function yPe(t,e,r,i,n,s,o,a){var c=0,u=e;u=u+i>>>0,c+=u<e?1:0,u=u+s>>>0,c+=u<s?1:0,u=u+a>>>0,c+=u<a?1:0;var l=t+r+n+o+c;return l>>>0}Xt.sum64_4_hi=yPe;function gPe(t,e,r,i,n,s,o,a){var c=e+i+s+a;return c>>>0}Xt.sum64_4_lo=gPe;function bPe(t,e,r,i,n,s,o,a,c,u){var l=0,d=e;d=d+i>>>0,l+=d<e?1:0,d=d+s>>>0,l+=d<s?1:0,d=d+a>>>0,l+=d<a?1:0,d=d+u>>>0,l+=d<u?1:0;var h=t+r+n+o+c+l;return h>>>0}Xt.sum64_5_hi=bPe;function mPe(t,e,r,i,n,s,o,a,c,u){var l=e+i+s+a+u;return l>>>0}Xt.sum64_5_lo=mPe;function vPe(t,e,r){var i=e<<32-r|t>>>r;return i>>>0}Xt.rotr64_hi=vPe;function wPe(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Xt.rotr64_lo=wPe;function _Pe(t,e,r){return t>>>r}Xt.shr64_hi=_Pe;function EPe(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Xt.shr64_lo=EPe});var dh=p(RM=>{f();"use strict";var TM=yo(),SPe=xu();function Fv(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}RM.BlockHash=Fv;Fv.prototype.update=function(e,r){if(e=TM.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=TM.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};Fv.prototype.digest=function(e){return this.update(this._pad()),SPe(this.pending===null),this._digest(e)};Fv.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,i=r-(e+this.padLength)%r,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n}});var M6=p(Ec=>{f();"use strict";var xPe=yo(),pa=xPe.rotr32;function APe(t,e,r,i){if(t===0)return PM(e,r,i);if(t===1||t===3)return OM(e,r,i);if(t===2)return CM(e,r,i)}Ec.ft_1=APe;function PM(t,e,r){return t&e^~t&r}Ec.ch32=PM;function CM(t,e,r){return t&e^t&r^e&r}Ec.maj32=CM;function OM(t,e,r){return t^e^r}Ec.p32=OM;function IPe(t){return pa(t,2)^pa(t,13)^pa(t,22)}Ec.s0_256=IPe;function TPe(t){return pa(t,6)^pa(t,11)^pa(t,25)}Ec.s1_256=TPe;function RPe(t){return pa(t,7)^pa(t,18)^t>>>3}Ec.g0_256=RPe;function PPe(t){return pa(t,17)^pa(t,19)^t>>>10}Ec.g1_256=PPe});var NM=p((dAt,qM)=>{f();"use strict";var hh=yo(),CPe=dh(),OPe=M6(),L6=hh.rotl32,ig=hh.sum32,kPe=hh.sum32_5,qPe=OPe.ft_1,kM=CPe.BlockHash,NPe=[1518500249,1859775393,2400959708,3395469782];function ya(){if(!(this instanceof ya))return new ya;kM.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}hh.inherits(ya,kM);qM.exports=ya;ya.blockSize=512;ya.outSize=160;ya.hmacStrength=80;ya.padLength=64;ya.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=L6(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4];for(n=0;n<i.length;n++){var l=~~(n/20),d=kPe(L6(s,5),qPe(l,o,a,c),u,i[n],NPe[l]);u=c,c=a,a=L6(o,30),o=s,s=d}this.h[0]=ig(this.h[0],s),this.h[1]=ig(this.h[1],o),this.h[2]=ig(this.h[2],a),this.h[3]=ig(this.h[3],c),this.h[4]=ig(this.h[4],u)};ya.prototype._digest=function(e){return e==="hex"?hh.toHex32(this.h,"big"):hh.split32(this.h,"big")}});var U6=p((hAt,BM)=>{f();"use strict";var ph=yo(),DPe=dh(),yh=M6(),BPe=xu(),go=ph.sum32,MPe=ph.sum32_4,LPe=ph.sum32_5,UPe=yh.ch32,FPe=yh.maj32,KPe=yh.s0_256,jPe=yh.s1_256,VPe=yh.g0_256,zPe=yh.g1_256,DM=DPe.BlockHash,HPe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ga(){if(!(this instanceof ga))return new ga;DM.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=HPe,this.W=new Array(64)}ph.inherits(ga,DM);BM.exports=ga;ga.blockSize=512;ga.outSize=256;ga.hmacStrength=192;ga.padLength=64;ga.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=MPe(zPe(i[n-2]),i[n-7],VPe(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],l=this.h[5],d=this.h[6],h=this.h[7];for(BPe(this.k.length===i.length),n=0;n<i.length;n++){var y=LPe(h,jPe(u),UPe(u,l,d),this.k[n],i[n]),g=go(KPe(s),FPe(s,o,a));h=d,d=l,l=u,u=go(c,y),c=a,a=o,o=s,s=go(y,g)}this.h[0]=go(this.h[0],s),this.h[1]=go(this.h[1],o),this.h[2]=go(this.h[2],a),this.h[3]=go(this.h[3],c),this.h[4]=go(this.h[4],u),this.h[5]=go(this.h[5],l),this.h[6]=go(this.h[6],d),this.h[7]=go(this.h[7],h)};ga.prototype._digest=function(e){return e==="hex"?ph.toHex32(this.h,"big"):ph.split32(this.h,"big")}});var UM=p((pAt,LM)=>{f();"use strict";var F6=yo(),MM=U6();function Sc(){if(!(this instanceof Sc))return new Sc;MM.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}F6.inherits(Sc,MM);LM.exports=Sc;Sc.blockSize=512;Sc.outSize=224;Sc.hmacStrength=192;Sc.padLength=64;Sc.prototype._digest=function(e){return e==="hex"?F6.toHex32(this.h.slice(0,7),"big"):F6.split32(this.h.slice(0,7),"big")}});var V6=p((yAt,VM)=>{f();"use strict";var Bn=yo(),$Pe=dh(),GPe=xu(),ba=Bn.rotr64_hi,ma=Bn.rotr64_lo,FM=Bn.shr64_hi,KM=Bn.shr64_lo,Tu=Bn.sum64,K6=Bn.sum64_hi,j6=Bn.sum64_lo,WPe=Bn.sum64_4_hi,YPe=Bn.sum64_4_lo,XPe=Bn.sum64_5_hi,QPe=Bn.sum64_5_lo,jM=$Pe.BlockHash,ZPe=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function bo(){if(!(this instanceof bo))return new bo;jM.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=ZPe,this.W=new Array(160)}Bn.inherits(bo,jM);VM.exports=bo;bo.blockSize=1024;bo.outSize=512;bo.hmacStrength=192;bo.padLength=128;bo.prototype._prepareBlock=function(e,r){for(var i=this.W,n=0;n<32;n++)i[n]=e[r+n];for(;n<i.length;n+=2){var s=uCe(i[n-4],i[n-3]),o=lCe(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],u=aCe(i[n-30],i[n-29]),l=cCe(i[n-30],i[n-29]),d=i[n-32],h=i[n-31];i[n]=WPe(s,o,a,c,u,l,d,h),i[n+1]=YPe(s,o,a,c,u,l,d,h)}};bo.prototype._update=function(e,r){this._prepareBlock(e,r);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],l=this.h[6],d=this.h[7],h=this.h[8],y=this.h[9],g=this.h[10],m=this.h[11],E=this.h[12],v=this.h[13],A=this.h[14],R=this.h[15];GPe(this.k.length===i.length);for(var F=0;F<i.length;F+=2){var q=A,N=R,z=sCe(h,y),G=oCe(h,y),Y=JPe(h,y,g,m,E,v),P=eCe(h,y,g,m,E,v),b=this.k[F],w=this.k[F+1],S=i[F],C=i[F+1],B=XPe(q,N,z,G,Y,P,b,w,S,C),W=QPe(q,N,z,G,Y,P,b,w,S,C);q=iCe(n,s),N=nCe(n,s),z=tCe(n,s,o,a,c,u),G=rCe(n,s,o,a,c,u);var j=K6(q,N,z,G),M=j6(q,N,z,G);A=E,R=v,E=g,v=m,g=h,m=y,h=K6(l,d,B,W),y=j6(d,d,B,W),l=c,d=u,c=o,u=a,o=n,a=s,n=K6(B,W,j,M),s=j6(B,W,j,M)}Tu(this.h,0,n,s),Tu(this.h,2,o,a),Tu(this.h,4,c,u),Tu(this.h,6,l,d),Tu(this.h,8,h,y),Tu(this.h,10,g,m),Tu(this.h,12,E,v),Tu(this.h,14,A,R)};bo.prototype._digest=function(e){return e==="hex"?Bn.toHex32(this.h,"big"):Bn.split32(this.h,"big")};function JPe(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function eCe(t,e,r,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function tCe(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function rCe(t,e,r,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function iCe(t,e){var r=ba(t,e,28),i=ba(e,t,2),n=ba(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function nCe(t,e){var r=ma(t,e,28),i=ma(e,t,2),n=ma(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function sCe(t,e){var r=ba(t,e,14),i=ba(t,e,18),n=ba(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function oCe(t,e){var r=ma(t,e,14),i=ma(t,e,18),n=ma(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function aCe(t,e){var r=ba(t,e,1),i=ba(t,e,8),n=FM(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function cCe(t,e){var r=ma(t,e,1),i=ma(t,e,8),n=KM(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function uCe(t,e){var r=ba(t,e,19),i=ba(e,t,29),n=FM(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}function lCe(t,e){var r=ma(t,e,19),i=ma(e,t,29),n=KM(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}});var $M=p((gAt,HM)=>{f();"use strict";var z6=yo(),zM=V6();function xc(){if(!(this instanceof xc))return new xc;zM.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}z6.inherits(xc,zM);HM.exports=xc;xc.blockSize=1024;xc.outSize=384;xc.hmacStrength=192;xc.padLength=128;xc.prototype._digest=function(e){return e==="hex"?z6.toHex32(this.h.slice(0,12),"big"):z6.split32(this.h.slice(0,12),"big")}});var GM=p(gh=>{f();"use strict";gh.sha1=NM();gh.sha224=UM();gh.sha256=U6();gh.sha384=$M();gh.sha512=V6()});var JM=p(ZM=>{f();"use strict";var tf=yo(),fCe=dh(),Kv=tf.rotl32,WM=tf.sum32,ng=tf.sum32_3,YM=tf.sum32_4,XM=fCe.BlockHash;function va(){if(!(this instanceof va))return new va;XM.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}tf.inherits(va,XM);ZM.ripemd160=va;va.blockSize=512;va.outSize=160;va.hmacStrength=192;va.padLength=64;va.prototype._update=function(e,r){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,u=n,l=s,d=o,h=a,y=0;y<80;y++){var g=WM(Kv(YM(i,QM(y,n,s,o),e[pCe[y]+r],dCe(y)),gCe[y]),a);i=a,a=o,o=Kv(s,10),s=n,n=g,g=WM(Kv(YM(c,QM(79-y,u,l,d),e[yCe[y]+r],hCe(y)),bCe[y]),h),c=h,h=d,d=Kv(l,10),l=u,u=g}g=ng(this.h[1],s,d),this.h[1]=ng(this.h[2],o,h),this.h[2]=ng(this.h[3],a,c),this.h[3]=ng(this.h[4],i,u),this.h[4]=ng(this.h[0],n,l),this.h[0]=g};va.prototype._digest=function(e){return e==="hex"?tf.toHex32(this.h,"little"):tf.split32(this.h,"little")};function QM(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function dCe(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function hCe(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var pCe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],yCe=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],gCe=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],bCe=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var t7=p((vAt,e7)=>{f();"use strict";var mCe=yo(),vCe=xu();function bh(t,e,r){if(!(this instanceof bh))return new bh(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(mCe.toArray(e,r))}e7.exports=bh;bh.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),vCe(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)};bh.prototype.update=function(e,r){return this.inner.update(e,r),this};bh.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var jv=p(r7=>{f();var Hi=r7;Hi.utils=yo();Hi.common=dh();Hi.sha=GM();Hi.ripemd=JM();Hi.hmac=t7();Hi.sha1=Hi.sha.sha1;Hi.sha256=Hi.sha.sha256;Hi.sha224=Hi.sha.sha224;Hi.sha384=Hi.sha.sha384;Hi.sha512=Hi.sha.sha512;Hi.ripemd160=Hi.ripemd.ripemd160});var n7=p((_At,i7)=>{f();i7.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Vv=p(a7=>{f();"use strict";var H6=a7,Ru=jv(),$6=B6(),wCe=Jn(),s7=wCe.assert;function o7(t){t.type==="short"?this.curve=new $6.short(t):t.type==="edwards"?this.curve=new $6.edwards(t):this.curve=new $6.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,s7(this.g.validate(),"Invalid curve"),s7(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}H6.PresetCurve=o7;function Pu(t,e){Object.defineProperty(H6,t,{configurable:!0,enumerable:!0,get:function(){var r=new o7(e);return Object.defineProperty(H6,t,{configurable:!0,enumerable:!0,value:r}),r}})}Pu("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ru.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Pu("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ru.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Pu("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ru.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Pu("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ru.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Pu("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ru.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Pu("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ru.sha256,gRed:!1,g:["9"]});Pu("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ru.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var G6;try{G6=n7()}catch(t){G6=void 0}Pu("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ru.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",G6]})});var l7=p((SAt,u7)=>{f();"use strict";var _Ce=jv(),rf=P6(),c7=xu();function Cu(t){if(!(this instanceof Cu))return new Cu(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=rf.toArray(t.entropy,t.entropyEnc||"hex"),r=rf.toArray(t.nonce,t.nonceEnc||"hex"),i=rf.toArray(t.pers,t.persEnc||"hex");c7(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}u7.exports=Cu;Cu.prototype._init=function(e,r,i){var n=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};Cu.prototype._hmac=function(){return new _Ce.hmac(this.hash,this.K)};Cu.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),!!e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};Cu.prototype.reseed=function(e,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),e=rf.toArray(e,r),i=rf.toArray(i,n),c7(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};Cu.prototype.generate=function(e,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=rf.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,rf.encode(o,r)}});var d7=p((xAt,f7)=>{f();"use strict";var ECe=da(),SCe=Jn(),W6=SCe.assert;function nn(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}f7.exports=nn;nn.fromPublic=function(e,r,i){return r instanceof nn?r:new nn(e,{pub:r,pubEnc:i})};nn.fromPrivate=function(e,r,i){return r instanceof nn?r:new nn(e,{priv:r,privEnc:i})};nn.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};nn.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};nn.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};nn.prototype._importPrivate=function(e,r){this.priv=new ECe(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};nn.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?W6(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&W6(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};nn.prototype.derive=function(e){return e.validate()||W6(e.validate(),"public point not validated"),e.mul(this.priv).getX()};nn.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};nn.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};nn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var y7=p((AAt,p7)=>{f();"use strict";var zv=da(),Y6=Jn(),xCe=Y6.assert;function Hv(t,e){if(t instanceof Hv)return t;this._importDER(t,e)||(xCe(t.r&&t.s,"Signature without r or s"),this.r=new zv(t.r,16),this.s=new zv(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}p7.exports=Hv;function ACe(){this.place=0}function X6(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function h7(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}Hv.prototype._importDER=function(e,r){e=Y6.toArray(e,r);var i=new ACe;if(e[i.place++]!==48)return!1;var n=X6(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=X6(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=X6(e,i);if(a===!1||e.length!==a+i.place)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new zv(o),this.s=new zv(c),this.recoveryParam=null,!0};function Q6(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}Hv.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=h7(r),i=h7(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Q6(n,r.length),n=n.concat(r),n.push(2),Q6(n,i.length);var s=n.concat(i),o=[48];return Q6(o,s.length),o=o.concat(s),Y6.encode(o,e)}});var v7=p((IAt,m7)=>{f();"use strict";var nf=da(),g7=l7(),ICe=Jn(),Z6=Vv(),TCe=q6(),b7=ICe.assert,J6=d7(),$v=y7();function Ts(t){if(!(this instanceof Ts))return new Ts(t);typeof t=="string"&&(b7(Object.prototype.hasOwnProperty.call(Z6,t),"Unknown curve "+t),t=Z6[t]),t instanceof Z6.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}m7.exports=Ts;Ts.prototype.keyPair=function(e){return new J6(this,e)};Ts.prototype.keyFromPrivate=function(e,r){return J6.fromPrivate(this,e,r)};Ts.prototype.keyFromPublic=function(e,r){return J6.fromPublic(this,e,r)};Ts.prototype.genKeyPair=function(e){e||(e={});for(var r=new g7({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||TCe(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new nf(2));;){var s=new nf(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Ts.prototype._truncateToN=function(e,r){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};Ts.prototype.sign=function(e,r,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),r=this.keyFromPrivate(r,i),e=this._truncateToN(new nf(e,16));for(var s=this.n.byteLength(),o=r.getPrivate().toArray("be",s),a=e.toArray("be",s),c=new g7({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),u=this.n.sub(new nf(1)),l=0;;l++){var d=n.k?n.k(l):new nf(c.generate(this.n.byteLength()));if(d=this._truncateToN(d,!0),!(d.cmpn(1)<=0||d.cmp(u)>=0)){var h=this.g.mul(d);if(!h.isInfinity()){var y=h.getX(),g=y.umod(this.n);if(g.cmpn(0)!==0){var m=d.invm(this.n).mul(g.mul(r.getPrivate()).iadd(e));if(m=m.umod(this.n),m.cmpn(0)!==0){var E=(h.getY().isOdd()?1:0)|(y.cmp(g)!==0?2:0);return n.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),E^=1),new $v({r:g,s:m,recoveryParam:E})}}}}}};Ts.prototype.verify=function(e,r,i,n){e=this._truncateToN(new nf(e,16)),i=this.keyFromPublic(i,n),r=new $v(r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(e).umod(this.n),u=a.mul(s).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(c,i.getPublic(),u),l.isInfinity()?!1:l.eqXToP(s)):(l=this.g.mulAdd(c,i.getPublic(),u),l.isInfinity()?!1:l.getX().umod(this.n).cmp(s)===0)};Ts.prototype.recoverPubKey=function(t,e,r,i){b7((3&r)===r,"The recovery param is more than two bits"),e=new $v(e,i);var n=this.n,s=new nf(t),o=e.r,a=e.s,c=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var l=e.r.invm(n),d=n.sub(s).mul(l).umod(n),h=a.mul(l).umod(n);return this.g.mulAdd(d,o,h)};Ts.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new $v(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch(o){continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")}});var S7=p((TAt,E7)=>{f();"use strict";var sg=Jn(),w7=sg.assert,_7=sg.parseBytes,mh=sg.cachedProperty;function Ni(t,e){this.eddsa=t,this._secret=_7(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=_7(e.pub)}Ni.fromPublic=function(e,r){return r instanceof Ni?r:new Ni(e,{pub:r})};Ni.fromSecret=function(e,r){return r instanceof Ni?r:new Ni(e,{secret:r})};Ni.prototype.secret=function(){return this._secret};mh(Ni,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});mh(Ni,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});mh(Ni,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,n=r.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});mh(Ni,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});mh(Ni,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});mh(Ni,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Ni.prototype.sign=function(e){return w7(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Ni.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};Ni.prototype.getSecret=function(e){return w7(this._secret,"KeyPair is public only"),sg.encode(this.secret(),e)};Ni.prototype.getPublic=function(e){return sg.encode(this.pubBytes(),e)};E7.exports=Ni});var A7=p((RAt,x7)=>{f();"use strict";var RCe=da(),Gv=Jn(),PCe=Gv.assert,Wv=Gv.cachedProperty,CCe=Gv.parseBytes;function sf(t,e){this.eddsa=t,typeof e!="object"&&(e=CCe(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),PCe(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof RCe&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}Wv(sf,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Wv(sf,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Wv(sf,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Wv(sf,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});sf.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};sf.prototype.toHex=function(){return Gv.encode(this.toBytes(),"hex").toUpperCase()};x7.exports=sf});var C7=p((PAt,P7)=>{f();"use strict";var OCe=jv(),kCe=Vv(),vh=Jn(),qCe=vh.assert,I7=vh.parseBytes,T7=S7(),R7=A7();function Mn(t){if(qCe(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Mn))return new Mn(t);t=kCe[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=OCe.sha512}P7.exports=Mn;Mn.prototype.sign=function(e,r){e=I7(e);var i=this.keyFromSecret(r),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Mn.prototype.verify=function(e,r,i){e=I7(e),r=this.makeSignature(r);var n=this.keyFromPublic(i),s=this.hashInt(r.Rencoded(),n.pubBytes(),e),o=this.g.mul(r.S()),a=r.R().add(n.pub().mul(s));return a.eq(o)};Mn.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return vh.intFromLE(e.digest()).umod(this.curve.n)};Mn.prototype.keyFromPublic=function(e){return T7.fromPublic(this,e)};Mn.prototype.keyFromSecret=function(e){return T7.fromSecret(this,e)};Mn.prototype.makeSignature=function(e){return e instanceof R7?e:new R7(this,e)};Mn.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};Mn.prototype.decodePoint=function(e){e=vh.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&~128),n=(e[r]&128)!=0,s=vh.intFromLE(i);return this.curve.pointFromY(s,n)};Mn.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Mn.prototype.decodeInt=function(e){return vh.intFromLE(e)};Mn.prototype.isPoint=function(e){return e instanceof this.pointClass}});var k7=p(O7=>{f();"use strict";var of=O7;of.version=sM().version;of.utils=Jn();of.rand=q6();of.curve=B6();of.curves=Vv();of.ec=v7();of.eddsa=C7()});var N7=p((OAt,q7)=>{f();var NCe=k7().ec,wa=new NCe("secp256k1"),Et=wa.curve,Qt=Et.n.constructor;function DCe(t,e){let r=new Qt(e);if(r.cmp(Et.p)>=0)return null;r=r.toRed(Et.red);let i=r.redSqr().redIMul(r).redIAdd(Et.b).redSqrt();return t===3!==i.isOdd()&&(i=i.redNeg()),wa.keyPair({pub:{x:r,y:i}})}function BCe(t,e,r){let i=new Qt(e),n=new Qt(r);if(i.cmp(Et.p)>=0||n.cmp(Et.p)>=0||(i=i.toRed(Et.red),n=n.toRed(Et.red),(t===6||t===7)&&n.isOdd()!==(t===7)))return null;let s=i.redSqr().redIMul(i);return n.redSqr().redISub(s.redIAdd(Et.b)).isZero()?wa.keyPair({pub:{x:i,y:n}}):null}function Ou(t){let e=t[0];switch(e){case 2:case 3:return t.length!==33?null:DCe(e,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:BCe(e,t.subarray(1,33),t.subarray(33,65));default:return null}}function af(t,e){let r=e.encode(null,t.length===33);for(let i=0;i<t.length;++i)t[i]=r[i]}q7.exports={contextRandomize(){return 0},privateKeyVerify(t){let e=new Qt(t);return e.cmp(Et.n)<0&&!e.isZero()?0:1},privateKeyNegate(t){let e=new Qt(t),r=Et.n.sub(e).umod(Et.n).toArrayLike(Uint8Array,"be",32);return t.set(r),0},privateKeyTweakAdd(t,e){let r=new Qt(e);if(r.cmp(Et.n)>=0||(r.iadd(new Qt(t)),r.cmp(Et.n)>=0&&r.isub(Et.n),r.isZero()))return 1;let i=r.toArrayLike(Uint8Array,"be",32);return t.set(i),0},privateKeyTweakMul(t,e){let r=new Qt(e);if(r.cmp(Et.n)>=0||r.isZero())return 1;r.imul(new Qt(t)),r.cmp(Et.n)>=0&&(r=r.umod(Et.n));let i=r.toArrayLike(Uint8Array,"be",32);return t.set(i),0},publicKeyVerify(t){return Ou(t)===null?1:0},publicKeyCreate(t,e){let r=new Qt(e);if(r.cmp(Et.n)>=0||r.isZero())return 1;let i=wa.keyFromPrivate(e).getPublic();return af(t,i),0},publicKeyConvert(t,e){let r=Ou(e);if(r===null)return 1;let i=r.getPublic();return af(t,i),0},publicKeyNegate(t,e){let r=Ou(e);if(r===null)return 1;let i=r.getPublic();return i.y=i.y.redNeg(),af(t,i),0},publicKeyCombine(t,e){let r=new Array(e.length);for(let n=0;n<e.length;++n)if(r[n]=Ou(e[n]),r[n]===null)return 1;let i=r[0].getPublic();for(let n=1;n<r.length;++n)i=i.add(r[n].pub);return i.isInfinity()?2:(af(t,i),0)},publicKeyTweakAdd(t,e,r){let i=Ou(e);if(i===null)return 1;if(r=new Qt(r),r.cmp(Et.n)>=0)return 2;let n=i.getPublic().add(Et.g.mul(r));return n.isInfinity()?2:(af(t,n),0)},publicKeyTweakMul(t,e,r){let i=Ou(e);if(i===null)return 1;if(r=new Qt(r),r.cmp(Et.n)>=0||r.isZero())return 2;let n=i.getPublic().mul(r);return af(t,n),0},signatureNormalize(t){let e=new Qt(t.subarray(0,32)),r=new Qt(t.subarray(32,64));return e.cmp(Et.n)>=0||r.cmp(Et.n)>=0?1:(r.cmp(wa.nh)===1&&t.set(Et.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){let r=e.subarray(0,32),i=e.subarray(32,64);if(new Qt(r).cmp(Et.n)>=0||new Qt(i).cmp(Et.n)>=0)return 1;let{output:n}=t,s=n.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=n.subarray(6+33,6+33+33);c[0]=0,c.set(i,1);let u=33,l=0;for(;u>1&&c[l]===0&&!(c[l+1]&128);--u,++l);return c=c.subarray(l),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(t.outputlen=6+o+u,n[0]=48,n[1]=t.outputlen-2,n[2]=2,n[3]=s.length,n.set(s,4),n[4+o]=2,n[5+o]=c.length,n.set(c,6+o),0)},signatureImport(t,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let r=e[3];if(r===0||5+r>=e.length||e[4+r]!==2)return 1;let i=e[5+r];if(i===0||6+r+i!==e.length||e[4]&128||r>1&&e[4]===0&&!(e[5]&128)||e[r+6]&128||i>1&&e[r+6]===0&&!(e[r+7]&128))return 1;let n=e.subarray(4,4+r);if(n.length===33&&n[0]===0&&(n=n.subarray(1)),n.length>32)return 1;let s=e.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new Qt(n);o.cmp(Et.n)>=0&&(o=new Qt(0));let a=new Qt(e.subarray(6+r));return a.cmp(Et.n)>=0&&(a=new Qt(0)),t.set(o.toArrayLike(Uint8Array,"be",32),0),t.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e,r,i,n){if(n){let a=n;n=c=>{let u=a(e,r,null,i,c);if(!(u instanceof Uint8Array&&u.length===32))throw new Error("This is the way");return new Qt(u)}}let s=new Qt(r);if(s.cmp(Et.n)>=0||s.isZero())return 1;let o;try{o=wa.sign(e,r,{canonical:!0,k:n,pers:i})}catch(a){return 1}return t.signature.set(o.r.toArrayLike(Uint8Array,"be",32),0),t.signature.set(o.s.toArrayLike(Uint8Array,"be",32),32),t.recid=o.recoveryParam,0},ecdsaVerify(t,e,r){let i={r:t.subarray(0,32),s:t.subarray(32,64)},n=new Qt(i.r),s=new Qt(i.s);if(n.cmp(Et.n)>=0||s.cmp(Et.n)>=0)return 1;if(s.cmp(wa.nh)===1||n.isZero()||s.isZero())return 3;let o=Ou(r);if(o===null)return 2;let a=o.getPublic();return wa.verify(e,i,a)?0:3},ecdsaRecover(t,e,r,i){let n={r:e.slice(0,32),s:e.slice(32,64)},s=new Qt(n.r),o=new Qt(n.s);if(s.cmp(Et.n)>=0||o.cmp(Et.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=wa.recoverPubKey(i,n,r)}catch(c){return 2}return af(t,a),0},ecdh(t,e,r,i,n,s,o){let a=Ou(e);if(a===null)return 1;let c=new Qt(r);if(c.cmp(Et.n)>=0||c.isZero())return 2;let u=a.getPublic().mul(c);if(n===void 0){let l=u.encode(null,!0),d=wa.hash().update(l).digest();for(let h=0;h<32;++h)t[h]=d[h]}else{s||(s=new Uint8Array(32));let l=u.getX().toArray("be",32);for(let g=0;g<32;++g)s[g]=l[g];o||(o=new Uint8Array(32));let d=u.getY().toArray("be",32);for(let g=0;g<32;++g)o[g]=d[g];let h=n(s,o,i);if(!(h instanceof Uint8Array&&h.length===t.length))return 2;t.set(h)}return 0}}});var B7=p((kAt,D7)=>{f();D7.exports=nM()(N7())});var U7=p((qAt,L7)=>{f();"use strict";var mo=B7(),{sha256:M7}=(ei(),Ur);L7.exports=t=>{let e=32;function r(){let l;do l=t(32);while(!mo.privateKeyVerify(l));return l}async function i(l,d){let{digest:h}=await M7.digest(d),y=mo.ecdsaSign(h,l);return mo.signatureExport(y.signature)}async function n(l,d,h){let{digest:y}=await M7.digest(h);return d=mo.signatureImport(d),mo.ecdsaVerify(d,y,l)}function s(l){if(!mo.publicKeyVerify(l))throw new Error("Invalid public key");return mo.publicKeyConvert(l,!0)}function o(l){return mo.publicKeyConvert(l,!1)}function a(l){if(!mo.privateKeyVerify(l))throw new Error("Invalid private key")}function c(l){if(!mo.publicKeyVerify(l))throw new Error("Invalid public key")}function u(l){return a(l),mo.publicKeyCreate(l)}return{generateKey:r,privateKeyLength:e,hashAndSign:i,hashAndVerify:n,compressPublicKey:s,decompressPublicKey:o,validatePrivateKey:a,validatePublicKey:c,computePublicKey:u}}});var V7=p((NAt,j7)=>{f();"use strict";var{sha256:F7}=(ei(),Ur),MCe=ae(),K7=ci(),LCe=Je(),UCe=Tv();j7.exports=(t,e,r)=>{r=r||U7()(e);class i{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,l){return r.hashAndVerify(this._key,l,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return K7(this.bytes,u.bytes)}async hash(){let{bytes:u}=await F7.digest(this.bytes);return u}}class n{constructor(u,l){this._key=u,this._publicKey=l||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return K7(this.bytes,u.bytes)}async hash(){let{bytes:u}=await F7.digest(this.bytes);return u}async id(){let u=await this.public.hash();return LCe(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return UCe.export(this.bytes,u);throw MCe(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await r.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var H7=p((DAt,z7)=>{f();"use strict";z7.exports={SHA1:20,SHA256:32,SHA512:64}});var eA=p(G7=>{f();"use strict";var $7=Wy(),FCe=H7(),KCe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},jCe=async(t,e)=>{let r=await $7.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};G7.create=async function(t,e){let r=KCe[t],i=await $7.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(n){return jCe(i,n)},length:FCe[t]}}});var Z7=p((MAt,Q7)=>{f();"use strict";var W7=ae(),Y7=tn(),VCe=ct(),zCe=eA(),X7={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};Q7.exports=async(t,e,r)=>{let i=X7[t];if(!i){let A=Object.keys(X7).join(" / ");throw W7(new Error(`unknown cipher type '${t}'. Must be ${A}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw W7(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=VCe("key expansion"),c=2*(s+n+o),u=await zCe.create(e,r),l=await u.digest(a),d=[],h=0;for(;h<c;){let A=await u.digest(Y7([l,a])),R=A.length;h+R>c&&(R=c-h),d.push(A),h+=R,l=await u.digest(l)}let y=c/2,g=Y7(d),m=g.slice(0,y),E=g.slice(y,c),v=A=>({iv:A.slice(0,s),cipherKey:A.slice(s,s+n),macKey:A.slice(s+n)});return{k1:v(m),k2:v(E)}}});var eL=p((LAt,J7)=>{f();"use strict";var HCe=ae();J7.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw HCe(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var oL=p(sL=>{f();"use strict";var $Ce=ae(),og=Wy(),{base64urlToBuffer:tL}=Iv(),GCe=eL(),tA=Je(),WCe=tn(),YCe=ci(),rL={"P-256":256,"P-384":384,"P-521":521};sL.generateEphmeralKeyPair=async function(t){GCe(Object.keys(rL),t);let e=await og.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(n,s)=>{let o;s?o=await og.get().subtle.importKey("jwk",QCe(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let a=[await og.get().subtle.importKey("jwk",nL(t,n),{name:"ECDH",namedCurve:t},!1,[]),o],c=await og.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:a[0]},a[1],rL[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await og.get().subtle.exportKey("jwk",e.publicKey);return{key:XCe(i),genSharedKey:r}};var iL={"P-256":32,"P-384":48,"P-521":66};function XCe(t){let e=iL[t.crv];return WCe([Uint8Array.from([4]),tL(t.x,e),tL(t.y,e)],1+e*2)}function nL(t,e){let r=iL[t];if(YCe(!e.slice(0,1),Uint8Array.from([4])))throw $Ce(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:tA(e.slice(1,r+1),"base64url"),y:tA(e.slice(1+r),"base64url"),ext:!0}}var QCe=(t,e)=>({...nL(t,e.public),d:tA(e.private,"base64url")})});var cL=p((FAt,aL)=>{f();"use strict";var ZCe=oL();aL.exports=async t=>ZCe.generateEphmeralKeyPair(t)});var Xv=p((KAt,lL)=>{f();"use strict";var _a=ev();hc();o6();var rA=lt(),ag=ae(),JCe=ct(),eOe=lB(),Rs={rsa:XB(),ed25519:rM(),secp256k1:V7()(_a,Qy())},Yv={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function wh(t){let e=Rs[t.toLowerCase()];if(!e){let r=Object.keys(Rs).join(" / ");throw ag(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var tOe=async(t,e)=>wh(t).generateKeyPair(e),rOe=async(t,e,r)=>{let i=wh(t);if(t.toLowerCase()!=="ed25519")throw ag(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,r)},iOe=t=>{let e=_a.PublicKey.decode(t),r=e.Data;switch(e.Type){case _a.KeyType.RSA:return Rs.rsa.unmarshalRsaPublicKey(r);case _a.KeyType.Ed25519:return Rs.ed25519.unmarshalEd25519PublicKey(r);case _a.KeyType.Secp256k1:if(Rs.secp256k1)return Rs.secp256k1.unmarshalSecp256k1PublicKey(r);throw ag(new Error(Yv.message),Yv.code);default:wh(e.Type)}},nOe=(t,e)=>(e=(e||"rsa").toLowerCase(),wh(e),t.bytes),uL=async t=>{let e=_a.PrivateKey.decode(t),r=e.Data;switch(e.Type){case _a.KeyType.RSA:return Rs.rsa.unmarshalRsaPrivateKey(r);case _a.KeyType.Ed25519:return Rs.ed25519.unmarshalEd25519PrivateKey(r);case _a.KeyType.Secp256k1:if(Rs.secp256k1)return Rs.secp256k1.unmarshalSecp256k1PrivateKey(r);throw ag(new Error(Yv.message),Yv.code);default:wh(e.Type)}},sOe=(t,e)=>(e=(e||"rsa").toLowerCase(),wh(e),t.bytes),oOe=async(t,e)=>{try{let n=await eOe.import(t,e);return uL(n)}catch(n){}let r=rA.pki.decryptRsaPrivateKey(t,e);if(r===null)throw ag(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=rA.asn1.toDer(rA.pki.privateKeyToAsn1(r));return i=JCe(i.getBytes(),"ascii"),Rs.rsa.unmarshalRsaPrivateKey(i)};lL.exports={supportedKeys:Rs,keysPBM:_a,keyStretcher:Z7(),generateEphemeralKeyPair:cL(),generateKeyPair:tOe,generateKeyPairFromSeed:rOe,unmarshalPublicKey:iOe,marshalPublicKey:nOe,unmarshalPrivateKey:uL,marshalPrivateKey:sOe,import:oOe}});var Qv=p((jAt,iA)=>{f();"use strict";function aOe(t,{className:e,symbolName:r}){let i=Symbol.for(r),n={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function cOe(t,{className:e,symbolName:r,withoutNew:i}){let n=Symbol.for(r),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=t.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}iA.exports=aOe;iA.exports.proto=cOe});var hL=p((VAt,dL)=>{f();"use strict";var _h=Ti(),fL=_h.Reader,uOe=_h.Writer,pi=_h.util,cg=_h.roots["libp2p-peer-id"]||(_h.roots["libp2p-peer-id"]={});cg.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.id=pi.newBuffer([]),t.prototype.pubKey=pi.newBuffer([]),t.prototype.privKey=pi.newBuffer([]),t.encode=function(r,i){return i||(i=uOe.create()),i.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&i.uint32(26).bytes(r.privKey),i},t.decode=function(r,i){r instanceof fL||(r=fL.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new cg.PeerIdProto;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw pi.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof cg.PeerIdProto)return r;var i=new cg.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?pi.base64.decode(r.id,i.id=pi.newBuffer(pi.base64.length(r.id)),0):r.id.length&&(i.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?pi.base64.decode(r.pubKey,i.pubKey=pi.newBuffer(pi.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?pi.base64.decode(r.privKey,i.privKey=pi.newBuffer(pi.base64.length(r.privKey)),0):r.privKey.length&&(i.privKey=r.privKey)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=pi.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=pi.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=pi.newBuffer(n.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(n.id=i.bytes===String?pi.base64.encode(r.id,0,r.id.length):i.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?pi.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?pi.base64.encode(r.privKey,0,r.privKey.length):i.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,_h.util.toJSONOptions)},t}();dL.exports=cg});var et=p((sn,_L)=>{f();"use strict";var{CID:nA}=(Ae(),ke),lOe=(Ji(),Zi),fOe=(Sx(),Gm),dOe=(Zr(),Qr),hOe=(My(),$d),{base58btc:sA}=(Zr(),Qr),{base32:pOe}=(Ji(),Zi),{base16:pL}=(xx(),Wm),ug=(vn(),mn),Ea=Xv(),yOe=Qv(),{PeerIdProto:yL}=hL(),cf=ci(),lg=ct(),gOe=Je(),{identity:Zv}=(bc(),ua),gL={...lOe,...fOe,...dOe,...hOe},bOe=Object.keys(gL).reduce((t,e)=>t.or(gL[e]),pOe.decoder),mOe=112,bL=114,mL=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&i&&!cf(r.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=sA.encode(this.id).substring(1),this._privKey=r,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=ug.decode(this.id);e.code===Zv.code&&(this._pubKey=Ea.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return Ea.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return Ea.marshalPrivateKey(this.privKey)}marshal(e){return yL.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:wL(this.marshalPrivKey()),pubKey:wL(this.marshalPubKey())}}toHexString(){return pL.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=nA.createV1(bL,ug.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return cf(this.id,e);if(e.id)return cf(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&cf(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(ug.decode(this.id).code===Zv.code)return!0}catch(e){}return!1}},Sa=yOe(mL,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});sn=_L.exports=Sa;var fg=t=>t.bytes.length<=42?ug.create(Zv.code,t.bytes).bytes:t.hash(),oA=async(t,e)=>{let r=await fg(e);return new Sa(r,t,e)};sn.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await Ea.generateKeyPair(t.keyType,t.bits);return oA(e,e.public)};sn.createFromHexString=t=>new Sa(pL.decode("f"+t));sn.createFromBytes=t=>{try{let e=nA.decode(t);if(!vL(e))throw new Error("Supplied PeerID CID is invalid");return sn.createFromCID(e)}catch{if(ug.decode(t).code!==Zv.code)throw new Error("Supplied PeerID CID is invalid");return new Sa(t)}};sn.createFromB58String=t=>sn.createFromBytes(sA.decode("z"+t));var vL=t=>t.code===bL||t.code===mOe;sn.createFromCID=t=>{if(t=nA.asCID(t),!t||!vL(t))throw new Error("Supplied PeerID CID is invalid");return new Sa(t.multihash.bytes)};sn.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=lg(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await Ea.unmarshalPublicKey(e);return oA(void 0,r)};sn.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=lg(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await Ea.unmarshalPrivateKey(t);return oA(e,e.public)};sn.createFromJSON=async t=>{let e=sA.decode("z"+t.id),r=t.privKey&&lg(t.privKey,"base64pad"),i=t.pubKey&&lg(t.pubKey,"base64pad"),n=i&&await Ea.unmarshalPublicKey(i);if(!r)return new Sa(e,void 0,n);let s=await Ea.unmarshalPrivateKey(r),o=await fg(s.public),a;if(n&&(a=await fg(n)),n&&!cf(o,a))throw new Error("Public and private key do not match");if(e&&!cf(o,e))throw new Error("Id and private key do not match");return new Sa(e,s,n)};sn.createFromProtobuf=async t=>{typeof t=="string"&&(t=lg(t,"base16"));let{id:e,privKey:r,pubKey:i}=yL.decode(t);r=r?await Ea.unmarshalPrivateKey(r):!1,i=i?await Ea.unmarshalPublicKey(i):!1;let n,s;if(r&&(s=await fg(r.public)),i&&(n=await fg(i)),r){if(i&&!cf(s,n))throw new Error("Public and private key do not match");return new Sa(s,r,r.public)}if(i)return new Sa(n,void 0,i);if(e)return new Sa(e);throw new Error("Protobuf did not contain any usable key material")};sn.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),sn.createFromBytes(bOe.decode(t)));sn.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function wL(t){if(t)return gOe(t,"base64pad")}});var xL=p((zAt,SL)=>{f();"use strict";Qd();var Jv=lt(),Eh=Je(),EL=ct();SL.exports={createCipheriv:(t,e,r)=>{let i=Jv.cipher.createCipher("AES-CTR",Eh(e,"ascii"));return i.start({iv:Eh(r,"ascii")}),{update:n=>(i.update(Jv.util.createBuffer(Eh(n,"ascii"))),EL(i.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let i=Jv.cipher.createDecipher("AES-CTR",Eh(e,"ascii"));return i.start({iv:Eh(r,"ascii")}),{update:n=>(i.update(Jv.util.createBuffer(Eh(n,"ascii"))),EL(i.output.getBytes(),"ascii"))}}}});var TL=p((HAt,IL)=>{f();"use strict";var vOe=ae(),AL={16:"aes-128-ctr",32:"aes-256-ctr"};IL.exports=function(t){let e=AL[t.length];if(!e){let r=Object.entries(AL).map(([i,n])=>`${i} (${n})`).join(" / ");throw vOe(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var CL=p(PL=>{f();"use strict";var RL=xL(),wOe=TL();PL.create=async function(t,e){let r=wOe(t),i=RL.createCipheriv(r,t,e),n=RL.createDecipheriv(r,t,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var qL=p((GAt,kL)=>{f();"use strict";var _Oe=Xx(),EOe=Wt(),SOe=ae(),OL={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function xOe(t,e,r,i,n){let s=OL[n];if(!s){let a=Object.keys(OL).join(" / ");throw SOe(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=_Oe(t,e,r,i,s);return EOe.encode64(o)}kL.exports=xOe});var xa=p(Sh=>{f();"use strict";var AOe=eA(),IOe=CL(),TOe=Xv();Sh.aes=IOe;Sh.hmac=AOe;Sh.keys=TOe;Sh.randomBytes=Qy();Sh.pbkdf2=qL()});var cA=p((YAt,DL)=>{f();"use strict";var NL="[a-fA-F\\d:]",ku=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${NL})|(?<=${NL})(?=\\s|$))`:"",vo="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",ui="[a-fA-F\\d]{1,4}",ew=`
(?:
(?:${ui}:){7}(?:${ui}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${ui}:){6}(?:${vo}|:${ui}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${ui}:){5}(?::${vo}|(?::${ui}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${ui}:){4}(?:(?::${ui}){0,1}:${vo}|(?::${ui}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${ui}:){3}(?:(?::${ui}){0,2}:${vo}|(?::${ui}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${ui}:){2}(?:(?::${ui}){0,3}:${vo}|(?::${ui}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${ui}:){1}(?:(?::${ui}){0,4}:${vo}|(?::${ui}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${ui}){0,5}:${vo}|(?::${ui}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),ROe=new RegExp(`(?:^${vo}$)|(?:^${ew}$)`),POe=new RegExp(`^${vo}$`),COe=new RegExp(`^${ew}$`),aA=t=>t&&t.exact?ROe:new RegExp(`(?:${ku(t)}${vo}${ku(t)})|(?:${ku(t)}${ew}${ku(t)})`,"g");aA.v4=t=>t&&t.exact?POe:new RegExp(`${ku(t)}${vo}${ku(t)}`,"g");aA.v6=t=>t&&t.exact?COe:new RegExp(`${ku(t)}${ew}${ku(t)}`,"g");DL.exports=aA});var ML=p((XAt,BL)=>{f();"use strict";var uA=cA(),xh=t=>uA({exact:!0}).test(t);xh.v4=t=>uA.v4({exact:!0}).test(t);xh.v6=t=>uA.v6({exact:!0}).test(t);xh.version=t=>xh(t)?xh.v4(t)?4:6:void 0;BL.exports=xh});var jL=p((QAt,KL)=>{f();"use strict";var lA=ML(),LL=Je(),OOe=lA,fA=lA.v4,UL=lA.v6,FL=function(t,e,r){r=~~r;let i;if(fA(t))i=e||new Uint8Array(r+4),t.split(/\./g).map(function(n){i[r++]=parseInt(n,10)&255});else if(UL(t)){let n=t.split(":",8),s;for(s=0;s<n.length;s++){let o=fA(n[s]),a;o&&(a=FL(n[s]),n[s]=LL(a.slice(0,2),"base16")),a&&++s<8&&n.splice(s,0,LL(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let o=[s,"1"];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(i=e||new Uint8Array(r+16),s=0;s<n.length;s++){let o=parseInt(n[s],16);i[r++]=o>>8&255,i[r++]=o&255}}if(!i)throw Error("Invalid ip address: "+t);return i},kOe=function(t,e,r){e=~~e,r=r||t.length-e;let i=[],n,s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)i.push(t[e+o]);n=i.join(".")}else if(r===16){for(let o=0;o<r;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};KL.exports={isIP:OOe,isV4:fA,isV6:UL,toBytes:FL,toString:kOe}});var dg=p((ZAt,zL)=>{f();"use strict";function Ln(t){if(typeof t=="number"){if(Ln.codes[t])return Ln.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(Ln.names[t])return Ln.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var Ps=-1;Ln.lengthPrefixedVarSize=Ps;Ln.V=Ps;Ln.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Ps,"ip6zone"],[53,Ps,"dns","resolvable"],[54,Ps,"dns4","resolvable"],[55,Ps,"dns6","resolvable"],[56,Ps,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Ps,"unix",!1,"path"],[421,Ps,"ipfs"],[421,Ps,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Ps,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Ps,"memory"]];Ln.names={};Ln.codes={};Ln.table.map(t=>{let e=VL.apply(null,t);return Ln.codes[e.code]=e,Ln.names[e.name]=e,null});Ln.object=VL;function VL(t,e,r,i,n){return{code:t,size:e,name:r,resolvable:Boolean(i),path:Boolean(n)}}zL.exports=Ln});var GL=p((JAt,$L)=>{f();$L.exports=dA;var HL=128,qOe=127,NOe=~qOe,DOe=Math.pow(2,31);function dA(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw dA.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var i=r;t>=DOe;)e[r++]=t&255|HL,t/=128;for(;t&NOe;)e[r++]=t&255|HL,t>>>=7;return e[r]=t|0,dA.bytes=r-i+1,e}});var XL=p((eIt,YL)=>{f();YL.exports=hA;var BOe=128,WL=127;function hA(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o||i>49)throw hA.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&WL)<<i:(s&WL)*Math.pow(2,i),i+=7}while(s>=BOe);return hA.bytes=n-e,r}});var ZL=p((tIt,QL)=>{f();var MOe=Math.pow(2,7),LOe=Math.pow(2,14),UOe=Math.pow(2,21),FOe=Math.pow(2,28),KOe=Math.pow(2,35),jOe=Math.pow(2,42),VOe=Math.pow(2,49),zOe=Math.pow(2,56),HOe=Math.pow(2,63);QL.exports=function(t){return t<MOe?1:t<LOe?2:t<UOe?3:t<FOe?4:t<KOe?5:t<jOe?6:t<VOe?7:t<zOe?8:t<HOe?9:10}});var es=p((rIt,JL)=>{f();JL.exports={encode:GL(),decode:XL(),encodingLength:ZL()}});var a9=p((iIt,o9)=>{f();"use strict";var tw=jL(),e9=dg(),{CID:$Oe}=(Ae(),ke),{base32:t9}=(Ji(),Zi),{base58btc:GOe}=(Zr(),Qr),WOe=(vn(),mn),Ah=es(),rw=Je(),r9=ct(),iw=tn();o9.exports=hg;function hg(t,e){return e instanceof Uint8Array?hg.toString(t,e):hg.toBytes(t,e)}hg.toString=function(e,r){switch(e9(e).code){case 4:case 41:return YOe(r);case 6:case 273:case 33:case 132:return n9(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return QOe(r);case 421:return JOe(r);case 444:return s9(r);case 445:return s9(r);default:return rw(r,"base16")}};hg.toBytes=function(e,r){switch(e9(e).code){case 4:return i9(r);case 41:return i9(r);case 6:case 273:case 33:case 132:return pA(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return XOe(r);case 421:return ZOe(r);case 444:return eke(r);case 445:return tke(r);default:return r9(r,"base16")}};function i9(t){if(!tw.isIP(t))throw new Error("invalid ip address");return tw.toBytes(t)}function YOe(t){let e=tw.toString(t);if(!e||!tw.isIP(e))throw new Error("invalid ip address");return e}function pA(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function n9(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function XOe(t){let e=r9(t),r=Uint8Array.from(Ah.encode(e.length));return iw([r,e],r.length+e.length)}function QOe(t){let e=Ah.decode(t);if(t=t.slice(Ah.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return rw(t)}function ZOe(t){let e;t[0]==="Q"||t[0]==="1"?e=WOe.decode(GOe.decode(`z${t}`)).bytes:e=$Oe.parse(t).multihash.bytes;let r=Uint8Array.from(Ah.encode(e.length));return iw([r,e],r.length+e.length)}function JOe(t){let e=Ah.decode(t),r=t.slice(Ah.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return rw(r,"base58btc")}function eke(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=t9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=pA(i);return iw([r,n],r.length+n.length)}function tke(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=t9.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=pA(i);return iw([r,n],r.length+n.length)}function s9(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),i=rw(e,"base32"),n=n9(r);return i+":"+n}});var v9=p((nIt,m9)=>{f();"use strict";var c9=a9(),yA=dg(),pg=es(),u9=tn(),rke=Je();m9.exports={stringToStringTuples:l9,stringTuplesToString:f9,tuplesToStringTuples:h9,stringTuplesToTuples:d9,bytesToTuples:gA,tuplesToBytes:p9,bytesToString:ike,stringToBytes:g9,fromString:nke,fromBytes:b9,validateBytes:bA,isValidBytes:ske,cleanPath:nw,ParseError:mA,protoFromTuple:yg,sizeForAddr:y9};function l9(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let i=0;i<r.length;i++){let n=r[i],s=yA(n);if(s.size===0){e.push([n]);continue}if(i++,i>=r.length)throw mA("invalid address: "+t);if(s.path){e.push([n,nw(r.slice(i).join("/"))]);break}e.push([n,r[i]])}return e}function f9(t){let e=[];return t.map(r=>{let i=yg(r);return e.push(i.name),r.length>1&&e.push(r[1]),null}),nw(e.join("/"))}function d9(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=yg(e);return e.length>1?[r.code,c9.toBytes(r.code,e[1])]:[r.code]})}function h9(t){return t.map(e=>{let r=yg(e);return e[1]?[r.code,c9.toString(r.code,e[1])]:[r.code]})}function p9(t){return b9(u9(t.map(e=>{let r=yg(e),i=Uint8Array.from(pg.encode(r.code));return e.length>1&&(i=u9([i,e[1]])),i})))}function y9(t,e){return t.size>0?t.size/8:t.size===0?0:pg.decode(e)+pg.decode.bytes}function gA(t){let e=[],r=0;for(;r<t.length;){let i=pg.decode(t,r),n=pg.decode.bytes,s=yA(i),o=y9(s,t.slice(r+n));if(o===0){e.push([i]),r+=n;continue}let a=t.slice(r+n,r+n+o);if(r+=o+n,r>t.length)throw mA("Invalid address Uint8Array: "+rke(t,"base16"));e.push([i,a])}return e}function ike(t){let e=gA(t),r=h9(e);return f9(r)}function g9(t){t=nw(t);let e=l9(t),r=d9(e);return p9(r)}function nke(t){return g9(t)}function b9(t){let e=bA(t);if(e)throw e;return Uint8Array.from(t)}function bA(t){try{gA(t)}catch(e){return e}}function ske(t){return bA(t)===void 0}function nw(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function mA(t){return new Error("Error parsing address: "+t)}function yg(t){return yA(t[0])}});var tt=p((sIt,E9)=>{f();"use strict";var wo=v9(),Ih=dg(),w9=es(),{CID:oke}=(Ae(),ke),{base58btc:ake}=(Zr(),Qr),cke=ae(),uke=Symbol.for("nodejs.util.inspect.custom"),sw=Je(),lke=ci(),vA=new Map,_9=Symbol.for("@multiformats/js-multiaddr/multiaddr"),En=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,_9,{value:!0}),e instanceof Uint8Array)this.bytes=wo.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=wo.fromString(e)}else if(En.isMultiaddr(e))this.bytes=wo.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return wo.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},Ih(e)))}protoCodes(){let e=[],r=this.bytes,i=0;for(;i<r.length;){let n=w9.decode(r,i),s=w9.decode.bytes,o=Ih(n);i+=wo.sizeForAddr(o,r.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return wo.bytesToTuples(this.bytes)}stringTuples(){let e=wo.bytesToTuples(this.bytes);return wo.tuplesToStringTuples(e)}encapsulate(e){return e=new En(e),new En(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),i=this.toString(),n=i.lastIndexOf(r);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new En(i.slice(0,n))}decapsulateCode(e){let r=this.tuples();for(let i=r.length-1;i>=0;i--)if(r[i][0]===e)return new En(wo.tuplesToBytes(r.slice(0,i)));return this}getPeerId(){try{let r=this.stringTuples().filter(i=>i[0]===Ih.names.ipfs.code).pop();if(r&&r[1]){let i=r[1];return i[0]==="Q"||i[0]==="1"?sw(ake.decode(`z${i}`),"base58btc"):sw(oke.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!Ih(r[0]).path)[0][1],e||(e=null)}catch(r){e=null}return e}equals(e){return lke(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let r=vA.get(e.name);if(!r)throw cke(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(n=>new En(n))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new En("/"+[i,e.address,r,e.port].join("/"))}static isName(e){return En.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof En||Boolean(e&&e[_9])}[uke](){return"<Multiaddr "+sw(this.bytes,"base16")+" - "+wo.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+sw(this.bytes,"base16")+" - "+wo.bytesToString(this.bytes)+">"}};En.protocols=Ih;En.resolvers=vA;function fke(t){return new En(t)}E9.exports={Multiaddr:En,multiaddr:fke,protocols:Ih,resolvers:vA}});var lf=p((oIt,k9)=>{f();"use strict";var{Multiaddr:wA}=tt(),S9=Xe("dns4"),x9=Xe("dns6"),A9=Xe("dnsaddr"),uf=on(Xe("dns"),A9,S9,x9),gg=on(Xe("ip4"),Xe("ip6")),Th=on(ft(gg,Xe("tcp")),ft(uf,Xe("tcp"))),_A=ft(gg,Xe("udp")),I9=ft(_A,Xe("utp")),T9=ft(_A,Xe("quic")),Rh=on(ft(Th,Xe("ws")),ft(uf,Xe("ws"))),Ph=on(ft(Th,Xe("wss")),ft(uf,Xe("wss"))),ow=on(ft(Th,Xe("http")),ft(gg,Xe("http")),ft(uf,Xe("http"))),aw=on(ft(Th,Xe("https")),ft(gg,Xe("https")),ft(uf,Xe("https"))),EA=on(ft(Rh,Xe("p2p-webrtc-star"),Xe("p2p")),ft(Ph,Xe("p2p-webrtc-star"),Xe("p2p")),ft(Rh,Xe("p2p-webrtc-star")),ft(Ph,Xe("p2p-webrtc-star"))),dke=on(ft(Rh,Xe("p2p-websocket-star"),Xe("p2p")),ft(Ph,Xe("p2p-websocket-star"),Xe("p2p")),ft(Rh,Xe("p2p-websocket-star")),ft(Ph,Xe("p2p-websocket-star"))),SA=on(ft(ow,Xe("p2p-webrtc-direct"),Xe("p2p")),ft(aw,Xe("p2p-webrtc-direct"),Xe("p2p")),ft(ow,Xe("p2p-webrtc-direct")),ft(aw,Xe("p2p-webrtc-direct"))),Ch=on(Rh,Ph,ow,aw,EA,SA,Th,I9,T9,uf),hke=on(ft(Ch,Xe("p2p-stardust"),Xe("p2p")),ft(Ch,Xe("p2p-stardust"))),qu=on(ft(Ch,Xe("p2p")),EA,SA,Xe("p2p")),R9=on(ft(qu,Xe("p2p-circuit"),qu),ft(qu,Xe("p2p-circuit")),ft(Xe("p2p-circuit"),qu),ft(Ch,Xe("p2p-circuit")),ft(Xe("p2p-circuit"),Ch),Xe("p2p-circuit")),P9=()=>on(ft(R9,P9),R9),Oh=P9(),C9=on(ft(Oh,qu,Oh),ft(qu,Oh),ft(Oh,qu),Oh,qu);k9.exports={DNS:uf,DNS4:S9,DNS6:x9,DNSADDR:A9,IP:gg,TCP:Th,UDP:_A,QUIC:T9,UTP:I9,HTTP:ow,HTTPS:aw,WebSockets:Rh,WebSocketsSecure:Ph,WebSocketStar:dke,WebRTCStar:EA,WebRTCDirect:SA,Reliable:Ch,Stardust:hke,Circuit:Oh,P2P:C9,IPFS:C9};function O9(t){function e(r){if(!wA.isMultiaddr(r))try{r=new wA(r)}catch(n){return!1}let i=t(r.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function ft(...t){function e(r){if(r.length<t.length)return null;let i=r;return t.some(n=>(i=typeof n=="function"?n().partialMatch(r):n.partialMatch(r),Array.isArray(i)&&(r=i),i===null)),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:O9(e),partialMatch:e}}function on(...t){function e(i){let n=null;return t.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:O9(e),partialMatch:e}}function Xe(t){let e=t;function r(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new wA(n)}catch(a){return!1}else s=n;let o=s.protoNames();return o.length===1&&o[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:i}}});var qh=p((aIt,H9)=>{f();"use strict";var{base58btc:pke}=(Zr(),Qr),{base32:yke}=(Ji(),Zi),gke=(vn(),mn),{Multiaddr:q9}=tt(),bke=lf(),{CID:xA}=(Ae(),ke),{URL:mke}=Um(),vke=Je(),AA=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,kh=/^\/(ip[fn]s)\/([^/?#]+)/,N9=1,D9=2,bg=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,B9=1,M9=2,wke=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function _ke(t){let e=IA(t);try{gke.decode(pke.decode("z"+e))}catch{return!1}return!0}function Eke(t){try{yke.decode(t)}catch{return!1}return!0}function mg(t){try{return typeof t=="string"?Boolean(xA.parse(t)):t instanceof Uint8Array?Boolean(xA.decode(t)):Boolean(xA.asCID(t))}catch(e){return!1}}function L9(t){if(!t)return!1;if(q9.isMultiaddr(t))return!0;try{return new q9(t),!0}catch(e){return!1}}function Ske(t){return L9(t)&&bke.P2P.matches(t)}function vg(t,e,r=N9,i=D9){let n=IA(t);if(!n)return!1;let s=n.match(e);if(!s||s[r]!=="ipfs")return!1;let o=s[i];return o&&e===bg&&(o=o.toLowerCase()),mg(o)}function cw(t,e,r=N9,i=D9){let n=IA(t);if(!n)return!1;let s=n.match(e);if(!s||s[r]!=="ipns")return!1;let o=s[i];if(o&&e===bg){if(o=o.toLowerCase(),mg(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new mke(`http://${o}`);return wke.test(a)}catch(a){return!1}}return!0}function U9(t){return typeof t=="string"}function IA(t){return t instanceof Uint8Array?vke(t,"base58btc"):U9(t)?t:!1}var TA=t=>vg(t,bg,M9,B9),RA=t=>cw(t,bg,M9,B9),F9=t=>TA(t)||RA(t),K9=t=>vg(t,AA)||TA(t),j9=t=>cw(t,AA)||RA(t),V9=t=>K9(t)||j9(t)||F9(t),z9=t=>vg(t,kh)||cw(t,kh);H9.exports={multihash:_ke,multiaddr:L9,peerMultiaddr:Ske,cid:mg,base32cid:t=>Eke(t)&&mg(t),ipfsSubdomain:TA,ipnsSubdomain:RA,subdomain:F9,subdomainGatewayPattern:bg,ipfsUrl:K9,ipnsUrl:j9,url:V9,pathGatewayPattern:AA,ipfsPath:t=>vg(t,kh),ipnsPath:t=>cw(t,kh),path:z9,pathPattern:kh,urlOrPath:t=>V9(t)||z9(t),cidPath:t=>U9(t)&&!mg(t)&&vg(`/ipfs/${t}`,kh)}});var G9=p((cIt,$9)=>{f();var Nh=1e3,Dh=Nh*60,Bh=Dh*60,ff=Bh*24,xke=ff*7,Ake=ff*365.25;$9.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Ike(t);if(r==="number"&&isFinite(t))return e.long?Rke(t):Tke(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Ike(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*Ake;case"weeks":case"week":case"w":return r*xke;case"days":case"day":case"d":return r*ff;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Bh;case"minutes":case"minute":case"mins":case"min":case"m":return r*Dh;case"seconds":case"second":case"secs":case"sec":case"s":return r*Nh;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Tke(t){var e=Math.abs(t);return e>=ff?Math.round(t/ff)+"d":e>=Bh?Math.round(t/Bh)+"h":e>=Dh?Math.round(t/Dh)+"m":e>=Nh?Math.round(t/Nh)+"s":t+"ms"}function Rke(t){var e=Math.abs(t);return e>=ff?uw(t,e,ff,"day"):e>=Bh?uw(t,e,Bh,"hour"):e>=Dh?uw(t,e,Dh,"minute"):e>=Nh?uw(t,e,Nh,"second"):t+" ms"}function uw(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var Y9=p((uIt,W9)=>{f();function Pke(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=n,r.enabled=o,r.humanize=G9(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let d=0;for(let h=0;h<l.length;h++)d=(d<<5)-d+l.charCodeAt(h),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=e;function r(l){let d,h=null,y,g;function m(...E){if(!m.enabled)return;let v=m,A=Number(new Date),R=A-(d||A);v.diff=R,v.prev=d,v.curr=A,d=A,E[0]=r.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let F=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(N,z)=>{if(N==="%%")return"%";F++;let G=r.formatters[z];if(typeof G=="function"){let Y=E[F];N=G.call(v,Y),E.splice(F,1),F--}return N}),r.formatArgs.call(v,E),(v.log||r.log).apply(v,E)}return m.namespace=l,m.useColors=r.useColors(),m.color=r.selectColor(l),m.extend=i,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(y!==r.namespaces&&(y=r.namespaces,g=r.enabled(l)),g),set:E=>{h=E}}),typeof r.init=="function"&&r.init(m),m}function i(l,d){let h=r(this.namespace+(typeof d=="undefined"?":":d)+l);return h.log=this.log,h}function n(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let d,h=(typeof l=="string"?l:"").split(/[\s,]+/),y=h.length;for(d=0;d<y;d++)!h[d]||(l=h[d].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.substr(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(d=>"-"+d)].join(",");return r.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let d,h;for(d=0,h=r.skips.length;d<h;d++)if(r.skips[d].test(l))return!1;for(d=0,h=r.names.length;d<h;d++)if(r.names[d].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}W9.exports=Pke});var me=p((ts,lw)=>{f();ts.formatArgs=Oke;ts.save=kke;ts.load=qke;ts.useColors=Cke;ts.storage=Nke();ts.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ts.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Cke(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Oke(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+lw.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}ts.log=console.debug||console.log||(()=>{});function kke(t){try{t?ts.storage.setItem("debug",t):ts.storage.removeItem("debug")}catch(e){}}function qke(){let t;try{t=ts.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function Nke(){try{return localStorage}catch(t){}}lw.exports=Y9()(ts);var{formatters:Dke}=lw.exports;Dke.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Q9=p((lIt,X9)=>{f();"use strict";var Nu=Ti(),Mh=Nu.Reader,PA=Nu.Writer,Qe=Nu.util,Di=Nu.roots["ipfs-unixfs"]||(Nu.roots["ipfs-unixfs"]={});Di.Data=function(){function t(e){if(this.blocksizes=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=Qe.newBuffer([]),t.prototype.filesize=Qe.Long?Qe.Long.fromBits(0,0,!0):0,t.prototype.blocksizes=Qe.emptyArray,t.prototype.hashType=Qe.Long?Qe.Long.fromBits(0,0,!0):0,t.prototype.fanout=Qe.Long?Qe.Long.fromBits(0,0,!0):0,t.prototype.mode=0,t.prototype.mtime=null,t.encode=function(r,i){if(i||(i=PA.create()),i.uint32(8).int32(r.Type),r.Data!=null&&Object.hasOwnProperty.call(r,"Data")&&i.uint32(18).bytes(r.Data),r.filesize!=null&&Object.hasOwnProperty.call(r,"filesize")&&i.uint32(24).uint64(r.filesize),r.blocksizes!=null&&r.blocksizes.length)for(var n=0;n<r.blocksizes.length;++n)i.uint32(32).uint64(r.blocksizes[n]);return r.hashType!=null&&Object.hasOwnProperty.call(r,"hashType")&&i.uint32(40).uint64(r.hashType),r.fanout!=null&&Object.hasOwnProperty.call(r,"fanout")&&i.uint32(48).uint64(r.fanout),r.mode!=null&&Object.hasOwnProperty.call(r,"mode")&&i.uint32(56).uint32(r.mode),r.mtime!=null&&Object.hasOwnProperty.call(r,"mtime")&&Di.UnixTime.encode(r.mtime,i.uint32(66).fork()).ldelim(),i},t.decode=function(r,i){r instanceof Mh||(r=Mh.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Di.Data;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;case 3:s.filesize=r.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=r.uint32()+r.pos;r.pos<a;)s.blocksizes.push(r.uint64());else s.blocksizes.push(r.uint64());break;case 5:s.hashType=r.uint64();break;case 6:s.fanout=r.uint64();break;case 7:s.mode=r.uint32();break;case 8:s.mtime=Di.UnixTime.decode(r,r.uint32());break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Qe.ProtocolError("missing required 'Type'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Di.Data)return r;var i=new Di.Data;switch(r.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(r.Data!=null&&(typeof r.Data=="string"?Qe.base64.decode(r.Data,i.Data=Qe.newBuffer(Qe.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),r.filesize!=null&&(Qe.Long?(i.filesize=Qe.Long.fromValue(r.filesize)).unsigned=!0:typeof r.filesize=="string"?i.filesize=parseInt(r.filesize,10):typeof r.filesize=="number"?i.filesize=r.filesize:typeof r.filesize=="object"&&(i.filesize=new Qe.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0))),r.blocksizes){if(!Array.isArray(r.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<r.blocksizes.length;++n)Qe.Long?(i.blocksizes[n]=Qe.Long.fromValue(r.blocksizes[n])).unsigned=!0:typeof r.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(r.blocksizes[n],10):typeof r.blocksizes[n]=="number"?i.blocksizes[n]=r.blocksizes[n]:typeof r.blocksizes[n]=="object"&&(i.blocksizes[n]=new Qe.LongBits(r.blocksizes[n].low>>>0,r.blocksizes[n].high>>>0).toNumber(!0))}if(r.hashType!=null&&(Qe.Long?(i.hashType=Qe.Long.fromValue(r.hashType)).unsigned=!0:typeof r.hashType=="string"?i.hashType=parseInt(r.hashType,10):typeof r.hashType=="number"?i.hashType=r.hashType:typeof r.hashType=="object"&&(i.hashType=new Qe.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0))),r.fanout!=null&&(Qe.Long?(i.fanout=Qe.Long.fromValue(r.fanout)).unsigned=!0:typeof r.fanout=="string"?i.fanout=parseInt(r.fanout,10):typeof r.fanout=="number"?i.fanout=r.fanout:typeof r.fanout=="object"&&(i.fanout=new Qe.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0))),r.mode!=null&&(i.mode=r.mode>>>0),r.mtime!=null){if(typeof r.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=Di.UnixTime.fromObject(r.mtime)}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Qe.newBuffer(n.Data))),Qe.Long){var s=new Qe.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(Qe.Long){var s=new Qe.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(Qe.Long){var s=new Qe.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?Di.Data.DataType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Qe.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),r.filesize!=null&&r.hasOwnProperty("filesize")&&(typeof r.filesize=="number"?n.filesize=i.longs===String?String(r.filesize):r.filesize:n.filesize=i.longs===String?Qe.Long.prototype.toString.call(r.filesize):i.longs===Number?new Qe.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0):r.filesize),r.blocksizes&&r.blocksizes.length){n.blocksizes=[];for(var o=0;o<r.blocksizes.length;++o)typeof r.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(r.blocksizes[o]):r.blocksizes[o]:n.blocksizes[o]=i.longs===String?Qe.Long.prototype.toString.call(r.blocksizes[o]):i.longs===Number?new Qe.LongBits(r.blocksizes[o].low>>>0,r.blocksizes[o].high>>>0).toNumber(!0):r.blocksizes[o]}return r.hashType!=null&&r.hasOwnProperty("hashType")&&(typeof r.hashType=="number"?n.hashType=i.longs===String?String(r.hashType):r.hashType:n.hashType=i.longs===String?Qe.Long.prototype.toString.call(r.hashType):i.longs===Number?new Qe.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0):r.hashType),r.fanout!=null&&r.hasOwnProperty("fanout")&&(typeof r.fanout=="number"?n.fanout=i.longs===String?String(r.fanout):r.fanout:n.fanout=i.longs===String?Qe.Long.prototype.toString.call(r.fanout):i.longs===Number?new Qe.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0):r.fanout),r.mode!=null&&r.hasOwnProperty("mode")&&(n.mode=r.mode),r.mtime!=null&&r.hasOwnProperty("mtime")&&(n.mtime=Di.UnixTime.toObject(r.mtime,i)),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Nu.util.toJSONOptions)},t.DataType=function(){var e={},r=Object.create(e);return r[e[0]="Raw"]=0,r[e[1]="Directory"]=1,r[e[2]="File"]=2,r[e[3]="Metadata"]=3,r[e[4]="Symlink"]=4,r[e[5]="HAMTShard"]=5,r}(),t}();Di.UnixTime=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Seconds=Qe.Long?Qe.Long.fromBits(0,0,!1):0,t.prototype.FractionalNanoseconds=0,t.encode=function(r,i){return i||(i=PA.create()),i.uint32(8).int64(r.Seconds),r.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(r,"FractionalNanoseconds")&&i.uint32(21).fixed32(r.FractionalNanoseconds),i},t.decode=function(r,i){r instanceof Mh||(r=Mh.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Di.UnixTime;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.Seconds=r.int64();break;case 2:s.FractionalNanoseconds=r.fixed32();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw Qe.ProtocolError("missing required 'Seconds'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Di.UnixTime)return r;var i=new Di.UnixTime;return r.Seconds!=null&&(Qe.Long?(i.Seconds=Qe.Long.fromValue(r.Seconds)).unsigned=!1:typeof r.Seconds=="string"?i.Seconds=parseInt(r.Seconds,10):typeof r.Seconds=="number"?i.Seconds=r.Seconds:typeof r.Seconds=="object"&&(i.Seconds=new Qe.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber())),r.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=r.FractionalNanoseconds>>>0),i},t.toObject=function(r,i){i||(i={});var n={};if(i.defaults){if(Qe.Long){var s=new Qe.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return r.Seconds!=null&&r.hasOwnProperty("Seconds")&&(typeof r.Seconds=="number"?n.Seconds=i.longs===String?String(r.Seconds):r.Seconds:n.Seconds=i.longs===String?Qe.Long.prototype.toString.call(r.Seconds):i.longs===Number?new Qe.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber():r.Seconds),r.FractionalNanoseconds!=null&&r.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=r.FractionalNanoseconds),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Nu.util.toJSONOptions)},t}();Di.Metadata=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.MimeType="",t.encode=function(r,i){return i||(i=PA.create()),r.MimeType!=null&&Object.hasOwnProperty.call(r,"MimeType")&&i.uint32(10).string(r.MimeType),i},t.decode=function(r,i){r instanceof Mh||(r=Mh.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Di.Metadata;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.MimeType=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Di.Metadata)return r;var i=new Di.Metadata;return r.MimeType!=null&&(i.MimeType=String(r.MimeType)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),r.MimeType!=null&&r.hasOwnProperty("MimeType")&&(n.MimeType=r.MimeType),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Nu.util.toJSONOptions)},t}();X9.exports=Di});var yi=p((fIt,tU)=>{f();"use strict";var{Data:Ac}=Q9(),CA=ae(),Z9=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],Bke=["directory","hamt-sharded-directory"],J9=parseInt("0644",8),eU=parseInt("0755",8);function fw(t){if(t!=null)return typeof t=="number"?t&4095:(t=t.toString(),t.substring(0,1)==="0"?parseInt(t,8)&4095:parseInt(t,10)&4095)}function OA(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),i=Math.floor(r/1e3);e={secs:i,nsecs:(r-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw CA(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var dw=class{static unmarshal(e){let r=Ac.decode(e),i=Ac.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new dw({type:Z9[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:r,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(r&&!Z9.includes(r))throw CA(new Error("Type: "+r+" is not valid"),"ERR_INVALID_TYPE");this.type=r||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=fw(c),a&&(this.mtime=OA(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?eU:J9;let r=fw(e);r!==void 0&&(this._mode=r)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&Bke.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(r=>{e+=r}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=Ac.DataType.Raw;break;case"directory":e=Ac.DataType.Directory;break;case"file":e=Ac.DataType.File;break;case"metadata":e=Ac.DataType.Metadata;break;case"symlink":e=Ac.DataType.Symlink;break;case"hamt-sharded-directory":e=Ac.DataType.HAMTShard;break;default:throw CA(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let r=this.data;(!this.data||!this.data.length)&&(r=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(fw(this.mode)||0),i===J9&&!this.isDirectory()&&(i=void 0),i===eU&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=OA(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:r,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return Ac.encode(s).finish()}};tU.exports={UnixFS:dw,parseMode:fw,parseMtime:OA}});function kA(t,e){let r=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");let n=t[e++];if(r+=i<28?(n&127)<<i:(n&127)*2**i,n<128)break}return[r,e]}function hw(t,e){let r;[r,e]=kA(t,e);let i=e+r;if(r<0||i<0)throw new Error("protobuf: invalid length");if(i>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,i),i]}function rU(t,e){let r;return[r,e]=kA(t,e),[r&7,r>>3,e]}function Lke(t){let e={},r=t.length,i=0;for(;i<r;){let n,s;if([n,s,i]=rU(t,i),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=hw(t,i)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,i]=hw(t,i),e.Name=Mke.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,i]=kA(t,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(i>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function iU(t){let e=t.length,r=0,i,n=!1,s;for(;r<e;){let a,c;if([a,c,r]=rU(t,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,r]=hw(t,r),i&&(n=!0)}else if(c===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let u;[u,r]=hw(t,r),i.push(Lke(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=i||[],o}var Mke,nU=Ge(()=>{f();Mke=new TextDecoder});function Fke(t,e){let r=e.length;if(typeof t.Tsize=="number"){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=wg(e,r,t.Tsize)-1,e[r]=24}if(typeof t.Name=="string"){let i=sU.encode(t.Name);r-=i.length,e.set(i,r),r=wg(e,r,i.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=wg(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function aU(t){let e=jke(t),r=new Uint8Array(e),i=e;if(t.Data&&(i-=t.Data.length,r.set(t.Data,i),i=wg(r,i,t.Data.length)-1,r[i]=10),t.Links)for(let n=t.Links.length-1;n>=0;n--){let s=Fke(t.Links[n],r.subarray(0,i));i-=s,i=wg(r,i,s)-1,r[i]=18}return r}function Kke(t){let e=0;if(t.Hash){let r=t.Hash.length;e+=1+r+Lh(r)}if(typeof t.Name=="string"){let r=sU.encode(t.Name).length;e+=1+r+Lh(r)}return typeof t.Tsize=="number"&&(e+=1+Lh(t.Tsize)),e}function jke(t){let e=0;if(t.Data){let r=t.Data.length;e+=1+r+Lh(r)}if(t.Links)for(let r of t.Links){let i=Kke(r);e+=1+i+Lh(i)}return e}function wg(t,e,r){e-=Lh(r);let i=e;for(;r>=Uke;)t[e++]=r&127|128,r/=128;for(;r>=128;)t[e++]=r&127|128,r>>>=7;return t[e]=r,i}function Lh(t){return t%2==0&&t++,Math.floor((Vke(t)+6)/7)}function Vke(t){let e=0;return t>=oU&&(t=Math.floor(t/oU),e=32),t>=1<<16&&(t>>>=16,e+=16),t>=1<<8&&(t>>>=8,e+=8),e+zke[t]}var sU,oU,Uke,zke,cU=Ge(()=>{f();sU=new TextEncoder,oU=2**32,Uke=2**31;zke=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]});function uU(t,e){if(t===e)return 0;let r=t.Name?qA.encode(t.Name):[],i=e.Name?qA.encode(e.Name):[],n=r.length,s=i.length;for(let o=0,a=Math.min(n,s);o<a;++o)if(r[o]!==i[o]){n=r[o],s=i[o];break}return n<s?-1:s<n?1:0}function lU(t,e){return!Object.keys(t).some(r=>!e.includes(r))}function fU(t){if(typeof t.asCID=="object"){let r=rt.asCID(t);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Hash){let r=rt.asCID(t.Hash);try{r||(typeof t.Hash=="string"?r=rt.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=rt.decode(t.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof t.Name=="string"&&(e.Name=t.Name),typeof t.Tsize=="number"&&(e.Tsize=t.Tsize),e}function NA(t){if((t instanceof Uint8Array||typeof t=="string")&&(t={Data:t}),typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Data!==void 0)if(typeof t.Data=="string")e.Data=qA.encode(t.Data);else if(t.Data instanceof Uint8Array)e.Data=t.Data;else throw new TypeError("Invalid DAG-PB form");if(t.Links!==void 0)if(Array.isArray(t.Links))e.Links=t.Links.map(fU),e.Links.sort(uU);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function DA(t){if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");if(!lU(t,Hke))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(t.Data!==void 0&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<t.Links.length;e++){let r=t.Links[e];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!lU(r,$ke))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&uU(r,t.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function dU(t,e=[]){return NA({Data:t,Links:e})}function hU(t,e,r){return fU({Hash:r,Name:t,Tsize:e})}var Hke,$ke,qA,pU=Ge(()=>{f();Ae();Hke=["Data","Links"],$ke=["Hash","Name","Tsize"],qA=new TextEncoder});var St={};Gt(St,{code:()=>Wke,createLink:()=>hU,createNode:()=>dU,decode:()=>Xke,encode:()=>Yke,name:()=>Gke,prepare:()=>NA,validate:()=>DA});function Yke(t){DA(t);let e={};return t.Links&&(e.Links=t.Links.map(r=>{let i={};return r.Hash&&(i.Hash=r.Hash.bytes),r.Name!==void 0&&(i.Name=r.Name),r.Tsize!==void 0&&(i.Tsize=r.Tsize),i})),t.Data&&(e.Data=t.Data),aU(e)}function Xke(t){let e=iU(t),r={};return e.Data&&(r.Data=e.Data),e.Links&&(r.Links=e.Links.map(i=>{let n={};try{n.Hash=rt.decode(i.Hash)}catch(s){}if(!n.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(n.Name=i.Name),i.Tsize!==void 0&&(n.Tsize=i.Tsize),n})),r}var Gke,Wke,xt=Ge(()=>{f();Ae();nU();cU();pU();Gke="dag-pb",Wke=112});function yU(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(Qke.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(Jke(t))return"Buffer";let r=eqe(t);return r||"Object"}function Jke(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function eqe(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(Zke.includes(e))return e}var Qke,Zke,gU=Ge(()=>{f();Qke=["string","number","bigint","symbol"],Zke=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var de,Ue,rs=Ge(()=>{f();de=class{constructor(e,r,i){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};de.uint=new de(0,"uint",!0);de.negint=new de(1,"negint",!0);de.bytes=new de(2,"bytes",!0);de.string=new de(3,"string",!0);de.array=new de(4,"array",!1);de.map=new de(5,"map",!1);de.tag=new de(6,"tag",!1);de.float=new de(7,"float",!0);de.false=new de(7,"false",!0);de.true=new de(7,"true",!0);de.null=new de(7,"null",!0);de.undefined=new de(7,"undefined",!0);de.break=new de(7,"break",!0);Ue=class{constructor(e,r,i){this.type=e,this.value=r,this.encodedLength=i,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function pw(t){return Uh&&globalThis.Buffer.isBuffer(t)}function BA(t){return t instanceof Uint8Array?pw(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}function _U(t,e){if(pw(t)&&pw(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function EU(t,e=1/0){let r,i=t.length,n=null,s=[];for(let o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function SU(t,e,r){let i=[];for(;e<r;){let n=t[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=r){let a,c,u,l;switch(o){case 1:n<128&&(s=n);break;case 2:a=t[e+1],(a&192)==128&&(l=(n&31)<<6|a&63,l>127&&(s=l));break;case 3:a=t[e+1],c=t[e+2],(a&192)==128&&(c&192)==128&&(l=(n&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:a=t[e+1],c=t[e+2],u=t[e+3],(a&192)==128&&(c&192)==128&&(u&192)==128&&(l=(n&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return iqe(i)}function iqe(t){let e=t.length;if(e<=xU)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=xU));return r}var Uh,tqe,rqe,bU,mU,Aa,yw,vU,wU,xU,Fh=Ge(()=>{f();Uh=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",tqe=new TextDecoder,rqe=new TextEncoder;bU=Uh?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):SU(t,e,r):(t,e,r)=>r-e>64?tqe.decode(t.subarray(e,r)):SU(t,e,r),mU=Uh?t=>t.length>64?globalThis.Buffer.from(t):EU(t):t=>t.length>64?rqe.encode(t):EU(t),Aa=t=>Uint8Array.from(t),yw=Uh?(t,e,r)=>pw(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),vU=Uh?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),BA(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),i=0;for(let n of t)i+n.length>r.length&&(n=n.subarray(0,r.length-i)),r.set(n,i),i+=n.length;return r},wU=Uh?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);xU=4096});var nqe,gw,AU=Ge(()=>{f();Fh();nqe=256,gw=class{constructor(e=nqe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=r.length-(this.maxCursor-this.cursor)-1;r.set(e,n)}else{if(r){let n=r.length-(this.maxCursor-this.cursor)-1;n<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=wU(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(r=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=yw(i,0,this.cursor)}else r=vU(this.chunks,this.cursor);return e&&this.reset(),r}}});function Ic(t,e,r){if(t.length-e<r)throw new Error(`${st} not enough data for type`)}var st,MA,_g,_o=Ge(()=>{f();st="CBOR decode error:",MA="CBOR encode error:",_g=[];_g[23]=1;_g[24]=2;_g[25]=3;_g[26]=5;_g[27]=9});function is(t,e,r){Ic(t,e,1);let i=t[e];if(r.strict===!0&&i<Bi[0])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function ns(t,e,r){Ic(t,e,2);let i=t[e]<<8|t[e+1];if(r.strict===!0&&i<Bi[1])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function ss(t,e,r){Ic(t,e,4);let i=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&i<Bi[2])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);return i}function os(t,e,r){Ic(t,e,8);let i=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],n=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(r.strict===!0&&s<Bi[3])throw new Error(`${st} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(r.allowBigInt===!0)return s;throw new Error(`${st} integers outside of the safe integer range are not supported`)}function IU(t,e,r,i){return new Ue(de.uint,is(t,e+1,i),2)}function TU(t,e,r,i){return new Ue(de.uint,ns(t,e+1,i),3)}function RU(t,e,r,i){return new Ue(de.uint,ss(t,e+1,i),5)}function PU(t,e,r,i){return new Ue(de.uint,os(t,e+1,i),9)}function Cs(t,e){return Un(t,0,e.value)}function Un(t,e,r){if(r<Bi[0]){let i=Number(r);t.push([e|i])}else if(r<Bi[1]){let i=Number(r);t.push([e|24,i])}else if(r<Bi[2]){let i=Number(r);t.push([e|25,i>>>8,i&255])}else if(r<Bi[3]){let i=Number(r);t.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(r);if(i<Bi[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,t.push(n)}else throw new Error(`${st} encountered BigInt larger than allowable range`)}}var Bi,Ia=Ge(()=>{f();rs();_o();Bi=[24,256,65536,4294967296,BigInt("18446744073709551616")];Cs.encodedSize=function(e){return Un.encodedSize(e.value)};Un.encodedSize=function(e){return e<Bi[0]?1:e<Bi[1]?2:e<Bi[2]?3:e<Bi[3]?5:9};Cs.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0}});function CU(t,e,r,i){return new Ue(de.negint,-1-is(t,e+1,i),2)}function OU(t,e,r,i){return new Ue(de.negint,-1-ns(t,e+1,i),3)}function kU(t,e,r,i){return new Ue(de.negint,-1-ss(t,e+1,i),5)}function NU(t,e,r,i){let n=os(t,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new Ue(de.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${st} integers outside of the safe integer range are not supported`);return new Ue(de.negint,LA-BigInt(n),9)}function bw(t,e){let r=e.value,i=typeof r=="bigint"?r*LA-qU:r*-1-1;Un(t,e.type.majorEncoded,i)}var LA,qU,UA=Ge(()=>{f();rs();Ia();_o();LA=BigInt(-1),qU=BigInt(1);bw.encodedSize=function(e){let r=e.value,i=typeof r=="bigint"?r*LA-qU:r*-1-1;return i<Bi[0]?1:i<Bi[1]?2:i<Bi[2]?3:i<Bi[3]?5:9};bw.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0}});function Eg(t,e,r,i){Ic(t,e,r+i);let n=yw(t,e+r,e+r+i);return new Ue(de.bytes,n,r+i)}function DU(t,e,r,i){return Eg(t,e,1,r)}function BU(t,e,r,i){return Eg(t,e,2,is(t,e+1,i))}function MU(t,e,r,i){return Eg(t,e,3,ns(t,e+1,i))}function LU(t,e,r,i){return Eg(t,e,5,ss(t,e+1,i))}function UU(t,e,r,i){let n=os(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer bytes lengths not supported`);return Eg(t,e,9,n)}function mw(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===de.string?mU(t.value):t.value),t.encodedBytes}function Kh(t,e){let r=mw(e);Un(t,e.type.majorEncoded,r.length),t.push(r)}function sqe(t,e){return t.length<e.length?-1:t.length>e.length?1:_U(t,e)}var vw=Ge(()=>{f();rs();_o();Ia();Fh();Kh.encodedSize=function(e){let r=mw(e);return Un.encodedSize(r.length)+r.length};Kh.compareTokens=function(e,r){return sqe(mw(e),mw(r))}});function Sg(t,e,r,i){let n=r+i;return Ic(t,e,n),new Ue(de.string,bU(t,e+r,e+n),n)}function FU(t,e,r,i){return Sg(t,e,1,r)}function KU(t,e,r,i){return Sg(t,e,2,is(t,e+1,i))}function jU(t,e,r,i){return Sg(t,e,3,ns(t,e+1,i))}function VU(t,e,r,i){return Sg(t,e,5,ss(t,e+1,i))}function zU(t,e,r,i){let n=os(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer string lengths not supported`);return Sg(t,e,9,n)}var HU,FA=Ge(()=>{f();rs();_o();Ia();vw();Fh();HU=Kh});function jh(t,e,r,i){return new Ue(de.array,i,r)}function $U(t,e,r,i){return jh(t,e,1,r)}function GU(t,e,r,i){return jh(t,e,2,is(t,e+1,i))}function WU(t,e,r,i){return jh(t,e,3,ns(t,e+1,i))}function YU(t,e,r,i){return jh(t,e,5,ss(t,e+1,i))}function XU(t,e,r,i){let n=os(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer array lengths not supported`);return jh(t,e,9,n)}function QU(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return jh(t,e,1,1/0)}function KA(t,e){Un(t,de.array.majorEncoded,e.value)}var jA=Ge(()=>{f();rs();Ia();_o();KA.compareTokens=Cs.compareTokens});function Vh(t,e,r,i){return new Ue(de.map,i,r)}function ZU(t,e,r,i){return Vh(t,e,1,r)}function JU(t,e,r,i){return Vh(t,e,2,is(t,e+1,i))}function eF(t,e,r,i){return Vh(t,e,3,ns(t,e+1,i))}function tF(t,e,r,i){return Vh(t,e,5,ss(t,e+1,i))}function rF(t,e,r,i){let n=os(t,e+1,i);if(typeof n=="bigint")throw new Error(`${st} 64-bit integer map lengths not supported`);return Vh(t,e,9,n)}function iF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return Vh(t,e,1,1/0)}function VA(t,e){Un(t,de.map.majorEncoded,e.value)}var zA=Ge(()=>{f();rs();Ia();_o();VA.compareTokens=Cs.compareTokens});function nF(t,e,r,i){return new Ue(de.tag,r,1)}function sF(t,e,r,i){return new Ue(de.tag,is(t,e+1,i),2)}function oF(t,e,r,i){return new Ue(de.tag,ns(t,e+1,i),3)}function aF(t,e,r,i){return new Ue(de.tag,ss(t,e+1,i),5)}function cF(t,e,r,i){return new Ue(de.tag,os(t,e+1,i),9)}function HA(t,e){Un(t,de.tag.majorEncoded,e.value)}var $A=Ge(()=>{f();rs();Ia();HA.compareTokens=Cs.compareTokens});function uF(t,e,r,i){if(i.allowUndefined===!1)throw new Error(`${st} undefined values are not supported`);return new Ue(de.undefined,void 0,1)}function lF(t,e,r,i){if(i.allowIndefinite===!1)throw new Error(`${st} indefinite length items not allowed`);return new Ue(de.break,void 0,1)}function GA(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${st} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${st} Infinity values are not supported`)}return new Ue(de.float,t,e)}function fF(t,e,r,i){return GA(WA(t,e+1),3,i)}function dF(t,e,r,i){return GA(YA(t,e+1),5,i)}function hF(t,e,r,i){return GA(bF(t,e+1),9,i)}function ww(t,e,r){let i=e.value;if(i===!1)t.push([de.float.majorEncoded|oqe]);else if(i===!0)t.push([de.float.majorEncoded|aqe]);else if(i===null)t.push([de.float.majorEncoded|cqe]);else if(i===void 0)t.push([de.float.majorEncoded|uqe]);else{let n,s=!1;(!r||r.float64!==!0)&&(yF(i),n=WA(Eo,1),i===n||Number.isNaN(i)?(Eo[0]=249,t.push(Eo.slice(0,3)),s=!0):(gF(i),n=YA(Eo,1),i===n&&(Eo[0]=250,t.push(Eo.slice(0,5)),s=!0))),s||(lqe(i),n=bF(Eo,1),Eo[0]=251,t.push(Eo.slice(0,9)))}}function yF(t){if(t===1/0)Os.setUint16(0,31744,!1);else if(t===-1/0)Os.setUint16(0,64512,!1);else if(Number.isNaN(t))Os.setUint16(0,32256,!1);else{Os.setFloat32(0,t);let e=Os.getUint32(0),r=(e&2139095040)>>23,i=e&8388607;if(r===255)Os.setUint16(0,31744,!1);else if(r===0)Os.setUint16(0,(t&2147483648)>>16|i>>13,!1);else{let n=r-127;n<-24?Os.setUint16(0,0):n<-14?Os.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Os.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function WA(t,e){if(t.length-e<2)throw new Error(`${st} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let i=r>>10&31,n=r&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?1/0:NaN,r&32768?-s:s}function gF(t){Os.setFloat32(0,t,!1)}function YA(t,e){if(t.length-e<4)throw new Error(`${st} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function lqe(t){Os.setFloat64(0,t,!1)}function bF(t,e){if(t.length-e<8)throw new Error(`${st} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}var oqe,aqe,cqe,uqe,pF,Os,Eo,XA=Ge(()=>{f();rs();_o();Ia();oqe=20,aqe=21,cqe=22,uqe=23;ww.encodedSize=function(e,r){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;let n;if(!r||r.float64!==!0){if(yF(i),n=WA(Eo,1),i===n||Number.isNaN(i))return 3;if(gF(i),n=YA(Eo,1),i===n)return 5}return 9};pF=new ArrayBuffer(9),Os=new DataView(pF,1),Eo=new Uint8Array(pF,0);ww.compareTokens=Cs.compareTokens});function Dt(t,e,r){throw new Error(`${st} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function _w(t){return()=>{throw new Error(`${st} ${t}`)}}function mF(t){switch(t.type){case de.false:return Aa([244]);case de.true:return Aa([245]);case de.null:return Aa([246]);case de.bytes:return t.value.length?void 0:Aa([64]);case de.string:return t.value===""?Aa([96]):void 0;case de.array:return t.value===0?Aa([128]):void 0;case de.map:return t.value===0?Aa([160]):void 0;case de.uint:return t.value<24?Aa([Number(t.value)]):void 0;case de.negint:if(t.value>=-24)return Aa([31-Number(t.value)])}}var qe,So,QA=Ge(()=>{f();rs();Ia();UA();vw();FA();jA();zA();$A();XA();_o();Fh();qe=[];for(let t=0;t<=23;t++)qe[t]=Dt;qe[24]=IU;qe[25]=TU;qe[26]=RU;qe[27]=PU;qe[28]=Dt;qe[29]=Dt;qe[30]=Dt;qe[31]=Dt;for(let t=32;t<=55;t++)qe[t]=Dt;qe[56]=CU;qe[57]=OU;qe[58]=kU;qe[59]=NU;qe[60]=Dt;qe[61]=Dt;qe[62]=Dt;qe[63]=Dt;for(let t=64;t<=87;t++)qe[t]=DU;qe[88]=BU;qe[89]=MU;qe[90]=LU;qe[91]=UU;qe[92]=Dt;qe[93]=Dt;qe[94]=Dt;qe[95]=_w("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)qe[t]=FU;qe[120]=KU;qe[121]=jU;qe[122]=VU;qe[123]=zU;qe[124]=Dt;qe[125]=Dt;qe[126]=Dt;qe[127]=_w("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)qe[t]=$U;qe[152]=GU;qe[153]=WU;qe[154]=YU;qe[155]=XU;qe[156]=Dt;qe[157]=Dt;qe[158]=Dt;qe[159]=QU;for(let t=160;t<=183;t++)qe[t]=ZU;qe[184]=JU;qe[185]=eF;qe[186]=tF;qe[187]=rF;qe[188]=Dt;qe[189]=Dt;qe[190]=Dt;qe[191]=iF;for(let t=192;t<=215;t++)qe[t]=nF;qe[216]=sF;qe[217]=oF;qe[218]=aF;qe[219]=cF;qe[220]=Dt;qe[221]=Dt;qe[222]=Dt;qe[223]=Dt;for(let t=224;t<=243;t++)qe[t]=_w("simple values are not supported");qe[244]=Dt;qe[245]=Dt;qe[246]=Dt;qe[247]=uF;qe[248]=_w("simple values are not supported");qe[249]=fF;qe[250]=dF;qe[251]=hF;qe[252]=Dt;qe[253]=Dt;qe[254]=Dt;qe[255]=lF;So=[];for(let t=0;t<24;t++)So[t]=new Ue(de.uint,t,1);for(let t=-1;t>=-24;t--)So[31-t]=new Ue(de.negint,t,1);So[64]=new Ue(de.bytes,new Uint8Array(0),1);So[96]=new Ue(de.string,"",1);So[128]=new Ue(de.array,0,1);So[160]=new Ue(de.map,0,1);So[244]=new Ue(de.false,!1,1);So[245]=new Ue(de.true,!0,1);So[246]=new Ue(de.null,null,1)});function Ew(t,e={},r){let i=yU(t),n=e&&e.typeEncoders&&e.typeEncoders[i]||Bu[i];if(typeof n=="function"){let o=n(t,i,e,r);if(o!=null)return o}let s=Bu[i];if(!s)throw new Error(`${MA} unsupported type: ${i}`);return s(t,i,e,r)}function dqe(t,e){e.mapSorter&&t.sort(e.mapSorter)}function hqe(t,e){let r=Array.isArray(t[0])?t[0][0]:t[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==i.type)return r.type.compare(i.type);let n=r.type.major,s=Ta[n].compareTokens(r,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function wF(t,e,r,i){if(Array.isArray(e))for(let n of e)wF(t,n,r,i);else r[e.type.major](t,e,i)}function pqe(t,e,r){let i=Ew(t,r);if(!Array.isArray(i)&&r.quickEncodeToken){let n=r.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,r),a=new gw(o);if(s(a,i,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return BA(a.chunks[0])}}return wF(vF,i,e,r),vF.toBytes(!0)}function Sw(t,e){return e=Object.assign({},fqe,e),pqe(t,Ta,e)}var fqe,Ta,vF,xg,Du,Bu,_F=Ge(()=>{f();gU();rs();AU();_o();QA();Fh();Ia();UA();vw();FA();jA();zA();$A();XA();fqe={float64:!1,mapSorter:hqe,quickEncodeToken:mF},Ta=[];Ta[de.uint.major]=Cs;Ta[de.negint.major]=bw;Ta[de.bytes.major]=Kh;Ta[de.string.major]=HU;Ta[de.array.major]=KA;Ta[de.map.major]=VA;Ta[de.tag.major]=HA;Ta[de.float.major]=ww;vF=new gw,xg=class{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${MA} object contains circular references`);return new xg(r,e)}},Du={null:new Ue(de.null,null),undefined:new Ue(de.undefined,void 0),true:new Ue(de.true,!0),false:new Ue(de.false,!1),emptyArray:new Ue(de.array,0),emptyMap:new Ue(de.map,0)},Bu={number(t,e,r,i){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new Ue(de.float,t):t>=0?new Ue(de.uint,t):new Ue(de.negint,t)},bigint(t,e,r,i){return t>=BigInt(0)?new Ue(de.uint,t):new Ue(de.negint,t)},Uint8Array(t,e,r,i){return new Ue(de.bytes,t)},string(t,e,r,i){return new Ue(de.string,t)},boolean(t,e,r,i){return t?Du.true:Du.false},null(t,e,r,i){return Du.null},undefined(t,e,r,i){return Du.undefined},ArrayBuffer(t,e,r,i){return new Ue(de.bytes,new Uint8Array(t))},DataView(t,e,r,i){return new Ue(de.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,i){if(!t.length)return r.addBreakTokens===!0?[Du.emptyArray,new Ue(de.break)]:Du.emptyArray;i=xg.createCheck(i,t);let n=[],s=0;for(let o of t)n[s++]=Ew(o,r,i);return r.addBreakTokens?[new Ue(de.array,t.length),n,new Ue(de.break)]:[new Ue(de.array,t.length),n]},Object(t,e,r,i){let n=e!=="Object",s=n?t.keys():Object.keys(t),o=n?t.size:s.length;if(!o)return r.addBreakTokens===!0?[Du.emptyMap,new Ue(de.break)]:Du.emptyMap;i=xg.createCheck(i,t);let a=[],c=0;for(let u of s)a[c++]=[Ew(u,r,i),Ew(n?t.get(u):t[u],r,i)];return dqe(a,r),r.addBreakTokens?[new Ue(de.map,o),a,new Ue(de.break)]:[new Ue(de.map,o),a]}};Bu.Map=Bu.Object;Bu.Buffer=Bu.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Bu[`${t}Array`]=Bu.DataView});function gqe(t,e,r){let i=[];for(let n=0;n<t.value;n++){let s=Ig(e,r);if(s===xw){if(t.value===1/0)break;throw new Error(`${st} got unexpected break to lengthed array`)}if(s===Ag)throw new Error(`${st} found array but not enough entries (got ${n}, expected ${t.value})`);i[n]=s}return i}function bqe(t,e,r){let i=r.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<t.value;o++){let a=Ig(e,r);if(a===xw){if(t.value===1/0)break;throw new Error(`${st} got unexpected break to lengthed map`)}if(a===Ag)throw new Error(`${st} found map but not enough entries (got ${o} [no key], expected ${t.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${st} non-string keys not supported (got ${typeof a})`);let c=Ig(e,r);if(c===Ag)throw new Error(`${st} found map but not enough entries (got ${o} [no value], expected ${t.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function Ig(t,e){if(t.done())return Ag;let r=t.next();if(r.type===de.break)return xw;if(r.type.terminal)return r.value;if(r.type===de.array)return gqe(r,t,e);if(r.type===de.map)return bqe(r,t,e);if(r.type===de.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let i=Ig(t,e);return e.tags[r.value](i)}throw new Error(`${st} tag not supported (${r.value})`)}throw new Error("unsupported")}function Aw(t,e){if(!(t instanceof Uint8Array))throw new Error(`${st} data to decode must be a Uint8Array`);e=Object.assign({},yqe,e);let r=e.tokenizer||new EF(t,e),i=Ig(r,e);if(i===Ag)throw new Error(`${st} did not find any content to decode`);if(i===xw)throw new Error(`${st} got unexpected break`);if(!r.done())throw new Error(`${st} too many terminals, data makes no sense`);return i}var yqe,EF,Ag,xw,SF=Ge(()=>{f();_o();rs();QA();yqe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},EF=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],r=So[e];if(r===void 0){let i=qe[e];if(!i)throw new Error(`${st} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;r=i(this.data,this.pos,n,this.options)}return this.pos+=r.encodedLength,r}},Ag=Symbol.for("DONE"),xw=Symbol.for("BREAK")});var Iw={};Gt(Iw,{Token:()=>Ue,Type:()=>de,decode:()=>Aw,encode:()=>Sw});var Tg=Ge(()=>{f();_F();SF();rs()});var df={};Gt(df,{code:()=>xqe,decode:()=>JA,encode:()=>ZA,name:()=>Sqe});function mqe(t){if(t.asCID!==t)return null;let e=rt.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new Ue(de.tag,xF),new Ue(de.bytes,r)]}function vqe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function wqe(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function Eqe(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return rt.decode(t.subarray(1))}var xF,_qe,AF,Sqe,xqe,ZA,JA,Tc=Ge(()=>{f();Tg();Ae();xF=42;_qe={float64:!0,typeEncoders:{Object:mqe,undefined:vqe,number:wqe}};AF={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};AF.tags[xF]=Eqe;Sqe="dag-cbor",xqe=113,ZA=t=>Sw(t,_qe),JA=t=>Aw(t,AF)});var TF=p((K4t,IF)=>{f();"use strict";IF.exports=()=>{}});var Lu=p(Mu=>{f();"use strict";var Rg=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=Rg.code}};Rg.code="ERR_NOT_INITIALIZED";Mu.NotInitializedError=Rg;var eI=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=zh.code}};eI.code="ERR_ALREADY_INITIALIZING";Mu.AlreadyInitializingError=eI;var zh=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=zh.code}};zh.code="ERR_ALREADY_INITIALIZED";Mu.AlreadyInitializedError=zh;var Pg=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=Pg.code}};Pg.code="ERR_NOT_STARTED";Mu.NotStartedError=Pg;var Cg=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=Cg.code}};Cg.code="ERR_ALREADY_STARTING";Mu.AlreadyStartingError=Cg;var Og=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=Og.code}};Og.code="ERR_ALREADY_STARTED";Mu.AlreadyStartedError=Og;var kg=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=kg.code}};kg.code="ERR_NOT_ENABLED";Mu.NotEnabledError=kg});var RF,PF=Ge(()=>{f();RF="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var qg={};Gt(qg,{customAlphabet:()=>Aqe,customRandom:()=>OF,nanoid:()=>Iqe,random:()=>CF,urlAlphabet:()=>RF});var CF,OF,Aqe,Iqe,Ng=Ge(()=>{f();PF();CF=t=>crypto.getRandomValues(new Uint8Array(t)),OF=(t,e,r)=>{let i=(2<<Math.log(t.length-1)/Math.LN2)-1,n=-~(1.6*i*e/t.length);return()=>{let s="";for(;;){let o=r(n),a=n;for(;a--;)if(s+=t[o[a]&i]||"",s.length===e)return s}}},Aqe=(t,e)=>OF(t,e,CF),Iqe=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let i=r[t]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var tI=p((H4t,qF)=>{f();"use strict";var{nanoid:Tqe}=(Ng(),qg),Rqe=Je(),Pqe=ct(),Rc="/",kF=new TextEncoder().encode(Rc),Tw=kF[0],ks=class{constructor(e,r){if(typeof e=="string")this._buf=Pqe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Tw)throw new Error("Invalid key")}toString(e="utf8"){return Rqe(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ks(e.join(Rc))}static random(){return new ks(Tqe().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=kF),this._buf[0]!==Tw){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Tw,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Tw;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),i=e.list();for(let n=0;n<r.length;n++){if(i.length<n+1)return!1;let s=r[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return r.length<i.length}reverse(){return ks.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Rc).slice(1)}type(){return Cqe(this.baseNamespace())}name(){return Oqe(this.baseNamespace())}instance(e){return new ks(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Rc)||(e+=Rc),e+=this.type(),new ks(e)}parent(){let e=this.list();return e.length===1?new ks(Rc):new ks(e.slice(0,-1).join(Rc))}child(e){return this.toString()===Rc?e:e.toString()===Rc?this:new ks(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return ks.withNamespaces([...this.namespaces(),...kqe(e.map(r=>r.namespaces()))])}};function Cqe(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Oqe(t){let e=t.split(":");return e[e.length-1]}function kqe(t){return[].concat(...t)}qF.exports=ks});var DF=p(($4t,NF)=>{f();"use strict";var{nanoid:qqe}=(Ng(),qg),Nqe=(t=e=>e)=>t(qqe());NF.exports=Nqe});var Hh=p((G4t,BF)=>{f();"use strict";var Dqe=async t=>{let e=[];for await(let r of t)e.push(r);return e};BF.exports=Dqe});var rI=p((W4t,MF)=>{f();"use strict";var Bqe=DF(),Mqe=Hh(),Lqe=(t,e)=>async function*(){yield*(await Mqe(t)).sort(e)}(),Uqe=(t,e)=>{let r=new RegExp("^"+e);return t.replace(r,"")};MF.exports={sortAll:Lqe,tmpdir:Bqe,replaceStartWith:Uqe}});var Ra=p((Y4t,LF)=>{f();"use strict";var Fqe=async t=>{for await(let e of t);};LF.exports=Fqe});var Pa=p((X4t,UF)=>{f();"use strict";var Kqe=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};UF.exports=Kqe});var $h=p((Q4t,FF)=>{f();"use strict";var jqe=async function*(t,e){let r=0;if(!(e<1)){for await(let i of t)if(yield i,r++,r===e)return}};FF.exports=jqe});var iI=p((Z4t,HF)=>{f();"use strict";var{sortAll:KF}=rI(),jF=Ra(),Gh=Pa(),VF=$h(),zF=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,i){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:i,value:n}of e)await this.put(i,n,r),yield{key:i,value:n}}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}async*deleteMany(e,r={}){for await(let i of e)await this.delete(i,r),yield i}batch(){let e=[],r=[];return{put(i,n){e.push({key:i,value:n})},delete(i){r.push(i)},commit:async i=>{await jF(this.putMany(e,i)),e=[],await jF(this.deleteMany(r,i)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let i=this._all(e,r);if(e.prefix!=null&&(i=Gh(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>Gh(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>KF(n,s),i)),e.offset!=null){let n=0;i=Gh(i,()=>n++>=e.offset)}return e.limit!=null&&(i=VF(i,e.limit)),i}queryKeys(e,r){let i=this._allKeys(e,r);if(e.prefix!=null&&(i=Gh(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>Gh(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>KF(n,s),i)),e.offset!=null){let n=0;i=Gh(i,()=>n++>=e.offset)}return e.limit!=null&&(i=VF(i,e.limit)),i}};HF.exports=zF});var nI=p((J4t,$F)=>{f();"use strict";var Dg=ae();function Vqe(t){return t=t||new Error("Cannot open database"),Dg(t,"ERR_DB_OPEN_FAILED")}function zqe(t){return t=t||new Error("Delete failed"),Dg(t,"ERR_DB_DELETE_FAILED")}function Hqe(t){return t=t||new Error("Write failed"),Dg(t,"ERR_DB_WRITE_FAILED")}function $qe(t){return t=t||new Error("Not Found"),Dg(t,"ERR_NOT_FOUND")}function Gqe(t){return t=t||new Error("Aborted"),Dg(t,"ERR_ABORTED")}$F.exports={dbOpenFailedError:Vqe,dbDeleteFailedError:zqe,dbWriteFailedError:Hqe,notFoundError:$qe,abortedError:Gqe}});var XF=p((e5t,YF)=>{f();"use strict";var GF=tI(),Wqe=iI(),Yqe=nI(),WF=class extends Wqe{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[e.toString()]=r}async get(e){if(!await this.has(e))throw Yqe.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:new GF(e),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new GF(e))}};YF.exports=WF});var Ft=p((t5t,QF)=>{f();"use strict";var Xqe=tI(),Qqe=XF(),Zqe=rI(),Jqe=nI(),eNe=iI();QF.exports={Key:Xqe,MemoryDatastore:Qqe,utils:Zqe,Errors:Jqe,Adapter:eNe}});var JF=p((r5t,ZF)=>{f();"use strict";ZF.exports=function(){return Date.now()}});var tK=p((i5t,eK)=>{f();"use strict";var sI=JF();function oI(t,e,r){var i=this;this._started=sI(),this._rescheduled=0,this._scheduled=e,this._args=r,this._timer=setTimeout(n,e);function n(){i._rescheduled>0?(i._scheduled=i._rescheduled-(sI()-i._started),i._timer=setTimeout(n,i._scheduled),i._rescheduled=0):t.apply(null,i._args)}}oI.prototype.reschedule=function(t){var e=sI();return e+t-(this._started+this._scheduled)<0?!1:(this._started=e,this._rescheduled=t,!0)};oI.prototype.clear=function(){clearTimeout(this._timer)};function tNe(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new oI(arguments[0],arguments[1],t)}eK.exports=tNe});var cI=p((n5t,aI)=>{f();"use strict";var{AbortController:rNe}=typeof self!="undefined"?self:typeof window!="undefined"?window:Ll(),rK=tK(),Bg=class extends rNe{constructor(e){super();this._ms=e,this._timer=rK(()=>this.abort(),e),Object.setPrototypeOf(this,Bg.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=rK(()=>this.abort(),this._ms)}};aI.exports=Bg;aI.exports.TimeoutController=Bg});var Mg=p((s5t,uI)=>{f();"use strict";var iNe=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;uI.exports=dt;uI.exports.default=dt;dt.nanosecond=dt.ns=1/1e6;dt.\u00B5s=dt.\u03BCs=dt.us=dt.microsecond=1/1e3;dt.millisecond=dt.ms=dt[""]=1;dt.second=dt.sec=dt.s=dt.ms*1e3;dt.minute=dt.min=dt.m=dt.s*60;dt.hour=dt.hr=dt.h=dt.m*60;dt.day=dt.d=dt.h*24;dt.week=dt.wk=dt.w=dt.d*7;dt.month=dt.b=dt.d*(365.25/12);dt.year=dt.yr=dt.y=dt.d*365.25;function dt(t="",e="ms"){var r=null;return t=(t+"").replace(/(\d)[,_](\d)/g,"$1$2"),t.replace(iNe,function(i,n,s){s=iK(s),s&&(r=(r||0)+parseFloat(n,10)*s)}),r&&r/(iK(e)||1)}function iK(t){return dt[t]||dt[t.toLowerCase().replace(/s$/,"")]}});var sK=p(nK=>{f();"use strict";var Lg=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=Lg.code}};Lg.code="ERR_TIMEOUT";nK.TimeoutError=Lg});var Ce=p((a5t,oK)=>{f();"use strict";var nNe=cI(),{anySignal:sNe}=Ul(),{default:oNe}=Mg(),{TimeoutError:lI}=sK();function aNe(t,e){return(...r)=>{let i=r[e??r.length-1];if(!i||!i.timeout)return t(...r);let n=typeof i.timeout=="string"?oNe(i.timeout):i.timeout,s=new nNe(n);i.signal=sNe([i.signal,s.signal]);let o=t(...r),a=new Promise((l,d)=>{s.signal.addEventListener("abort",()=>{d(new lI)})}),c=Date.now(),u=()=>{if(s.signal.aborted)throw new lI;if(Date.now()-c>n)throw s.abort(),new lI};return o[Symbol.asyncIterator]?async function*(){let l=o[Symbol.asyncIterator]();try{for(;;){let{value:d,done:h}=await Promise.race([l.next(),a]);if(h)break;u(),yield d}}catch(d){throw u(),d}finally{s.clear(),l.return&&l.return()}}():(async()=>{try{let l=await Promise.race([o,a]);return u(),l}catch(l){throw u(),l}finally{s.clear()}})()}}oK.exports=aNe});var Ug=p((c5t,uK)=>{f();"use strict";var{CID:fI}=(Ae(),ke),aK=ae(),cK="/ipfs/",cNe=t=>{if(t instanceof Uint8Array)try{t=fI.decode(t)}catch(n){throw aK(n,"ERR_INVALID_CID")}if(t instanceof fI)return{cid:t,path:void 0};t.startsWith(cK)&&(t=t.substring(cK.length));let e=t.split("/"),r,i;try{r=fI.parse(e.shift()||"")}catch(n){throw aK(n,"ERR_INVALID_CID")}return e.length&&(i=`/${e.join("/")}`),{cid:r,path:i}};uK.exports=cNe});var Mi=p((u5t,fK)=>{f();"use strict";var uNe=qh(),{CID:Wh}=(Ae(),ke),lNe=Ft().Key,dI=ae(),fNe=Ce(),dNe=Ug(),hNe=(xt(),St),pNe="ERR_BAD_PATH",yNe=t=>{if(t instanceof Wh)return`/ipfs/${t}`;try{Wh.parse(t),t=`/ipfs/${t}`}catch{}if(uNe.path(t))return t;throw dI(new Error(`invalid path: ${t}`),pNe)},gNe=t=>t instanceof Uint8Array?Wh.decode(t).toString():t instanceof Wh?t.toString():(t.indexOf("/ipfs/")===0&&(t=t.substring("/ipfs/".length)),t.charAt(t.length-1)==="/"&&(t=t.substring(0,t.length-1)),t),bNe=async function(t,e,r,i={}){let{cid:n,path:s}=dNe(r);s&&(i.path=s);let o=n,a=i.path||"";if(a.startsWith("/")&&(a=a.substring(1)),i.path)try{for await(let{value:c,remainderPath:u}of lK(n,i.path,e,t,{signal:i.signal})){if(!(c instanceof Wh))break;a=u,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},mNe=t=>{if(t.type!=="file"&&t.type!=="directory"&&t.type!=="raw")throw new Error(`Unknown node type '${t.type}'`);let e={cid:t.cid,path:t.path,name:t.name,size:t.size,type:"file"};return t.type==="directory"&&(e.type="dir"),t.type==="file"&&(e.size=t.unixfs.fileSize()),(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,t.unixfs.mtime!==void 0&&(e.mtime=t.unixfs.mtime)),e},vNe=fNe(async(t,e)=>await t),lK=async function*(t,e,r,i,n){let s=async u=>{let l=await r.getCodec(u.code),d=await i.blocks.get(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(o.length||(yield{value:a,remainderPath:""});o.length;){let u=o.shift();if(!u)throw dI(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(t.code===hNe.code&&Array.isArray(a.Links)){let l=a.Links.find(d=>d.Name===u);if(l){yield{value:l.Hash,remainderPath:o.join("/")},a=await s(l.Hash),c=l.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw dI(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");a instanceof Wh&&(c=a,a=await s(a))}};fK.exports={normalizePath:yNe,normalizeCidPath:gNe,resolvePath:bNe,mapFile:mNe,withTimeout:vNe,resolve:lK,OFFLINE_ERROR:"This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY:new lNe("/local/filesroot"),MFS_MAX_CHUNK_SIZE:262144,MFS_MAX_LINKS:174}});var Rw=p((l5t,dK)=>{f();"use strict";var{NotStartedError:wNe,AlreadyStartingError:_Ne,AlreadyStartedError:ENe}=Lu(),{withTimeout:SNe}=Mi(),Ca=class{static create({start:e,stop:r}){return new Ca(e,r)}static async start(e,r){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(r);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new _Ne;case"started":throw new ENe;case"stopping":return await i.ready,await Ca.start(e,r);default:return Ca.panic(e)}}static async stop(e){let{state:r,deactivate:i}=e;switch(r.status){case"stopped":break;case"starting":{try{await r.ready}catch(n){}return await Ca.stop(e)}case"stopping":return await r.ready;case"started":{i&&await i(r.value),e.state={status:"stopped"};break}default:Ca.panic(r)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},r){switch(e.status){case"started":return e.value;case"starting":return await SNe(e.ready,r);default:throw new wNe}}static panic({state:e}){let r=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${r}, should never happen if you see this please report a bug`)}constructor(e,r){this.activate=e,this.deactivate=r,this.state={status:"stopped"}}async use(e){return await Ca.use(this,e)}try(){return Ca.try(this)}};dK.exports=Ca});var pK=p((f5t,hK)=>{f();"use strict";var xNe=Rw();hK.exports=({network:t,preload:e,peerId:r,keychain:i,repo:n,ipns:s,mfsPreload:o,print:a,options:c})=>async()=>{let{libp2p:l}=await xNe.start(t,{peerId:r,repo:n,print:a,options:c});await Promise.all([s.startOnline({keychain:i,libp2p:l,peerId:r,repo:n}),e.start(),o.start()])}});var gK=p((d5t,yK)=>{f();"use strict";var ANe=Rw();yK.exports=({network:t,preload:e,ipns:r,repo:i,mfsPreload:n})=>async()=>{await Promise.all([e.stop(),r.stop(),n.stop(),ANe.stop(t),i.close()])}});var Fg=p((h5t,bK)=>{f();bK.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),i=Object.create(null);function n(s,o){r[s]=o,e++,e>=t&&(e=0,i=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||i[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=r[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){r[s]!==void 0?r[s]=o:n(s,o)},clear:function(){r=Object.create(null),i=Object.create(null)}}}});var hI=p((p5t,vK)=>{f();"use strict";var INe=Fg(),mK=class{constructor(e){this.lru=INe(e)}get(e){let r=this.lru.get(e);if(r){if(r.expire&&r.expire<Date.now()){this.lru.remove(e);return}return r.value}}set(e,r,i){this.lru.set(e,{value:r,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};vK.exports=mK});var _K=p((y5t,pI)=>{f();"use strict";var TNe=Object.prototype.hasOwnProperty,Sn="~";function Kg(){}Object.create&&(Kg.prototype=Object.create(null),new Kg().__proto__||(Sn=!1));function RNe(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function wK(t,e,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new RNe(r,i||t,n),o=Sn?Sn+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function Pw(t,e){--t._eventsCount==0?t._events=new Kg:delete t._events[e]}function an(){this._events=new Kg,this._eventsCount=0}an.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)TNe.call(r,i)&&e.push(Sn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};an.prototype.listeners=function(e){var r=Sn?Sn+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};an.prototype.listenerCount=function(e){var r=Sn?Sn+e:e,i=this._events[r];return i?i.fn?1:i.length:0};an.prototype.emit=function(e,r,i,n,s,o){var a=Sn?Sn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,i),!0;case 4:return c.fn.call(c.context,r,i,n),!0;case 5:return c.fn.call(c.context,r,i,n,s),!0;case 6:return c.fn.call(c.context,r,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,y;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,r);break;case 3:c[d].fn.call(c[d].context,r,i);break;case 4:c[d].fn.call(c[d].context,r,i,n);break;default:if(!l)for(y=1,l=new Array(u-1);y<u;y++)l[y-1]=arguments[y];c[d].fn.apply(c[d].context,l)}}return!0};an.prototype.on=function(e,r,i){return wK(this,e,r,i,!1)};an.prototype.once=function(e,r,i){return wK(this,e,r,i,!0)};an.prototype.removeListener=function(e,r,i,n){var s=Sn?Sn+e:e;if(!this._events[s])return this;if(!r)return Pw(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!n||o.once)&&(!i||o.context===i)&&Pw(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==r||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:Pw(this,s)}return this};an.prototype.removeAllListeners=function(e){var r;return e?(r=Sn?Sn+e:e,this._events[r]&&Pw(this,r)):(this._events=new Kg,this._eventsCount=0),this};an.prototype.off=an.prototype.removeListener;an.prototype.addListener=an.prototype.on;an.prefixed=Sn;an.EventEmitter=an;typeof pI!="undefined"&&(pI.exports=an)});var SK=p((g5t,EK)=>{f();"use strict";EK.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(i=>{i(e())}).then(()=>r),r=>new Promise(i=>{i(e())}).then(()=>{throw r})))});var AK=p((b5t,Cw)=>{f();"use strict";var PNe=SK(),yI=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},xK=(t,e,r)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{i(r())}catch(c){n(c)}return}let o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,a=r instanceof Error?r:new yI(o);typeof t.cancel=="function"&&t.cancel(),n(a)},e);PNe(t.then(i,n),()=>{clearTimeout(s)})});Cw.exports=xK;Cw.exports.default=xK;Cw.exports.TimeoutError=yI});var IK=p(gI=>{f();"use strict";Object.defineProperty(gI,"__esModule",{value:!0});function CNe(t,e,r){let i=0,n=t.length;for(;n>0;){let s=n/2|0,o=i+s;r(t[o],e)<=0?(i=++o,n-=s+1):n=s}return i}gI.default=CNe});var RK=p(bI=>{f();"use strict";Object.defineProperty(bI,"__esModule",{value:!0});var ONe=IK(),TK=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let i={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(i);return}let n=ONe.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};bI.default=TK});var Pc=p(mI=>{f();"use strict";Object.defineProperty(mI,"__esModule",{value:!0});var kNe=_K(),PK=AK(),qNe=RK(),Ow=()=>{},NNe=new PK.TimeoutError,CK=class extends kNe{constructor(e){var r,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Ow,this._resolveIdle=Ow,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:qNe.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Ow,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Ow,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&r.timeout===void 0?e():PK.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&n(NNe)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async i=>this.add(i,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};mI.default=CK});var qK=p((_5t,kK)=>{f();"use strict";var DNe=hI(),{default:BNe}=Pc(),MNe=ky(),vI=new DNe(1e3),LNe=60*1e3,UNe=new BNe({concurrency:4}),OK=t=>{if(t.Path)return t.Path;throw new Error(t.Message)};kK.exports=async(t,e)=>(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&vI.has(o)){let c=vI.get(o);return OK(c)}let a=await UNe.add(async()=>{let c=await MNe.get("https://ipfs.io/api/v0/dns",{searchParams:s}),u=new URL(c.url).search.slice(1),l=await c.json();return vI.set(u,l,LNe),l});return OK(a)})(t,e)});var DK=p((E5t,NK)=>{f();"use strict";var FNe=qK(),KNe=Ce();function jNe(t){return t.endsWith(".eth")&&(t=t.replace(/.eth$/,".eth.link")),t}NK.exports=()=>KNe(async(e,r={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=jNe(e),FNe(e,r)})});var MK=p((S5t,BK)=>{f();"use strict";BK.exports=({network:t})=>()=>{let e=t.try();return e!=null&&Boolean(e.libp2p.isStarted())}});var FK=p((x5t,UK)=>{f();"use strict";var LK=qh(),{CID:wI}=(Ae(),ke),VNe=et(),zNe=Ce(),{resolve:HNe}=Mi();UK.exports=({repo:t,codecs:e,bases:r,name:i})=>{async function n(s,o={}){if(!LK.path(s))throw new Error("invalid argument "+s);if(LK.ipnsPath(s))for await(let E of i.resolve(s,o))s=E;let[,a,c,...u]=s.split("/"),l=o.cidBase?await r.getBase(o.cidBase):void 0,d=$Ne(c);if(u.length===0){let E=l?l.encoder.encode(d):c;return`/${a}/${E}`}let h=wI.decode(d);s=u.join("/");let y=HNe(h,s,e,t,o),g=h,m=s;for await(let E of y)E.value instanceof wI&&(g=E.value,m=E.remainderPath);return`/ipfs/${g.toString(l&&l.encoder)}${m?"/"+m:""}`}return zNe(n)};function $Ne(t){try{return VNe.parse(t).toBytes()}catch{return wI.parse(t).bytes}}});var Fn=p((A5t,KK)=>{f();"use strict";var GNe=async t=>{let e;for await(let r of t)e=r;return e};KK.exports=GNe});var VK=p((I5t,jK)=>{f();"use strict";var WNe=Fn(),{CID:YNe}=(Ae(),ke);jK.exports=({addAll:t})=>(e,r={})=>{let i;return e instanceof YNe?i=t([{cid:e,...r}],r):i=t([{path:e.toString(),...r}],r),WNe(i)}});var Yh=p((T5t,zK)=>{f();"use strict";var jg=ae(),{CID:_I}=(Ae(),ke);async function*XNe(t){if(t==null)throw jg(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");if(t instanceof _I){yield xo({cid:t});return}if(t instanceof String||typeof t=="string"){yield xo({path:t});return}if(t.cid!=null||t.path!=null)return yield xo(t);if(Symbol.iterator in t){let e=t[Symbol.iterator](),r=e.next();if(r.done)return e;if(r.value instanceof _I||r.value instanceof String||typeof r.value=="string"){yield xo({cid:r.value});for(let i of e)yield xo({cid:i});return}if(r.value.cid!=null||r.value.path!=null){yield xo(r.value);for(let i of e)yield xo(i);return}throw jg(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in t){let e=t[Symbol.asyncIterator](),r=await e.next();if(r.done)return e;if(r.value instanceof _I||r.value instanceof String||typeof r.value=="string"){yield xo({cid:r.value});for await(let i of e)yield xo({cid:i});return}if(r.value.cid!=null||r.value.path!=null){yield xo(r.value);for await(let i of e)yield xo(i);return}throw jg(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}throw jg(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}function xo(t){let e=t.cid||`${t.path}`;if(!e)throw jg(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let r={path:e,recursive:t.recursive!==!1};return t.metadata!=null&&(r.metadata=t.metadata),r}zK.exports={normaliseInput:XNe}});var EI=p((R5t,HK)=>{f();HK.exports=QNe;function QNe(t,e,r){if(!t)return r;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!t||(t=t[n],t===void 0))return r;return t}});var SI=p((P5t,$K)=>{f();"use strict";var ZNe=async t=>{let e=0;for await(let r of t)e++;return e};$K.exports=ZNe});var ZK=p((C5t,QK)=>{f();"use strict";var{CID:GK}=(Ae(),ke),WK=Ft().Key,JNe=me()("ipfs:repo:migrator:migration-8"),eDe=SI(),{base32:kw}=(Ji(),Zi),tDe=(Es(),Zn),rDe=(vn(),mn);function YK(t){return t.child?YK(t.child):t}function iDe(t){try{let e=kw.decode(`b${t.toString().toLowerCase().slice(1)}`),r=GK.decode(e).multihash.bytes,i=kw.encode(r).slice(1).toUpperCase();return new WK(`/${i}`,!1)}catch(e){return t}}function nDe(t){try{let e=kw.decode(`b${t.toString().toLowerCase().slice(1)}`),r=rDe.decode(e),i=kw.encode(GK.createV1(tDe.code,r).bytes).slice(1);return new WK(`/${i.toUpperCase()}`,!1)}catch{return t}}async function XK(t,e,r){let i=t.blocks;await i.open();let n=YK(i),s;s=await eDe(n.queryKeys({filters:[o=>r(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=r(a.key);c.toString()!==a.key.toString()&&(o+=1,JNe(`Migrating Block from ${a.key} to ${c}`,await n.has(a.key)),await n.delete(a.key),await n.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await i.close()}}QK.exports={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(t,e=()=>{})=>XK(t,e,iDe),revert:(t,e=()=>{})=>XK(t,e,nDe)}});var tj=p((k5t,ej)=>{f();"use strict";var Xh=Ti(),JK=Xh.Reader,sDe=Xh.Writer,O5t=Xh.util,Vg=Xh.roots.default||(Xh.roots.default={});Vg.ipfs=function(){var t={};return t.pin=function(){var e={};return e.Set=function(){function r(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return r.prototype.version=0,r.prototype.fanout=0,r.prototype.seed=0,r.encode=function(n,s){return s||(s=sDe.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},r.decode=function(n,s){n instanceof JK||(n=JK.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Vg.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},r.fromObject=function(n){if(n instanceof Vg.ipfs.pin.Set)return n;var s=new Vg.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},r.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,Xh.util.toJSONOptions)},r}(),e}(),t}();ej.exports=Vg});var ij=p((q5t,rj)=>{f();xI.BASE=2166136261;function xI(t){for(var e=xI.BASE,r=0,i=t.length;r<i;r++)e^=t.charCodeAt(r),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}rj.exports=xI});var AI=p((N5t,sj)=>{f();"use strict";var{Key:nj}=Ft(),{base32:oDe}=(Ji(),Zi),{CID:aDe}=(_u(),rh),cDe=new nj("/local/pins"),uDe=256,lDe=8192,fDe=aDe.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),dDe={direct:"direct",recursive:"recursive"};function hDe(t){return new nj(`/${oDe.encode(t.multihash.bytes).toUpperCase().substring(1)}`)}sj.exports={PIN_DS_KEY:cDe,DEFAULT_FANOUT:uDe,MAX_ITEMS:lDe,EMPTY_KEY:fDe,PinTypes:dDe,cidToKey:hDe}});var aj=p((D5t,oj)=>{f();"use strict";function pDe(t,e){for(let r=0;r<t.byteLength;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}oj.exports=pDe});var hj=p((B5t,dj)=>{f();"use strict";var{CID:cj}=(Ae(),ke),{ipfs:{pin:{Set:II}}}=tj(),yDe=ij(),TI=es(),qw=(xt(),St),{DEFAULT_FANOUT:RI,MAX_ITEMS:gDe,EMPTY_KEY:uj}=AI(),PI=tn(),bDe=aj(),mDe=Je(),vDe=ct(),{sha256:lj}=(ei(),Ur);function wDe(t){let e=t.Data;if(!e)throw new Error("No data present");let r=TI.decode(e),i=TI.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+r>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,r+i),s=II.toObject(II.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>t.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(r+i)}}function _De(t,e){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,t,!0);let n=vDe(e.toString()),s=PI([r,n],r.byteLength+n.byteLength);return yDe(mDe(s))}async function*fj(t,e){let r=wDe(e),i=0;for(let n of e.Links){if(i<r.header.fanout){let s=n.Hash;if(!uj.equals(s)){let o=await t.get(s),a=qw.decode(o);yield*fj(t,a)}}else yield n.Hash;i++}}async function*EDe(t,e,r){let i=e.Links.find(o=>o.Name===r);if(!i)throw new Error("No link found with name "+r);let n=await t.get(i.Hash),s=qw.decode(n);yield*fj(t,s)}function SDe(t,e){return r(e,0);async function r(i,n){let s=II.encode({version:1,fanout:RI,seed:n}).finish(),o=TI.encode(s.length),a=PI([o,s]),c=[];for(let l=0;l<RI;l++)c.push({Name:"",Tsize:1,Hash:uj});if(i.length<=gDe){let l=i.map(y=>({link:{Name:"",Tsize:1,Hash:y.key},data:y.data||new Uint8Array})).sort((y,g)=>bDe(y.link.Hash.bytes,g.link.Hash.bytes)),d=c.concat(l.map(y=>y.link));return{Data:PI([a,...l.map(y=>y.data)]),Links:d}}else{let l=i.reduce((h,y)=>{let g=_De(n,y.key)%RI;return h[g]=g in h?h[g].concat([y]):[y],h},[]),d=0;for(let h of l){let y=await r(h,n+1);await u(y,d),d++}return{Data:a,Links:c}}async function u(l,d){let h=qw.encode(l),y=await lj.digest(h),g=cj.createV0(y);await t.put(g,h);let m=l.Links.reduce((E,v)=>E+(v.Tsize||0),0)+h.length;c[d]={Name:"",Tsize:m,Hash:g}}}}async function xDe(t,e,r){let i=await SDe(t,r.map(c=>({key:c}))),n=qw.encode(i),s=await lj.digest(n),o=cj.createV0(s);await t.put(o,n);let a=i.Links.reduce((c,u)=>c+u.Tsize,0)+n.length;return{Name:e,Tsize:a,Hash:o}}dj.exports={loadSet:EDe,storeSet:xDe}});var bj=p((M5t,gj)=>{f();"use strict";var{CID:CI}=(Ae(),ke),zg=(xt(),St),OI=(Tg(),Iw),Qh=hj(),{cidToKey:pj,PIN_DS_KEY:Nw,PinTypes:Zh}=AI(),kI=SI(),{sha256:ADe}=(ei(),Ur),IDe=(vn(),mn),{base32:TDe}=(Ji(),Zi);async function RDe(t,e,r,i){if(!await e.has(Nw))return;let n=await e.get(Nw),s=CI.decode(n),o=await t.get(s),a=zg.decode(o),c=0,u;u=await kI(Qh.loadSet(t,a,Zh.recursive))+await kI(Qh.loadSet(t,a,Zh.direct));for await(let l of Qh.loadSet(t,a,Zh.recursive)){c++;let d={depth:1/0};l.version!==0&&(d.version=l.version),l.code!==zg.code&&(d.codec=l.code),await r.put(pj(l),OI.encode(d)),i(c/u*100,`Migrated recursive pin ${l}`)}for await(let l of Qh.loadSet(t,a,Zh.direct)){c++;let d={depth:0};l.version!==0&&(d.version=l.version),l.code!==zg.code&&(d.codec=l.code),await r.put(pj(l),OI.encode(d)),i(c/u*100,`Migrated direct pin ${l}`)}await t.delete(s),await e.delete(Nw)}async function PDe(t,e,r,i){let n=[],s=[],o=0,a=await kI(r.queryKeys({}));for await(let{key:h,value:y}of r.query({})){o++;let g=OI.decode(y),m=CI.create(g.version||0,g.codec||zg.code,IDe.decode(TDe.decode("b"+h.toString().toLowerCase().split("/").pop())));g.depth===0?(i(o/a*100,`Reverted direct pin ${m}`),s.push(m)):(i(o/a*100,`Reverted recursive pin ${m}`),n.push(m))}i(100,"Updating pin root");let c={Links:[await Qh.storeSet(t,Zh.direct,s),await Qh.storeSet(t,Zh.recursive,n)]},u=zg.encode(c),l=await ADe.digest(u),d=CI.createV0(l);await t.put(d,u),await e.put(Nw,d.bytes)}async function yj(t,e,r){let i=t.blocks,n=t.datastore,s=t.pins;await i.open(),await n.open(),await s.open();try{await r(i,n,s,e)}finally{await s.close(),await n.close(),await i.close()}}gj.exports={version:9,description:"Migrates pins to datastore",migrate:(t,e=()=>{})=>yj(t,e,RDe),revert:(t,e=()=>{})=>yj(t,e,PDe)}});var hf=p((L5t,Ej)=>{f();"use strict";var{Key:mj,Errors:vj}=Ft(),CDe=new mj("/config"),ODe=new mj("/version");function qI(t){let e=t;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function wj(t,e,r){let i=await e(t);if(i)return i;let n=qI(r);return n?new Promise((s,o)=>{let a=n.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function _j(t,e,r,i){if(await r(t))return e(t);let n=qI(i);if(!n)throw vj.notFoundError();return new Promise((s,o)=>{let a=n.store("readonly").get(t.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(vj.notFoundError())}})}function Dw(t){let e=t.get.bind(t),r=t.has.bind(t);return t.get=i=>_j(i,e,r,t),t.has=i=>wj(i,r,t),t}function kDe(t){return{...t,root:Dw(t.root),datastore:Dw(t.datastore),pins:Dw(t.pins),keys:Dw(t.keys)}}Ej.exports={wrapBackends:kDe,hasWithFallback:wj,getWithFallback:_j,findLevelJs:qI,CONFIG_KEY:CDe,VERSION_KEY:ODe}});var Rj=p((U5t,Tj)=>{f();"use strict";var{findLevelJs:Sj}=hf(),qDe=ct(),NDe=Je();async function DDe(t,e,r=()=>{}){let i=Sj(e);if(!i){r(`${t} did not need an upgrade`);return}r(`Upgrading ${t}`),await Ij(i,(s,o)=>[{type:"del",key:s},{type:"put",key:qDe(s),value:o}])}async function BDe(t,e,r=()=>{}){let i=Sj(e);if(!i){r(`${t} did not need a downgrade`);return}r(`Downgrading ${t}`),await Ij(i,(s,o)=>[{type:"del",key:s},{type:"put",key:NDe(s),value:o}])}function xj(t){return t.child?xj(t.child):t}async function Aj(t,e,r){let i=Object.entries(t).map(([s,o])=>({key:s,backend:xj(o)})).filter(({key:s,backend:o})=>o.constructor.name==="LevelDatastore").map(({key:s,backend:o})=>({name:s,store:o}));e(0,`Migrating ${i.length} dbs`);let n=0;for(let{name:s,store:o}of i){await o.open();try{await r(s,o,c=>{e(Math.round(n/i.length*100),c)})}finally{n++,o.close()}}e(100,`Migrated ${i.length} dbs`)}Tj.exports={version:10,description:"Migrates datastore-level keys to binary",migrate:(t,e=()=>{})=>Aj(t,e,DDe),revert:(t,e=()=>{})=>Aj(t,e,BDe)};function Ij(t,e){function r(i,n){let s=t.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function u(){var l=i[a++],d=l.key;try{var h=l.type==="del"?s.delete(d):s.put(l.value,d)}catch(y){c=y,o.abort();return}a<i.length&&(h.onsuccess=u)}u()}return new Promise((i,n)=>{let s=t.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(u,l,d)=>{if(u||l===void 0){let h=y=>{if(y){n(y);return}i()};s.end(h);return}r(e(l,d),a)};s.next(c)}})}});var Cj=p((F5t,Pj)=>{f();"use strict";var pf={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};Pj.exports=[Object.assign({version:1},pf),Object.assign({version:2},pf),Object.assign({version:3},pf),Object.assign({version:4},pf),Object.assign({version:5},pf),Object.assign({version:6},pf),Object.assign({version:7},pf),ZK(),bj(),Rj()]});var Bw=p((K5t,Oj)=>{f();"use strict";var NI=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=e}};NI.code="ERR_NON_REVERSIBLE_MIGRATION";var DI=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=e}};DI.code="ERR_NOT_INITIALIZED_REPO";var BI=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=e}};BI.code="ERR_REQUIRED_PARAMETER";var MI=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=e}};MI.code="ERR_INVALID_VALUE";var LI=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=e}};LI.code="ERR_MISSING_REPO_OPTIONS";Oj.exports={NonReversibleMigrationError:NI,NotInitializedRepoError:DI,RequiredParameterError:BI,InvalidValueError:MI,MissingRepoOptionsError:LI}});var qj=p((j5t,kj)=>{f();"use strict";var UI=me()("ipfs:repo:migrator:repo:init"),{CONFIG_KEY:MDe,VERSION_KEY:LDe}=hf(),{MissingRepoOptionsError:UDe}=Bw();async function FDe(t){if(!t)throw new UDe("Please pass repo options when trying to open a repo");let e=t.root;try{await e.open();let r=await e.has(LDe),i=await e.has(MDe);return!r||!i?(UI(`Version entry present: ${r}`),UI(`Config entry present: ${i}`),!1):!0}catch(r){return UI("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}kj.exports={isRepoInitialized:FDe}});var Bj=p((V5t,Dj)=>{f();"use strict";var KDe=qj(),{MissingRepoOptionsError:jDe,NotInitializedRepoError:VDe}=Bw(),{VERSION_KEY:Nj}=hf(),zDe=ct(),HDe=Je();async function $De(t){if(!await KDe.isRepoInitialized(t))throw new VDe("Repo is not initialized!");let e=t.root;await e.open();try{return parseInt(HDe(await e.get(Nj)))}finally{await e.close()}}async function GDe(t,e){if(!e)throw new jDe("Please pass repo options when trying to open a repo");let r=e.root;await r.open(),await r.put(Nj,zDe(String(t))),await r.close()}Dj.exports={getVersion:$De,setVersion:GDe}});var Kj=p((z5t,Fj)=>{f();"use strict";var FI=Cj(),yf=Bj(),as=Bw(),{wrapBackends:Mj}=hf(),Ao=me()("ipfs:repo:migrator");function Lj(t){return t=t||FI,!Array.isArray(t)||t.length===0?0:t[t.length-1].version}async function WDe(t,e,r,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||FI,!t)throw new as.RequiredParameterError("Path argument is required!");if(!r)throw new as.RequiredParameterError("repoOptions argument is required!");if(!i)throw new as.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new as.InvalidValueError("Version has to be positive integer!");e=Mj(e);let c=await yf.getVersion(e);if(c===i){Ao("Nothing to migrate.");return}if(c>i)throw new as.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${i}), you probably wanted to revert it?`);Uj(a,c,i);let u;!o&&!n&&(u=await r.repoLock.lock(t));try{for(let l of a){if(i!==void 0&&l.version>i)break;if(!(l.version<=c)){Ao(`Migrating version ${l.version}`);try{if(!o){let d=()=>{};s&&(d=(h,y)=>s(l.version,h.toFixed(2),y)),await l.migrate(e,d)}}catch(d){let h=l.version-1;throw Ao(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${h}`),await yf.setVersion(h,e),new Error(`During migration to version ${l.version} exception was raised: ${d.stack||d.message||d}`)}Ao(`Migrating to version ${l.version} finished`)}}o||await yf.setVersion(i||Lj(a),e),Ao("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!o&&!n&&u&&await u.close()}}async function YDe(t,e,r,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||FI,!t)throw new as.RequiredParameterError("Path argument is required!");if(!r)throw new as.RequiredParameterError("repoOptions argument is required!");if(!i)throw new as.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new as.InvalidValueError("Version has to be positive integer!");e=Mj(e);let c=await yf.getVersion(e);if(c===i){Ao("Nothing to revert.");return}if(c<i)throw new as.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${i}), you probably wanted to migrate it?`);Uj(a,i,c,!0);let u;!o&&!n&&(u=await r.repoLock.lock(t)),Ao(`Reverting from version ${c} to ${i}`);try{let l=a.slice().reverse();for(let d of l){if(d.version<=i)break;if(!(d.version>c)){Ao(`Reverting migration version ${d.version}`);try{if(!o){let h=()=>{};s&&(h=(y,g)=>s(d.version,y.toFixed(2),g)),await d.revert(e,h)}}catch(h){let y=d.version;throw Ao(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${y}`),await yf.setVersion(y,e),h.message=`During reversion to version ${d.version} exception was raised: ${h.message}`,h}Ao(`Reverting to version ${d.version} finished`)}}o||await yf.setVersion(i,e),Ao(`All migrations successfully reverted to version ${i}!`)}finally{!o&&!n&&u&&await u.close()}}function Uj(t,e,r,i=!1){let n=0;for(let s of t){if(s.version>r)break;if(s.version>e){if(i&&!s.revert)throw new as.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==r-e)throw new as.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${r}`)}Fj.exports={getCurrentRepoVersion:yf.getVersion,getLatestMigrationVersion:Lj,errors:as,migrate:WDe,revert:YDe}});var zj=p((H5t,Mw)=>{f();"use strict";Mw.exports=JDe;Mw.exports.format=jj;Mw.exports.parse=Vj;var XDe=/\B(?=(\d{3})+(?!\d))/g,QDe=/(?:\.0*|(\.[^0]+)0+)$/,Uu={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},ZDe=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function JDe(t,e){return typeof t=="string"?Vj(t):typeof t=="number"?jj(t,e):null}function jj(t,e){if(!Number.isFinite(t))return null;var r=Math.abs(t),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!Uu[a.toLowerCase()])&&(r>=Uu.pb?a="PB":r>=Uu.tb?a="TB":r>=Uu.gb?a="GB":r>=Uu.mb?a="MB":r>=Uu.kb?a="KB":a="B");var c=t/Uu[a.toLowerCase()],u=c.toFixed(s);return o||(u=u.replace(QDe,"$1")),i&&(u=u.replace(XDe,i)),u+n+a}function Vj(t){if(typeof t=="number"&&!isNaN(t))return t;if(typeof t!="string")return null;var e=ZDe.exec(t),r,i="b";return e?(r=parseFloat(e[1]),i=e[4].toLowerCase()):(r=parseInt(t,10),i="b"),Math.floor(Uu[i]*r)}});var $j=p(($5t,Hj)=>{f();"use strict";Hj.exports={repoVersion:10}});var Wj=p((G5t,Gj)=>{f();"use strict";var eBe=Ft().Key,tBe=me(),rBe=tBe("ipfs:repo:version"),iBe=Je(),nBe=ct(),{hasWithFallback:sBe,getWithFallback:oBe}=hf(),KI=new eBe("version");Gj.exports=t=>({async exists(){return sBe(KI,t.has.bind(t),t)},async get(){let e=await oBe(KI,t.get.bind(t),t.has.bind(t),t);return parseInt(iBe(e),10)},set(e){return t.put(KI,nBe(String(e)))},async check(e){let r=await this.get();return rBe("comparing version: %s and %s",r,e),r===e||(r===6&&e===7||e===6&&r===7)}})});var jI=p((W5t,Xj)=>{f();Xj.exports=aBe;function aBe(t,e,r){typeof e=="string"&&(e=e.split(".")),typeof e=="symbol"&&(e=[e]);var i=e.pop();if(!i)return!1;Yj(i);for(var n;n=e.shift();)if(Yj(n),typeof t[n]=="undefined"&&(t[n]={}),t=t[n],!t||typeof t!="object")return!1;return t[i]=r,!0}function Yj(t){if(t==="__proto__"||t==="constructor"||t==="prototype")throw new Error("setting of prototype values not supported")}});var Lw=p(gf=>{f();"use strict";var Hg=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=Hg.code}};Hg.code="ERR_LOCK_EXISTS";gf.LockExistsError=Hg;var $g=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=$g.code}};$g.code="ERR_NOT_FOUND";gf.NotFoundError=$g;var Gg=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=Gg.code}};Gg.code="ERR_INVALID_REPO_VERSION";gf.InvalidRepoVersionError=Gg;gf.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED";gf.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN";gf.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED"});var Jj=p((X5t,Zj)=>{f();"use strict";var{Key:cBe}=Ft(),{default:uBe}=Pc(),lBe=EI(),fBe=jI(),VI=ae(),Qj=Lw(),dBe=Je(),hBe=ct(),{hasWithFallback:pBe,getWithFallback:yBe}=hf(),zI=new cBe("config");Zj.exports=t=>{let e=new uBe({concurrency:1}),r={async getAll(s={}){let o=await yBe(zI,t.get.bind(t),t.has.bind(t),t,{signal:s.signal});return JSON.parse(dBe(o))},async get(s,o={}){if(s==null)throw new Qj.NotFoundError(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=lBe(a,s);if(c===void 0)throw new Qj.NotFoundError(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw VI(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw VI(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw VI(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return pBe(zI,t.has.bind(t),t)}};return r;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let u=await r.getAll();return typeof u=="object"&&u!==null&&fBe(u,a,c),n(u)}return n(c)}function n(s){let o=hBe(JSON.stringify(s,null,2));return t.put(zI,o)}}});var tV=p((Q5t,eV)=>{f();"use strict";eV.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var iV=p((Z5t,rV)=>{f();"use strict";var HI=tV();rV.exports=(t,e={})=>{if(!HI(t)&&!Array.isArray(t))throw new TypeError("Expected a plain object or array");let{deep:r}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u=[];return i.push(a),n.push(u),u.push(...a.map(l=>Array.isArray(l)?s(l):HI(l)?o(l):l)),u},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u={},l=Object.keys(a).sort(e.compare);i.push(a),n.push(u);for(let d of l){let h=a[d],y;r&&Array.isArray(h)?y=s(h):y=r&&HI(h)?o(h):h,Object.defineProperty(u,d,{...Object.getOwnPropertyDescriptor(a,d),value:y})}return u};return Array.isArray(t)?r?s(t):t.slice():o(t)}});var sV=p((J5t,nV)=>{f();"use strict";var gBe=Ft().Key,bBe=iV(),mBe=Je(),vBe=ct(),$I=new gBe("datastore_spec");nV.exports=t=>({exists(){return t.has($I)},async get(){let e=await t.get($I);return JSON.parse(mBe(e))},async set(e){return t.put($I,vBe(JSON.stringify(bBe(e,{deep:!0}))))}})});var aV=p((eTt,oV)=>{f();"use strict";var wBe=Ft().Key,_Be=ct(),GI=new wBe("api");oV.exports=t=>({async get(){let e=await t.get(GI);return e&&e.toString()},set(e){return t.put(GI,_Be(e.toString()))},delete(){return t.delete(GI)}})});var uV=p((rTt,cV)=>{f();cV.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var WI=p((nTt,fV)=>{f();var lV=uV();fV.exports=class{constructor(e){this.hwm=e||16,this.head=new lV(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new lV(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var Oa=p((sTt,dV)=>{f();var YI=WI();dV.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new YI,i,n,s,o=()=>{if(!r.isEmpty()){if(t.writev){let m,E=[];for(;!r.isEmpty();){if(m=r.shift(),m.error)throw m.error;E.push(m.value)}return{done:m.done,value:E}}let g=r.shift();if(g.error)throw g.error;return g}return s?{done:!0}:new Promise((g,m)=>{n=E=>(n=null,E.error?m(E.error):t.writev&&!E.done?g({done:E.done,value:[E.value]}):g(E),i)})},a=g=>n?n(g):(r.push(g),i),c=g=>(r=new YI,n?n({error:g}):(r.push({error:g}),i)),u=g=>s?i:a({done:!1,value:g}),l=g=>s?i:(s=!0,g?c(g):a({done:!0})),d=()=>(r=new YI,l(),{done:!0}),h=g=>(l(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:d,throw:h,push:u,end:l},!e)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),e&&(e(g),e=null),{done:!0}},return(){return y.return(),e&&(e(),e=null),{done:!0}},push:u,end(g){return y.end(g),e&&(e(g),e=null),i}},i}});var pV=p((oTt,hV)=>{f();"use strict";var EBe=Pa(),SBe=Oa(),xBe=Ra(),{CID:ABe}=(Ae(),ke),IBe=ae(),{identity:TBe}=(bc(),ua);hV.exports=RBe;function RBe(t){return{open(){return t.open()},close(){return t.close()},query(e,r){return t.query(e,r)},queryKeys(e,r){return t.queryKeys(e,r)},async get(e,r){let i=Fu(e);return i.isIdentity?Promise.resolve(i.digest):t.get(e,r)},async*getMany(e,r){for await(let i of e)yield this.get(i,r)},async put(e,r,i){let{isIdentity:n}=Fu(e);n||await t.put(e,r,i)},async*putMany(e,r){let i=SBe();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await xBe(t.putMany(async function*(){for await(let{key:s,value:o}of e)Fu(s).isIdentity||(yield{key:s,value:o}),i.push({key:s,value:o})}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,r){let{isIdentity:i}=Fu(e);return i?Promise.resolve(!0):t.has(e,r)},delete(e,r){let{isIdentity:i}=Fu(e);return i?Promise.resolve():t.delete(e,r)},deleteMany(e,r){return t.deleteMany(EBe(e,i=>!Fu(i).isIdentity),r)},batch(){let e=t.batch();return{put(r,i){let{isIdentity:n}=Fu(r);n||e.put(r,i)},delete(r){let{isIdentity:i}=Fu(r);i||e.delete(r)},commit:r=>e.commit(r)}}}}function Fu(t){let e=ABe.asCID(t);if(e==null)throw IBe(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==TBe.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}});var Uw=p(XI=>{f();"use strict";var PBe=Lw(),CBe=me(),yV=CBe("ipfs:repo:lock:memory"),gV="repo.lock",Wg={};XI.lock=async t=>{let e=t+"/"+gV;if(yV("locking %s",e),Wg[e]===!0)throw new PBe.LockExistsError(`Lock already being held for file: ${e}`);return Wg[e]=!0,{async close(){Wg[e]&&delete Wg[e]}}};XI.locked=async t=>{let e=t+"/"+gV;return yV(`checking lock: ${e}`),Boolean(Wg[e])}});var mV=p((cTt,bV)=>{f();"use strict";bV.exports={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:Uw()}});var wV=p((uTt,vV)=>{f();"use strict";vV.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}});var Jh=p((lTt,_V)=>{f();"use strict";var OBe=async t=>{for await(let e of t)return e};_V.exports=OBe});var Kw={};Gt(Kw,{Block:()=>Yg,create:()=>DBe,createUnsafe:()=>EV,decode:()=>NBe,encode:()=>qBe});var Fw,QI,ZI,kBe,Yg,qBe,NBe,EV,DBe,jw=Ge(()=>{f();_u();Fw=({enumerable:t=!0,configurable:e=!1}={})=>({enumerable:t,configurable:e,writable:!1}),QI=function*(t,e){if(t!=null&&!(t instanceof Uint8Array))for(let[r,i]of Object.entries(t)){let n=[...e,r];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=rt.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*QI(o,a))}else{let s=rt.asCID(i);s?yield[n.join("/"),s]:yield*QI(i,n)}}},ZI=function*(t,e){if(t!=null)for(let[r,i]of Object.entries(t)){let n=[...e,r];if(yield n.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!rt.asCID(i))if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s];yield a.join("/"),typeof o=="object"&&!rt.asCID(o)&&(yield*ZI(o,a))}else yield*ZI(i,n)}},kBe=(t,e)=>{let r=t;for(let[i,n]of e.entries()){if(r=r[n],r==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=rt.asCID(r);if(s)return{value:s,remaining:e.slice(i+1).join("/")}}return{value:r}},Yg=class{constructor({cid:e,bytes:r,value:i}){if(!e||!r||typeof i=="undefined")throw new Error("Missing required argument");this.cid=e,this.bytes=r,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:Fw(),bytes:Fw(),value:Fw(),asBlock:Fw()})}links(){return QI(this.value,[])}tree(){return ZI(this.value,[])}get(e="/"){return kBe(this.value,e.split("/").filter(Boolean))}},qBe=async({value:t,codec:e,hasher:r})=>{if(typeof t=="undefined")throw new Error('Missing required argument "value"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let i=e.encode(t),n=await r.digest(i),s=rt.create(1,e.code,n);return new Yg({value:t,bytes:i,cid:s})},NBe=async({bytes:t,codec:e,hasher:r})=>{if(!t)throw new Error('Missing required argument "bytes"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let i=e.decode(t),n=await r.digest(t),s=rt.create(1,e.code,n);return new Yg({value:i,bytes:t,cid:s})},EV=({bytes:t,cid:e,value:r,codec:i})=>{let n=r!==void 0?r:i&&i.decode(t);if(n===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Yg({cid:e,bytes:t,value:n})},DBe=async({bytes:t,cid:e,hasher:r,codec:i})=>{if(!t)throw new Error('Missing required argument "bytes"');if(!r)throw new Error('Missing required argument "hasher"');let n=i.decode(t),s=await r.digest(t);if(!jl.equals(e.multihash.bytes,s.bytes))throw new Error("CID hash does not match bytes");return EV({bytes:t,cid:e,value:n,codec:i})}});var JI=p((dTt,IV)=>{f();"use strict";var{Key:BBe}=Ft(),{CID:SV}=(_u(),rh),MBe=(Es(),Zn),LBe=ae(),{base32:xV}=(Ji(),Zi),UBe=(vn(),mn);function FBe(t){let e=SV.asCID(t);if(e==null)throw LBe(new Error("Not a valid cid"),"ERR_INVALID_CID");let r=xV.encode(e.multihash.bytes);return new BBe("/"+r.slice(1).toUpperCase(),!1)}function KBe(t){return SV.createV1(MBe.code,AV(t))}function AV(t){return UBe.decode(xV.decode(`b${t.toString().toLowerCase().substring(1)}`))}IV.exports={cidToKey:FBe,keyToCid:KBe,keyToMultihash:AV}});var e4=p((hTt,RV)=>{f();"use strict";var jBe=me()("ipfs:repo:utils:walk-dag"),VBe=(jw(),Kw);async function*TV(t,e,r,i){try{let n=await e.get(t,i),s=await r(t.code),o=VBe.createUnsafe({bytes:n,cid:t,codec:s});for(let[,a]of o.links())yield a,yield*TV(a,e,r,i)}catch(n){throw jBe("Could not walk DAG for CID",t.toString(),n),n}}RV.exports=TV});var t4=p((pTt,NV)=>{f();"use strict";var{CID:PV}=(Ae(),ke),zBe=ae(),HBe=me(),CV=Jh(),$Be=(jw(),Kw),Ku=(Tg(),Iw),Vw=(xt(),St),{cidToKey:zw,keyToMultihash:OV}=JI(),kV=e4();function GBe(t){let e=`Invalid type '${t}', must be one of {direct, indirect, recursive, all}`;return zBe(new Error(e),"ERR_INVALID_PIN_TYPE")}var qs={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"},qV=class{constructor({pinstore:e,blockstore:r,loadCodec:i}){this.pinstore=e,this.blockstore=r,this.loadCodec=i,this.log=HBe("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,r={}){await this.blockstore.get(e,r);let i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==Vw.code&&(i.codec=e.code),r.metadata&&(i.metadata=r.metadata),this.pinstore.put(zw(e),Ku.encode(i))}unpin(e,r){return this.pinstore.delete(zw(e),r)}async pinRecursively(e,r={}){await this.fetchCompleteDag(e,r);let i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==Vw.code&&(i.codec=e.code),r.metadata&&(i.metadata=r.metadata),await this.pinstore.put(zw(e),Ku.encode(i))}async*directKeys(e){for await(let r of this.pinstore.query({filters:[i=>Ku.decode(i.value).depth===0]})){let i=Ku.decode(r.value),n=i.version||0,s=i.codec!=null?i.codec:Vw.code,o=OV(r.key);yield{cid:PV.create(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let r of this.pinstore.query({filters:[i=>Ku.decode(i.value).depth===1/0]})){let i=Ku.decode(r.value),n=i.version||0,s=i.codec!=null?i.codec:Vw.code,o=OV(r.key);yield{cid:PV.create(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:r}of this.recursiveKeys())for await(let i of kV(r,this.blockstore,this.loadCodec,e)){let n=[qs.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,r,i){Array.isArray(r)||(r=[r]);let n=r.includes(qs.all),s=r.includes(qs.direct),o=r.includes(qs.recursive),a=r.includes(qs.indirect);if(o||s||n){let l=await CV(this.pinstore.query({prefix:zw(e).toString(),filters:[d=>{if(n)return!0;let h=Ku.decode(d.value);return r.includes(h.depth===0?qs.direct:qs.recursive)}],limit:1}));if(l){let d=Ku.decode(l.value);return{cid:e,pinned:!0,reason:d.depth===0?qs.direct:qs.recursive,metadata:d.metadata}}}let c=this;async function*u(l,d){for await(let{cid:h}of d)for await(let y of kV(h,c.blockstore,c.loadCodec))if(y.equals(l)){yield h;return}}if(n||a){let l=await CV(u(e,this.recursiveKeys()));if(l)return{cid:e,pinned:!0,reason:qs.indirect,parent:l}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,r){let i=new Set,n=async(s,o)=>{if(i.has(s.toString()))return;i.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),u=$Be.createUnsafe({bytes:a,cid:s,codec:c});await Promise.all([...u.links()].map(([,l])=>n(l,o)))};await n(e,r)}static checkPinType(e){if(typeof e!="string"||!Object.keys(qs).includes(e))throw GBe(e);return!0}};NV.exports={PinManager:qV,PinTypes:qs}});var Io=p((yTt,DV)=>{f();"use strict";var WBe=async function*(t,e){for await(let r of t)yield e(r)};DV.exports=WBe});var LV=p((gTt,MV)=>{f();"use strict";var YBe=Io(),XBe=ae(),{PinTypes:QBe}=t4();MV.exports=ZBe;function ZBe(t,e){return{open(){return e.open()},close(){return e.close()},query(r,i){return e.query(r,i)},queryKeys(r,i){return e.queryKeys(r,i)},async get(r,i){return e.get(r,i)},async*getMany(r,i){yield*e.getMany(r,i)},async put(r,i,n){await e.put(r,i,n)},async*putMany(r,i){yield*e.putMany(r,i)},has(r,i){return e.has(r,i)},async delete(r,i){return await BV(r,t),e.delete(r,i)},deleteMany(r,i){return e.deleteMany(YBe(r,async n=>(await BV(n,t),n)),i)},batch(){return e.batch()}}}async function BV(t,e){let{pinned:r,reason:i}=await e.isPinnedWithType(t,QBe.all);if(r)throw XBe(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}});var dr=p((bTt,r4)=>{f();"use strict";var ep=typeof Reflect=="object"?Reflect:null,UV=ep&&typeof ep.apply=="function"?ep.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Hw;ep&&typeof ep.ownKeys=="function"?Hw=ep.ownKeys:Object.getOwnPropertySymbols?Hw=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Hw=function(e){return Object.getOwnPropertyNames(e)};function JBe(t){console&&console.warn&&console.warn(t)}var FV=Number.isNaN||function(e){return e!==e};function $t(){$t.init.call(this)}r4.exports=$t;r4.exports.once=iMe;$t.EventEmitter=$t;$t.prototype._events=void 0;$t.prototype._eventsCount=0;$t.prototype._maxListeners=void 0;var KV=10;function $w(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty($t,"defaultMaxListeners",{enumerable:!0,get:function(){return KV},set:function(t){if(typeof t!="number"||t<0||FV(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");KV=t}});$t.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};$t.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||FV(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function jV(t){return t._maxListeners===void 0?$t.defaultMaxListeners:t._maxListeners}$t.prototype.getMaxListeners=function(){return jV(this)};$t.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")UV(c,this,r);else for(var u=c.length,l=GV(c,u),i=0;i<u;++i)UV(l[i],this,r);return!0};function VV(t,e,r,i){var n,s,o;if($w(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=jV(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,JBe(a)}return t}$t.prototype.addListener=function(e,r){return VV(this,e,r,!1)};$t.prototype.on=$t.prototype.addListener;$t.prototype.prependListener=function(e,r){return VV(this,e,r,!0)};function eMe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function zV(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=eMe.bind(i);return n.listener=r,i.wrapFn=n,n}$t.prototype.once=function(e,r){return $w(r),this.on(e,zV(this,e,r)),this};$t.prototype.prependOnceListener=function(e,r){return $w(r),this.prependListener(e,zV(this,e,r)),this};$t.prototype.removeListener=function(e,r){var i,n,s,o,a;if($w(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():tMe(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};$t.prototype.off=$t.prototype.removeListener;$t.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function HV(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?rMe(n):GV(n,n.length)}$t.prototype.listeners=function(e){return HV(this,e,!0)};$t.prototype.rawListeners=function(e){return HV(this,e,!1)};$t.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):$V.call(t,e)};$t.prototype.listenerCount=$V;function $V(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}$t.prototype.eventNames=function(){return this._eventsCount>0?Hw(this._events):[]};function GV(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function tMe(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function rMe(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function iMe(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}WV(t,e,s,{once:!0}),e!=="error"&&nMe(t,n,{once:!0})})}function nMe(t,e,r){typeof t.on=="function"&&WV(t,"error",e,r)}function WV(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var i4=p((mTt,YV)=>{f();YV.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var XV=p(()=>{f()});var oz=p((_Tt,sz)=>{f();var sMe=dr().EventEmitter,{nanoid:oMe}=(Ng(),qg),{WORKER_REQUEST_READ_LOCK:QV,WORKER_RELEASE_READ_LOCK:ZV,MASTER_GRANT_READ_LOCK:JV,WORKER_REQUEST_WRITE_LOCK:ez,WORKER_RELEASE_WRITE_LOCK:tz,MASTER_GRANT_WRITE_LOCK:rz}=i4(),Xg,iz=(t,e,r,i,n)=>(s,o)=>{o&&o.type===r&&t.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===i&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},nz=(t,e,r,i)=>()=>{let n=oMe();return process.send({type:e,identifier:n,name:t}),new Promise(s=>{let o=a=>{a&&a.type===r&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:t})}))};process.on("message",o)})};sz.exports=t=>{try{if(Xg=XV(),!Object.keys(Xg).length)return}catch(e){return}if(Xg.isMaster||t.singleProcess){let e=new sMe;return Xg.on("message",iz(e,"requestReadLock",QV,ZV,JV)),Xg.on("message",iz(e,"requestWriteLock",ez,tz,rz)),e}return{isWorker:!0,readLock:e=>nz(e,QV,JV,ZV),writeLock:e=>nz(e,ez,rz,tz)}}});var n4=p((ETt,az)=>{f();var ju={},tp=t=>{t.addEventListener("message",e=>{tp.dispatchEvent("message",t,e)}),t.port&&t.port.addEventListener("message",e=>{tp.dispatchEvent("message",t,e)})};tp.addEventListener=(t,e)=>{ju[t]||(ju[t]=[]),ju[t].push(e)};tp.removeEventListener=(t,e)=>{!ju[t]||(ju[t]=ju[t].filter(r=>r===e))};tp.dispatchEvent=function(){let t=Array.prototype.slice.call(arguments),e=t.shift();!ju[e]||ju[e].forEach(r=>r.apply(null,t))};az.exports=tp});var mz=p((STt,bz)=>{f();var aMe=dr().EventEmitter,{nanoid:cMe}=(Ng(),qg),{WORKER_REQUEST_READ_LOCK:cz,WORKER_RELEASE_READ_LOCK:uz,MASTER_GRANT_READ_LOCK:lz,WORKER_REQUEST_WRITE_LOCK:fz,WORKER_RELEASE_WRITE_LOCK:dz,MASTER_GRANT_WRITE_LOCK:hz}=i4(),pz=n4(),yz=(t,e,r,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==r)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};t.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=l=>{if(!l||!l.data)return;let d={type:l.data.type,name:l.data.name,identifier:l.data.identifier};d&&d.type===i&&d.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},gz=(t,e,r,i)=>()=>{let n=cMe();return globalThis.postMessage({type:e,identifier:n,name:t}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===r&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:t})}))};globalThis.addEventListener("message",o)})},uMe={singleProcess:!1};bz.exports=t=>{if(t=Object.assign({},uMe,t),!!globalThis.document||t.singleProcess){let r=new aMe;return pz.addEventListener("message",yz(r,"requestReadLock",cz,uz,lz)),pz.addEventListener("message",yz(r,"requestWriteLock",fz,dz,hz)),r}return{isWorker:!0,readLock:r=>gz(r,cz,lz,uz),writeLock:r=>gz(r,fz,hz,dz)}}});var vz=p((ATt,s4)=>{f();"use strict";var Gw,xTt=s4.exports.timeout=function(t,e){var r=new Gw,i;return Promise.race([t,new Promise(function(n,s){i=setTimeout(function(){s(r)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};Gw=s4.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};Gw.prototype=Object.create(Error.prototype);Gw.prototype.name="TimeoutError"});var c4=p((ITt,a4)=>{f();var lMe=oz(),fMe=mz(),{default:wz}=Pc(),{timeout:dMe}=vz(),hMe=n4(),bf={},Vu;function o4(t,e){let r,i=new Promise(n=>{r=n});return t.add(()=>dMe((()=>new Promise(n=>{r(()=>{n()})}))(),e.timeout)),i}var pMe=(t,e)=>{if(Vu.isWorker)return{readLock:Vu.readLock(t,e),writeLock:Vu.writeLock(t,e)};let r=new wz({concurrency:1}),i=null;return{readLock:()=>{if(i)return o4(i,e);i=new wz({concurrency:e.concurrency,autoStart:!1});let n=i,s=o4(i,e);return r.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,o4(r,e))}},yMe={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};a4.exports=(t,e)=>(e||(e={}),typeof t=="object"&&(e=t,t="lock"),t||(t="lock"),e=Object.assign({},yMe,e),Vu||(Vu=lMe(e)||fMe(e),Vu.isWorker||(Vu.on("requestReadLock",(r,i)=>{!bf[r]||bf[r].readLock().then(n=>i().finally(()=>n()))}),Vu.on("requestWriteLock",async(r,i)=>{!bf[r]||bf[r].writeLock().then(n=>i().finally(()=>n()))}))),bf[t]||(bf[t]=pMe(t,e)),bf[t]);a4.exports.Worker=function(t,e){e=e||globalThis.Worker;let r;try{r=new e(t)}catch(i){i.message.includes("not a constructor")&&(r=e(t))}if(!r)throw new Error("Could not create Worker from",e);return hMe(r),r}});var Ww=p((TTt,_z)=>{f();"use strict";async function*gMe(t,e=1){let r=[];e<1&&(e=1);for await(let i of t)for(r.push(i);r.length>=e;)yield r.slice(0,e),r=r.slice(e);for(;r.length;)yield r.slice(0,e),r=r.slice(e)}_z.exports=gMe});var Yw=p((RTt,Ez)=>{f();"use strict";var bMe=Ww();async function*mMe(t,e=1){for await(let r of bMe(t,e)){let i=r.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}Ez.exports=mMe});var Er=p((PTt,rp)=>{f();var Sz=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},u4=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),Xw=t=>t&&typeof t.sink=="function"&&u4(t.source),vMe=t=>e=>(t.sink(e),t.source),xz=(...t)=>{if(Xw(t[0])){let e=t[0];t[0]=()=>e.source}else if(u4(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&Xw(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)Xw(t[e])&&(t[e]=vMe(t[e]));return Sz(...t)};rp.exports=xz;rp.exports.pipe=xz;rp.exports.rawPipe=Sz;rp.exports.isIterable=u4;rp.exports.isDuplex=Xw});var ip=p((CTt,Az)=>{f();"use strict";var wMe=Oa(),_Me=async function*(...t){let e=wMe();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let i of r)e.push(i)})),e.end()}catch(r){e.end(r)}},0),yield*e};Az.exports=_Me});var Pz=p((OTt,Rz)=>{f();"use strict";var{CID:EMe}=(Ae(),ke),Qg=me()("ipfs:repo:gc"),{Errors:SMe}=Ft(),xMe=SMe.notFoundError().code,AMe=Yw(),{pipe:IMe}=Er(),Iz=ip(),l4=Io(),TMe=Pa(),{Key:RMe}=Ft(),{base32:Tz}=(Ji(),Zi),PMe=e4(),CMe=256,OMe=new RMe("/local/filesroot");Rz.exports=({gcLock:t,pins:e,blockstore:r,root:i,loadCodec:n})=>{async function*s(){let o=Date.now();Qg("Creating set of marked blocks");let a=await t.writeLock();try{let c=await kMe({pins:e,blockstore:r,root:i,loadCodec:n}),u=r.queryKeys({});yield*qMe({blockstore:r},c,u),Qg(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s};async function kMe({pins:t,blockstore:e,loadCodec:r,root:i}){let n=async function*(){let a;try{a=await i.get(OMe)}catch(u){if(u.code===xMe){Qg("No blocks in MFS");return}throw u}let c=EMe.decode(a);yield c,yield*PMe(c,e,r)}(),s=Iz(l4(t.recursiveKeys(),({cid:a})=>a),t.indirectKeys(),l4(t.directKeys(),({cid:a})=>a),n),o=new Set;for await(let a of Iz(s,n))o.add(Tz.encode(a.multihash.bytes));return o}async function*qMe({blockstore:t},e,r){let i=0,n=0;yield*IMe(AMe(l4(r,async o=>async function(){i++;try{let c=Tz.encode(o.multihash.bytes);if(e.has(c))return null;try{await t.delete(o),n++}catch(u){return{err:new Error(`Could not delete block with CID ${o}: ${u.message}`)}}return{cid:o}}catch(c){let u=`Could delete block with CID ${o}`;return Qg(u,c),{err:new Error(u+`: ${c.message}`)}}}),CMe),o=>TMe(o,Boolean)),Qg(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}});var mf=p((kTt,Dz)=>{f();"use strict";var Cz=EI(),NMe=me(),np=ae(),Oz=Kj(),DMe=zj(),BMe=hr(),Qw=$j(),MMe=Wj(),LMe=Jj(),UMe=sV(),FMe=aV(),KMe=pV(),jMe=mV(),kz=wV(),Cc=Lw(),{PinManager:VMe,PinTypes:zMe}=t4(),HMe=LV(),$Me=c4(),GMe=Pz(),WMe=Uw(),YMe=Uw(),Kn=NMe("ipfs:repo"),XMe=Number.MAX_SAFE_INTEGER,QMe="repoAutoMigrate",qz=class{constructor(e,r,i,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof r!="function")throw new Error("missing codec loader");this.options=BMe(jMe,n),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;let s=i.blocks,o=i.pins;this.pins=new VMe({pinstore:o,blockstore:s,loadCodec:r});let a=HMe(this.pins,s);this.blocks=KMe(a),this.version=MMe(this.root),this.config=LMe(this.root),this.spec=UMe(this.root),this.apiAddr=FMe(this.root),this.gcLock=$Me(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=GMe({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:r})}async init(e){Kn("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(JMe(e)),await this.spec.set(e7e(e)),await this.version.set(Qw.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw np(new Error("repo is already open"),Cc.ERR_REPO_ALREADY_OPEN);Kn("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Kn("acquired repo.lock"),!await this.version.check(Qw.repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(Qw.repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new Cc.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");Kn("creating datastore"),await this.datastore.open(),Kn("creating blocks"),this.blocks.open(),Kn("creating keystore"),await this.keys.open(),Kn("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Kn("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(r){Kn("error removing lock",r)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw np(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){Kn("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(r){throw r.code==="ERR_NOT_FOUND"?np(new Error("repo is not initialized yet"),Cc.ERR_REPO_NOT_INITIALIZED,{path:this.path}):r}if(!e)throw np(new Error("repo is not initialized yet"),Cc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw np(new Error("repo is already closed"),Cc.ERR_REPO_ALREADY_CLOSED);Kn("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Cc.ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),Kn("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,r,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),Nz(this.datastore),Nz(this.keys)]),o=r.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:r.count,repoSize:o}}throw np(new Error("repo is not initialized yet"),Cc.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(QMe)}catch(r){if(r.code===Cc.NotFoundError.code)e=!0;else throw r}return e}async _migrate(e,r){return await this.version.get()>e?(Kn(`reverting to version ${e}`),Oz.revert(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Kn(`migrating to version ${e}`),Oz.migrate(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt(DMe(e))}catch(e){return BigInt(XMe)}}async _blockStat(){let e=BigInt(0),r=BigInt(0);if(this.blocks)for await(let{key:i,value:n}of this.blocks.query({}))e+=BigInt(1),r+=BigInt(n.byteLength),r+=BigInt(i.bytes.byteLength);return{count:e,size:r}}};async function Nz(t){let e=BigInt(0);for await(let r of t.query({}))e+=BigInt(r.value.byteLength),e+=BigInt(r.key.uint8Array().byteLength);return e}function ZMe(t,e,r,i){return new qz(t,e,r,i)}Dz.exports={createRepo:ZMe,repoVersion:Qw.repoVersion,errors:Cc,utils:{blockstore:JI()},locks:{memory:WMe,fs:YMe},PinTypes:zMe};function JMe(t){return t.Datastore=Object.assign({},kz,Cz(t,"datastore")),t}function e7e(t){let e={...kz.Spec,...Cz(t,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(r=>({mountpoint:r.mountpoint,type:r.child.type,path:r.child.path,shardFunc:r.child.shardFunc}))}}});var Lz=p((qTt,Mz)=>{f();"use strict";var{resolvePath:t7e}=Mi(),r7e=Ce(),{normaliseInput:i7e}=Yh(),{PinTypes:Bz}=mf();Mz.exports=({repo:t,codecs:e})=>{async function*r(i,n={}){let s=async function*(){for await(let{path:c,recursive:u,metadata:l}of i7e(i)){let{cid:d}=await t7e(t,e,c),{reason:h}=await t.pins.isPinnedWithType(d,[Bz.recursive,Bz.direct]);if(h==="recursive"&&!u)throw new Error(`${d} already pinned recursively`);u?await t.pins.pinRecursively(d,{metadata:l}):await t.pins.pinDirectly(d,{metadata:l}),yield d}};if(!Boolean(n.lock)){yield*s();return}let a=await t.gcLock.readLock();try{yield*s()}finally{a()}}return r7e(r)}});var Kz=p((NTt,Fz)=>{f();"use strict";var{PinTypes:jn}=mf(),{normaliseInput:n7e}=Yh(),{resolvePath:s7e}=Mi(),o7e=Ce(),Uz=ae();function Zg(t,e,r){let i={type:t,cid:e};return r&&(i.metadata=r),i}Fz.exports=({repo:t,codecs:e})=>{async function*r(i={}){let n=jn.all;if(i.type&&(n=i.type,!Object.keys(jn).includes(n)))throw Uz(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(i.paths){let s=!1;for await(let{path:o}of n7e(i.paths)){let{cid:a}=await s7e(t,e,o),{reason:c,pinned:u,parent:l,metadata:d}=await t.pins.isPinnedWithType(a,n);if(!u)throw Uz(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case jn.direct:case jn.recursive:s=!0,yield Zg(c,a,d);break;default:s=!0,yield Zg(`${jn.indirect} through ${l}`,a,d)}}if(!s)throw new Error("No match found");return}if(n===jn.recursive||n===jn.all)for await(let{cid:s,metadata:o}of t.pins.recursiveKeys())yield Zg(jn.recursive,s,o);if(n===jn.indirect||n===jn.all)for await(let s of t.pins.indirectKeys(i))yield Zg(jn.indirect,s);if(n===jn.direct||n===jn.all)for await(let{cid:s,metadata:o}of t.pins.directKeys())yield Zg(jn.direct,s,o)}return o7e(r)}});var Vz=p((DTt,jz)=>{f();"use strict";var a7e=Fn();jz.exports=({rmAll:t})=>(e,r={})=>a7e(t([{path:e,...r}],r))});var Hz=p((BTt,zz)=>{f();"use strict";var{normaliseInput:c7e}=Yh(),{resolvePath:u7e}=Mi(),l7e=Ce(),{PinTypes:f4}=mf();zz.exports=({repo:t,codecs:e})=>{async function*r(i,n={}){let s=await t.gcLock.readLock();try{for await(let{path:o,recursive:a}of c7e(i)){let{cid:c}=await u7e(t,e,o),{pinned:u,reason:l}=await t.pins.isPinnedWithType(c,f4.all);if(!u)throw new Error(`${c} is not pinned`);switch(l){case f4.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await t.pins.unpin(c),yield c;break;case f4.direct:await t.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${l}`)}}}finally{s()}}return l7e(r)}});var Wz=p((MTt,Gz)=>{f();"use strict";var f7e=VK(),d7e=Lz(),h7e=Kz(),p7e=Vz(),y7e=Hz(),$z=class{constructor({codecs:e,repo:r}){let i=d7e({codecs:e,repo:r});this.addAll=i,this.add=f7e({addAll:i});let n=y7e({codecs:e,repo:r});this.rmAll=n,this.rm=p7e({rmAll:n}),this.ls=h7e({codecs:e,repo:r}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}};Gz.exports=$z});var Yz=p((UTt,d4)=>{f();var LTt=function(){typeof d4!="undefined"&&(d4.exports=v);var t=24*3600,e=3200,r=(365*400+97)*e/400,i=t*r,n=i*1e3,s=1e3*1e4*1e4*t,o=16777216,a=65536*65536,c=1e3*1e3,u=1e3*1e3*1e3,l="000000000",d=Math.trunc||M,h=v.prototype;v.fromDate=Y,v.fromInt64BE=W(0,1,2,3,0,4),v.fromInt64LE=W(3,2,1,0,4,0),v.fromString=G,v.fromTimeT=P,h.year=0,h.time=0,h.nano=0,h.addNano=N,h.getNano=z,h.getTimeT=w,h.getYear=A,h.toDate=F,h.toJSON=S,h.toString=C,h.writeInt64BE=B(0,1,2,3,0,4),h.writeInt64LE=B(3,2,1,0,4,0);var y="%Y-%m-%dT%H:%M:%S.%NZ",g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return v;function v(X,ne,oe){var he=this;if(!(he instanceof v))return new v(X,ne,oe);he.time=+X||0,he.nano=+ne||0,he.year=+oe||0,R(he)}function A(){var X=this.toDate().getUTCFullYear();return X+this.year}function R(X){var ne=X.year,oe=X.time,he=X.nano,pe,_e;if(he<0||c<=he){var k=Math.floor(he/c);he-=k*c,oe+=k,pe=1}var K=ne%e;if(oe<-s||s<oe||K){_e=d(oe/n),_e&&(ne+=_e*e,oe-=_e*n);var $=q(oe);$.setUTCFullYear(K+$.getUTCFullYear()),ne-=K,oe=+$,_e=d(ne/e);var Z=oe+_e*n;_e&&-s<=Z&&Z<=s&&(ne-=_e*e,oe=Z),pe=1}return pe&&(X.year=ne,X.time=oe,X.nano=he),X}function F(){var X=R(this);return q(X.time)}function q(X){var ne=new Date(0);return ne.setTime(X),ne}function N(X){return this.nano+=+X||0,this}function z(){var X=R(this);return(X.time%1e3*c+ +X.nano+u)%u}function G(X){var ne,oe=new v;X+="";var he=X.replace(/^\s*[+\-]?\d+/,function(pe){var _e=+pe,k=1970+(_e-1970)%400;return oe.year=_e-k,k}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(pe,_e,k){return _e<0&&(k*=-1),ne=(+_e*60+ +k)*6e4,""}).replace(/\.\d+$/,function(pe){return oe.nano=+(pe+l).substr(1,9),""}).split(/\D+/);if(he.length>1?he[1]--:he[1]=0,oe.time=ne=Date.UTC.apply(Date,he)-(ne||0),isNaN(ne))throw new TypeError("Invalid Date");return R(oe)}function Y(X){return new v(+X)}function P(X){return b(X,0)}function b(X,ne){ne|=0,ne*=a,X=+X||0;var oe=d(ne/i)+d(X/i),he=ne%i+X%i,pe=d(he/i);return pe&&(oe+=pe,he-=pe*i),new v(he*1e3,0,oe*e)}function w(){var X=R(this),ne=Math.floor(X.time/1e3),oe=X.year;return oe&&(ne+=oe*r*t/e),ne}function S(){return this.toString().replace(/0{1,6}Z$/,"Z")}function C(X){var ne=this,oe=ne.toDate(),he={H:Z,L:V,M:I,N:D,S:U,Y:_e,a:Q,b:ee,d:K,e:$,m:k};return pe(X||y);function pe(J){return J.replace(/%./g,function(ue){var ge=ue[1],be=E[ge],Ke=he[ge];return be?pe(be):Ke?Ke():ue})}function _e(){var J=ne.getYear();return J>999999?"+"+J:J>9999?"+"+ce(J,6):J>=0?ce(J,4):J>=-999999?"-"+ce(-J,6):J}function k(){return L(oe.getUTCMonth()+1)}function K(){return L(oe.getUTCDate())}function $(){return _(oe.getUTCDate())}function Z(){return L(oe.getUTCHours())}function I(){return L(oe.getUTCMinutes())}function U(){return L(oe.getUTCSeconds())}function V(){return ce(oe.getUTCMilliseconds(),3)}function D(){return ce(ne.getNano(),9)}function Q(){return m[oe.getUTCDay()]}function ee(){return g[oe.getUTCMonth()]}}function B(X,ne,oe,he,pe,_e){return k;function k($,Z){var I=R(this);$||($=new Array(8)),j($,Z|=0);var U=Math.floor(I.time/1e3),V=I.year*(r*t/e),D=d(V/a)+d(U/a),Q=V%a+U%a,ee=Math.floor(Q/a);return ee&&(D+=ee,Q-=ee*a),K($,Z+pe,D),K($,Z+_e,Q),$}function K($,Z,I){$[Z+X]=I>>24&255,$[Z+ne]=I>>16&255,$[Z+oe]=I>>8&255,$[Z+he]=I&255}}function W(X,ne,oe,he,pe,_e){return k;function k($,Z){j($,Z|=0);var I=K($,Z+pe),U=K($,Z+_e);return b(U,I)}function K($,Z){return $[Z+X]*o+($[Z+ne]<<16|$[Z+oe]<<8|$[Z+he])}}function j(X,ne){var oe=X&&X.length;if(oe==null)throw new TypeError("Invalid Buffer");if(oe<ne+8)throw new RangeError("Out of range")}function M(X){var ne=X-X%1;return ne===0&&(X<0||X===0&&1/X!=1/0)?-0:ne}function _(X){return(X>9?"":" ")+(X|0)}function L(X){return(X>9?"":"0")+(X|0)}function ce(X,ne){return(l+(X|0)).substr(-ne)}}()});var oH=p((FTt,sH)=>{f();sH.exports=nr;var Ns=null;try{Ns=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function nr(t,e,r){this.low=t|0,this.high=e|0,this.unsigned=!!r}nr.prototype.__isLong__;Object.defineProperty(nr.prototype,"__isLong__",{value:!0});function Vn(t){return(t&&t.__isLong__)===!0}nr.isLong=Vn;var Xz={},Qz={};function vf(t,e){var r,i,n;return e?(t>>>=0,(n=0<=t&&t<256)&&(i=Qz[t],i)?i:(r=sr(t,(t|0)<0?-1:0,!0),n&&(Qz[t]=r),r)):(t|=0,(n=-128<=t&&t<128)&&(i=Xz[t],i)?i:(r=sr(t,t<0?-1:0,!1),n&&(Xz[t]=r),r))}nr.fromInt=vf;function Ds(t,e){if(isNaN(t))return e?wf:Bs;if(e){if(t<0)return wf;if(t>=Jz)return nH}else{if(t<=-eH)return zn;if(t+1>=eH)return iH}return t<0?Ds(-t,e).neg():sr(t%sp|0,t/sp|0,e)}nr.fromNumber=Ds;function sr(t,e,r){return new nr(t,e,r)}nr.fromBits=sr;var Zw=Math.pow;function h4(t,e,r){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Bs;if(typeof e=="number"?(r=e,e=!1):e=!!e,r=r||10,r<2||36<r)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return h4(t.substring(1),e,r).neg();for(var n=Ds(Zw(r,8)),s=Bs,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),r);if(a<8){var u=Ds(Zw(r,a));s=s.mul(u).add(Ds(c))}else s=s.mul(n),s=s.add(Ds(c))}return s.unsigned=e,s}nr.fromString=h4;function To(t,e){return typeof t=="number"?Ds(t,e):typeof t=="string"?h4(t,e):sr(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}nr.fromValue=To;var Zz=1<<16,g7e=1<<24,sp=Zz*Zz,Jz=sp*sp,eH=Jz/2,tH=vf(g7e),Bs=vf(0);nr.ZERO=Bs;var wf=vf(0,!0);nr.UZERO=wf;var op=vf(1);nr.ONE=op;var rH=vf(1,!0);nr.UONE=rH;var p4=vf(-1);nr.NEG_ONE=p4;var iH=sr(4294967295|0,2147483647|0,!1);nr.MAX_VALUE=iH;var nH=sr(4294967295|0,4294967295|0,!0);nr.MAX_UNSIGNED_VALUE=nH;var zn=sr(0,2147483648|0,!1);nr.MIN_VALUE=zn;var Re=nr.prototype;Re.toInt=function(){return this.unsigned?this.low>>>0:this.low};Re.toNumber=function(){return this.unsigned?(this.high>>>0)*sp+(this.low>>>0):this.high*sp+(this.low>>>0)};Re.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(zn)){var r=Ds(e),i=this.div(r),n=i.mul(r).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Ds(Zw(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),u=o.sub(c.mul(s)).toInt()>>>0,l=u.toString(e);if(o=c,o.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}};Re.getHighBits=function(){return this.high};Re.getHighBitsUnsigned=function(){return this.high>>>0};Re.getLowBits=function(){return this.low};Re.getLowBitsUnsigned=function(){return this.low>>>0};Re.getNumBitsAbs=function(){if(this.isNegative())return this.eq(zn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,r=31;r>0&&(e&1<<r)==0;r--);return this.high!=0?r+33:r+1};Re.isZero=function(){return this.high===0&&this.low===0};Re.eqz=Re.isZero;Re.isNegative=function(){return!this.unsigned&&this.high<0};Re.isPositive=function(){return this.unsigned||this.high>=0};Re.isOdd=function(){return(this.low&1)==1};Re.isEven=function(){return(this.low&1)==0};Re.equals=function(e){return Vn(e)||(e=To(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};Re.eq=Re.equals;Re.notEquals=function(e){return!this.eq(e)};Re.neq=Re.notEquals;Re.ne=Re.notEquals;Re.lessThan=function(e){return this.comp(e)<0};Re.lt=Re.lessThan;Re.lessThanOrEqual=function(e){return this.comp(e)<=0};Re.lte=Re.lessThanOrEqual;Re.le=Re.lessThanOrEqual;Re.greaterThan=function(e){return this.comp(e)>0};Re.gt=Re.greaterThan;Re.greaterThanOrEqual=function(e){return this.comp(e)>=0};Re.gte=Re.greaterThanOrEqual;Re.ge=Re.greaterThanOrEqual;Re.compare=function(e){if(Vn(e)||(e=To(e)),this.eq(e))return 0;var r=this.isNegative(),i=e.isNegative();return r&&!i?-1:!r&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Re.comp=Re.compare;Re.negate=function(){return!this.unsigned&&this.eq(zn)?zn:this.not().add(op)};Re.neg=Re.negate;Re.add=function(e){Vn(e)||(e=To(e));var r=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,u=e.low&65535,l=0,d=0,h=0,y=0;return y+=s+u,h+=y>>>16,y&=65535,h+=n+c,d+=h>>>16,h&=65535,d+=i+a,l+=d>>>16,d&=65535,l+=r+o,l&=65535,sr(h<<16|y,l<<16|d,this.unsigned)};Re.subtract=function(e){return Vn(e)||(e=To(e)),this.add(e.neg())};Re.sub=Re.subtract;Re.multiply=function(e){if(this.isZero())return Bs;if(Vn(e)||(e=To(e)),Ns){var r=Ns.mul(this.low,this.high,e.low,e.high);return sr(r,Ns.get_high(),this.unsigned)}if(e.isZero())return Bs;if(this.eq(zn))return e.isOdd()?zn:Bs;if(e.eq(zn))return this.isOdd()?zn:Bs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(tH)&&e.lt(tH))return Ds(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,l=e.low&65535,d=0,h=0,y=0,g=0;return g+=o*l,y+=g>>>16,g&=65535,y+=s*l,h+=y>>>16,y&=65535,y+=o*u,h+=y>>>16,y&=65535,h+=n*l,d+=h>>>16,h&=65535,h+=s*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,d+=i*l+n*u+s*c+o*a,d&=65535,sr(y<<16|g,d<<16|h,this.unsigned)};Re.mul=Re.multiply;Re.divide=function(e){if(Vn(e)||(e=To(e)),e.isZero())throw Error("division by zero");if(Ns){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var r=(this.unsigned?Ns.div_u:Ns.div_s)(this.low,this.high,e.low,e.high);return sr(r,Ns.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?wf:Bs;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return wf;if(e.gt(this.shru(1)))return rH;s=wf}else{if(this.eq(zn)){if(e.eq(op)||e.eq(p4))return zn;if(e.eq(zn))return op;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(Bs)?e.isNegative()?op:p4:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(zn))return this.unsigned?wf:Bs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=Bs}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:Zw(2,a-48),u=Ds(i),l=u.mul(e);l.isNegative()||l.gt(n);)i-=c,u=Ds(i,this.unsigned),l=u.mul(e);u.isZero()&&(u=op),s=s.add(u),n=n.sub(l)}return s};Re.div=Re.divide;Re.modulo=function(e){if(Vn(e)||(e=To(e)),Ns){var r=(this.unsigned?Ns.rem_u:Ns.rem_s)(this.low,this.high,e.low,e.high);return sr(r,Ns.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Re.mod=Re.modulo;Re.rem=Re.modulo;Re.not=function(){return sr(~this.low,~this.high,this.unsigned)};Re.and=function(e){return Vn(e)||(e=To(e)),sr(this.low&e.low,this.high&e.high,this.unsigned)};Re.or=function(e){return Vn(e)||(e=To(e)),sr(this.low|e.low,this.high|e.high,this.unsigned)};Re.xor=function(e){return Vn(e)||(e=To(e)),sr(this.low^e.low,this.high^e.high,this.unsigned)};Re.shiftLeft=function(e){return Vn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?sr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):sr(0,this.low<<e-32,this.unsigned)};Re.shl=Re.shiftLeft;Re.shiftRight=function(e){return Vn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?sr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):sr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Re.shr=Re.shiftRight;Re.shiftRightUnsigned=function(e){if(Vn(e)&&(e=e.toInt()),e&=63,e===0)return this;var r=this.high;if(e<32){var i=this.low;return sr(i>>>e|r<<32-e,r>>>e,this.unsigned)}else return e===32?sr(r,0,this.unsigned):sr(r>>>e-32,0,this.unsigned)};Re.shru=Re.shiftRightUnsigned;Re.shr_u=Re.shiftRightUnsigned;Re.toSigned=function(){return this.unsigned?sr(this.low,this.high,!1):this};Re.toUnsigned=function(){return this.unsigned?this:sr(this.low,this.high,!0)};Re.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Re.toBytesLE=function(){var e=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Re.toBytesBE=function(){var e=this.high,r=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,r>>>24,r>>>16&255,r>>>8&255,r&255]};nr.fromBytes=function(e,r,i){return i?nr.fromBytesLE(e,r):nr.fromBytesBE(e,r)};nr.fromBytesLE=function(e,r){return new nr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)};nr.fromBytesBE=function(e,r){return new nr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)}});var uH=p((KTt,cH)=>{f();"use strict";var ap=Ti(),aH=ap.Reader,b7e=ap.Writer,We=ap.util,cp=ap.roots["ipfs-ipns"]||(ap.roots["ipfs-ipns"]={});cp.IpnsEntry=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.value=We.newBuffer([]),t.prototype.signature=We.newBuffer([]),t.prototype.validityType=0,t.prototype.validity=We.newBuffer([]),t.prototype.sequence=We.Long?We.Long.fromBits(0,0,!0):0,t.prototype.ttl=We.Long?We.Long.fromBits(0,0,!0):0,t.prototype.pubKey=We.newBuffer([]),t.prototype.signatureV2=We.newBuffer([]),t.prototype.data=We.newBuffer([]),t.encode=function(r,i){return i||(i=b7e.create()),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&i.uint32(10).bytes(r.value),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(18).bytes(r.signature),r.validityType!=null&&Object.hasOwnProperty.call(r,"validityType")&&i.uint32(24).int32(r.validityType),r.validity!=null&&Object.hasOwnProperty.call(r,"validity")&&i.uint32(34).bytes(r.validity),r.sequence!=null&&Object.hasOwnProperty.call(r,"sequence")&&i.uint32(40).uint64(r.sequence),r.ttl!=null&&Object.hasOwnProperty.call(r,"ttl")&&i.uint32(48).uint64(r.ttl),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(58).bytes(r.pubKey),r.signatureV2!=null&&Object.hasOwnProperty.call(r,"signatureV2")&&i.uint32(66).bytes(r.signatureV2),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&i.uint32(74).bytes(r.data),i},t.decode=function(r,i){r instanceof aH||(r=aH.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new cp.IpnsEntry;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.value=r.bytes();break;case 2:s.signature=r.bytes();break;case 3:s.validityType=r.int32();break;case 4:s.validity=r.bytes();break;case 5:s.sequence=r.uint64();break;case 6:s.ttl=r.uint64();break;case 7:s.pubKey=r.bytes();break;case 8:s.signatureV2=r.bytes();break;case 9:s.data=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof cp.IpnsEntry)return r;var i=new cp.IpnsEntry;switch(r.value!=null&&(typeof r.value=="string"?We.base64.decode(r.value,i.value=We.newBuffer(We.base64.length(r.value)),0):r.value.length&&(i.value=r.value)),r.signature!=null&&(typeof r.signature=="string"?We.base64.decode(r.signature,i.signature=We.newBuffer(We.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),r.validityType){case"EOL":case 0:i.validityType=0;break}return r.validity!=null&&(typeof r.validity=="string"?We.base64.decode(r.validity,i.validity=We.newBuffer(We.base64.length(r.validity)),0):r.validity.length&&(i.validity=r.validity)),r.sequence!=null&&(We.Long?(i.sequence=We.Long.fromValue(r.sequence)).unsigned=!0:typeof r.sequence=="string"?i.sequence=parseInt(r.sequence,10):typeof r.sequence=="number"?i.sequence=r.sequence:typeof r.sequence=="object"&&(i.sequence=new We.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0))),r.ttl!=null&&(We.Long?(i.ttl=We.Long.fromValue(r.ttl)).unsigned=!0:typeof r.ttl=="string"?i.ttl=parseInt(r.ttl,10):typeof r.ttl=="number"?i.ttl=r.ttl:typeof r.ttl=="object"&&(i.ttl=new We.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0))),r.pubKey!=null&&(typeof r.pubKey=="string"?We.base64.decode(r.pubKey,i.pubKey=We.newBuffer(We.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.signatureV2!=null&&(typeof r.signatureV2=="string"?We.base64.decode(r.signatureV2,i.signatureV2=We.newBuffer(We.base64.length(r.signatureV2)),0):r.signatureV2.length&&(i.signatureV2=r.signatureV2)),r.data!=null&&(typeof r.data=="string"?We.base64.decode(r.data,i.data=We.newBuffer(We.base64.length(r.data)),0):r.data.length&&(i.data=r.data)),i},t.toObject=function(r,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=We.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=We.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=We.newBuffer(n.validity))),We.Long){var s=new We.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(We.Long){var s=new We.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=We.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=We.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=We.newBuffer(n.data)))}return r.value!=null&&r.hasOwnProperty("value")&&(n.value=i.bytes===String?We.base64.encode(r.value,0,r.value.length):i.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?We.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),r.validityType!=null&&r.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?cp.IpnsEntry.ValidityType[r.validityType]:r.validityType),r.validity!=null&&r.hasOwnProperty("validity")&&(n.validity=i.bytes===String?We.base64.encode(r.validity,0,r.validity.length):i.bytes===Array?Array.prototype.slice.call(r.validity):r.validity),r.sequence!=null&&r.hasOwnProperty("sequence")&&(typeof r.sequence=="number"?n.sequence=i.longs===String?String(r.sequence):r.sequence:n.sequence=i.longs===String?We.Long.prototype.toString.call(r.sequence):i.longs===Number?new We.LongBits(r.sequence.low>>>0,r.sequence.high>>>0).toNumber(!0):r.sequence),r.ttl!=null&&r.hasOwnProperty("ttl")&&(typeof r.ttl=="number"?n.ttl=i.longs===String?String(r.ttl):r.ttl:n.ttl=i.longs===String?We.Long.prototype.toString.call(r.ttl):i.longs===Number?new We.LongBits(r.ttl.low>>>0,r.ttl.high>>>0).toNumber(!0):r.ttl),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?We.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.signatureV2!=null&&r.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?We.base64.encode(r.signatureV2,0,r.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(r.signatureV2):r.signatureV2),r.data!=null&&r.hasOwnProperty("data")&&(n.data=i.bytes===String?We.base64.encode(r.data,0,r.data.length):i.bytes===Array?Array.prototype.slice.call(r.data):r.data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,ap.util.toJSONOptions)},t.ValidityType=function(){var e={},r=Object.create(e);return r[e[0]="EOL"]=0,r}(),t}();cH.exports=cp});var lH=p((jTt,y4)=>{f();"use strict";y4.exports.toRFC3339=t=>{let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0"),c=t.getUTCMilliseconds()*1e3*1e3;return`${e}-${r}-${i}T${n}:${s}:${o}.${c}Z`};y4.exports.parseRFC3339=t=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let i=parseInt(r[1],10),n=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var fH=p(ka=>{f();"use strict";ka.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD";ka.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY";ka.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION";ka.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION";ka.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT";ka.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY";ka.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID";ka.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER";ka.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA"});var dp=p((zTt,xH)=>{f();"use strict";var dH=Yz(),{Key:Jg}=Ft(),g4=xa(),hH=et(),m7e=(vn(),mn),{identity:v7e}=(bc(),ua),cn=ae(),{base32upper:w7e}=(Ji(),Zi),up=ct(),_7e=Je(),lp=tn(),pH=ci(),yH=(Tg(),Iw),gH=oH(),bH=me(),cs=Object.assign(bH("jsipns"),{error:bH("jsipns:error")}),{IpnsEntry:fp}=uH(),{parseRFC3339:E7e}=lH(),$i=fH(),S7e=v7e.code,mH="/ipns/",x7e=up("/ipns/"),A7e=(t,e,r,i)=>{let n=new dH(Date.now()+Number(i)),s=fp.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*100000n+BigInt(a||0);return vH(t,e,r,s,n,c)},I7e=(t,e,r,i)=>{let n=dH.fromString(i),s=fp.ValidityType.EOL,o=n.toDate().getTime()-Date.now(),a=BigInt(o)*100000n+BigInt(n.getNano());return vH(t,e,r,s,n,a)},vH=async(t,e,r,i,n,s)=>{r=BigInt(r);let o=up(n.toString()),a=await k7e(t,e,i,o),c=T7e(e,o,i,r,s),u=SH(c),l=await t.sign(u),d={value:e,signature:a,validityType:i,validity:o,sequence:r,ttl:s,signatureV2:l,data:c};return cs(`ipns entry for ${e} created`),d},T7e=(t,e,r,i,n)=>{let s={Value:t,Validity:e,ValidityType:r,Sequence:i,TTL:n};return yH.encode(s)},wH=async(t,e)=>{let{value:r,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=SH(e.data),R7e(e)):(o=e.signature,s=EH(r,i,n));let a;try{a=await t.verify(s,o)}catch(c){a=!1}if(!a)throw cs.error("record signature verification failed"),cn(new Error("record signature verification failed"),$i.ERR_SIGNATURE_VERIFICATION);if(i===fp.ValidityType.EOL){let c;try{c=E7e(_7e(n))}catch(u){throw cs.error("unrecognized validity format (not an rfc3339 format)"),cn(new Error("unrecognized validity format (not an rfc3339 format)"),$i.ERR_UNRECOGNIZED_FORMAT)}if(c.getTime()<Date.now())throw cs.error("record has expired"),cn(new Error("record has expired"),$i.ERR_IPNS_EXPIRED_RECORD)}else if(i)throw cs.error("unrecognized validity type"),cn(new Error("unrecognized validity type"),$i.ERR_UNRECOGNIZED_VALIDITY);cs(`ipns entry for ${r} is valid`)},R7e=t=>{if(!t.data)throw cn(new Error("Record data is missing"),$i.ERR_INVALID_RECORD_DATA);let e=yH.decode(t.data);if(Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),!pH(e.Value,t.value))throw cn(new Error('Field "value" did not match between protobuf and CBOR'),$i.ERR_SIGNATURE_VERIFICATION);if(!pH(e.Validity,t.validity))throw cn(new Error('Field "validity" did not match between protobuf and CBOR'),$i.ERR_SIGNATURE_VERIFICATION);if(e.ValidityType!==t.validityType)throw cn(new Error('Field "validityType" did not match between protobuf and CBOR'),$i.ERR_SIGNATURE_VERIFICATION);if(e.Sequence!==t.sequence)throw cn(new Error('Field "sequence" did not match between protobuf and CBOR'),$i.ERR_SIGNATURE_VERIFICATION);if(e.TTL!==t.ttl)throw cn(new Error('Field "ttl" did not match between protobuf and CBOR'),$i.ERR_SIGNATURE_VERIFICATION)},P7e=async(t,e)=>{if(!t||!t.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw cs.error(n),cn(n,$i.ERR_UNDEFINED_PARAMETER)}let r;try{r=await hH.createFromPubKey(t.bytes)}catch(n){throw cn(n,$i.ERR_PEER_ID_FROM_PUBLIC_KEY)}let i;try{i=N7e(r)}catch(n){throw cs.error(n),cn(n,$i.ERR_PUBLIC_KEY_FROM_ID)}if(i)return null;try{e.pubKey=g4.keys.marshalPublicKey(t)}catch(n){throw cs.error(n),n}return e},_H=(t,e)=>{if(!e||!t){let r=new Error("one or more of the provided parameters are not defined");throw cs.error(r),cn(r,$i.ERR_UNDEFINED_PARAMETER)}if(e.pubKey){let r;try{r=g4.keys.unmarshalPublicKey(e.pubKey)}catch(i){throw cs.error(i),i}return r}if(t.pubKey)return t.pubKey;throw Object.assign(new Error("no public key is available"),{code:$i.ERR_UNDEFINED_PARAMETER})},b4=t=>w7e.encode(t).slice(1),C7e=t=>new Jg(`/ipns/${b4(t)}`),O7e=t=>{let e=up("/pk/"),r=up("/ipns/");return{routingPubKey:new Jg(lp([e,t]),!1),pkKey:new Jg(b4(lp([e,t]))),routingKey:new Jg(lp([r,t]),!1),ipnsKey:new Jg(b4(lp([r,t])))}},k7e=(t,e,r,i)=>{try{let n=EH(e,r,i);return t.sign(n)}catch(n){throw cs.error("record signature creation failed"),cn(new Error("record signature creation failed: "+n.message),$i.ERR_SIGNATURE_CREATION)}},q7e=t=>{if(t.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${t.toString()}`);throw cs.error(e),cn(e,$i.ERR_UNRECOGNIZED_VALIDITY)},EH=(t,e,r)=>{let i=up(q7e(e));return lp([t,r,i])},SH=t=>{let e=up("ipns-signature:");return lp([e,t])},N7e=t=>{let e=m7e.decode(t.id);return e.code!==S7e?null:g4.keys.unmarshalPublicKey(e.digest)},D7e=t=>fp.encode({...t,sequence:gH.fromString(t.sequence.toString()),ttl:t.ttl==null?void 0:gH.fromString(t.ttl.toString())}).finish(),Jw=t=>{let e=fp.decode(t),r=fp.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:r.value,signature:r.signature,validityType:r.validityType,validity:r.validity,sequence:Object.hasOwnProperty.call(r,"sequence")?BigInt(`${r.sequence}`):0n,pubKey:r.pubKey,ttl:Object.hasOwnProperty.call(r,"ttl")?BigInt(`${r.ttl}`):void 0}},B7e={validate:async(t,e)=>{let r=Jw(t),i=e.slice(x7e.length),n=hH.createFromBytes(i),s=_H(n,r);await wH(s,r)},select:(t,e)=>{let r=Jw(t),i=Jw(e);return r.sequence>i.sequence?0:1}};xH.exports={create:A7e,createWithExpiration:I7e,validate:wH,embedPublicKey:P7e,extractPublicKey:_H,getLocalKey:C7e,getIdKeys:O7e,marshal:D7e,unmarshal:Jw,validator:B7e,namespace:mH,namespaceLength:mH.length}});var OH=p((PH,CH)=>{f();"use strict";var e_=et(),{Key:AH,Errors:M7e}=Ft(),xn=ae(),IH=me(),gi=Object.assign(IH("ipfs:ipns:publisher"),{error:IH("ipfs:ipns:publisher:error")}),eb=Je(),L7e=ci(),Oc=dp(),TH=M7e.notFoundError().code,RH=60*60*1e3,m4=class{constructor(e,r){this._routing=e,this._datastore=r}async publishWithEOL(e,r,i){if(!e||!e.bytes)throw xn(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await e_.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,r,i,n);return this._putRecordToRouting(s,n)}publish(e,r){return this.publishWithEOL(e,r,RH)}async _putRecordToRouting(e,r){if(!e_.isPeerId(r)){let o="peerId received is not valid";throw gi.error(o),xn(new Error(o),"ERR_INVALID_PEER_ID")}let i=r._pubKey,n=await Oc.embedPublicKey(i,e),s=Oc.getIdKeys(r.toBytes());return await this._publishEntry(s.routingKey,n||e),await this._publishPublicKey(s.routingPubKey,i),n||e}async _publishEntry(e,r){if(!(e instanceof AH)){let n="datastore key does not have a valid format";throw gi.error(n),xn(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let i;try{i=Oc.marshal(r)}catch(n){throw gi.error(n),n}try{let n=await this._routing.put(e.uint8Array(),i);return gi(`ipns record for ${eb(e.uint8Array(),"base64")} was stored in the routing`),n}catch(n){let s=`ipns record for ${eb(e.uint8Array(),"base64")} could not be stored in the routing`;throw gi.error(s),gi.error(n),xn(new Error(s),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(e,r){if(!(e instanceof AH)){let i="datastore key does not have a valid format";throw gi.error(i),xn(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!r||!r.bytes){let i="one or more of the provided parameters are not defined";throw gi.error(i),xn(new Error(i),"ERR_UNDEFINED_PARAMETER")}try{let i=await this._routing.put(e.uint8Array(),r.bytes);return gi(`public key for ${eb(e.uint8Array(),"base64")} was stored in the routing`),i}catch(i){let n=`public key for ${eb(e.uint8Array(),"base64")} could not be stored in the routing`;throw gi.error(n),gi.error(i),xn(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,r={}){if(!e_.isPeerId(e)){let n="peerId received is not valid";throw gi.error(n),xn(new Error(n),"ERR_INVALID_PEER_ID")}let i=r.checkRouting!==!1;try{let n=await this._datastore.get(Oc.getLocalKey(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==TH){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw gi.error(s),xn(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw xn(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=Oc.getIdKeys(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw gi.error(s),s}}}_unmarshalData(e){try{return Oc.unmarshal(e)}catch(r){throw xn(r,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,r,i,n){if(!e_.isPeerId(n)){let u="peerId received is not valid";throw gi.error(u),xn(new Error(u),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(u){if(u.code!==TH){let l=`unexpected error when determining the last published IPNS record for ${n.id} ${u.stack}`;throw gi.error(l),xn(new Error(l),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=L7e(o.value,r)?BigInt(o.sequence):BigInt(o.sequence)+1n);let c;try{c=await Oc.create(e,r,a,i)}catch(u){let l=`ipns record for ${r} could not be created`;throw gi.error(u),xn(new Error(l),"ERR_CREATING_IPNS_RECORD")}try{let u=Oc.marshal(c);return await this._datastore.put(Oc.getLocalKey(n.id),u),gi(`ipns record for ${eb(r,"base32")} was stored in the datastore`),c}catch(u){let l=`ipns record for ${r} could not be stored in the datastore`;throw gi.error(l),xn(new Error(l),"ERR_STORING_IN_DATASTORE")}}};m4.defaultRecordLifetime=RH;PH=CH.exports=m4});var FH=p((LH,UH)=>{f();"use strict";var kH=dp(),U7e=xa(),qH=et(),_f=ae(),NH=me(),t_=Object.assign(NH("ipfs:ipns:republisher"),{error:NH("ipfs:ipns:republisher:error")}),DH=60*1e3,BH=60*DH,F7e=4*BH,K7e=24*BH,MH=class{constructor(e,r,i,n,s={pass:""}){this._publisher=e,this._datastore=r,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw _f(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){t_.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:r}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(r,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||DH):this._options.broadcastInterval||F7e),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw _f(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,r){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";t_.error(n);return}if(r)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,r),o=await U7e.keys.import(s,r);await this._republishEntry(o)}}catch(i){t_.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw _f(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let r=await qH.createFromPrivKey(e.bytes),i=await this._getPreviousValue(r);await this._publisher.publishWithEOL(e,i,K7e)}catch(r){if(r.code==="ERR_NO_ENTRY_FOUND")return;throw r}}async _getPreviousValue(e){if(!qH.isPeerId(e))throw _f(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let r=await this._datastore.get(kH.getLocalKey(e.id));if(!(r instanceof Uint8Array))throw _f(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return kH.unmarshal(r).value}catch(i){throw t_.error(i),_f(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(r){throw r&&r.notFound?_f(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):r}}};LH=UH.exports=MH});var $H=p((zH,HH)=>{f();"use strict";var r_=dp(),j7e=et(),hp=ae(),KH=me(),i_=Object.assign(KH("ipfs:ipns:resolver"),{error:KH("ipfs:ipns:resolver:error")}),V7e=Je(),{Errors:z7e}=Ft(),H7e=z7e.notFoundError().code,jH=32,VH=class{constructor(e){this._routing=e}async resolve(e,r={}){if(typeof e!="string")throw hp(new Error("invalid name"),"ERR_INVALID_NAME");let i=r.recursive&&r.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw hp(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=1/0;i&&(o=jH);let a=await this.resolver(s,o);return i_(`${e} was locally resolved correctly`),a}async resolver(e,r){if(r===0){let s=`could not resolve name (recursion limit of ${jH} exceeded)`;throw i_.error(s),hp(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!r?i:this.resolver(n[2],r-1)}async _resolveName(e){let r=j7e.parse(e),{routingKey:i}=r_.getIdKeys(r.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw i_.error("could not get record from routing",o),o.code===H7e?hp(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):hp(new Error(`unexpected error getting the ipns record ${r.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=r_.unmarshal(n)}catch(o){throw i_.error("could not unmarshal record",o),hp(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(r,s)}async _validateRecord(e,r){let i=await r_.extractPublicKey(e,r);return await r_.validate(i,r),V7e(r.value)}};zH=HH.exports=VH});var ZH=p((HTt,QH)=>{f();"use strict";var{createFromPrivKey:$7e}=et(),G7e=ae(),GH=me(),tb=Object.assign(GH("ipfs:ipns"),{error:GH("ipfs:ipns:error")}),v4=OH(),W7e=FH(),Y7e=$H(),X7e=hI(),WH=60*1e3,YH=Je(),XH=class{constructor(e,r,i,n,s){this.publisher=new v4(e,r),this.republisher=new W7e(this.publisher,r,i,n,s),this.resolver=new Y7e(e),this.cache=new X7e(1e3),this.routing=e}async publish(e,r,i=v4.defaultRecordLifetime){try{let n=await $7e(e.bytes);await this.publisher.publishWithEOL(e,r,i),tb(`IPNS value ${YH(r,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<WH?o:WH;return this.cache.set(s,r,a),tb(`IPNS value ${YH(r,"base32")} was cached correctly`),{name:s,value:r}}catch(n){throw tb.error(n),n}}async resolve(e,r={}){if(typeof e!="string")throw G7e(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!r.nocache&&!r.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,r);return tb(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw tb.error(i),i}}async initializeKeyspace(e,r){return this.publish(e,r,v4.defaultRecordLifetime)}};QH.exports=XH});var rb=p(($Tt,e$)=>{f();"use strict";var{Adapter:Q7e}=Ft(),Ef=Io(),{pipe:w4}=Er(),JH=class extends Q7e{constructor(e,r){super();this.child=e,this.transform=r}open(){return this.child.open()}put(e,r,i){return this.child.put(this.transform.convert(e),r,i)}get(e,r){return this.child.get(this.transform.convert(e),r)}has(e,r){return this.child.has(this.transform.convert(e),r)}delete(e,r){return this.child.delete(this.transform.convert(e),r)}async*putMany(e,r={}){let i=this.transform,n=this.child;yield*w4(e,async function*(s){yield*Ef(s,({key:o,value:a})=>({key:i.convert(o),value:a}))},async function*(s){yield*n.putMany(s,r)},async function*(s){yield*Ef(s,({key:o,value:a})=>({key:i.invert(o),value:a}))})}async*getMany(e,r={}){let i=this.transform,n=this.child;yield*w4(e,async function*(s){yield*Ef(s,o=>i.convert(o))},async function*(s){yield*n.getMany(s,r)})}async*deleteMany(e,r={}){let i=this.transform,n=this.child;yield*w4(e,async function*(s){yield*Ef(s,o=>i.convert(o))},async function*(s){yield*n.deleteMany(s,r)},async function*(s){yield*Ef(s,o=>i.invert(o))})}batch(){let e=this.child.batch();return{put:(r,i)=>{e.put(this.transform.convert(r),i)},delete:r=>{e.delete(this.transform.convert(r))},commit:r=>e.commit(r)}}query(e,r){return Ef(this.child.query(e,r),({key:i,value:n})=>({key:this.transform.invert(i),value:n}))}queryKeys(e,r){return Ef(this.child.queryKeys(e,r),i=>this.transform.invert(i))}close(){return this.child.close()}};e$.exports=JH});var r$=p((GTt,t$)=>{f();"use strict";t$.exports=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var x4=p((WTt,o$)=>{f();"use strict";var{Key:i$}=Ft(),Z7e=r$(),n_="/repo/flatfs/shard/",n$="SHARDING",J7e="_README",s_=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${n_}v1/${this.name}/${this.param}`}},_4=class extends s_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},E4=class extends s_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let r=this._padding+e;return r.slice(r.length-this.param)}},S4=class extends s_{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let r=this._padding+e,i=r.length-this.param-1;return r.slice(i,i+this.param)}};function s$(t){if(t=t.trim(),t.length===0)throw new Error("empty shard string");if(!t.startsWith(n_))throw new Error(`invalid or no path prefix: ${t}`);let e=t.slice(n_.length).split("/"),r=e[0];if(r!=="v1")throw new Error(`expect 'v1' version, got '${r}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new _4(n);case"suffix":return new E4(n);case"next-to-last":return new S4(n);default:throw new Error(`unkown sharding function: ${i}`)}}var eLe=async(t,e)=>{let r=new i$(t).child(new i$(n$)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(r);return s$(new TextDecoder().decode(n||"").trim())};o$.exports={readme:Z7e,parseShardFun:s$,readShardFun:eLe,Prefix:_4,Suffix:E4,NextToLast:S4,README_FN:J7e,SHARDING_FN:n$,PREFIX:n_}});var c$=p((YTt,a$)=>{f();"use strict";var{Adapter:tLe,Key:o_,Errors:rLe}=Ft(),ib=x4(),iLe=rb(),pp=new o_(ib.SHARDING_FN),nb=new o_(ib.README_FN),Sf=class extends tLe{constructor(e,r){super();this.child=new iLe(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=r}async open(){await this.child.open(),this.shard=await Sf.create(this.child,this.shard)}_convertKey(e){let r=e.toString();return r===pp.toString()||r===nb.toString()?e:new o_(this.shard.fun(r)).child(e)}_invertKey(e){let r=e.toString();return r===pp.toString()||r===nb.toString()?e:o_.withNamespaces(e.list().slice(1))}static async createOrOpen(e,r){try{await Sf.create(e,r)}catch(i){if(i&&i.message!=="datastore exists")throw i}return Sf.open(e)}static async open(e){let r=await ib.readShardFun("/",e);return new Sf(e,r)}static async create(e,r){let i=await e.has(pp);if(!i&&!r)throw rLe.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(pp,new TextEncoder().encode(r.toString()+`
`)),a(nb,new TextEncoder().encode(ib.readme))]),r}let n=await ib.readShardFun("/",e),s=(n||"").toString(),o=r.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,r,i){return this.child.put(e,r,i)}get(e,r){return this.child.get(e,r)}has(e,r){return this.child.has(e,r)}delete(e,r){return this.child.delete(e,r)}async*putMany(e,r={}){yield*this.child.putMany(e,r)}async*getMany(e,r={}){yield*this.child.getMany(e,r)}async*deleteMany(e,r={}){yield*this.child.deleteMany(e,r)}batch(){return this.child.batch()}query(e,r){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.key.toString()!==pp.toString(),s=>s.key.toString()!==nb.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s.key).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>({key:c,value:u})=>o({key:this._invertKey(c),value:u}));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s({key:this._invertKey(a.key),value:a.value},{key:this._invertKey(c.key),value:c.value}))),this.child.query(i,r)}queryKeys(e,r){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.toString()!==pp.toString(),s=>s.toString()!==nb.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>c=>o(this._invertKey(c)));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s(this._invertKey(a),this._invertKey(c)))),this.child.queryKeys(i,r)}close(){return this.child.close()}};a$.exports=Sf});var y$=p((XTt,p$)=>{f();"use strict";var{Adapter:nLe,Key:sLe,Errors:A4,utils:{sortAll:u$,replaceStartWith:I4}}=Ft(),a_=Pa(),l$=$h(),f$=ip(),d$=rb(),h$=class extends nLe{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let r of this.mounts)if(r.prefix.toString()===e.toString()||r.prefix.isAncestorOf(e)){let i=I4(e.toString(),r.prefix.toString());return{datastore:r.datastore,mountpoint:r.prefix,rest:new sLe(i)}}}put(e,r,i){let n=this._lookup(e);if(n==null)throw A4.dbWriteFailedError(new Error("No datastore mounted for this key"));return n.datastore.put(n.rest,r,i)}get(e,r){let i=this._lookup(e);if(i==null)throw A4.notFoundError(new Error("No datastore mounted for this key"));return i.datastore.get(i.rest,r)}has(e,r){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(i.rest,r)}delete(e,r){let i=this._lookup(e);if(i==null)throw A4.dbDeleteFailedError(new Error("No datastore mounted for this key"));return i.datastore.delete(i.rest,r)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},r=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s],rest:n.rest}};return{put:(i,n)=>{let s=r(i);s.batch.put(s.rest,n)},delete:i=>{let n=r(i);n.batch.delete(n.rest)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,r){let i=this.mounts.map(s=>{let o=new d$(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=I4(e.prefix,s.prefix.toString())),o.query({prefix:a,filters:e.filters},r)}),n=f$(...i);if(e.filters&&e.filters.forEach(s=>{n=a_(n,s)}),e.orders&&e.orders.forEach(s=>{n=u$(n,s)}),e.offset!=null){let s=0;n=a_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=l$(n,e.limit)),n}queryKeys(e,r){let i=this.mounts.map(s=>{let o=new d$(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=I4(e.prefix,s.prefix.toString())),o.queryKeys({prefix:a,filters:e.filters},r)}),n=f$(...i);if(e.filters&&e.filters.forEach(s=>{n=a_(n,s)}),e.orders&&e.orders.forEach(s=>{n=u$(n,s)}),e.offset!=null){let s=0;n=a_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=l$(n,e.limit)),n}};p$.exports=h$});var w$=p((QTt,v$)=>{f();"use strict";var{Adapter:oLe,Errors:c_}=Ft(),aLe=me()("datastore:core:tiered"),g$=Oa(),b$=Ra(),m$=class extends oLe{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw c_.dbOpenFailedError()}}async put(e,r){try{await Promise.all(this.stores.map(i=>i.put(e,r)))}catch(i){throw c_.dbWriteFailedError()}}async get(e,r){for(let i of this.stores)try{let n=await i.get(e,r);if(n)return n}catch(n){aLe(n)}throw c_.notFoundError()}async has(e,r){for(let i of this.stores)if(await i.has(e,r))return!0;return!1}async delete(e,r){try{await Promise.all(this.stores.map(i=>i.delete(e,r)))}catch(i){throw c_.dbDeleteFailedError()}}async*putMany(e,r={}){let i,n=this.stores.map(s=>{let o=g$();return b$(s.putMany(o,r)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async*deleteMany(e,r={}){let i,n=this.stores.map(s=>{let o=g$();return b$(s.deleteMany(o,r)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(r=>r.batch());return{put:(r,i)=>{e.forEach(n=>n.put(r,i))},delete:r=>{e.forEach(i=>i.delete(r))},commit:async r=>{for(let i of e)await i.commit(r)}}}query(e,r){return this.stores[this.stores.length-1].query(e,r)}queryKeys(e,r){return this.stores[this.stores.length-1].queryKeys(e,r)}};v$.exports=m$});var S$=p((ZTt,E$)=>{f();"use strict";var T4=Ft().Key,cLe=rb(),_$=class extends cLe{constructor(e,r){super(e,{convert(i){return r.child(i)},invert(i){if(r.toString()==="/")return i;if(!r.isAncestorOf(i))throw new Error(`Expected prefix: (${r.toString()}) in key: ${i.toString()}`);return new T4(i.toString().slice(r.toString().length),!1)}});this.prefix=r}query(e,r){return e.prefix&&this.prefix.toString()!=="/"?super.query(Object.assign({},e,{prefix:this.prefix.child(new T4(e.prefix)).toString()})):super.query(e,r)}queryKeys(e,r){return e.prefix&&this.prefix.toString()!=="/"?super.queryKeys(Object.assign({},e,{prefix:this.prefix.child(new T4(e.prefix)).toString()})):super.queryKeys(e,r)}};E$.exports=_$});var A$=p((JTt,x$)=>{f();"use strict";var uLe=rb(),lLe=c$(),fLe=y$(),dLe=w$(),hLe=S$(),pLe=x4();x$.exports={KeytransformDatastore:uLe,ShardingDatastore:lLe,MountDatastore:fLe,TieredDatastore:dLe,NamespaceDatastore:hLe,shard:pLe}});var sb=p((R4,P4)=>{f();(function(t,e){typeof R4=="object"&&typeof P4!="undefined"?P4.exports=function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}:typeof define=="function"&&define.amd?define(function(){return function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}}):t.dlv=function(r,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)r=r?r[i[s]]:o;return r===o?n:r}})(R4)});var P$=p((eRt,R$)=>{f();"use strict";var yLe=ae(),I$=Je(),T$=ct(),u_="/record/";function gLe(t){return I$(t,"base32")}function bLe(t){(typeof t=="string"||t instanceof String)&&(t=T$(t.toString()));let e=I$(t,"base64url");return`${u_}${e}`}function mLe(t){if(t.substring(0,u_.length)!==u_)throw yLe(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=t.substring(u_.length);return T$(e,"base64url")}R$.exports={encodeBase32:gLe,keyToTopic:bLe,topicToKey:mLe}});var D$=p((q$,N$)=>{f();"use strict";var{Key:C4,Adapter:vLe}=Ft(),{encodeBase32:C$,keyToTopic:l_,topicToKey:wLe}=P$(),_Le=ci(),Ms=ae(),O$=me(),un=Object.assign(O$("datastore-pubsub:publisher"),{error:O$("datastore-pubsub:publisher:error")}),k$=class extends vLe{constructor(e,r,i,n,s){super();if(!n)throw Ms(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw Ms(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw Ms(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw Ms(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=r,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,r){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw un.error(n),Ms(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(r instanceof Uint8Array)){let n="received value is not a Uint8Array";throw un.error(n),Ms(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=l_(e);un(`publish value for topic ${i}`),await this._pubsub.publish(i,r)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw un.error(n),Ms(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let r=l_(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(r)>-1)return this._getLocal(e);try{this._pubsub.on(r,this._onMessage),await this._pubsub.subscribe(r)}catch(n){let s=`cannot subscribe topic ${r}`;throw un.error(s),Ms(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return un(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){let r=l_(e);return this._pubsub.removeListener(r,this._onMessage),this._pubsub.unsubscribe(r)}async _getLocal(e){let r=new C4("/"+C$(e),!1),i;try{i=await this._datastore.get(r)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${r.toString()}`;throw un.error(o),Ms(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${r.toString()}`;throw un.error(s),Ms(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw un.error(n),Ms(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:r,from:i,topicIDs:n}=e,s;try{s=wLe(n[0])}catch(o){un.error(o);return}if(un(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){un("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){un.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,r)}catch(o){un.error(o)}}async _storeIfSubscriptionIsBetter(e,r){let i=!1;try{i=await this._isBetter(e,r)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,r)}async _validateRecord(e,r){return this._validator.validate(e,r)}async _selectRecord(e,r){return await this._validator.select(e,r)===0}async _isBetter(e,r){try{await this._validateRecord(r,e)}catch(s){let o="record received through pubsub is not valid";throw un.error(o),Ms(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new C4(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return _Le(n,r)?!1:this._selectRecord(e,[n,r])}async _storeRecord(e,r){let i=new C4("/"+C$(e),!1);await this._datastore.put(i,r),un(`record for ${l_(e)} was stored in the datastore`)}};q$=N$.exports=k$});var k4=p((tRt,j$)=>{f();"use strict";var zu=dp(),{base58btc:B$}=(Zr(),Qr),ELe=D$(),M$=Je(),L$=ct(),U$=ae(),F$=me(),O4=Object.assign(F$("ipfs:ipns:pubsub"),{error:F$("ipfs:ipns:pubsub:error")}),K$=class{constructor(e,r,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new ELe(e,r,i,zu.validator,this._handleSubscriptionKey)}put(e,r){return this._pubsubDs.put(e,r)}async get(e){let r,i;try{r=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,zu.namespaceLength);if(M$(n)===zu.namespace){let s=B$.encode(e).substring(1),o=B$.encode(e.slice(zu.namespaceLength)).substring(1);this._subscriptions[s]=o,O4(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return r}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=M$(e,"base58btc"));let r=this._subscriptions[e];if(!r)throw U$(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=zu.getIdKeys(L$(r,"base58btc"))}catch(n){throw O4.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(r=>`${zu.namespace}${r}`)}async cancel(e){if(typeof e!="string")throw U$(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(zu.namespace)&&(e=e.substring(zu.namespaceLength));let r=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!r)return{canceled:!1};let i=L$(r);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[r],O4(`unsubscribed pubsub ${r}: ${e}`),{canceled:!0}}};j$.exports=K$});var H$=p((rRt,z$)=>{f();"use strict";var yp=Ti(),V$=yp.Reader,SLe=yp.Writer,Ls=yp.util,ob=yp.roots["libp2p-record"]||(yp.roots["libp2p-record"]={});ob.Record=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.key=Ls.newBuffer([]),t.prototype.value=Ls.newBuffer([]),t.prototype.timeReceived="",t.encode=function(r,i){return i||(i=SLe.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&i.uint32(10).bytes(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&i.uint32(18).bytes(r.value),r.timeReceived!=null&&Object.hasOwnProperty.call(r,"timeReceived")&&i.uint32(42).string(r.timeReceived),i},t.decode=function(r,i){r instanceof V$||(r=V$.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new ob.Record;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.key=r.bytes();break;case 2:s.value=r.bytes();break;case 5:s.timeReceived=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ob.Record)return r;var i=new ob.Record;return r.key!=null&&(typeof r.key=="string"?Ls.base64.decode(r.key,i.key=Ls.newBuffer(Ls.base64.length(r.key)),0):r.key.length&&(i.key=r.key)),r.value!=null&&(typeof r.value=="string"?Ls.base64.decode(r.value,i.value=Ls.newBuffer(Ls.base64.length(r.value)),0):r.value.length&&(i.value=r.value)),r.timeReceived!=null&&(i.timeReceived=String(r.timeReceived)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=Ls.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=Ls.newBuffer(n.value))),n.timeReceived=""),r.key!=null&&r.hasOwnProperty("key")&&(n.key=i.bytes===String?Ls.base64.encode(r.key,0,r.key.length):i.bytes===Array?Array.prototype.slice.call(r.key):r.key),r.value!=null&&r.hasOwnProperty("value")&&(n.value=i.bytes===String?Ls.base64.encode(r.value,0,r.value.length):i.bytes===Array?Array.prototype.slice.call(r.value):r.value),r.timeReceived!=null&&r.hasOwnProperty("timeReceived")&&(n.timeReceived=r.timeReceived),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,yp.util.toJSONOptions)},t}();z$.exports=ob});var $$=p((iRt,q4)=>{f();"use strict";q4.exports.toRFC3339=t=>{let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),s=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0"),c=t.getUTCMilliseconds()*1e3*1e3;return`${e}-${r}-${i}T${n}:${s}:${o}.${c}Z`};q4.exports.parseRFC3339=t=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(!r)throw new Error("Invalid format");let i=parseInt(r[1],10),n=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var Y$=p((nRt,W$)=>{f();"use strict";var{Record:N4}=H$(),G$=$$(),ab=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(r instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=r,this.timeReceived=i}serialize(){return N4.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&G$.toRFC3339(this.timeReceived)}}static deserialize(e){let r=N4.decode(e);return ab.fromDeserialized(N4.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let r;return e.timeReceived&&(r=G$.parseRFC3339(e.timeReceived)),new ab(e.key,e.value,r)}};W$.exports=ab});var Q$=p((sRt,X$)=>{f();"use strict";var{sha256:xLe}=(ei(),Ur),f_=ae(),ALe=Je(),ILe=ci(),TLe=async(t,e)=>{if(!(t instanceof Uint8Array))throw f_(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(t.byteLength<5)throw f_(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(ALe(t.subarray(0,4))!=="/pk/")throw f_(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=t.slice(4),n=await xLe.digest(e);if(!ILe(i,n.bytes))throw f_(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};X$.exports={func:TLe,sign:!1}});var J$=p((oRt,Z$)=>{f();"use strict";Z$.exports={pk:Q$()}});var tG=p((aRt,eG)=>{f();"use strict";var RLe=ae(),PLe=Je(),CLe=(t,e)=>{let r=e.key,n=PLe(r).split("/");if(n.length<3)return;let s=t[n[1].toString()];if(!s){let o="Invalid record keytype";throw RLe(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(r,e.value)};eG.exports={verifyRecord:CLe,validators:J$()}});var iG=p((cRt,rG)=>{f();"use strict";var OLe=(t,e)=>0;rG.exports=OLe});var sG=p((uRt,nG)=>{f();"use strict";nG.exports={pk:iG()}});var aG=p((lRt,oG)=>{f();"use strict";var D4=ae(),kLe=Je(),qLe=(t,e,r)=>{if(r.length===0){let o="No records given";throw D4(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=kLe(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw D4(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=t[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw D4(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return s(e,r)};oG.exports={bestRecord:qLe,selectors:sG()}});var xf=p((fRt,cG)=>{f();"use strict";cG.exports={Record:Y$(),validator:tG(),selection:aG()}});var B4=p((dRt,lG)=>{f();"use strict";var uG=dp(),NLe=Je();lG.exports={encodeBase32:t=>NLe(t,"base32upper"),validator:{func:(t,e)=>uG.validator.validate(e,t)},selector:(t,e)=>uG.validator.select(e[0],e[1])}});var L4=p((pG,yG)=>{f();"use strict";var{Key:DLe}=Ft(),{Record:fG}=xf(),{encodeBase32:BLe}=B4(),cb=ae(),dG=me(),M4=Object.assign(dG("ipfs:ipns:offline-datastore"),{error:dG("ipfs:ipns:offline-datastore:error")}),hG=class{constructor(e){this._repo=e,this.stores=[]}async put(e,r){if(!(e instanceof Uint8Array))throw cb(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(r instanceof Uint8Array))throw cb(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw M4.error(s),cb(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new fG(e,r);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw cb(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let r;try{r=this._routingKey(e)}catch(s){throw M4.error(s),cb(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(r),n;try{n=fG.deserialize(i)}catch(s){throw M4.error(s),s}return n.value}_routingKey(e){return new DLe("/"+BLe(e),!1)}};pG=yG.exports=hG});var bG=p((hRt,gG)=>{f();"use strict";var{TieredDatastore:MLe}=A$(),U4=sb(),LLe=k4(),ULe=L4();gG.exports=({libp2p:t,repo:e,peerId:r,options:i})=>{let n=[],s;if(U4(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=t.pubsub,a=e.datastore;s=new LLe(o,a,r),n.push(s)}if(U4(i,"offline")||!U4(i,"libp2p.config.dht.enabled",!1)){let o=new ULe(e);n.push(o)}else n.push(t._dht);return new MLe(n)}});var EG=p((pRt,_G)=>{f();"use strict";var mG=ZH(),FLe=bG(),KLe=L4(),{NotInitializedError:jLe,AlreadyInitializedError:vG}=Lu(),VLe=me()("ipfs:components:ipns"),wG=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new jLe}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:r,keychain:i}){if(this.offline!=null)throw new vG;VLe("initializing IPNS keyspace");let n=new KLe(e),s=new mG(n,e.datastore,r,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:r,peerId:i,keychain:n}){if(this.online!=null)throw new vG;let s=FLe({libp2p:e,repo:r,peerId:i,options:this.options}),o=new mG(s,r.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,r,i){return this.getIPNS().publish(e,r,i)}resolve(e,r){return this.getIPNS().resolve(e,r)}initializeKeyspace(e,r){return this.getIPNS().initializeKeyspace(e,r)}};_G.exports=wG});var xG=p(SG=>{f();"use strict";var zLe=qh(),HLe=Ug(),$Le=Ra(),{resolve:GLe}=Mi();SG.resolvePath=async({ipns:t,repo:e,codecs:r},i,n)=>{if(zLe.ipnsPath(i))return t.resolve(i);let{cid:s,path:o}=HLe(i);await $Le(GLe(s,o||"",r,e,n))}});var RG=p((gRt,TG)=>{f();"use strict";var AG=me(),{default:WLe}=Mg(),YLe=xa(),IG=ae(),XLe=ct(),QLe=Je(),F4=Object.assign(AG("ipfs:name:publish"),{error:AG("ipfs:name:publish:error")}),{OFFLINE_ERROR:ZLe,normalizePath:JLe}=Mi(),e9e=Ce(),{resolvePath:t9e}=xG();TG.exports=({ipns:t,repo:e,codecs:r,peerId:i,isOnline:n,keychain:s})=>{let o=async c=>{if(c==="self")return i.privKey;try{let u=await s.exportKey(c,"temp");return await YLe.keys.import(u,"temp")}catch(u){throw F4.error(u),IG(u,"ERR_CANNOT_GET_KEY")}};async function a(c,u={}){let l=u.resolve!==!1,d=u.lifetime||"24h",h=u.key||"self";if(!n())throw IG(new Error(ZLe),"OFFLINE_ERROR");try{c=JLe(c)}catch(v){throw F4.error(v),v}let y=0;try{y=WLe(d)||0,y=parseFloat(y.toFixed(6))}catch(v){throw F4.error(v),v}let g=await Promise.all([o(h),l?t9e({ipns:t,repo:e,codecs:r},c):Promise.resolve()]),m=XLe(c),E=await t.publish(g[0],m,y);return{name:E.name,value:QLe(E.value)}}return e9e(a)}});var CG=p((bRt,PG)=>{f();"use strict";var r9e=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;PG.exports=function(e,r){if(r==null&&(r=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(r){if(i!==".")return!1}else if(i===".")return!1;return r9e.test(e)}});var NG=p((mRt,qG)=>{f();"use strict";var OG=me(),K4=ae(),i9e=hr().bind({ignoreUndefined:!0}),{CID:n9e}=(Ae(),ke),s9e=et(),o9e=CG(),a9e=Je(),c9e=Object.assign(OG("ipfs:name:resolve"),{error:OG("ipfs:name:resolve:error")}),{OFFLINE_ERROR:u9e}=Mi(),l9e=Ce(),kG=(t,e)=>e.length>0?t+"/"+e.join("/"):t;qG.exports=({dns:t,ipns:e,peerId:r,isOnline:i,options:{offline:n}})=>{async function*s(o,a={}){if(a=i9e({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw K4(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");o||(o=r.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,u,...l]=o.slice(1).split("/");try{u.substring(0,1)==="1"?s9e.parse(u):n9e.parse(u)}catch(h){if(o9e(u)){yield kG(await t(u,a),l);return}throw c9e.error(h),K4(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}if(!i()&&!n)throw K4(new Error(u9e),"OFFLINE_ERROR");let d=await e.resolve(`/${c}/${u}`,a);yield kG(d instanceof Uint8Array?a9e(d):d,l)}return l9e(s)}});var d_=p(MG=>{f();"use strict";var DG=k4(),BG=ae();MG.getPubsubRouting=(t,e)=>{if(!t||!(e&&e.ipnsPubsub))throw BG(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(t.routing instanceof DG)return t.routing;let r=(t.routing.stores||[]).find(i=>i instanceof DG);if(!r)throw BG(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}});var UG=p((wRt,LG)=>{f();"use strict";var{getPubsubRouting:f9e}=d_(),d9e=Ce();LG.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n,s={}){return f9e(t,r).cancel(n,s)}return d9e(i)}});var KG=p((_Rt,FG)=>{f();"use strict";var{getPubsubRouting:h9e}=d_(),p9e=Ce();FG.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(h9e(t,r))}}catch(s){return{enabled:!1}}}return p9e(i)}});var VG=p((ERt,jG)=>{f();"use strict";var{getPubsubRouting:y9e}=d_(),g9e=Ce();jG.exports=({ipns:t,options:e})=>{let r=e.EXPERIMENTAL;async function i(n={}){return y9e(t,r).getSubscriptions(n)}return g9e(i)}});var $G=p((SRt,HG)=>{f();"use strict";var b9e=UG(),m9e=KG(),v9e=VG(),zG=class{constructor({ipns:e,options:r}){this.cancel=b9e({ipns:e,options:r}),this.state=m9e({ipns:e,options:r}),this.subs=v9e({ipns:e,options:r})}};HG.exports=zG});var YG=p((xRt,WG)=>{f();"use strict";var w9e=RG(),_9e=NG(),E9e=$G(),GG=class{constructor({dns:e,ipns:r,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=w9e({ipns:r,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a}),this.resolve=_9e({dns:e,ipns:r,peerId:s,isOnline:o,options:c}),this.pubsub=new E9e({ipns:r,options:c})}};WG.exports=GG});var ZG=p((ARt,V4)=>{f();"use strict";var S9e=(xt(),St),{Errors:x9e}=Ft(),A9e=x9e.notFoundError().code,I9e=Ce(),XG=Ug(),{CID:QG}=(Ae(),ke),h_={default:"<dst>",edges:"<src> -> <dst>"};V4.exports=function({repo:t,codecs:e,resolve:r,preload:i}){async function*n(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==h_.default)throw new Error("Cannot set edges to true and also specify format");o.format=o.edges?h_.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1);let c=(Array.isArray(s)?s:[s]).map(u=>T9e(i,u,o));for(let u of c)yield*R9e(r,t,e,u,o)}return I9e(n)};V4.exports.Format=h_;function T9e(t,e,r){let{cid:i,path:n}=XG(e);return r.preload!==!1&&t(i),`/ipfs/${i}${n||""}`}async function*R9e(t,e,r,i,n){let s=await t(i),{cid:o}=XG(s),a=n.maxDepth!=null?n.maxDepth:1/0,c=n.unique||!1;for await(let u of C9e(e,r,o,a,c))!u.parent||u.isDuplicate||(yield{ref:P9e(u.parent.cid,u.node.cid,u.node.name,n.format)})}function P9e(t,e,r="",i=h_.default){let n=i.replace(/<src>/g,t.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,r),n}async function*C9e(t,e,r,i,n){let s=new Set;async function*o(a,c){let u=c+1;if(!(u>i))try{for await(let l of O9e(t,e,a.cid))yield{parent:a,node:l,isDuplicate:n&&s.has(l.cid.toString())},n&&s.add(l.cid.toString()),yield*o(l,u)}catch(l){throw l.code===A9e&&(l.message=`Could not find object with CID: ${a.cid}`),l}}yield*o({cid:r},0)}async function*O9e(t,e,r,i=[]){let n=await t.blocks.get(r),o=(await e.getCodec(r.code)).decode(n),a=r.code===S9e.code;for(let[c,u]of j4(o,i)){if(a){let l=c.match(/^Links\/(\d+)\/Hash$/);if(l){let d=Number(l[1]);if(d<o.Links.length){yield{name:o.Links[d].Name,cid:u};continue}}}yield{name:c,cid:u}}}var j4=function*(t,e){if(t!=null&&!(t instanceof Uint8Array)){for(let[r,i]of Object.entries(t)){let n=[...e,r];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=QG.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*j4(o,a))}else{let s=QG.asCID(i);s?yield[n.join("/"),s]:yield*j4(i,n)}}return[]}}});var eW=p((IRt,JG)=>{f();"use strict";var k9e=Ce();JG.exports=function({repo:t}){async function*e(r={}){for await(let i of t.blocks.queryKeys({},{signal:r.signal}))yield{ref:i.toString()}}return k9e(e)}});var rW=p((TRt,tW)=>{f();"use strict";var q9e=Ce();tW.exports=({network:t})=>{async function e(r={}){let{bitswap:i}=await t.use(r),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return q9e(e)}});var nW=p((RRt,iW)=>{f();"use strict";var N9e=et(),D9e=Ce();iW.exports=({network:t})=>{async function e(r,i={}){let{bitswap:n}=await t.use(i),s=n.wantlistForPeer(N9e.createFromB58String(r));return Array.from(s).map(o=>o[1].cid)}return D9e(e)}});var oW=p((PRt,sW)=>{f();"use strict";var B9e=Ce();sW.exports=({network:t})=>{async function e(r,i={}){let{bitswap:n}=await t.use(i);return Array.isArray(r)||(r=[r]),n.unwant(r)}return B9e(e)}});var z4=p((CRt,aW)=>{f();"use strict";var M9e=Ce();aW.exports=({network:t})=>{async function e(r={}){let i=(await t.use(r)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return M9e(e)}});var lW=p((ORt,uW)=>{f();"use strict";var L9e=rW(),U9e=nW(),F9e=oW(),K9e=z4(),cW=class{constructor({network:e}){this.wantlist=L9e({network:e}),this.wantlistForPeer=U9e({network:e}),this.unwant=F9e({network:e}),this.stat=K9e({network:e})}};uW.exports=cW});var H4=p(fW=>{f();"use strict";var j9e=lf().IPFS.matches;fW.isValidMultiaddr=t=>{try{return j9e(t)}catch(e){return!1}}});var hW=p((qRt,dW)=>{f();"use strict";var{isValidMultiaddr:V9e}=H4(),z9e=Ce();dW.exports=({repo:t})=>{async function e(r,i={}){if(!V9e(r))throw new Error(`${r} is not a valid Multiaddr`);let n=await t.config.getAll(i),s=n.Bootstrap||[];return s.push(r.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await t.config.replace(n),{Peers:[r]}}return z9e(e)}});var yW=p((NRt,pW)=>{f();"use strict";var H9e=Ce(),{Multiaddr:$9e}=tt();pW.exports=({repo:t})=>{async function e(r={}){let i=await t.config.getAll(r),n=i.Bootstrap||[];return i.Bootstrap=[],await t.config.replace(i),{Peers:n.map(s=>new $9e(s))}}return H9e(e)}});var bW=p((DRt,gW)=>{f();"use strict";var G9e=Ce(),{Multiaddr:W9e}=tt();gW.exports=({repo:t})=>{async function e(r={}){return{Peers:(await t.config.get("Bootstrap",r)||[]).map(n=>new W9e(n))}}return G9e(e)}});var p_=p((BRt,mW)=>{f();"use strict";mW.exports=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}})});var _W=p((MRt,wW)=>{f();"use strict";var vW=p_(),Y9e=Ce(),{Multiaddr:X9e}=tt();wW.exports=({repo:t})=>{async function e(r={}){let i=await t.config.getAll(r);return i.Bootstrap=vW().Bootstrap,await t.config.replace(i),{Peers:vW().Bootstrap.map(n=>new X9e(n))}}return Y9e(e)}});var SW=p((LRt,EW)=>{f();"use strict";var{isValidMultiaddr:Q9e}=H4(),Z9e=Ce();EW.exports=({repo:t})=>{async function e(r,i={}){if(!Q9e(r))throw new Error(`${r} is not a valid Multiaddr`);let n=await t.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==r.toString()),await t.config.replace(n),{Peers:[r]}}return Z9e(e)}});var IW=p((URt,AW)=>{f();"use strict";var J9e=hW(),eUe=yW(),tUe=bW(),rUe=_W(),iUe=SW(),xW=class{constructor({repo:e}){this.add=J9e({repo:e}),this.list=tUe({repo:e}),this.rm=iUe({repo:e}),this.clear=eUe({repo:e}),this.reset=rUe({repo:e})}};AW.exports=xW});var RW=p((FRt,TW)=>{f();"use strict";var nUe=Ce();TW.exports=({preload:t,repo:e})=>{async function r(i,n={}){return n.preload!==!1&&t(i),e.blocks.get(i,n)}return nUe(r)}});var CW=p((KRt,PW)=>{f();"use strict";var{CID:sUe}=(Ae(),ke),oUe=Ce();PW.exports=({codecs:t,hashers:e,repo:r,preload:i})=>{async function n(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,u=o.format||(c===0?"dag-pb":"raw"),d=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),h=await t.getCodec(u),y=sUe.create(c,h.code,d);return await r.blocks.put(y,s,{signal:o.signal}),o.preload!==!1&&i(y),o.pin===!0&&await r.pins.pinRecursively(y,{signal:o.signal}),y}finally{a&&a()}}return oUe(n)}});var gp=p((y_,OW)=>{f();(function(t,e){typeof y_=="object"&&typeof OW!="undefined"?e(y_):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.streamingIterables={}))})(y_,function(t){"use strict";async function*e(I,U){let V=[];for await(let D of U)V.push(D),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function*r(I,U){let V=[];for(let D of U)V.push(D),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function i(I,U){return U===void 0?V=>i(I,V):U[Symbol.asyncIterator]?e(I,U):r(I,U)}function n(I){if(typeof I.next=="function")return I;if(typeof I[Symbol.iterator]=="function")return I[Symbol.iterator]();if(typeof I[Symbol.asyncIterator]=="function")return I[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let I,U;return{promise:new Promise((D,Q)=>{U=D,I=Q}),reject:I,resolve:U}}function o(I,U){let V=n(U),D=[],Q=[],ee=!1,J=!1;function ue(){for(;Q.length>0&&D.length>0;){let Te=Q.shift(),{error:je,value:Ze}=D.shift();je?Te.reject(je):Te.resolve({done:!1,value:Ze})}for(;Q.length>0&&J;){let{resolve:Te}=Q.shift();Te({done:!0,value:void 0})}}async function ge(){if(!J&&!ee&&!(D.length>=I)){ee=!0;try{let{done:Te,value:je}=await V.next();Te?J=!0:D.push({value:je})}catch(Te){J=!0,D.push({error:Te})}ue(),ee=!1,ge()}}async function be(){if(D.length>0){let{error:je,value:Ze}=D.shift();if(je)throw je;return ge(),{done:!1,value:Ze}}if(J)return{done:!0,value:void 0};let Te=s();return Q.push(Te),ge(),Te.promise}let Ke={next:be,[Symbol.asyncIterator]:()=>Ke};return Ke}function*a(I,U){let V=[],D;try{for(let Q of U)V.push(Q),!(V.length<=I)&&(yield V.shift())}catch(Q){D=Q}for(let Q of V)yield Q;if(D)throw D}function c(I,U){return U===void 0?V=>c(I,V):I===0?U:U[Symbol.asyncIterator]?o(I,U):a(I,U)}async function u(I){let U=[];for await(let V of I)U.push(V);return U}function l(I){return I[Symbol.asyncIterator]?u(I):Array.from(I)}async function*d(I){for await(let U of I)yield*U}function*h(I){for(let U of I)yield*U}function y(...I){return I.find(V=>V[Symbol.asyncIterator]!==void 0)?d(I):h(I)}async function g(I){for await(let U of I);}function m(I){if(I[Symbol.asyncIterator])return g(I);for(let U of I);}async function*E(I,U){for await(let V of U)await I(V)&&(yield V)}function v(I,U){return U===void 0?V=>E(I,V):E(I,U)}async function*A(I){for await(let U of I)U&&typeof U!="string"&&(U[Symbol.iterator]||U[Symbol.asyncIterator])?yield*A(U):yield U}async function*R(I,U){for await(let V of U)yield await I(V)}function F(I,U){return U===void 0?V=>R(I,V):R(I,U)}function q(I,U){return U===void 0?V=>q(I,V):v(V=>V!=null,A(F(I,U)))}function N(I,U,V){let D=n(V),Q=[],ee=[],J=!1,ue=!1,ge=0,be=null;function Ke(){for(;ee.length>0&&Q.length>0;){let{resolve:Ve}=ee.shift(),ht=Q.shift();Ve({done:!1,value:ht})}for(;ee.length>0&&ge===0&&J;){let{resolve:Ve,reject:ht}=ee.shift();be?(ht(be),be=null):Ve({done:!0,value:void 0})}}async function Te(){if(J){Ke();return}if(!ue&&!(ge+Q.length>=I)){ue=!0,ge++;try{let{done:Ve,value:ht}=await D.next();Ve?(J=!0,ge--,Ke()):je(ht)}catch(Ve){J=!0,ge--,be=Ve,Ke()}ue=!1,Te()}}async function je(Ve){try{let ht=await U(Ve);if(ht&&ht[Symbol.asyncIterator])for await(let Ht of ht)Q.push(Ht);else Q.push(ht)}catch(ht){J=!0,be=ht}ge--,Ke(),Te()}async function Ze(){if(Q.length===0){let ht=s();return ee.push(ht),Te(),ht.promise}let Ve=Q.shift();return Te(),{done:!1,value:Ve}}let ze={next:Ze,[Symbol.asyncIterator]:()=>ze};return ze}function z(I,U,V){return U===void 0?(D,Q)=>Q?z(I,D,Q):z(I,D):V===void 0?D=>z(I,U,D):v(D=>D!=null,A(N(I,U,V)))}async function G(I){return new Promise(U=>{I.once("readable",()=>{U()})})}async function*Y(I){for(;;){let U=I.read();if(U!==null){yield U;continue}if(I._readableState.ended)break;await G(I)}}function P(I){return typeof I[Symbol.asyncIterator]=="function"?I:Y(I)}async function*b(...I){let U=new Set(I.map(n));for(;U.size>0;)for(let V of U){let D=await V.next();D.done?U.delete(V):yield D.value}}function w(I,...U){let V=I();for(let D of U)V=D(V);return V}async function*S(I,U,V){let D=null,Q=ge=>({value:U(ge)}),ee=async function*(ge){for await(let be of ge){if(D)return;yield be}},J=w(()=>V,c(1),ee,F(Q),c(I-1)),ue=n(J);for(;;){let{value:ge,done:be}=await ue.next();if(be)break;try{let Ke=await ge.value;D||(yield Ke)}catch(Ke){D=Ke}}if(D)throw D}function C(I,U,V){return U===void 0?(D,Q)=>C(I,D,Q):V===void 0?D=>C(I,U,D):I===1?F(U,V):S(I,U,V)}function B(I,U,V){return U===void 0?(D,Q)=>Q?B(I,D,Q):B(I,D):V===void 0?D=>B(I,U,D):v(D=>D!=null,A(C(I,U,V)))}async function*W(...I){let U=I.map(n),V=new Set,D=new Map,Q=null,ee=null,J=null,ue=Te=>{Q=Te,ee&&ee(Te)},ge=Te=>{J&&J(Te)},be=()=>new Promise((Te,je)=>{if(Q&&je(Q),D.size>0)return Te();J=Te,ee=je}),Ke=Te=>{let je=Promise.resolve(Te.next()).then(async({done:Ze,value:ze})=>{Ze||D.set(Te,ze),V.delete(je)});V.add(je),je.then(ge,ue)};for(let Te of U)Ke(Te);for(;;){if(V.size===0&&D.size===0)return;await be();for(let[Te,je]of D)D.delete(Te),yield je,Ke(Te)}}async function j(I,U,V){let D=U;for await(let Q of V)D=await I(D,Q);return D}function M(I,U,V){return U===void 0?(D,Q)=>Q?j(I,D,Q):M(I,D):V===void 0?D=>M(I,U,D):j(I,U,V)}async function*_(I,U){let V=0;for await(let D of U)if(yield await D,V++,V>=I)break}function*L(I,U){let V=0;for(let D of U)if(yield D,V++,V>=I)break}function ce(I,U){return U===void 0?V=>ce(I,V):U[Symbol.asyncIterator]?_(I,U):L(I,U)}async function*X(I,U){for await(let V of U)await I(V),yield V}function ne(I,U){return U===void 0?V=>X(I,V):X(I,U)}function oe(I,U){let V=I[0]+U[0],D=I[1]+U[1];if(D>=1e9){let Q=D%1e9;V+=(D-Q)/1e9,D=Q}return[V,D]}async function*he(I,U){let V=U[Symbol.asyncIterator](),D=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=await V.next(),ue=process.hrtime(Q);if(D=oe(D,ue),I.progress&&I.progress(ue,D),J)return I.total&&I.total(D),ee;yield ee}}function*pe(I,U){let V=U[Symbol.iterator](),D=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=V.next(),ue=process.hrtime(Q);if(D=oe(D,ue),I.progress&&I.progress(ue,D),J)return I.total&&I.total(D),ee;yield ee}}function _e(I={},U){return U===void 0?V=>_e(I,V):U[Symbol.asyncIterator]!==void 0?he(I,U):pe(I,U)}function k(I,U,V){let D=n(V),Q=[],ee=[],J=!1,ue=!1,ge=0,be=null;function Ke(){for(;ee.length>0&&Q.length>0;){let{resolve:Ve}=ee.shift(),ht=Q.shift();Ve({done:!1,value:ht})}for(;ee.length>0&&ge===0&&J;){let{resolve:Ve,reject:ht}=ee.shift();be?(ht(be),be=null):Ve({done:!0,value:void 0})}}async function Te(){if(J){Ke();return}if(!ue&&!(ge+Q.length>=I)){ue=!0,ge++;try{let{done:Ve,value:ht}=await D.next();Ve?(J=!0,ge--,Ke()):je(ht)}catch(Ve){J=!0,ge--,be=Ve,Ke()}ue=!1,Te()}}async function je(Ve){try{let ht=await U(Ve);Q.push(ht)}catch(ht){J=!0,be=ht}ge--,Ke(),Te()}async function Ze(){if(Q.length===0){let ht=s();return ee.push(ht),Te(),ht.promise}let Ve=Q.shift();return Te(),{done:!1,value:Ve}}let ze={next:Ze,[Symbol.asyncIterator]:()=>ze};return ze}function K(I,U,V){return U===void 0?(D,Q)=>Q?K(I,D,Q):K(I,D):V===void 0?D=>K(I,U,D):k(I,U,V)}async function $(I,U){let V=null,D=null,Q=null,ee=be=>{V=be,D&&D(be)},J=()=>{Q&&Q()},ue=()=>{I.removeListener("error",ee),I.removeListener("drain",J)};I.once("error",ee);let ge=()=>new Promise((be,Ke)=>{if(V)return Ke(V);I.once("drain",J),Q=be,D=Ke});for await(let be of U)if(I.write(be)===!1&&await ge(),V)break;if(ue(),V)throw V}function Z(I,U){return U===void 0?V=>$(I,V):$(I,U)}t.batch=i,t.buffer=c,t.collect=l,t.concat=y,t.consume=m,t.filter=v,t.flatMap=q,t.flatTransform=z,t.flatten=A,t.fromStream=P,t.getIterator=n,t.map=F,t.merge=b,t.parallelFlatMap=B,t.parallelMap=C,t.parallelMerge=W,t.pipeline=w,t.reduce=M,t.take=ce,t.tap=ne,t.time=_e,t.transform=K,t.writeToStream=Z,Object.defineProperty(t,"__esModule",{value:!0})})});var G4=p(kW=>{f();"use strict";var{CID:$4}=(Ae(),ke),aUe=ae();kW.cleanCid=t=>{if(t instanceof $4)return t;if(typeof t=="string")return $4.parse(t);if(t instanceof Uint8Array)return $4.decode(t);throw aUe(new Error("Invalid CID"),"ERR_INVALID_CID")}});var NW=p((VRt,qW)=>{f();"use strict";var cUe=ae(),{parallelMap:uUe,filter:lUe}=gp(),{pipe:fUe}=Er(),{cleanCid:dUe}=G4(),hUe=Ce(),pUe=8;qW.exports=({repo:t})=>{async function*e(r,i={}){Array.isArray(r)||(r=[r]);let n=await t.gcLock.writeLock();try{yield*fUe(r,uUe(pUe,async s=>{s=dUe(s);let o={cid:s};try{if(!await t.blocks.has(s))throw cUe(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await t.blocks.delete(s)}catch(a){i.force||(a.message=`cannot remove ${s}: ${a.message}`,o.error=a)}return o}),lUe(()=>!i.quiet))}finally{n()}}return hUe(e)}});var BW=p((zRt,DW)=>{f();"use strict";var{cleanCid:yUe}=G4(),gUe=Ce();DW.exports=({repo:t,preload:e})=>{async function r(i,n={}){i=yUe(i),n.preload!==!1&&e(i);let s=await t.blocks.get(i);return{cid:i,size:s.length}}return gUe(r)}});var UW=p((HRt,LW)=>{f();"use strict";var bUe=RW(),mUe=CW(),vUe=NW(),wUe=BW(),MW=class{constructor({codecs:e,hashers:r,preload:i,repo:n}){this.get=bUe({preload:i,repo:n}),this.put=mUe({codecs:e,hashers:r,preload:i,repo:n}),this.rm=vUe({repo:n}),this.stat=wUe({preload:i,repo:n})}};LW.exports=MW});var KW=p(($Rt,FW)=>{f();"use strict";var _Ue=Fn();FW.exports=({addAll:t})=>{async function e(r,i={}){let n=await _Ue(t(r,i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}});var jW=p((ub,g_)=>{f();(function(t,e){"use strict";var r={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(y){if(!Array.isArray(y)&&!ArrayBuffer.isView(y))return!1;for(var g=0;g<y.length;g++)if(!Number.isInteger(y[g])||y[g]<0||y[g]>255)return!1;return!0}function n(y,g){return(y&65535)*g+(((y>>>16)*g&65535)<<16)}function s(y,g){return y<<g|y>>>32-g}function o(y){return y^=y>>>16,y=n(y,2246822507),y^=y>>>13,y=n(y,3266489909),y^=y>>>16,y}function a(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]+g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]+g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]+g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]+g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function c(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var m=[0,0,0,0];return m[3]+=y[3]*g[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=y[2]*g[3],m[1]+=m[2]>>>16,m[2]&=65535,m[2]+=y[3]*g[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=y[1]*g[3],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[2]*g[2],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=y[3]*g[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=y[0]*g[3]+y[1]*g[2]+y[2]*g[1]+y[3]*g[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function u(y,g){return g%=64,g===32?[y[1],y[0]]:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g|y[0]>>>32-g]:(g-=32,[y[1]<<g|y[0]>>>32-g,y[0]<<g|y[1]>>>32-g])}function l(y,g){return g%=64,g===0?y:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g]:[y[1]<<g-32,0]}function d(y,g){return[y[0]^g[0],y[1]^g[1]]}function h(y){return y=d(y,[0,y[0]>>>1]),y=c(y,[4283543511,3981806797]),y=d(y,[0,y[0]>>>1]),y=c(y,[3301882366,444984403]),y=d(y,[0,y[0]>>>1]),y}r.x86.hash32=function(y,g){if(r.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%4,E=y.length-m,v=g,A=0,R=3432918353,F=461845907,q=0;q<E;q=q+4)A=y[q]|y[q+1]<<8|y[q+2]<<16|y[q+3]<<24,A=n(A,R),A=s(A,15),A=n(A,F),v^=A,v=s(v,13),v=n(v,5)+3864292196;switch(A=0,m){case 3:A^=y[q+2]<<16;case 2:A^=y[q+1]<<8;case 1:A^=y[q],A=n(A,R),A=s(A,15),A=n(A,F),v^=A}return v^=y.length,v=o(v),v>>>0},r.x86.hash128=function(y,g){if(r.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,E=y.length-m,v=g,A=g,R=g,F=g,q=0,N=0,z=0,G=0,Y=597399067,P=2869860233,b=951274213,w=2716044179,S=0;S<E;S=S+16)q=y[S]|y[S+1]<<8|y[S+2]<<16|y[S+3]<<24,N=y[S+4]|y[S+5]<<8|y[S+6]<<16|y[S+7]<<24,z=y[S+8]|y[S+9]<<8|y[S+10]<<16|y[S+11]<<24,G=y[S+12]|y[S+13]<<8|y[S+14]<<16|y[S+15]<<24,q=n(q,Y),q=s(q,15),q=n(q,P),v^=q,v=s(v,19),v+=A,v=n(v,5)+1444728091,N=n(N,P),N=s(N,16),N=n(N,b),A^=N,A=s(A,17),A+=R,A=n(A,5)+197830471,z=n(z,b),z=s(z,17),z=n(z,w),R^=z,R=s(R,15),R+=F,R=n(R,5)+2530024501,G=n(G,w),G=s(G,18),G=n(G,Y),F^=G,F=s(F,13),F+=v,F=n(F,5)+850148119;switch(q=0,N=0,z=0,G=0,m){case 15:G^=y[S+14]<<16;case 14:G^=y[S+13]<<8;case 13:G^=y[S+12],G=n(G,w),G=s(G,18),G=n(G,Y),F^=G;case 12:z^=y[S+11]<<24;case 11:z^=y[S+10]<<16;case 10:z^=y[S+9]<<8;case 9:z^=y[S+8],z=n(z,b),z=s(z,17),z=n(z,w),R^=z;case 8:N^=y[S+7]<<24;case 7:N^=y[S+6]<<16;case 6:N^=y[S+5]<<8;case 5:N^=y[S+4],N=n(N,P),N=s(N,16),N=n(N,b),A^=N;case 4:q^=y[S+3]<<24;case 3:q^=y[S+2]<<16;case 2:q^=y[S+1]<<8;case 1:q^=y[S],q=n(q,Y),q=s(q,15),q=n(q,P),v^=q}return v^=y.length,A^=y.length,R^=y.length,F^=y.length,v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,v=o(v),A=o(A),R=o(R),F=o(F),v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,("00000000"+(v>>>0).toString(16)).slice(-8)+("00000000"+(A>>>0).toString(16)).slice(-8)+("00000000"+(R>>>0).toString(16)).slice(-8)+("00000000"+(F>>>0).toString(16)).slice(-8)},r.x64.hash128=function(y,g){if(r.inputValidation&&!i(y))return e;g=g||0;for(var m=y.length%16,E=y.length-m,v=[0,g],A=[0,g],R=[0,0],F=[0,0],q=[2277735313,289559509],N=[1291169091,658871167],z=0;z<E;z=z+16)R=[y[z+4]|y[z+5]<<8|y[z+6]<<16|y[z+7]<<24,y[z]|y[z+1]<<8|y[z+2]<<16|y[z+3]<<24],F=[y[z+12]|y[z+13]<<8|y[z+14]<<16|y[z+15]<<24,y[z+8]|y[z+9]<<8|y[z+10]<<16|y[z+11]<<24],R=c(R,q),R=u(R,31),R=c(R,N),v=d(v,R),v=u(v,27),v=a(v,A),v=a(c(v,[0,5]),[0,1390208809]),F=c(F,N),F=u(F,33),F=c(F,q),A=d(A,F),A=u(A,31),A=a(A,v),A=a(c(A,[0,5]),[0,944331445]);switch(R=[0,0],F=[0,0],m){case 15:F=d(F,l([0,y[z+14]],48));case 14:F=d(F,l([0,y[z+13]],40));case 13:F=d(F,l([0,y[z+12]],32));case 12:F=d(F,l([0,y[z+11]],24));case 11:F=d(F,l([0,y[z+10]],16));case 10:F=d(F,l([0,y[z+9]],8));case 9:F=d(F,[0,y[z+8]]),F=c(F,N),F=u(F,33),F=c(F,q),A=d(A,F);case 8:R=d(R,l([0,y[z+7]],56));case 7:R=d(R,l([0,y[z+6]],48));case 6:R=d(R,l([0,y[z+5]],40));case 5:R=d(R,l([0,y[z+4]],32));case 4:R=d(R,l([0,y[z+3]],24));case 3:R=d(R,l([0,y[z+2]],16));case 2:R=d(R,l([0,y[z+1]],8));case 1:R=d(R,[0,y[z]]),R=c(R,q),R=u(R,31),R=c(R,N),v=d(v,R)}return v=d(v,[0,y.length]),A=d(A,[0,y.length]),v=a(v,A),A=a(A,v),v=h(v),A=h(A),v=a(v,A),A=a(A,v),("00000000"+(v[0]>>>0).toString(16)).slice(-8)+("00000000"+(v[1]>>>0).toString(16)).slice(-8)+("00000000"+(A[0]>>>0).toString(16)).slice(-8)+("00000000"+(A[1]>>>0).toString(16)).slice(-8)},typeof ub!="undefined"?(typeof g_!="undefined"&&g_.exports&&(ub=g_.exports=r),ub.murmurHash3=r):typeof define=="function"&&define.amd?define([],function(){return r}):(r._murmurHash3=t.murmurHash3,r.noConflict=function(){return t.murmurHash3=r._murmurHash3,r._murmurHash3=e,r.noConflict=e,r},t.murmurHash3=r)})(ub)});var W4=p((GRt,VW)=>{f();VW.exports=jW()});var b_=p((WRt,zW)=>{f();"use strict";var EUe=hr().bind({ignoreUndefined:!0}),{sha256:SUe}=(ei(),Ur),xUe=W4(),AUe=ct();async function IUe(t){return AUe(xUe.x64.hash128(t),"base16").slice(0,8).reverse()}var TUe={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:SUe,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:IUe,hamtHashCode:34,hamtBucketBits:8};zW.exports=function(t={}){return EUe(TUe,t)}});var Af=p((YRt,GW)=>{f();"use strict";var{CID:RUe}=(Ae(),ke),HW=(xt(),St),{sha256:$W}=(ei(),Ur),PUe=async(t,e,r)=>{r.codec||(r.codec=HW),r.hasher||(r.hasher=$W),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===HW&&r.hasher!==$W&&(r.cidVersion=1);let i=await r.hasher.digest(t),n=RUe.create(r.cidVersion,r.codec.code,i);return r.onlyHash||await e.put(n,t,{signal:r.signal}),n};GW.exports=PUe});var YW=p((XRt,WW)=>{f();"use strict";var{UnixFS:CUe}=yi(),OUe=Af(),{encode:kUe,prepare:qUe}=(xt(),St),NUe=async(t,e,r)=>{let i=new CUe({type:"directory",mtime:t.mtime,mode:t.mode}),n=kUe(qUe({Data:i.marshal()})),s=await OUe(n,e,r),o=t.path;return{cid:s,path:o,unixfs:i,size:n.length}};WW.exports=NUe});var QW=p((QRt,XW)=>{f();"use strict";var DUe=Hh();XW.exports=async function(t,e){return e(await DUe(t))}});var eY=p((ZRt,JW)=>{f();"use strict";var BUe=Ww();function MUe(t,e,r){return ZW(t,e,r)}async function ZW(t,e,r){let i=[];for await(let n of BUe(t,r.maxChildrenPerNode))i.push(await e(n));return i.length>1?ZW(i,e,r):i[0]}JW.exports=MUe});var iY=p((JRt,rY)=>{f();"use strict";var LUe=Ww();rY.exports=async function(e,r,i){let n=new tY(i.layerRepeat),s=0,o=1,a=n;for await(let c of LUe(e,i.maxChildrenPerNode))a.isFull()&&(a!==n&&n.addChild(await a.reduce(r)),s&&s%i.layerRepeat==0&&o++,a=new Y4(o,i.layerRepeat,s),s++),a.append(c);return a&&a!==n&&n.addChild(await a.reduce(r)),n.reduce(r)};var Y4=class{constructor(e,r,i=0){this.maxDepth=e,this.layerRepeat=r,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let r={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(r),this.currentDepth=r.depth,this.node=r}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,r){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,r)))),r((e.data||[]).concat(i))}_findParent(e,r){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,r):i}},tY=class extends Y4{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}});var oY=p((e8t,sY)=>{f();"use strict";var{UnixFS:UUe}=yi(),FUe=Af(),nY=(xt(),St),KUe=(Es(),Zn);async function*jUe(t,e,r){for await(let i of t.content)yield async()=>{r.progress(i.length,t.path);let n,s={codec:nY,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(s.codec=KUe,s.cidVersion=1):(n=new UUe({type:r.leafType,data:i,mtime:t.mtime,mode:t.mode}),i=nY.encode({Data:n.marshal(),Links:[]})),{cid:await FUe(i,e,s),unixfs:n,size:i.length}}}sY.exports=jUe});var dY=p((t8t,fY)=>{f();"use strict";var VUe=ae(),{UnixFS:aY}=yi(),cY=Af(),{encode:uY,prepare:lY}=(xt(),St),zUe=Yw(),X4=(Es(),Zn),HUe=(xt(),St),$Ue={flat:QW(),balanced:eY(),trickle:iY()};async function*GUe(t,e,r){let i=-1,n,s;typeof r.bufferImporter=="function"?s=r.bufferImporter:s=oY();for await(let o of zUe(s(t,e,r),r.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}var WUe=(t,e,r)=>{async function i(n){if(n.length===1&&n[0].single&&r.reduceSingleLeafToSelf){let l=n[0];if(l.cid.code===X4.code&&(t.mtime!==void 0||t.mode!==void 0)){let d=await e.get(l.cid);l.unixfs=new aY({type:"file",mtime:t.mtime,mode:t.mode,data:d}),d=uY(lY({Data:l.unixfs.marshal()})),l.cid=await cY(d,e,{...r,codec:HUe,hasher:r.hasher,cidVersion:r.cidVersion}),l.size=d.length}return{cid:l.cid,path:t.path,unixfs:l.unixfs,size:l.size}}let s=new aY({type:"file",mtime:t.mtime,mode:t.mode}),o=n.filter(l=>l.cid.code===X4.code&&l.size||l.unixfs&&!l.unixfs.data&&l.unixfs.fileSize()?!0:Boolean(l.unixfs&&l.unixfs.data&&l.unixfs.data.length)).map(l=>l.cid.code===X4.code?(s.addBlockSize(l.size),{Name:"",Tsize:l.size,Hash:l.cid}):(!l.unixfs||!l.unixfs.data?s.addBlockSize(l.unixfs&&l.unixfs.fileSize()||0):s.addBlockSize(l.unixfs.data.length),{Name:"",Tsize:l.size,Hash:l.cid})),a={Data:s.marshal(),Links:o},c=uY(lY(a));return{cid:await cY(c,e,r),path:t.path,unixfs:s,size:c.length+a.Links.reduce((l,d)=>l+d.Tsize,0)}}return i};function YUe(t,e,r){let i=$Ue[r.strategy];if(!i)throw VUe(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return i(GUe(t,e,r),WUe(t,e,r),r)}fY.exports=YUe});var ln=p((r8t,pY)=>{f();"use strict";var{Buffer:Ro}=Ut(),hY=Symbol.for("BufferList");function or(t){if(!(this instanceof or))return new or(t);or._init.call(this,t)}or._init=function(e){Object.defineProperty(this,hY,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};or.prototype._new=function(e){return new or(e)};or.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};or.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};or.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};or.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};or.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Ro.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&r||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Ro.concat(this._bufs,this.length);for(let d=0;d<this._bufs.length;d++)this._bufs[d].copy(e,u),u+=this._bufs[d].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,r,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Ro.allocUnsafe(a));for(let d=o[0];d<this._bufs.length;d++){let h=this._bufs[d].length-l;if(c>h)this._bufs[d].copy(e,u,l),u+=h;else{this._bufs[d].copy(e,u,l,l+c),u+=h;break}c-=h,l&&(l=0)}return e.length>u?e.slice(0,u):e};or.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};or.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};or.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};or.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};or.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Ro.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Ro.from(e));return this};or.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};or.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Ro.from([t]):typeof t=="string"?t=Ro.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Ro.from(t.buffer,t.byteOffset,t.byteLength):Ro.isBuffer(t)||(t=Ro.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};or.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?or.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:or.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();or.prototype._isBufferList=function(e){return e instanceof or||or.isBufferList(e)};or.isBufferList=function(e){return e!=null&&e[hY]};pY.exports=or});var bY=p((i8t,gY)=>{f();var yY=class{constructor(e,r=12,i=8*1024,n=32*1024,s=64,o){this.bits=r,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(r,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:r,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),u=r(n(o,c)),l=r(n(a,e)),d=this.rabin.fingerprint(l,u),h=s(d);i(l),i(u);let y=h.indexOf(0);return y>=0?h.subarray(0,y):h}};gY.exports=yY});var CY=p(db=>{f();"use strict";var Q4=-8,m_=-4,XUe=0,mY=1,vY=1<<0,v_=1<<1,n8t=1<<2,s8t=1<<3,wY=5,o8t=1<<wY,_Y=1<<10,EY=1<<11,a8t=1<<12,QUe=1<<13,SY=14,c8t=1<<SY,u8t=1<<19,l8t=1<<20,f8t=1<<21,d8t=1<<22,ZUe=0,Z4=4,JUe=8,eFe=12,xY=12,tFe=16,rFe=typeof BigUint64Array!="undefined",lb=Symbol(),fb=1024;function AY(t,e){let r=new Uint32Array(t),i=new Uint16Array(t);var n=r[e+m_>>>2]>>>1,s=e>>>1;if(n<=fb)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+fb-1],c=a>=55296&&a<56320?fb-1:fb;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>fb);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function J4(t){let e={};function r(n,s){return n?AY(n.buffer,s):"<yet unknown>"}let i=t.env=t.env||{};return i.abort=i.abort||function(s,o,a,c){let u=e.memory||i.memory;throw Error("abort: "+r(u,s)+" at "+r(u,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+r(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},t.Math=t.Math||Math,t.Date=t.Date||Date,e}function e5(t,e){let r=e.exports,i=r.memory,n=r.table,s=r.__alloc,o=r.__retain,a=r.__rtti_base||~0;function c(N){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((N>>>=0)>=G)throw Error("invalid id: "+N);return z[(a+4>>>2)+N*2]}function u(N){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((N>>>=0)>=G)throw Error("invalid id: "+N);return z[(a+4>>>2)+N*2+1]}function l(N){return 31-Math.clz32(N>>>wY&31)}function d(N){return 31-Math.clz32(N>>>SY&31)}function h(N){let z=N.length,G=s(z<<1,mY),Y=new Uint16Array(i.buffer);for(var P=0,b=G>>>1;P<z;++P)Y[b+P]=N.charCodeAt(P);return G}t.__allocString=h;function y(N){let z=i.buffer;if(new Uint32Array(z)[N+Q4>>>2]!==mY)throw Error("not a string: "+N);return AY(z,N)}t.__getString=y;function g(N,z,G){let Y=i.buffer;if(G)switch(N){case 2:return new Float32Array(Y);case 3:return new Float64Array(Y)}else switch(N){case 0:return new(z?Int8Array:Uint8Array)(Y);case 1:return new(z?Int16Array:Uint16Array)(Y);case 2:return new(z?Int32Array:Uint32Array)(Y);case 3:return new(z?BigInt64Array:BigUint64Array)(Y)}throw Error("unsupported align: "+N)}function m(N,z){let G=c(N);if(!(G&(vY|v_)))throw Error("not an array: "+N+" @ "+G);let Y=l(G),P=z.length,b=s(P<<Y,XUe),w=s(G&v_?tFe:eFe,N),S=new Uint32Array(i.buffer);S[w+ZUe>>>2]=o(b),S[w+Z4>>>2]=b,S[w+JUe>>>2]=P<<Y,G&v_&&(S[w+xY>>>2]=P);let C=g(Y,G&_Y,G&EY);if(G&QUe)for(let B=0;B<P;++B)C[(b>>>Y)+B]=o(z[B]);else C.set(z,b>>>Y);return w}t.__allocArray=m;function E(N){let z=new Uint32Array(i.buffer),G=z[N+Q4>>>2],Y=c(G);if(!(Y&vY))throw Error("not an array: "+G);let P=l(Y);var b=z[N+Z4>>>2];let w=Y&v_?z[N+xY>>>2]:z[b+m_>>>2]>>>P;return g(P,Y&_Y,Y&EY).subarray(b>>>=P,b+w)}t.__getArrayView=E;function v(N){let z=E(N),G=z.length,Y=new Array(G);for(let P=0;P<G;P++)Y[P]=z[P];return Y}t.__getArray=v;function A(N){let z=i.buffer,G=new Uint32Array(z)[N+m_>>>2];return z.slice(N,N+G)}t.__getArrayBuffer=A;function R(N,z,G){return new N(F(N,z,G))}function F(N,z,G){let Y=i.buffer,P=new Uint32Array(Y),b=P[G+Z4>>>2];return new N(Y,b,P[b+m_>>>2]>>>z)}t.__getInt8Array=R.bind(null,Int8Array,0),t.__getInt8ArrayView=F.bind(null,Int8Array,0),t.__getUint8Array=R.bind(null,Uint8Array,0),t.__getUint8ArrayView=F.bind(null,Uint8Array,0),t.__getUint8ClampedArray=R.bind(null,Uint8ClampedArray,0),t.__getUint8ClampedArrayView=F.bind(null,Uint8ClampedArray,0),t.__getInt16Array=R.bind(null,Int16Array,1),t.__getInt16ArrayView=F.bind(null,Int16Array,1),t.__getUint16Array=R.bind(null,Uint16Array,1),t.__getUint16ArrayView=F.bind(null,Uint16Array,1),t.__getInt32Array=R.bind(null,Int32Array,2),t.__getInt32ArrayView=F.bind(null,Int32Array,2),t.__getUint32Array=R.bind(null,Uint32Array,2),t.__getUint32ArrayView=F.bind(null,Uint32Array,2),rFe&&(t.__getInt64Array=R.bind(null,BigInt64Array,3),t.__getInt64ArrayView=F.bind(null,BigInt64Array,3),t.__getUint64Array=R.bind(null,BigUint64Array,3),t.__getUint64ArrayView=F.bind(null,BigUint64Array,3)),t.__getFloat32Array=R.bind(null,Float32Array,2),t.__getFloat32ArrayView=F.bind(null,Float32Array,2),t.__getFloat64Array=R.bind(null,Float64Array,3),t.__getFloat64ArrayView=F.bind(null,Float64Array,3);function q(N,z){let G=new Uint32Array(i.buffer);var Y=G[N+Q4>>>2];if(Y<=G[a>>>2])do if(Y==z)return!0;while(Y=u(Y));return!1}return t.__instanceof=q,t.memory=t.memory||i,t.table=t.table||n,PY(r,t)}function IY(t){return typeof Response!="undefined"&&t instanceof Response}async function TY(t,e){return IY(t=await t)?RY(t,e):e5(J4(e||(e={})),await WebAssembly.instantiate(t instanceof WebAssembly.Module?t:await WebAssembly.compile(t),e))}db.instantiate=TY;function iFe(t,e){return e5(J4(e||(e={})),new WebAssembly.Instance(t instanceof WebAssembly.Module?t:new WebAssembly.Module(t),e))}db.instantiateSync=iFe;async function RY(t,e){return WebAssembly.instantiateStreaming?e5(J4(e||(e={})),(await WebAssembly.instantiateStreaming(t,e)).instance):TY(IY(t=await t)?t.arrayBuffer():t,e)}db.instantiateStreaming=RY;function PY(t,e){var r=e?Object.create(e):{},i=t.__argumentsLength?function(n){t.__argumentsLength.value=n}:t.__setArgumentsLength||t.__setargc||function(){};for(let n in t){if(!Object.prototype.hasOwnProperty.call(t,n))continue;let s=t[n],o=n.split("."),a=r;for(;o.length>1;){let l=o.shift();Object.prototype.hasOwnProperty.call(a,l)||(a[l]={}),a=a[l]}let c=o[0],u=c.indexOf("#");if(u>=0){let l=c.substring(0,u),d=a[l];if(typeof d=="undefined"||!d.prototype){let h=function(...y){return h.wrap(h.prototype.constructor(0,...y))};h.prototype={valueOf:function(){return this[lb]}},h.wrap=function(y){return Object.create(h.prototype,{[lb]:{value:y,writable:!1}})},d&&Object.getOwnPropertyNames(d).forEach(y=>Object.defineProperty(h,y,Object.getOwnPropertyDescriptor(d,y))),a[l]=h}if(c=c.substring(u+1),a=a[l].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let h=t[n.replace("set:","get:")],y=t[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return h(this[lb])},set:function(g){y(this[lb],g)},enumerable:!0})}}else c==="constructor"?(a[c]=(...h)=>(i(h.length),s(...h))).original=s:(a[c]=function(...h){return i(h.length),s(this[lb],...h)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:t[n.replace("set:","get:")],set:t[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...l)=>(i(l.length),s(...l))).original=s:a[c]=s}return r}db.demangle=PY});var kY=p((p8t,OY)=>{f();var{instantiate:nFe}=CY();t5.supported=typeof WebAssembly!="undefined";function t5(t={}){if(!t5.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return nFe(new Response(new Blob([e],{type:"application/wasm"})),t)}OY.exports=t5});var DY=p((y8t,NY)=>{f();var qY=bY(),sFe=kY(),oFe=async(t,e,r,i,n)=>{let s=await sFe();return new qY(s,t,e,r,i,n)};NY.exports={Rabin:qY,create:oFe}});var LY=p((g8t,MY)=>{f();"use strict";var aFe=ln(),{create:cFe}=DY(),BY=ae();MY.exports=async function*(e,r){let i,n,s;if(r.minChunkSize&&r.maxChunkSize&&r.avgChunkSize)s=r.avgChunkSize,i=r.minChunkSize,n=r.maxChunkSize;else if(r.avgChunkSize)s=r.avgChunkSize,i=s/3,n=s+s/2;else throw BY(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(i<16)throw BY(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<i&&(n=i),s<i&&(s=i);let o=Math.floor(Math.log2(s));for await(let a of uFe(e,{min:i,max:n,bits:o,window:r.window,polynomial:r.polynomial}))yield a};async function*uFe(t,e){let r=await cFe(e.bits,e.min,e.max,e.window),i=new aFe;for await(let n of t){i.append(n);let s=r.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}});var FY=p((b8t,UY)=>{f();"use strict";var r5=ln();UY.exports=async function*(e,r){let i=new r5,n=0,s=!1,o=r.maxChunkSize;for await(let a of e)for(i.append(a),n+=a.length;n>=o;)if(yield i.slice(0,o),s=!0,o===i.length)i=new r5,n=0;else{let c=new r5;c.append(i.shallowSlice(o)),i=c,n-=o}(!s||n)&&(yield i.slice(0,n))}});var VY=p((m8t,jY)=>{f();"use strict";var KY=ae(),lFe=ct();async function*fFe(t){for await(let e of t){if(e.length===void 0)throw KY(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield lFe(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw KY(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}jY.exports=fFe});var $Y=p((v8t,HY)=>{f();"use strict";var dFe=YW(),hFe=dY(),zY=ae();function pFe(t){return Symbol.iterator in t}function yFe(t){return Symbol.asyncIterator in t}function gFe(t){try{if(t instanceof Uint8Array)return async function*(){yield t}();if(pFe(t))return async function*(){yield*t}();if(yFe(t))return t}catch{throw zY(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw zY(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*bFe(t,e,r){for await(let i of t)if(i.path&&(i.path.substring(0,2)==="./"&&(r.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof r.chunker=="function"?n=r.chunker:r.chunker==="rabin"?n=LY():n=FY();let s;typeof r.chunkValidator=="function"?s=r.chunkValidator:s=VY();let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(gFe(i.content),r),r)};yield()=>hFe(o,e,r)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>dFe(n,e,r)}else throw new Error("Import candidate must have content or path or both")}HY.exports=bFe});var w_=p((w8t,WY)=>{f();"use strict";var GY=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}};WY.exports=GY});var i5=p((_8t,QY)=>{f();"use strict";var{encode:mFe,prepare:vFe}=(xt(),St),{UnixFS:wFe}=yi(),YY=w_(),_Fe=Af(),XY=class extends YY{constructor(e,r){super(e,r);this._children={}}async put(e,r){this.cid=void 0,this.size=void 0,this._children[e]=r}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let r=0;r<e.length;r++){let i=e[r];yield{key:i,child:this._children[i]}}}async*flush(e){let r=Object.keys(this._children),i=[];for(let u=0;u<r.length;u++){let l=this._children[r[u]];if(l instanceof YY)for await(let d of l.flush(e))l=d,yield l;l.size!=null&&l.cid&&i.push({Name:r[u],Tsize:l.size,Hash:l.cid})}let n=new wFe({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:i},o=mFe(vFe(s)),a=await _Fe(o,e,this.options),c=o.length+s.Links.reduce((u,l)=>u+(l.Tsize==null?0:l.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}};QY.exports=XY});var eX=p((S8t,JY)=>{f();"use strict";var __=7;JY.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,r){let i=this._internalPositionFor(e,!1);if(r===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,r,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let r=this._internalPositionFor(e,!0);if(r!==-1)return this._data[r][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let r=0;for(;r<this.length;)e(this.get(r),r,this),r++}map(e){let r=0,i=new Array(this.length);for(;r<this.length;)i[r]=e(this.get(r),r,this),r++;return i}reduce(e,r){let i=0,n=r;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let r=0,i,n;for(;r<this.length&&!i;)n=this.get(r),i=e(n),r++;return i?n:void 0}_internalPositionFor(e,r){let i=this._bytePosFor(e,r);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*__;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(EFe,0),c=~(4294967295<<s+1),u=ZY(n&c);return a+u-1}_bytePosFor(e,r){let i=Math.floor(e/__),n=i+1;for(;!r&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]|=1<<e-r*__}_unsetBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]&=~(1<<e-r*__)}_setInternalPos(e,r,i,n){let s=this._data,o=[r,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=r)s.push(o);else if(s[0][0]<=r)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(SFe),this._changedData=!1}bitField(){let e=[],r=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,r),u=~(255<<c);n|=(s&u)<<8-r,s=s>>>c,i-=c,r-=c,(!r||!i&&!o.length)&&(e.push(n),n=0,r=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(xFe)}};function EFe(t,e){return t+ZY(e)}function ZY(t){let e=t;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function SFe(t,e){return t[0]-e[0]}function xFe(t){return t[1]}});var iX=p((x8t,rX)=>{f();"use strict";var AFe=eX(),IFe=ct(),Po=class{constructor(e,r,i=0){this._options=e,this._popCount=0,this._parent=r,this._posAtParent=i,this._children=new AFe,this.key=null}async put(e,r){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,r)}async get(e){let r=await this._findChild(e);if(r)return r.value}async del(e){let r=await this._findPlace(e),i=r.bucket._at(r.pos);i&&i.key===e&&r.bucket._delAt(r.pos)}leafCount(){return this._children.compactArray().reduce((r,i)=>i instanceof Po?r+i.leafCount():r+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let r of e)r instanceof Po?yield*r.eachLeafSeries():yield r;return[]}serialize(e,r){let i=[];return r(this._children.reduce((n,s,o)=>(s&&(s instanceof Po?n.push(s.serialize(e,r)):n.push(e(s,o))),n),i))}asyncTransform(e,r){return tX(this,e,r)}toJSON(){return this.serialize(RFe,PFe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let r=await this._findPlace(e),i=r.bucket._at(r.pos);if(!(i instanceof Po)&&i&&i.key===e)return i}async _findPlace(e){let r=this._options.hash(typeof e=="string"?IFe(e):e),i=await r.take(this._options.bits),n=this._children.get(i);return n instanceof Po?n._findPlace(r):{bucket:this,pos:i,hash:r,existingChild:n}}async _findNewBucketAndPos(e){let r=await this._findPlace(e);if(r.existingChild&&r.existingChild.key!==e){let i=new Po(this._options,r.bucket,r.pos);r.bucket._putObjectAt(r.pos,i);let n=await i._findPlace(r.existingChild.hash);return n.bucket._putAt(n,r.existingChild.key,r.existingChild.value),i._findNewBucketAndPos(r.hash)}return r}_putAt(e,r,i){this._putObjectAt(e.pos,{key:r,value:i,hash:e.hash})}_putObjectAt(e,r){this._children.get(e)||this._popCount++,this._children.set(e,r)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(TFe);if(e&&!(e instanceof Po)){let r=e.hash;r.untake(this._options.bits);let i={pos:this._posAtParent,hash:r,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function TFe(t){return Boolean(t)}function RFe(t,e){return t.key}function PFe(t){return t}async function tX(t,e,r){let i=[];for(let n of t._children.compactArray())if(n instanceof Po)await tX(n,e,r);else{let s=await e(n);i.push({bitField:t._children.bitField(),children:s})}return r(i)}rX.exports=Po});var sX=p((I8t,nX)=>{f();"use strict";var CFe=[255,254,252,248,240,224,192,128],OFe=[1,3,7,15,31,63,127,255];nX.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let r=e,i=0;for(;r&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,r),a=kFe(n,s-o,o);i=(i<<o)+a,r-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function kFe(t,e,r){let i=qFe(e,r);return(t&i)>>>e}function qFe(t,e){return CFe[t]&OFe[Math.min(e+t-1,7)]}});var oX=p((T8t,n5)=>{f();"use strict";var NFe=sX(),DFe=tn();function BFe(t){function e(r){return r instanceof E_?r:new E_(r,t)}return e}var E_=class{constructor(e,r){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let r=e;for(;this._availableBits<r;)await this._produceMoreBits();let i=0;for(;r>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),r),o=n.take(s);i=(i<<s)+o,r-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let r=e;for(;r>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),r);i.untake(n),r-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?DFe([this._value,Uint8Array.from([this._depth])]):this._value,r=await this._hashFn(e),i=new NFe(r);this._buffers.push(i),this._availableBits+=i.availableBits()}};n5.exports=BFe;n5.exports.InfiniteHash=E_});var S_=p((R8t,cX)=>{f();"use strict";var aX=iX(),MFe=oX();function LFe(t){if(!t||!t.hashFn)throw new Error("please define an options.hashFn");let e={bits:t.bits||8,hash:MFe(t.hashFn)};return new aX(e)}cX.exports={createHAMT:LFe,Bucket:aX}});var x_=p((P8t,fX)=>{f();"use strict";var{encode:UFe,prepare:FFe}=(xt(),St),{UnixFS:KFe}=yi(),jFe=w_(),VFe=Af(),{createHAMT:zFe,Bucket:HFe}=S_(),uX=class extends jFe{constructor(e,r){super(e,r);this._bucket=zFe({hashFn:r.hamtHashFn,bits:r.hamtBucketBits})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){for await(let r of lX(this._bucket,e,this,this.options))yield{...r,path:this.path}}};fX.exports=uX;async function*lX(t,e,r,i){let n=t._children,s=[],o=0;for(let y=0;y<n.length;y++){let g=n.get(y);if(!g)continue;let m=y.toString(16).toUpperCase().padStart(2,"0");if(g instanceof HFe){let E;for await(let v of await lX(g,e,null,i))E=v;if(!E)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:m,Tsize:E.size,Hash:E.cid}),o+=E.size}else if(typeof g.value.flush=="function"){let E=g.value,v;for await(let R of E.flush(e))v=R,yield v;let A=m+g.key;s.push({Name:A,Tsize:v.size,Hash:v.cid}),o+=v.size}else{let E=g.value;if(!E.cid)continue;let v=m+g.key,A=E.size;s.push({Name:v,Tsize:A,Hash:E.cid}),o+=A}}let a=Uint8Array.from(n.bitField().reverse()),c=new KFe({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:i.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),u={Data:c.marshal(),Links:s},l=UFe(FFe(u)),d=await VFe(l,e,i),h=l.length+o;yield{cid:d,unixfs:c,size:h}}});var hX=p((C8t,dX)=>{f();"use strict";var $Fe=x_(),GFe=i5();dX.exports=async function t(e,r,i,n){let s=r;r instanceof GFe&&r.directChildrenCount()>=i&&(s=await WFe(r,n));let o=s.parent;if(o){if(s!==r){if(e&&(e.parent=s),!s.parentKey)throw new Error("No parent key found");await o.put(s.parentKey,s)}return t(s,o,i,n)}return s};async function WFe(t,e){let r=new $Fe({root:t.root,dir:!0,parent:t.parent,parentKey:t.parentKey,path:t.path,dirty:t.dirty,flat:!1,mtime:t.mtime,mode:t.mode},e);for await(let{key:i,child:n}of t.eachChildSeries())await r.put(i,n);return r}});var yX=p((O8t,pX)=>{f();"use strict";var YFe=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);pX.exports=YFe});var wX=p((k8t,vX)=>{f();"use strict";var gX=i5(),XFe=hX(),bX=w_(),QFe=yX();async function ZFe(t,e,r){let i=QFe(t.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let u=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,t),e=await XFe(null,s,r.shardSplitThreshold,r);else{let l=await s.get(c);(!l||!(l instanceof bX))&&(l=new gX({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:l&&l.unixfs&&l.unixfs.mtime,mode:l&&l.unixfs&&l.unixfs.mode},r)),await s.put(c,l),s=l}}return e}async function*mX(t,e){if(!(t instanceof bX)){t&&t.unixfs&&t.unixfs.isDirectory()&&(yield t);return}yield*t.flush(e)}async function*JFe(t,e,r){let i=new gX({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(let n of t)!n||(i=await ZFe(n,i,r),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(r.wrapWithDirectory)yield*mX(i,e);else for await(let n of i.eachChildSeries())!n||(yield*mX(n.child,e))}vX.exports=JFe});var A_=p((q8t,_X)=>{f();"use strict";var eKe=Yw(),tKe=b_();async function*rKe(t,e,r={}){let i=tKe(r),n;typeof r.dagBuilder=="function"?n=r.dagBuilder:n=$Y();let s;typeof r.treeBuilder=="function"?s=r.treeBuilder:s=wX();let o;Symbol.asyncIterator in t||Symbol.iterator in t?o=t:o=[t];for await(let a of s(eKe(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}_X.exports={importer:rKe}});var hb=p((N8t,EX)=>{f();"use strict";async function*iKe(t,e={}){let r=t.getReader();try{for(;;){let i=await r.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&r.cancel(),r.releaseLock()}}EX.exports=iKe});var AX=p((D8t,xX)=>{f();"use strict";var SX=hb();function nKe(t){return typeof t.stream=="function"?SX(t.stream()):SX(new Response(t).body)}xX.exports=nKe});var pb=p((B8t,IX)=>{f();"use strict";function sKe(t){let[e,r]=t[Symbol.asyncIterator]?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[r](){return this}}}IX.exports=sKe});var I_=p((M8t,TX)=>{f();"use strict";function oKe(t){return ArrayBuffer.isView(t)||t instanceof ArrayBuffer}function aKe(t){return t.constructor&&(t.constructor.name==="Blob"||t.constructor.name==="File")&&typeof t.stream=="function"}function cKe(t){return typeof t=="object"&&(t.path||t.content)}var uKe=t=>t&&typeof t.getReader=="function";TX.exports={isBytes:oKe,isBlob:aKe,isFileObject:cKe,isReadableStream:uKe}});var CX=p((L8t,PX)=>{f();"use strict";var lKe=ae(),fKe=ct(),dKe=hb(),hKe=AX(),pKe=pb(),yKe=Hh(),gKe=Io(),{isBytes:RX,isReadableStream:bKe,isBlob:mKe}=I_();async function*vKe(t){if(RX(t)){yield s5(t);return}if(typeof t=="string"||t instanceof String){yield s5(t.toString());return}if(mKe(t)){yield*hKe(t);return}if(bKe(t)&&(t=dKe(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=pKe(t),{value:r,done:i}=await e.peek();if(i){yield*[];return}if(e.push(r),Number.isInteger(r)){yield Uint8Array.from(await yKe(e));return}if(RX(r)||typeof r=="string"||r instanceof String){yield*gKe(e,s5);return}}throw lKe(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}function s5(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Array.isArray(t)?Uint8Array.from(t):fKe(t.toString())}PX.exports=vKe});var o5=p((U8t,MX)=>{f();"use strict";var OX=ae(),wKe=hb(),_Ke=pb(),kX=Io(),{isBytes:qX,isBlob:NX,isReadableStream:DX,isFileObject:BX}=I_(),{parseMtime:EKe,parseMode:SKe}=yi();MX.exports=async function*(e,r){if(e==null)throw OX(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield bp(e.toString(),r);return}if(qX(e)||NX(e)){yield bp(e,r);return}if(DX(e)&&(e=wKe(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let i=_Ke(e),{value:n,done:s}=await i.peek();if(s){yield*[];return}if(i.push(n),Number.isInteger(n)||qX(n)){yield bp(i,r);return}if(BX(n)||NX(n)||typeof n=="string"||n instanceof String){yield*kX(i,o=>bp(o,r));return}if(n[Symbol.iterator]||n[Symbol.asyncIterator]||DX(n)){yield*kX(i,o=>bp(o,r));return}}if(BX(e)){yield bp(e,r);return}throw OX(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")};async function bp(t,e){let{path:r,mode:i,mtime:n,content:s}=t,o={path:r||"",mode:SKe(i),mtime:EKe(n)};return s?o.content=await e(s):r||(o.content=await e(t)),o}});var UX=p((F8t,LX)=>{f();"use strict";var xKe=CX(),AKe=o5();function IKe(t){return AKe(t,xKe)}LX.exports={normaliseInput:IKe}});var jX=p((K8t,KX)=>{f();"use strict";var TKe=t=>{if(t)if(t.startsWith("size-")){let e=t.split("-")[1],r=parseInt(e);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}else{if(t.startsWith("rabin"))return{chunker:"rabin",...FX(t)};throw new Error(`Unrecognized chunker option: ${t}`)}else return{chunker:"fixed"}},FX=t=>{let e={},r=t.split("-");switch(r.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=yb(r[1],"avg");break;case 4:e.minChunkSize=yb(r[1],"min"),e.avgChunkSize=yb(r[2],"avg"),e.maxChunkSize=yb(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},yb=(t,e)=>{let r=parseInt(t);if(isNaN(r))throw new Error(`Chunker parameter ${e} must be an integer`);return r};KX.exports={parseChunkSize:yb,parseRabinString:FX,parseChunkerString:TKe}});var zX=p((j8t,VX)=>{f();"use strict";var{importer:RKe}=A_(),{normaliseInput:PKe}=UX(),{parseChunkerString:CKe}=jX(),{pipe:OKe}=Er(),kKe=Ce(),qKe=hr().bind({ignoreUndefined:!0});VX.exports=({repo:t,preload:e,options:r})=>{let i=r&&r.sharding;async function*n(s,o={}){let a=qKe({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},o,{...CKe(o.chunker)});a.hashAlg&&a.hashAlg!=="sha2-256"&&a.cidVersion!==1&&(a.cidVersion=1),a.trickle&&(a.strategy="trickle"),a.strategy==="trickle"&&(a.leafType="raw",a.reduceSingleLeafToSelf=!1),a.cidVersion>0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),a.hashAlg!==void 0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),delete a.trickle;let c={};if(a.progress){let d=a.progress;a.progress=(h,y)=>{c[y]||(c[y]=0),c[y]+=h,d(c[y],y)}}let u=OKe(PKe(s),d=>RKe(d,t.blocks,{...a,pin:!1}),NKe(a),DKe(e,a),BKe(t,a)),l=await t.gcLock.readLock();try{for await(let d of u)delete c[d.path],yield d}finally{l()}}return kKe(n)};function NKe(t){async function*e(r){for await(let i of r){let n=i.cid;t.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();t.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function DKe(t,e){async function*r(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&t(n.cid),yield n}return r}function BKe(t,e){async function*r(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await t.pins.pinRecursively(n.cid),yield n}}return r}});var WX=p((V8t,GX)=>{f();"use strict";var{Bucket:MKe,createHAMT:LKe}=S_(),{decode:UKe}=(xt(),St),FKe=W4(),KKe=ct(),jKe=async function(t){return KKe(FKe.x64.hash128(t),"base16").slice(0,8).reverse()},VKe=(t,e,r)=>Promise.all(t.map(i=>{if(i.Name==null)throw new Error("Unexpected Link without a Name");if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new MKe({hash:r._options.hash,bits:r._options.bits},e,n))}return r.put(i.Name.substring(2),!0)})),HX=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),zKe=t=>{let e=t.bucket,r=[];for(;e._parent;)r.push(e),e=e._parent;return r.push(e),r.reverse()},$X=async(t,e,r,i,n)=>{if(!i){let l=LKe({hashFn:jKe});i={rootBucket:l,hamtDepth:1,lastBucket:l}}await VKe(t.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=HX(s.pos),a=zKe(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=HX(i.lastBucket._posAtParent));let c=t.Links.find(l=>{if(l.Name==null)return!1;let d=l.Name.substring(0,2),h=l.Name.substring(2);return!(d!==o||h&&h!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;i.hamtDepth++;let u=await r.get(c.Hash,n);return t=UKe(u),$X(t,e,r,i,n)};GX.exports=$X});var T_=p((z8t,YX)=>{f();"use strict";YX.exports=function(e,r,i,n){let s=e.length,o=r+s;return i>=o||n<r?new Uint8Array(0):(n>=r&&n<o&&(e=e.slice(0,n-r)),i>=r&&i<o&&(e=e.slice(i-r)),e)}});var R_=p((H8t,XX)=>{f();"use strict";var a5=ae(),HKe=(t,e,r)=>{if(e||(e=0),e<0)throw a5(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>t)throw a5(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!r&&r!==0&&(r=t-e),r<0)throw a5(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+r>t&&(r=t-e),{offset:e,length:r}};XX.exports=HKe});var c5=p(($8t,rQ)=>{f();"use strict";var QX=T_(),$Ke=R_(),{UnixFS:GKe}=yi(),ZX=ae(),JX=(xt(),St),eQ=(Tc(),df),WKe=(Es(),Zn);async function*tQ(t,e,r,i,n=0,s){if(e instanceof Uint8Array){let c=QX(e,n,r,i);return c.length&&(yield c),n+=c.length,n}if(e.Data==null)throw ZX(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=GKe.unmarshal(e.Data)}catch(c){throw ZX(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=QX(o.data,n,r,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let u=e.Links[c],l=n+o.blockSizes[c];if(r>=a&&r<l||i>a&&i<=l||r<a&&i>l){let d=await t.get(u.Hash,{signal:s.signal}),h;switch(u.Hash.code){case JX.code:h=await JX.decode(d);break;case WKe.code:h=d;break;case eQ.code:h=await eQ.decode(d);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let y of tQ(t,h,r,i,n,s))n+=y.length,yield y}n=l,a=l+1}}var YKe=(t,e,r,i,n,s,o)=>{function a(c={}){let u=r.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:l,length:d}=$Ke(u,c.offset,c.length),h=l,y=l+d;return tQ(o,e,h,y,0,c)}return a};rQ.exports=YKe});var nQ=p((G8t,iQ)=>{f();"use strict";var XKe=(t,e,r,i,n,s,o)=>{async function*a(c={}){let u=c.offset||0,l=c.length||e.Links.length,d=e.Links.slice(u,l);for(let h of d){let y=await n(h.Hash,h.Name||"",`${i}/${h.Name||""}`,[],s+1,o,c);y.entry&&(yield y.entry)}}return a};iQ.exports=XKe});var aQ=p((W8t,oQ)=>{f();"use strict";var{decode:QKe}=(xt(),St),ZKe=(t,e,r,i,n,s,o)=>{function a(c={}){return sQ(e,i,n,s,o,c)}return a};async function*sQ(t,e,r,i,n,s){let o=t.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await r(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{let u=await n.get(a.Hash);t=QKe(u);for await(let l of sQ(t,e,r,i,n,s))yield l}}}oQ.exports=ZKe});var uQ=p((Y8t,cQ)=>{f();"use strict";var u5=ae(),{UnixFS:JKe}=yi(),eje=WX(),{decode:tje}=(xt(),St),rje=(t,e)=>{let r=t.Links.find(i=>i.Name===e);return r&&r.Hash},ije={raw:c5(),file:c5(),directory:nQ(),"hamt-sharded-directory":aQ(),metadata:(t,e,r,i,n,s,o)=>()=>[],symlink:(t,e,r,i,n,s,o)=>()=>[]},nje=async(t,e,r,i,n,s,o,a)=>{let c=await o.get(t,a),u=tje(c),l,d;if(e||(e=t.toString()),u.Data==null)throw u5(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{l=JKe.unmarshal(u.Data)}catch(h){throw u5(h,"ERR_NOT_UNIXFS")}if(r||(r=e),i.length){let h;if(l&&l.type==="hamt-sharded-directory"?h=await eje(u,i[0],o):h=rje(u,i[0]),!h)throw u5(new Error("file does not exist"),"ERR_NOT_FOUND");let y=i.shift(),g=`${r}/${y}`;d={cid:h,toResolve:i,name:y||"",path:g}}return{entry:{type:l.isDirectory()?"directory":"file",name:e,path:r,cid:t,content:ije[l.type](t,u,l,r,n,s,o),unixfs:l,depth:s,node:u,size:l.fileSize()},next:d}};cQ.exports=nje});var fQ=p((X8t,lQ)=>{f();"use strict";var sje=ae(),oje=T_(),aje=R_(),cje=t=>{async function*e(r={}){let{offset:i,length:n}=aje(t.length,r.offset,r.length);yield oje(t,0,i,i+n)}return e},uje=async(t,e,r,i,n,s,o,a)=>{if(i.length)throw sje(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await o.get(t,a);return{entry:{type:"raw",name:e,path:r,cid:t,content:cje(c),depth:s,size:c.length,node:c}}};lQ.exports=uje});var hQ=p((Q8t,dQ)=>{f();"use strict";var{CID:lje}=(Ae(),ke),fje=ae(),dje=(Tc(),df),hje=async(t,e,r,i,n,s,o,a)=>{let c=await o.get(t),u=dje.decode(c),l=u,d=r;for(;i.length;){let h=i[0];if(h in l){i.shift(),d=`${d}/${h}`;let y=lje.asCID(l[h]);if(y)return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield u}},next:{cid:y,name:h,path:d,toResolve:i}};l=l[h]}else throw fje(new Error(`No property named ${h} found in cbor node ${t}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:r,cid:t,node:c,depth:s,size:c.length,content:async function*(){yield u}}}};dQ.exports=hje});var yQ=p((Z8t,pQ)=>{f();"use strict";var pje=ae(),yje=T_(),gje=R_(),bje=(vn(),mn),mje=t=>{async function*e(r={}){let{offset:i,length:n}=gje(t.length,r.offset,r.length);yield yje(t,0,i,i+n)}return e},vje=async(t,e,r,i,n,s,o,a)=>{if(i.length)throw pje(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let c=await bje.decode(t.multihash.bytes);return{entry:{type:"identity",name:e,path:r,cid:t,content:mje(c.digest),depth:s,size:c.digest.length,node:c.digest}}};pQ.exports=vje});var mQ=p((J8t,bQ)=>{f();"use strict";var wje=ae(),_je=(xt(),St),Eje=(Tc(),df),Sje=(Es(),Zn),{identity:xje}=(bc(),ua),Aje={[_je.code]:uQ(),[Sje.code]:fQ(),[Eje.code]:hQ(),[xje.code]:yQ()};function gQ(t,e,r,i,n,s,o){let a=Aje[t.code];if(!a)throw wje(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return a(t,e,r,i,gQ,n,s,o)}bQ.exports=gQ});var Co=p((ePt,_Q)=>{f();"use strict";var l5=ae(),{CID:f5}=(Ae(),ke),Ije=mQ(),Tje=Fn(),Rje=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),Pje=t=>{if(t instanceof Uint8Array)return{cid:f5.decode(t),toResolve:[]};let e=f5.asCID(t);if(e)return{cid:e,toResolve:[]};if(typeof t=="string"){t.indexOf("/ipfs/")===0&&(t=t.substring(6));let r=Rje(t);return{cid:f5.parse(r[0]),toResolve:r.slice(1)}}throw l5(new Error(`Unknown path type ${t}`),"ERR_BAD_PATH")};async function*vQ(t,e,r={}){let{cid:i,toResolve:n}=Pje(t),s=i.toString(),o=s,a=n.length;for(;;){let c=await Ije(i,s,o,n,a,e,r);if(!c.entry&&!c.next)throw l5(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function wQ(t,e,r={}){let i=await Tje(vQ(t,e,r));if(!i)throw l5(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");return i}async function*Cje(t,e,r={}){let i=await wQ(t,e,r);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,r))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}_Q.exports={exporter:wQ,walkPath:vQ,recursive:Cje}});var SQ=p((tPt,EQ)=>{f();"use strict";var{exporter:Oje}=Co(),{normalizeCidPath:kje}=Mi(),qje=Ce(),{CID:Nje}=(Ae(),ke);EQ.exports=function({repo:t,preload:e}){async function*r(i,n={}){if(i=kje(i),n.preload!==!1){let o=i.split("/");e(Nje.parse(o[0]))}let s=await Oje(i,t.blocks,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return qje(r)}});var Hu=p((rPt,xQ)=>{f();"use strict";var Dje=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};xQ.exports=Dje});var TQ=p(C_=>{f();var{Buffer:d5}=Ut(),mp=ln(),Bje="0".charCodeAt(0),Mje=d5.from("ustar\0","binary"),Lje=d5.from("ustar ","binary"),Uje=d5.from(" \0","binary"),P_=257,AQ=263,Fje=function(t,e,r){return typeof t!="number"?r:(t=~~t,t>=e?e:t>=0||(t+=e,t>=0)?t:0)},Kje=function(t){switch(t){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},IQ=function(t,e,r,i){for(;r<i;r++)if(t.get(r)===e)return r;return i},jje=function(t){let e=8*32;for(let r=0;r<148;r++)e+=t.get(r);for(let r=156;r<512;r++)e+=t.get(r);return e};function Vje(t){let e;if(t.get(0)===128)e=!0;else if(t.get(0)===255)e=!1;else return null;let r=!1,i=[];for(let o=t.length-1;o>0;o--){let a=t.get(o);e?i.push(a):r&&a===0?i.push(0):r?(r=!1,i.push(256-a)):i.push(255-a)}let n=0,s=i.length;for(let o=0;o<s;o++)n+=i[o]*Math.pow(256,o);return e?n:-1*n}var $u=function(t,e,r){if(t=t.shallowSlice(e,e+r),e=0,t.get(e)&128)return Vje(t);{for(;e<t.length&&t.get(e)===32;)e++;let i=Fje(IQ(t,32,e,t.length),t.length,t.length);for(;e<i&&t.get(e)===0;)e++;return i===e?0:parseInt(t.shallowSlice(e,i).toString(),8)}},vp=function(t,e,r,i){return t.shallowSlice(e,IQ(t,0,e,e+r)).toString(i)};C_.decodeLongPath=function(t,e){return t=mp.isBufferList(t)?t:new mp(t),vp(t,0,t.length,e)};C_.decodePax=function(t){t=mp.isBufferList(t)?t:new mp(t);let e={};for(;t.length;){let r=0;for(;r<t.length&&t.get(r)!==32;)r++;let i=parseInt(t.shallowSlice(0,r).toString(),10);if(!i)return e;let n=t.shallowSlice(r+1,i-1).toString(),s=n.indexOf("=");if(s===-1)return e;e[n.slice(0,s)]=n.slice(s+1),t=t.shallowSlice(i)}return e};C_.decode=function(t,e){t=mp.isBufferList(t)?t:new mp(t);let r=t.get(156)===0?0:t.get(156)-Bje,i=vp(t,0,100,e),n=$u(t,100,8),s=$u(t,108,8),o=$u(t,116,8),a=$u(t,124,12),c=$u(t,136,12),u=Kje(r),l=t.get(157)===0?null:vp(t,157,100,e),d=vp(t,265,32),h=vp(t,297,32),y=$u(t,329,8),g=$u(t,337,8),m=jje(t);if(m===8*32)return null;if(m!==$u(t,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(Mje.compare(t.slice(P_,P_+6))===0)t.get(345)&&(i=vp(t,345,155,e)+"/"+i);else if(!(Lje.compare(t.slice(P_,P_+6))===0&&Uje.compare(t.slice(AQ,AQ+2))===0))throw new Error("Invalid tar header: unknown format.");return r===0&&i&&i[i.length-1]==="/"&&(r=5),{name:i,mode:n,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:u,linkname:l,uname:d,gname:h,devmajor:y,devminor:g}}});var O_=p((nPt,RQ)=>{f();var h5=ln();RQ.exports=t=>{let e=async function*(){let r=yield,i=new h5;for await(let n of t){if(!r){r=yield i.append(n),i=new h5;continue}for(i.append(n);i.length>=r;){let s=i.shallowSlice(0,r);if(i.consume(r),r=yield s,!r){i.length&&(r=yield i,i=new h5);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var CQ=p((sPt,PQ)=>{f();var p5=ln(),zje=O_();PQ.exports=function(e){let r=zje(e),i,n={[Symbol.asyncIterator]:()=>n,async next(s){if(i){let o;if(s==null||i.length===s)o=i,i=null;else if(i.length>s)o=i.shallowSlice(0,s),i=i.shallowSlice(s);else if(i.length<s){let{value:a,done:c}=await r.next(s-i.length);if(c)throw Object.assign(new Error(`stream ended before ${s-i.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new p5([i,a]),i=null}return{value:o}}return r.next(s)},async nextLte(s){let{done:o,value:a}=await n.next();return o?{done:o}:a.length<=s?{value:a}:(a=p5.isBufferList(a)?a:new p5(a),i?i.append(a.shallowSlice(s)):i=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return r.return()}};return n}});var kQ=p((oPt,OQ)=>{f();var Hje=Hu(),gb=TQ(),$je=CQ();function Gje(t){return t&=511,t&&512-t}async function bb(t,e){let r=Gje(e);r&&await t.next(r)}OQ.exports=t=>(t=t||{},t.highWaterMark=t.highWaterMark||1024*16,e=>async function*(){let r=$je(e),i,n,s,o;try{for(;;){let a;try{let{done:y,value:g}=await r.next(512);if(y)return;a=g}catch(y){if(y.code==="ERR_UNDER_READ")return;throw y}let c=gb.decode(a,t.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:y,value:g}=await r.next(c.size);if(y)return;i=gb.decodeLongPath(g,t.filenameEncoding),await bb(r,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:y,value:g}=await r.next(c.size);if(y)return;n=gb.decodeLongPath(g,t.filenameEncoding),await bb(r,c.size);continue}if(c.type==="pax-global-header"){let{done:y,value:g}=await r.next(c.size);if(y)return;s=gb.decodePax(g,t.filenameEncoding),await bb(r,c.size);continue}if(c.type==="pax-header"){let{done:y,value:g}=await r.next(c.size);if(y)return;o=gb.decodePax(g,t.filenameEncoding),s&&(o={...s,...o}),await bb(r,c.size);continue}if(i&&(c.name=i,i=null),n&&(c.linkname=n,n=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let u=c.size,l=Hje(),d=await r.nextLte(Math.min(u,t.highWaterMark));u-=d.value.length,u||l.resolve();let h=async function*(){try{for(yield d.value;u;){let{done:y,value:g}=await r.nextLte(u);if(y){u=0;return}u-=g.length,yield g}}finally{l.resolve()}}();if(yield{header:c,body:h},await l.promise,u)for await(let y of h);await bb(r,c.size)}}finally{await r.return()}}())});var NQ=p((aPt,qQ)=>{f();"use strict";qQ.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:8,RTLD_LOCAL:4,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGINFO:29,SIGSYS:12,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,UV_FS_O_FILEMAP:0,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_DSYNC:4194304,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488319,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var BQ=p((cPt,DQ)=>{f();var Wje=ln(),y5={string:()=>"",buffer:()=>Wje()};DQ.exports=async(t,e)=>{if(e=e||{},e.type&&!y5[e.type])throw new Error(`invalid type "${e.type}"`);let r,i;for await(let n of t)r||(i=e.type||(typeof n=="string"?"string":"buffer"),r=y5[i]()),i==="string"?r+=n:r.append(n);return r||y5[e.type||"buffer"]()}});var MQ=p(b5=>{f();var{Buffer:qa}=Ut(),Yje=qa.alloc,Xje="0000000000000000000",Qje="7777777777777777777",Zje="0".charCodeAt(0),Jje=qa.from("ustar\0","binary"),eVe=qa.from("00","binary"),tVe=parseInt("7777",8),rVe=257,iVe=263,nVe=function(t){switch(t){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},sVe=function(t){let e=8*32;for(let r=0;r<148;r++)e+=t[r];for(let r=156;r<512;r++)e+=t[r];return e},Gu=function(t,e){return t=t.toString(8),t.length>e?Qje.slice(0,e)+" ":Xje.slice(0,e-t.length)+t+" "},g5=function(t){let e=qa.byteLength(t),r=Math.floor(Math.log(e)/Math.log(10))+1;return e+r>=Math.pow(10,r)&&r++,e+r+t};b5.encodePax=function(t){let e="";t.name&&(e+=g5(" path="+t.name+`
`)),t.linkname&&(e+=g5(" linkpath="+t.linkname+`
`));let r=t.pax;if(r)for(let i in r)e+=g5(" "+i+"="+r[i]+`
`);return qa.from(e)};b5.encode=function(t){let e=Yje(512),r=t.name,i="";if(t.typeflag===5&&r[r.length-1]!=="/"&&(r+="/"),qa.byteLength(r)!==r.length)return null;for(;qa.byteLength(r)>100;){let n=r.indexOf("/");if(n===-1)return null;i+=i?"/"+r.slice(0,n):r.slice(0,n),r=r.slice(n+1)}return qa.byteLength(r)>100||qa.byteLength(i)>155||t.linkname&&qa.byteLength(t.linkname)>100?null:(e.write(r),e.write(Gu(t.mode&tVe,6),100),e.write(Gu(t.uid,6),108),e.write(Gu(t.gid,6),116),e.write(Gu(t.size,11),124),e.write(Gu(t.mtime.getTime()/1e3|0,11),136),e[156]=Zje+nVe(t.type),t.linkname&&e.write(t.linkname,157),Jje.copy(e,rVe),eVe.copy(e,iVe),t.uname&&e.write(t.uname,265),t.gname&&e.write(t.gname,297),e.write(Gu(t.devmajor||0,6),329),e.write(Gu(t.devminor||0,6),337),i&&e.write(i,345),e.write(Gu(sVe(e),6),148),e)}});var FQ=p((lPt,UQ)=>{f();var{Buffer:m5}=Ut(),If=ln(),{S_IFMT:oVe,S_IFBLK:aVe,S_IFCHR:cVe,S_IFDIR:uVe,S_IFIFO:lVe,S_IFLNK:fVe}=NQ(),dVe=BQ(),k_=MQ(),hVe=parseInt("755",8),pVe=parseInt("644",8),LQ=m5.alloc(1024);function yVe(t){switch(t&oVe){case aVe:return"block-device";case cVe:return"character-device";case uVe:return"directory";case lVe:return"fifo";case fVe:return"symlink"}return"file"}function v5(t){if(t&=511,t)return new If(LQ.slice(0,512-t))}function w5(t){if(!t.pax){let e=k_.encode(t);if(e)return e}return gVe(t)}function gVe(t){let e=k_.encodePax({name:t.name,linkname:t.linkname,pax:t.pax}),r={name:"PaxHeader",mode:t.mode,uid:t.uid,gid:t.gid,size:e.length,mtime:t.mtime,type:"pax-header",linkname:t.linkname&&"PaxHeader",uname:t.uname,gname:t.gname,devmajor:t.devmajor,devminor:t.devminor};return new If([k_.encode(r),e,v5(e.length),k_.encode({...r,size:t.size,type:t.type})])}UQ.exports=()=>async function*(t){for await(let{header:e,body:r}of t){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=yVe(e.mode)),e.mode||(e.mode=e.type==="directory"?hVe:pVe),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof r=="string"&&(r=m5.from(r)),m5.isBuffer(r)||If.isBufferList(r)){e.size=r.length,yield new If([w5(e),r,v5(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await dVe(r)).toString(),yield w5(e);continue}if(yield w5(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let i=0;for await(let s of r)i+=s.length,yield If.isBufferList(s)?s:new If(s);if(i!==e.size)throw new Error("size mismatch");let n=v5(e.size);n&&(yield n)}yield new If(LQ)}});var KQ=p(_5=>{f();_5.extract=kQ();_5.pack=FQ()});var kc=p(An=>{f();"use strict";var bVe=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function mVe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}An.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(var i in r)mVe(r,i)&&(t[i]=r[i])}}return t};An.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var vVe={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray){t.set(e.subarray(r,r+i),n);return}for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){var e,r,i,n,s,o;for(i=0,e=0,r=t.length;e<r;e++)i+=t[e].length;for(o=new Uint8Array(i),n=0,e=0,r=t.length;e<r;e++)s=t[e],o.set(s,n),n+=s.length;return o}},wVe={arraySet:function(t,e,r,i,n){for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};An.setTyped=function(t){t?(An.Buf8=Uint8Array,An.Buf16=Uint16Array,An.Buf32=Int32Array,An.assign(An,vVe)):(An.Buf8=Array,An.Buf16=Array,An.Buf32=Array,An.assign(An,wVe))};An.setTyped(bVe)});var lZ=p(Ep=>{f();"use strict";var _Ve=kc(),EVe=4,jQ=0,VQ=1,SVe=2;function wp(t){for(var e=t.length;--e>=0;)t[e]=0}var xVe=0,zQ=1,AVe=2,IVe=3,TVe=258,E5=29,mb=256,vb=mb+1+E5,_p=30,S5=19,HQ=2*vb+1,Tf=15,x5=16,RVe=7,A5=256,$Q=16,GQ=17,WQ=18,I5=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],q_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],PVe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],YQ=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],CVe=512,qc=new Array((vb+2)*2);wp(qc);var wb=new Array(_p*2);wp(wb);var _b=new Array(CVe);wp(_b);var Eb=new Array(TVe-IVe+1);wp(Eb);var T5=new Array(E5);wp(T5);var N_=new Array(_p);wp(N_);function R5(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}var XQ,QQ,ZQ;function P5(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function JQ(t){return t<256?_b[t]:_b[256+(t>>>7)]}function Sb(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function Hn(t,e,r){t.bi_valid>x5-r?(t.bi_buf|=e<<t.bi_valid&65535,Sb(t,t.bi_buf),t.bi_buf=e>>x5-t.bi_valid,t.bi_valid+=r-x5):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function Na(t,e,r){Hn(t,r[e*2],r[e*2+1])}function eZ(t,e){var r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1}function OVe(t){t.bi_valid===16?(Sb(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function kVe(t,e){var r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,u,l,d,h,y,g,m=0;for(h=0;h<=Tf;h++)t.bl_count[h]=0;for(r[t.heap[t.heap_max]*2+1]=0,u=t.heap_max+1;u<HQ;u++)l=t.heap[u],h=r[r[l*2+1]*2+1]+1,h>c&&(h=c,m++),r[l*2+1]=h,!(l>i)&&(t.bl_count[h]++,y=0,l>=a&&(y=o[l-a]),g=r[l*2],t.opt_len+=g*(h+y),s&&(t.static_len+=g*(n[l*2+1]+y)));if(m!==0){do{for(h=c-1;t.bl_count[h]===0;)h--;t.bl_count[h]--,t.bl_count[h+1]+=2,t.bl_count[c]--,m-=2}while(m>0);for(h=c;h!==0;h--)for(l=t.bl_count[h];l!==0;)d=t.heap[--u],!(d>i)&&(r[d*2+1]!==h&&(t.opt_len+=(h-r[d*2+1])*r[d*2],r[d*2+1]=h),l--)}}function tZ(t,e,r){var i=new Array(Tf+1),n=0,s,o;for(s=1;s<=Tf;s++)i[s]=n=n+r[s-1]<<1;for(o=0;o<=e;o++){var a=t[o*2+1];a!==0&&(t[o*2]=eZ(i[a]++,a))}}function qVe(){var t,e,r,i,n,s=new Array(Tf+1);for(r=0,i=0;i<E5-1;i++)for(T5[i]=r,t=0;t<1<<I5[i];t++)Eb[r++]=i;for(Eb[r-1]=i,n=0,i=0;i<16;i++)for(N_[i]=n,t=0;t<1<<q_[i];t++)_b[n++]=i;for(n>>=7;i<_p;i++)for(N_[i]=n<<7,t=0;t<1<<q_[i]-7;t++)_b[256+n++]=i;for(e=0;e<=Tf;e++)s[e]=0;for(t=0;t<=143;)qc[t*2+1]=8,t++,s[8]++;for(;t<=255;)qc[t*2+1]=9,t++,s[9]++;for(;t<=279;)qc[t*2+1]=7,t++,s[7]++;for(;t<=287;)qc[t*2+1]=8,t++,s[8]++;for(tZ(qc,vb+1,s),t=0;t<_p;t++)wb[t*2+1]=5,wb[t*2]=eZ(t,5);XQ=new R5(qc,I5,mb+1,vb,Tf),QQ=new R5(wb,q_,0,_p,Tf),ZQ=new R5(new Array(0),PVe,0,S5,RVe)}function rZ(t){var e;for(e=0;e<vb;e++)t.dyn_ltree[e*2]=0;for(e=0;e<_p;e++)t.dyn_dtree[e*2]=0;for(e=0;e<S5;e++)t.bl_tree[e*2]=0;t.dyn_ltree[A5*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function iZ(t){t.bi_valid>8?Sb(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function NVe(t,e,r,i){iZ(t),i&&(Sb(t,r),Sb(t,~r)),_Ve.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function nZ(t,e,r,i){var n=e*2,s=r*2;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]}function C5(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&nZ(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!nZ(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function sZ(t,e,r){var i,n,s=0,o,a;if(t.last_lit!==0)do i=t.pending_buf[t.d_buf+s*2]<<8|t.pending_buf[t.d_buf+s*2+1],n=t.pending_buf[t.l_buf+s],s++,i===0?Na(t,n,e):(o=Eb[n],Na(t,o+mb+1,e),a=I5[o],a!==0&&(n-=T5[o],Hn(t,n,a)),i--,o=JQ(i),Na(t,o,r),a=q_[o],a!==0&&(i-=N_[o],Hn(t,i,a)));while(s<t.last_lit);Na(t,A5,e)}function O5(t,e){var r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,c=-1,u;for(t.heap_len=0,t.heap_max=HQ,o=0;o<s;o++)r[o*2]!==0?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):r[o*2+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=c<2?++c:0,r[u*2]=1,t.depth[u]=0,t.opt_len--,n&&(t.static_len-=i[u*2+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)C5(t,r,o);u=s;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],C5(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[u*2]=r[o*2]+r[a*2],t.depth[u]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[o*2+1]=r[a*2+1]=u,t.heap[1]=u++,C5(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],kVe(t,e),tZ(r,c,t.bl_count)}function oZ(t,e,r){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),e[(r+1)*2+1]=65535,i=0;i<=r;i++)s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)&&(a<u?t.bl_tree[s*2]+=a:s!==0?(s!==n&&t.bl_tree[s*2]++,t.bl_tree[$Q*2]++):a<=10?t.bl_tree[GQ*2]++:t.bl_tree[WQ*2]++,a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4))}function aZ(t,e,r){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),i=0;i<=r;i++)if(s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)){if(a<u)do Na(t,s,t.bl_tree);while(--a!=0);else s!==0?(s!==n&&(Na(t,s,t.bl_tree),a--),Na(t,$Q,t.bl_tree),Hn(t,a-3,2)):a<=10?(Na(t,GQ,t.bl_tree),Hn(t,a-3,3)):(Na(t,WQ,t.bl_tree),Hn(t,a-11,7));a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4)}}function DVe(t){var e;for(oZ(t,t.dyn_ltree,t.l_desc.max_code),oZ(t,t.dyn_dtree,t.d_desc.max_code),O5(t,t.bl_desc),e=S5-1;e>=3&&t.bl_tree[YQ[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function BVe(t,e,r,i){var n;for(Hn(t,e-257,5),Hn(t,r-1,5),Hn(t,i-4,4),n=0;n<i;n++)Hn(t,t.bl_tree[YQ[n]*2+1],3);aZ(t,t.dyn_ltree,e-1),aZ(t,t.dyn_dtree,r-1)}function MVe(t){var e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return jQ;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return VQ;for(r=32;r<mb;r++)if(t.dyn_ltree[r*2]!==0)return VQ;return jQ}var cZ=!1;function LVe(t){cZ||(qVe(),cZ=!0),t.l_desc=new P5(t.dyn_ltree,XQ),t.d_desc=new P5(t.dyn_dtree,QQ),t.bl_desc=new P5(t.bl_tree,ZQ),t.bi_buf=0,t.bi_valid=0,rZ(t)}function uZ(t,e,r,i){Hn(t,(xVe<<1)+(i?1:0),3),NVe(t,e,r,!0)}function UVe(t){Hn(t,zQ<<1,3),Na(t,A5,qc),OVe(t)}function FVe(t,e,r,i){var n,s,o=0;t.level>0?(t.strm.data_type===SVe&&(t.strm.data_type=MVe(t)),O5(t,t.l_desc),O5(t,t.d_desc),o=DVe(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&e!==-1?uZ(t,e,r,i):t.strategy===EVe||s===n?(Hn(t,(zQ<<1)+(i?1:0),3),sZ(t,qc,wb)):(Hn(t,(AVe<<1)+(i?1:0),3),BVe(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),sZ(t,t.dyn_ltree,t.dyn_dtree)),rZ(t),i&&iZ(t)}function KVe(t,e,r){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Eb[r]+mb+1)*2]++,t.dyn_dtree[JQ(e)*2]++),t.last_lit===t.lit_bufsize-1}Ep._tr_init=LVe;Ep._tr_stored_block=uZ;Ep._tr_flush_block=FVe;Ep._tr_tally=KVe;Ep._tr_align=UVe});var k5=p((pPt,fZ)=>{f();"use strict";function jVe(t,e,r,i){for(var n=t&65535|0,s=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0}fZ.exports=jVe});var q5=p((yPt,dZ)=>{f();"use strict";function VVe(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e}var zVe=VVe();function HVe(t,e,r,i){var n=zVe,s=i+r;t^=-1;for(var o=i;o<s;o++)t=t>>>8^n[(t^e[o])&255];return t^-1}dZ.exports=HVe});var D_=p((gPt,hZ)=>{f();"use strict";hZ.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var EZ=p(Ma=>{f();"use strict";var In=kc(),Us=lZ(),pZ=k5(),Wu=q5(),$Ve=D_(),Rf=0,GVe=1,WVe=3,Yu=4,yZ=5,Da=0,gZ=1,Fs=-2,YVe=-3,N5=-5,XVe=-1,QVe=1,B_=2,ZVe=3,JVe=4,eze=0,tze=2,M_=8,rze=9,ize=15,nze=8,sze=29,oze=256,D5=oze+1+sze,aze=30,cze=19,uze=2*D5+1,lze=15,At=3,Xu=258,Oo=Xu+At+1,fze=32,L_=42,B5=69,U_=73,F_=91,K_=103,Pf=113,xb=666,bi=1,Ab=2,Cf=3,Sp=4,dze=3;function Qu(t,e){return t.msg=$Ve[e],e}function bZ(t){return(t<<1)-(t>4?9:0)}function Zu(t){for(var e=t.length;--e>=0;)t[e]=0}function Ju(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(In.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))}function Gi(t,e){Us._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Ju(t.strm)}function Bt(t,e){t.pending_buf[t.pending++]=e}function Ib(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function hze(t,e,r,i){var n=t.avail_in;return n>i&&(n=i),n===0?0:(t.avail_in-=n,In.arraySet(e,t.input,t.next_in,n,r),t.state.wrap===1?t.adler=pZ(t.adler,e,n,r):t.state.wrap===2&&(t.adler=Wu(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)}function mZ(t,e){var r=t.max_chain_length,i=t.strstart,n,s,o=t.prev_length,a=t.nice_match,c=t.strstart>t.w_size-Oo?t.strstart-(t.w_size-Oo):0,u=t.window,l=t.w_mask,d=t.prev,h=t.strstart+Xu,y=u[i+o-1],g=u[i+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(n=e,!(u[n+o]!==g||u[n+o-1]!==y||u[n]!==u[i]||u[++n]!==u[i+1])){i+=2,n++;do;while(u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&i<h);if(s=Xu-(h-i),i=h-Xu,s>o){if(t.match_start=e,o=s,s>=a)break;y=u[i+o-1],g=u[i+o]}}while((e=d[e&l])>c&&--r!=0);return o<=t.lookahead?o:t.lookahead}function Of(t){var e=t.w_size,r,i,n,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Oo)){In.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,i=t.hash_size,r=i;do n=t.head[--r],t.head[r]=n>=e?n-e:0;while(--i);i=e,r=i;do n=t.prev[--r],t.prev[r]=n>=e?n-e:0;while(--i);s+=e}if(t.strm.avail_in===0)break;if(i=hze(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=i,t.lookahead+t.insert>=At)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+At-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<At)););}while(t.lookahead<Oo&&t.strm.avail_in!==0)}function pze(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Of(t),t.lookahead===0&&e===Rf)return bi;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((t.strstart===0||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,Gi(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Oo&&(Gi(t,!1),t.strm.avail_out===0))return bi}return t.insert=0,e===Yu?(Gi(t,!0),t.strm.avail_out===0?Cf:Sp):(t.strstart>t.block_start&&(Gi(t,!1),t.strm.avail_out===0),bi)}function M5(t,e){for(var r,i;;){if(t.lookahead<Oo){if(Of(t),t.lookahead<Oo&&e===Rf)return bi;if(t.lookahead===0)break}if(r=0,t.lookahead>=At&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+At-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Oo&&(t.match_length=mZ(t,r)),t.match_length>=At)if(i=Us._tr_tally(t,t.strstart-t.match_start,t.match_length-At),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=At){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+At-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=Us._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Gi(t,!1),t.strm.avail_out===0))return bi}return t.insert=t.strstart<At-1?t.strstart:At-1,e===Yu?(Gi(t,!0),t.strm.avail_out===0?Cf:Sp):t.last_lit&&(Gi(t,!1),t.strm.avail_out===0)?bi:Ab}function xp(t,e){for(var r,i,n;;){if(t.lookahead<Oo){if(Of(t),t.lookahead<Oo&&e===Rf)return bi;if(t.lookahead===0)break}if(r=0,t.lookahead>=At&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+At-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=At-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Oo&&(t.match_length=mZ(t,r),t.match_length<=5&&(t.strategy===QVe||t.match_length===At&&t.strstart-t.match_start>4096)&&(t.match_length=At-1)),t.prev_length>=At&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-At,i=Us._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-At),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+At-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=At-1,t.strstart++,i&&(Gi(t,!1),t.strm.avail_out===0))return bi}else if(t.match_available){if(i=Us._tr_tally(t,0,t.window[t.strstart-1]),i&&Gi(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return bi}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Us._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<At-1?t.strstart:At-1,e===Yu?(Gi(t,!0),t.strm.avail_out===0?Cf:Sp):t.last_lit&&(Gi(t,!1),t.strm.avail_out===0)?bi:Ab}function yze(t,e){for(var r,i,n,s,o=t.window;;){if(t.lookahead<=Xu){if(Of(t),t.lookahead<=Xu&&e===Rf)return bi;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=At&&t.strstart>0&&(n=t.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=t.strstart+Xu;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);t.match_length=Xu-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=At?(r=Us._tr_tally(t,1,t.match_length-At),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Us._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Gi(t,!1),t.strm.avail_out===0))return bi}return t.insert=0,e===Yu?(Gi(t,!0),t.strm.avail_out===0?Cf:Sp):t.last_lit&&(Gi(t,!1),t.strm.avail_out===0)?bi:Ab}function gze(t,e){for(var r;;){if(t.lookahead===0&&(Of(t),t.lookahead===0)){if(e===Rf)return bi;break}if(t.match_length=0,r=Us._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Gi(t,!1),t.strm.avail_out===0))return bi}return t.insert=0,e===Yu?(Gi(t,!0),t.strm.avail_out===0?Cf:Sp):t.last_lit&&(Gi(t,!1),t.strm.avail_out===0)?bi:Ab}function Ba(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}var Ap;Ap=[new Ba(0,0,0,0,pze),new Ba(4,4,8,4,M5),new Ba(4,5,16,8,M5),new Ba(4,6,32,32,M5),new Ba(4,4,16,16,xp),new Ba(8,16,32,32,xp),new Ba(8,16,128,128,xp),new Ba(8,32,128,256,xp),new Ba(32,128,258,1024,xp),new Ba(32,258,258,4096,xp)];function bze(t){t.window_size=2*t.w_size,Zu(t.head),t.max_lazy_match=Ap[t.level].max_lazy,t.good_match=Ap[t.level].good_length,t.nice_match=Ap[t.level].nice_length,t.max_chain_length=Ap[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=At-1,t.match_available=0,t.ins_h=0}function mze(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=M_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new In.Buf16(uze*2),this.dyn_dtree=new In.Buf16((2*aze+1)*2),this.bl_tree=new In.Buf16((2*cze+1)*2),Zu(this.dyn_ltree),Zu(this.dyn_dtree),Zu(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new In.Buf16(lze+1),this.heap=new In.Buf16(2*D5+1),Zu(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new In.Buf16(2*D5+1),Zu(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function vZ(t){var e;return!t||!t.state?Qu(t,Fs):(t.total_in=t.total_out=0,t.data_type=tze,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?L_:Pf,t.adler=e.wrap===2?0:1,e.last_flush=Rf,Us._tr_init(e),Da)}function wZ(t){var e=vZ(t);return e===Da&&bze(t.state),e}function vze(t,e){return!t||!t.state||t.state.wrap!==2?Fs:(t.state.gzhead=e,Da)}function _Z(t,e,r,i,n,s){if(!t)return Fs;var o=1;if(e===XVe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>rze||r!==M_||i<8||i>15||e<0||e>9||s<0||s>JVe)return Qu(t,Fs);i===8&&(i=9);var a=new mze;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+At-1)/At),a.window=new In.Buf8(a.w_size*2),a.head=new In.Buf16(a.hash_size),a.prev=new In.Buf16(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new In.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=r,wZ(t)}function wze(t,e){return _Z(t,e,M_,ize,nze,eze)}function _ze(t,e){var r,i,n,s;if(!t||!t.state||e>yZ||e<0)return t?Qu(t,Fs):Fs;if(i=t.state,!t.output||!t.input&&t.avail_in!==0||i.status===xb&&e!==Yu)return Qu(t,t.avail_out===0?N5:Fs);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===L_)if(i.wrap===2)t.adler=0,Bt(i,31),Bt(i,139),Bt(i,8),i.gzhead?(Bt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Bt(i,i.gzhead.time&255),Bt(i,i.gzhead.time>>8&255),Bt(i,i.gzhead.time>>16&255),Bt(i,i.gzhead.time>>24&255),Bt(i,i.level===9?2:i.strategy>=B_||i.level<2?4:0),Bt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Bt(i,i.gzhead.extra.length&255),Bt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=Wu(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=B5):(Bt(i,0),Bt(i,0),Bt(i,0),Bt(i,0),Bt(i,0),Bt(i,i.level===9?2:i.strategy>=B_||i.level<2?4:0),Bt(i,dze),i.status=Pf);else{var o=M_+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=B_||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=fze),o+=31-o%31,i.status=Pf,Ib(i,o),i.strstart!==0&&(Ib(i,t.adler>>>16),Ib(i,t.adler&65535)),t.adler=1}if(i.status===B5)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=Wu(t.adler,i.pending_buf,i.pending-n,n)),Ju(t),n=i.pending,i.pending===i.pending_buf_size));)Bt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(t.adler=Wu(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=U_)}else i.status=U_;if(i.status===U_)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=Wu(t.adler,i.pending_buf,i.pending-n,n)),Ju(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,Bt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=Wu(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=F_)}else i.status=F_;if(i.status===F_)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=Wu(t.adler,i.pending_buf,i.pending-n,n)),Ju(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,Bt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=Wu(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=K_)}else i.status=K_;if(i.status===K_&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Ju(t),i.pending+2<=i.pending_buf_size&&(Bt(i,t.adler&255),Bt(i,t.adler>>8&255),t.adler=0,i.status=Pf)):i.status=Pf),i.pending!==0){if(Ju(t),t.avail_out===0)return i.last_flush=-1,Da}else if(t.avail_in===0&&bZ(e)<=bZ(r)&&e!==Yu)return Qu(t,N5);if(i.status===xb&&t.avail_in!==0)return Qu(t,N5);if(t.avail_in!==0||i.lookahead!==0||e!==Rf&&i.status!==xb){var c=i.strategy===B_?gze(i,e):i.strategy===ZVe?yze(i,e):Ap[i.level].func(i,e);if((c===Cf||c===Sp)&&(i.status=xb),c===bi||c===Cf)return t.avail_out===0&&(i.last_flush=-1),Da;if(c===Ab&&(e===GVe?Us._tr_align(i):e!==yZ&&(Us._tr_stored_block(i,0,0,!1),e===WVe&&(Zu(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Ju(t),t.avail_out===0))return i.last_flush=-1,Da}return e!==Yu?Da:i.wrap<=0?gZ:(i.wrap===2?(Bt(i,t.adler&255),Bt(i,t.adler>>8&255),Bt(i,t.adler>>16&255),Bt(i,t.adler>>24&255),Bt(i,t.total_in&255),Bt(i,t.total_in>>8&255),Bt(i,t.total_in>>16&255),Bt(i,t.total_in>>24&255)):(Ib(i,t.adler>>>16),Ib(i,t.adler&65535)),Ju(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Da:gZ)}function Eze(t){var e;return!t||!t.state?Fs:(e=t.state.status,e!==L_&&e!==B5&&e!==U_&&e!==F_&&e!==K_&&e!==Pf&&e!==xb?Qu(t,Fs):(t.state=null,e===Pf?Qu(t,YVe):Da))}function Sze(t,e){var r=e.length,i,n,s,o,a,c,u,l;if(!t||!t.state||(i=t.state,o=i.wrap,o===2||o===1&&i.status!==L_||i.lookahead))return Fs;for(o===1&&(t.adler=pZ(t.adler,e,r,0)),i.wrap=0,r>=i.w_size&&(o===0&&(Zu(i.head),i.strstart=0,i.block_start=0,i.insert=0),l=new In.Buf8(i.w_size),In.arraySet(l,e,r-i.w_size,i.w_size,0),e=l,r=i.w_size),a=t.avail_in,c=t.next_in,u=t.input,t.avail_in=r,t.next_in=0,t.input=e,Of(i);i.lookahead>=At;){n=i.strstart,s=i.lookahead-(At-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+At-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--s);i.strstart=n,i.lookahead=At-1,Of(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=At-1,i.match_available=0,t.next_in=c,t.input=u,t.avail_in=a,i.wrap=o,Da}Ma.deflateInit=wze;Ma.deflateInit2=_Z;Ma.deflateReset=wZ;Ma.deflateResetKeep=vZ;Ma.deflateSetHeader=vze;Ma.deflate=_ze;Ma.deflateEnd=Eze;Ma.deflateSetDictionary=Sze;Ma.deflateInfo="pako deflate (from Nodeca project)"});var L5=p(Ip=>{f();"use strict";var j_=kc(),SZ=!0,xZ=!0;try{String.fromCharCode.apply(null,[0])}catch(t){SZ=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){xZ=!1}var Tb=new j_.Buf8(256);for(Nc=0;Nc<256;Nc++)Tb[Nc]=Nc>=252?6:Nc>=248?5:Nc>=240?4:Nc>=224?3:Nc>=192?2:1;var Nc;Tb[254]=Tb[254]=1;Ip.string2buf=function(t){var e,r,i,n,s,o=t.length,a=0;for(n=0;n<o;n++)r=t.charCodeAt(n),(r&64512)==55296&&n+1<o&&(i=t.charCodeAt(n+1),(i&64512)==56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new j_.Buf8(a),s=0,n=0;s<a;n++)r=t.charCodeAt(n),(r&64512)==55296&&n+1<o&&(i=t.charCodeAt(n+1),(i&64512)==56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};function AZ(t,e){if(e<65534&&(t.subarray&&xZ||!t.subarray&&SZ))return String.fromCharCode.apply(null,j_.shrinkBuf(t,e));for(var r="",i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r}Ip.buf2binstring=function(t){return AZ(t,t.length)};Ip.binstring2buf=function(t){for(var e=new j_.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e};Ip.buf2string=function(t,e){var r,i,n,s,o=e||t.length,a=new Array(o*2);for(i=0,r=0;r<o;){if(n=t[r++],n<128){a[i++]=n;continue}if(s=Tb[n],s>4){a[i++]=65533,r+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&r<o;)n=n<<6|t[r++]&63,s--;if(s>1){a[i++]=65533;continue}n<65536?a[i++]=n:(n-=65536,a[i++]=55296|n>>10&1023,a[i++]=56320|n&1023)}return AZ(a,i)};Ip.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+Tb[t[r]]>e?r:e}});var U5=p((vPt,IZ)=>{f();"use strict";function xze(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}IZ.exports=xze});var CZ=p(Cb=>{f();"use strict";var Rb=EZ(),Pb=kc(),F5=L5(),K5=D_(),Aze=U5(),TZ=Object.prototype.toString,Ize=0,j5=4,Tp=0,RZ=1,PZ=2,Tze=-1,Rze=0,Pze=8;function kf(t){if(!(this instanceof kf))return new kf(t);this.options=Pb.assign({level:Tze,method:Pze,chunkSize:16384,windowBits:15,memLevel:8,strategy:Rze,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Aze,this.strm.avail_out=0;var r=Rb.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==Tp)throw new Error(K5[r]);if(e.header&&Rb.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=F5.string2buf(e.dictionary):TZ.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,r=Rb.deflateSetDictionary(this.strm,i),r!==Tp)throw new Error(K5[r]);this._dict_set=!0}}kf.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;s=e===~~e?e:e===!0?j5:Ize,typeof t=="string"?r.input=F5.string2buf(t):TZ.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Pb.Buf8(i),r.next_out=0,r.avail_out=i),n=Rb.deflate(r,s),n!==RZ&&n!==Tp)return this.onEnd(n),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(s===j5||s===PZ))&&(this.options.to==="string"?this.onData(F5.buf2binstring(Pb.shrinkBuf(r.output,r.next_out))):this.onData(Pb.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&n!==RZ);return s===j5?(n=Rb.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Tp):(s===PZ&&(this.onEnd(Tp),r.avail_out=0),!0)};kf.prototype.onData=function(t){this.chunks.push(t)};kf.prototype.onEnd=function(t){t===Tp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Pb.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function V5(t,e){var r=new kf(e);if(r.push(t,!0),r.err)throw r.msg||K5[r.err];return r.result}function Cze(t,e){return e=e||{},e.raw=!0,V5(t,e)}function Oze(t,e){return e=e||{},e.gzip=!0,V5(t,e)}Cb.Deflate=kf;Cb.deflate=V5;Cb.deflateRaw=Cze;Cb.gzip=Oze});var kZ=p((_Pt,OZ)=>{f();"use strict";var V_=30,kze=12;OZ.exports=function(e,r){var i,n,s,o,a,c,u,l,d,h,y,g,m,E,v,A,R,F,q,N,z,G,Y,P,b;i=e.state,n=e.next_in,P=e.input,s=n+(e.avail_in-5),o=e.next_out,b=e.output,a=o-(r-e.avail_out),c=o+(e.avail_out-257),u=i.dmax,l=i.wsize,d=i.whave,h=i.wnext,y=i.window,g=i.hold,m=i.bits,E=i.lencode,v=i.distcode,A=(1<<i.lenbits)-1,R=(1<<i.distbits)-1;e:do{m<15&&(g+=P[n++]<<m,m+=8,g+=P[n++]<<m,m+=8),F=E[g&A];t:for(;;){if(q=F>>>24,g>>>=q,m-=q,q=F>>>16&255,q===0)b[o++]=F&65535;else if(q&16){N=F&65535,q&=15,q&&(m<q&&(g+=P[n++]<<m,m+=8),N+=g&(1<<q)-1,g>>>=q,m-=q),m<15&&(g+=P[n++]<<m,m+=8,g+=P[n++]<<m,m+=8),F=v[g&R];r:for(;;){if(q=F>>>24,g>>>=q,m-=q,q=F>>>16&255,q&16){if(z=F&65535,q&=15,m<q&&(g+=P[n++]<<m,m+=8,m<q&&(g+=P[n++]<<m,m+=8)),z+=g&(1<<q)-1,z>u){e.msg="invalid distance too far back",i.mode=V_;break e}if(g>>>=q,m-=q,q=o-a,z>q){if(q=z-q,q>d&&i.sane){e.msg="invalid distance too far back",i.mode=V_;break e}if(G=0,Y=y,h===0){if(G+=l-q,q<N){N-=q;do b[o++]=y[G++];while(--q);G=o-z,Y=b}}else if(h<q){if(G+=l+h-q,q-=h,q<N){N-=q;do b[o++]=y[G++];while(--q);if(G=0,h<N){q=h,N-=q;do b[o++]=y[G++];while(--q);G=o-z,Y=b}}}else if(G+=h-q,q<N){N-=q;do b[o++]=y[G++];while(--q);G=o-z,Y=b}for(;N>2;)b[o++]=Y[G++],b[o++]=Y[G++],b[o++]=Y[G++],N-=3;N&&(b[o++]=Y[G++],N>1&&(b[o++]=Y[G++]))}else{G=o-z;do b[o++]=b[G++],b[o++]=b[G++],b[o++]=b[G++],N-=3;while(N>2);N&&(b[o++]=b[G++],N>1&&(b[o++]=b[G++]))}}else if((q&64)==0){F=v[(F&65535)+(g&(1<<q)-1)];continue r}else{e.msg="invalid distance code",i.mode=V_;break e}break}}else if((q&64)==0){F=E[(F&65535)+(g&(1<<q)-1)];continue t}else if(q&32){i.mode=kze;break e}else{e.msg="invalid literal/length code",i.mode=V_;break e}break}}while(n<s&&o<c);N=m>>3,n-=N,m-=N<<3,g&=(1<<m)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),i.hold=g,i.bits=m}});var UZ=p((EPt,LZ)=>{f();"use strict";var qZ=kc(),Rp=15,NZ=852,DZ=592,BZ=0,z5=1,MZ=2,qze=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Nze=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Dze=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Bze=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];LZ.exports=function(e,r,i,n,s,o,a,c){var u=c.bits,l=0,d=0,h=0,y=0,g=0,m=0,E=0,v=0,A=0,R=0,F,q,N,z,G,Y=null,P=0,b,w=new qZ.Buf16(Rp+1),S=new qZ.Buf16(Rp+1),C=null,B=0,W,j,M;for(l=0;l<=Rp;l++)w[l]=0;for(d=0;d<n;d++)w[r[i+d]]++;for(g=u,y=Rp;y>=1&&w[y]===0;y--);if(g>y&&(g=y),y===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(h=1;h<y&&w[h]===0;h++);for(g<h&&(g=h),v=1,l=1;l<=Rp;l++)if(v<<=1,v-=w[l],v<0)return-1;if(v>0&&(e===BZ||y!==1))return-1;for(S[1]=0,l=1;l<Rp;l++)S[l+1]=S[l]+w[l];for(d=0;d<n;d++)r[i+d]!==0&&(a[S[r[i+d]]++]=d);if(e===BZ?(Y=C=a,b=19):e===z5?(Y=qze,P-=257,C=Nze,B-=257,b=256):(Y=Dze,C=Bze,b=-1),R=0,d=0,l=h,G=o,m=g,E=0,N=-1,A=1<<g,z=A-1,e===z5&&A>NZ||e===MZ&&A>DZ)return 1;for(;;){W=l-E,a[d]<b?(j=0,M=a[d]):a[d]>b?(j=C[B+a[d]],M=Y[P+a[d]]):(j=32+64,M=0),F=1<<l-E,q=1<<m,h=q;do q-=F,s[G+(R>>E)+q]=W<<24|j<<16|M|0;while(q!==0);for(F=1<<l-1;R&F;)F>>=1;if(F!==0?(R&=F-1,R+=F):R=0,d++,--w[l]==0){if(l===y)break;l=r[i+a[d]]}if(l>g&&(R&z)!==N){for(E===0&&(E=g),G+=h,m=l-E,v=1<<m;m+E<y&&(v-=w[m+E],!(v<=0));)m++,v<<=1;if(A+=1<<m,e===z5&&A>NZ||e===MZ&&A>DZ)return 1;N=R&z,s[N]=g<<24|m<<16|G-o|0}}return R!==0&&(s[G+R]=l-E<<24|64<<16|0),c.bits=g,0}});var wJ=p(ko=>{f();"use strict";var us=kc(),H5=k5(),La=q5(),Mze=kZ(),Ob=UZ(),Lze=0,FZ=1,KZ=2,jZ=4,Uze=5,z_=6,qf=0,Fze=1,Kze=2,Ks=-2,VZ=-3,$5=-4,jze=-5,zZ=8,HZ=1,$Z=2,GZ=3,WZ=4,YZ=5,XZ=6,QZ=7,ZZ=8,JZ=9,eJ=10,H_=11,Dc=12,G5=13,tJ=14,W5=15,rJ=16,iJ=17,nJ=18,sJ=19,$_=20,G_=21,oJ=22,aJ=23,cJ=24,uJ=25,lJ=26,Y5=27,fJ=28,dJ=29,gr=30,X5=31,Vze=32,zze=852,Hze=592,$ze=15,Gze=$ze;function hJ(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function Wze(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new us.Buf16(320),this.work=new us.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function pJ(t){var e;return!t||!t.state?Ks:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=HZ,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new us.Buf32(zze),e.distcode=e.distdyn=new us.Buf32(Hze),e.sane=1,e.back=-1,qf)}function yJ(t){var e;return!t||!t.state?Ks:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,pJ(t))}function gJ(t,e){var r,i;return!t||!t.state||(i=t.state,e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?Ks:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,yJ(t))}function bJ(t,e){var r,i;return t?(i=new Wze,t.state=i,i.window=null,r=gJ(t,e),r!==qf&&(t.state=null),r):Ks}function Yze(t){return bJ(t,Gze)}var mJ=!0,Q5,Z5;function Xze(t){if(mJ){var e;for(Q5=new us.Buf32(512),Z5=new us.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Ob(FZ,t.lens,0,288,Q5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Ob(KZ,t.lens,0,32,Z5,0,t.work,{bits:5}),mJ=!1}t.lencode=Q5,t.lenbits=9,t.distcode=Z5,t.distbits=5}function vJ(t,e,r,i){var n,s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new us.Buf8(s.wsize)),i>=s.wsize?(us.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),us.arraySet(s.window,e,r-i,n,s.wnext),i-=n,i?(us.arraySet(s.window,e,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function Qze(t,e){var r,i,n,s,o,a,c,u,l,d,h,y,g,m,E=0,v,A,R,F,q,N,z,G,Y=new us.Buf8(4),P,b,w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return Ks;r=t.state,r.mode===Dc&&(r.mode=G5),o=t.next_out,n=t.output,c=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,u=r.hold,l=r.bits,d=a,h=c,G=qf;e:for(;;)switch(r.mode){case HZ:if(r.wrap===0){r.mode=G5;break}for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(r.wrap&2&&u===35615){r.check=0,Y[0]=u&255,Y[1]=u>>>8&255,r.check=La(r.check,Y,2,0),u=0,l=0,r.mode=$Z;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=gr;break}if((u&15)!==zZ){t.msg="unknown compression method",r.mode=gr;break}if(u>>>=4,l-=4,z=(u&15)+8,r.wbits===0)r.wbits=z;else if(z>r.wbits){t.msg="invalid window size",r.mode=gr;break}r.dmax=1<<z,t.adler=r.check=1,r.mode=u&512?eJ:Dc,u=0,l=0;break;case $Z:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(r.flags=u,(r.flags&255)!==zZ){t.msg="unknown compression method",r.mode=gr;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=gr;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,r.check=La(r.check,Y,2,0)),u=0,l=0,r.mode=GZ;case GZ:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.head&&(r.head.time=u),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,Y[2]=u>>>16&255,Y[3]=u>>>24&255,r.check=La(r.check,Y,4,0)),u=0,l=0,r.mode=WZ;case WZ:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,r.check=La(r.check,Y,2,0)),u=0,l=0,r.mode=YZ;case YZ:if(r.flags&1024){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,r.check=La(r.check,Y,2,0)),u=0,l=0}else r.head&&(r.head.extra=null);r.mode=XZ;case XZ:if(r.flags&1024&&(y=r.length,y>a&&(y=a),y&&(r.head&&(z=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),us.arraySet(r.head.extra,i,s,y,z)),r.flags&512&&(r.check=La(r.check,i,y,s)),a-=y,s+=y,r.length-=y),r.length))break e;r.length=0,r.mode=QZ;case QZ:if(r.flags&2048){if(a===0)break e;y=0;do z=i[s+y++],r.head&&z&&r.length<65536&&(r.head.name+=String.fromCharCode(z));while(z&&y<a);if(r.flags&512&&(r.check=La(r.check,i,y,s)),a-=y,s+=y,z)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=ZZ;case ZZ:if(r.flags&4096){if(a===0)break e;y=0;do z=i[s+y++],r.head&&z&&r.length<65536&&(r.head.comment+=String.fromCharCode(z));while(z&&y<a);if(r.flags&512&&(r.check=La(r.check,i,y,s)),a-=y,s+=y,z)break e}else r.head&&(r.head.comment=null);r.mode=JZ;case JZ:if(r.flags&512){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=gr;break}u=0,l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Dc;break;case eJ:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.adler=r.check=hJ(u),u=0,l=0,r.mode=H_;case H_:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,Kze;t.adler=r.check=1,r.mode=Dc;case Dc:if(e===Uze||e===z_)break e;case G5:if(r.last){u>>>=l&7,l-=l&7,r.mode=Y5;break}for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}switch(r.last=u&1,u>>>=1,l-=1,u&3){case 0:r.mode=tJ;break;case 1:if(Xze(r),r.mode=$_,e===z_){u>>>=2,l-=2;break e}break;case 2:r.mode=iJ;break;case 3:t.msg="invalid block type",r.mode=gr}u>>>=2,l-=2;break;case tJ:for(u>>>=l&7,l-=l&7;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((u&65535)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=gr;break}if(r.length=u&65535,u=0,l=0,r.mode=W5,e===z_)break e;case W5:r.mode=rJ;case rJ:if(y=r.length,y){if(y>a&&(y=a),y>c&&(y=c),y===0)break e;us.arraySet(n,i,s,y,o),a-=y,s+=y,c-=y,o+=y,r.length-=y;break}r.mode=Dc;break;case iJ:for(;l<14;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(r.nlen=(u&31)+257,u>>>=5,l-=5,r.ndist=(u&31)+1,u>>>=5,l-=5,r.ncode=(u&15)+4,u>>>=4,l-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=gr;break}r.have=0,r.mode=nJ;case nJ:for(;r.have<r.ncode;){for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.lens[w[r.have++]]=u&7,u>>>=3,l-=3}for(;r.have<19;)r.lens[w[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,P={bits:r.lenbits},G=Ob(Lze,r.lens,0,19,r.lencode,0,r.work,P),r.lenbits=P.bits,G){t.msg="invalid code lengths set",r.mode=gr;break}r.have=0,r.mode=sJ;case sJ:for(;r.have<r.nlen+r.ndist;){for(;E=r.lencode[u&(1<<r.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(R<16)u>>>=v,l-=v,r.lens[r.have++]=R;else{if(R===16){for(b=v+2;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u>>>=v,l-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=gr;break}z=r.lens[r.have-1],y=3+(u&3),u>>>=2,l-=2}else if(R===17){for(b=v+3;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,z=0,y=3+(u&7),u>>>=3,l-=3}else{for(b=v+7;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,z=0,y=11+(u&127),u>>>=7,l-=7}if(r.have+y>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=gr;break}for(;y--;)r.lens[r.have++]=z}}if(r.mode===gr)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=gr;break}if(r.lenbits=9,P={bits:r.lenbits},G=Ob(FZ,r.lens,0,r.nlen,r.lencode,0,r.work,P),r.lenbits=P.bits,G){t.msg="invalid literal/lengths set",r.mode=gr;break}if(r.distbits=6,r.distcode=r.distdyn,P={bits:r.distbits},G=Ob(KZ,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,P),r.distbits=P.bits,G){t.msg="invalid distances set",r.mode=gr;break}if(r.mode=$_,e===z_)break e;case $_:r.mode=G_;case G_:if(a>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,Mze(t,h),o=t.next_out,n=t.output,c=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,u=r.hold,l=r.bits,r.mode===Dc&&(r.back=-1);break}for(r.back=0;E=r.lencode[u&(1<<r.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(A&&(A&240)==0){for(F=v,q=A,N=R;E=r.lencode[N+((u&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=F,l-=F,r.back+=F}if(u>>>=v,l-=v,r.back+=v,r.length=R,A===0){r.mode=lJ;break}if(A&32){r.back=-1,r.mode=Dc;break}if(A&64){t.msg="invalid literal/length code",r.mode=gr;break}r.extra=A&15,r.mode=oJ;case oJ:if(r.extra){for(b=r.extra;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=aJ;case aJ:for(;E=r.distcode[u&(1<<r.distbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((A&240)==0){for(F=v,q=A,N=R;E=r.distcode[N+((u&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=F,l-=F,r.back+=F}if(u>>>=v,l-=v,r.back+=v,A&64){t.msg="invalid distance code",r.mode=gr;break}r.offset=R,r.extra=A&15,r.mode=cJ;case cJ:if(r.extra){for(b=r.extra;l<b;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=gr;break}r.mode=uJ;case uJ:if(c===0)break e;if(y=h-c,r.offset>y){if(y=r.offset-y,y>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=gr;break}y>r.wnext?(y-=r.wnext,g=r.wsize-y):g=r.wnext-y,y>r.length&&(y=r.length),m=r.window}else m=n,g=o-r.offset,y=r.length;y>c&&(y=c),c-=y,r.length-=y;do n[o++]=m[g++];while(--y);r.length===0&&(r.mode=G_);break;case lJ:if(c===0)break e;n[o++]=r.length,c--,r.mode=G_;break;case Y5:if(r.wrap){for(;l<32;){if(a===0)break e;a--,u|=i[s++]<<l,l+=8}if(h-=c,t.total_out+=h,r.total+=h,h&&(t.adler=r.check=r.flags?La(r.check,n,h,o-h):H5(r.check,n,h,o-h)),h=c,(r.flags?u:hJ(u))!==r.check){t.msg="incorrect data check",r.mode=gr;break}u=0,l=0}r.mode=fJ;case fJ:if(r.wrap&&r.flags){for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=gr;break}u=0,l=0}r.mode=dJ;case dJ:G=Fze;break e;case gr:G=VZ;break e;case X5:return $5;case Vze:default:return Ks}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,r.hold=u,r.bits=l,(r.wsize||h!==t.avail_out&&r.mode<gr&&(r.mode<Y5||e!==jZ))&&vJ(t,t.output,t.next_out,h-t.avail_out)?(r.mode=X5,$5):(d-=t.avail_in,h-=t.avail_out,t.total_in+=d,t.total_out+=h,r.total+=h,r.wrap&&h&&(t.adler=r.check=r.flags?La(r.check,n,h,t.next_out-h):H5(r.check,n,h,t.next_out-h)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Dc?128:0)+(r.mode===$_||r.mode===W5?256:0),(d===0&&h===0||e===jZ)&&G===qf&&(G=jze),G)}function Zze(t){if(!t||!t.state)return Ks;var e=t.state;return e.window&&(e.window=null),t.state=null,qf}function Jze(t,e){var r;return!t||!t.state||(r=t.state,(r.wrap&2)==0)?Ks:(r.head=e,e.done=!1,qf)}function eHe(t,e){var r=e.length,i,n,s;return!t||!t.state||(i=t.state,i.wrap!==0&&i.mode!==H_)?Ks:i.mode===H_&&(n=1,n=H5(n,e,r,0),n!==i.check)?VZ:(s=vJ(t,e,r,r),s?(i.mode=X5,$5):(i.havedict=1,qf))}ko.inflateReset=yJ;ko.inflateReset2=gJ;ko.inflateResetKeep=pJ;ko.inflateInit=Yze;ko.inflateInit2=bJ;ko.inflate=Qze;ko.inflateEnd=Zze;ko.inflateGetHeader=Jze;ko.inflateSetDictionary=eHe;ko.inflateInfo="pako inflate (from Nodeca project)"});var J5=p((xPt,_J)=>{f();"use strict";_J.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var SJ=p((APt,EJ)=>{f();"use strict";function tHe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}EJ.exports=tHe});var AJ=p(qb=>{f();"use strict";var Pp=wJ(),kb=kc(),W_=L5(),ti=J5(),eT=D_(),rHe=U5(),iHe=SJ(),xJ=Object.prototype.toString;function Nf(t){if(!(this instanceof Nf))return new Nf(t);this.options=kb.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new rHe,this.strm.avail_out=0;var r=Pp.inflateInit2(this.strm,e.windowBits);if(r!==ti.Z_OK)throw new Error(eT[r]);if(this.header=new iHe,Pp.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=W_.string2buf(e.dictionary):xJ.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Pp.inflateSetDictionary(this.strm,e.dictionary),r!==ti.Z_OK)))throw new Error(eT[r])}Nf.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,o,a,c,u,l=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?ti.Z_FINISH:ti.Z_NO_FLUSH,typeof t=="string"?r.input=W_.binstring2buf(t):xJ.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new kb.Buf8(i),r.next_out=0,r.avail_out=i),s=Pp.inflate(r,ti.Z_NO_FLUSH),s===ti.Z_NEED_DICT&&n&&(s=Pp.inflateSetDictionary(this.strm,n)),s===ti.Z_BUF_ERROR&&l===!0&&(s=ti.Z_OK,l=!1),s!==ti.Z_STREAM_END&&s!==ti.Z_OK)return this.onEnd(s),this.ended=!0,!1;r.next_out&&(r.avail_out===0||s===ti.Z_STREAM_END||r.avail_in===0&&(o===ti.Z_FINISH||o===ti.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=W_.utf8border(r.output,r.next_out),c=r.next_out-a,u=W_.buf2string(r.output,a),r.next_out=c,r.avail_out=i-c,c&&kb.arraySet(r.output,r.output,a,c,0),this.onData(u)):this.onData(kb.shrinkBuf(r.output,r.next_out))),r.avail_in===0&&r.avail_out===0&&(l=!0)}while((r.avail_in>0||r.avail_out===0)&&s!==ti.Z_STREAM_END);return s===ti.Z_STREAM_END&&(o=ti.Z_FINISH),o===ti.Z_FINISH?(s=Pp.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===ti.Z_OK):(o===ti.Z_SYNC_FLUSH&&(this.onEnd(ti.Z_OK),r.avail_out=0),!0)};Nf.prototype.onData=function(t){this.chunks.push(t)};Nf.prototype.onEnd=function(t){t===ti.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=kb.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function tT(t,e){var r=new Nf(e);if(r.push(t,!0),r.err)throw r.msg||eT[r.err];return r.result}function nHe(t,e){return e=e||{},e.raw=!0,tT(t,e)}qb.Inflate=Nf;qb.inflate=tT;qb.inflateRaw=nHe;qb.ungzip=tT});var RJ=p((TPt,TJ)=>{f();"use strict";var sHe=kc().assign,oHe=CZ(),aHe=AJ(),cHe=J5(),IJ={};sHe(IJ,oHe,aHe,cHe);TJ.exports=IJ});var CJ=p((RPt,PJ)=>{f();"use strict";var uHe=tn();async function lHe(t){let e=new Uint8Array(0);for await(let r of t)e=uHe([e,r],e.length+r.length);return e}PJ.exports=lHe});var UJ=p((PPt,LJ)=>{f();"use strict";var{exporter:fHe,recursive:dHe}=Co(),Nb=ae(),{normalizeCidPath:hHe}=Mi(),pHe=Ce(),{CID:OJ}=(Ae(),ke),{pack:kJ}=KQ(),{pipe:qJ}=Er(),{gzip:NJ}=RJ(),DJ=Io(),BJ=CJ(),MJ=6;LJ.exports=function({repo:t,preload:e}){async function*r(i,n={}){if(n.compressionLevel<0||n.compressionLevel>9)throw Nb(new Error("Compression level must be between 1 and 9"),"ERR_INVALID_PARAMS");if(n.preload!==!1){let a;try{a=hHe(i).split("/")}catch(c){throw Nb(c,"ERR_INVALID_PATH")}e(OJ.parse(a[0]))}let s=OJ.asCID(i)||i,o=await fHe(s,t.blocks,n);if(o.type==="file"||o.type==="raw"){let a=[];!n.compress||n.archive===!0?a.push([{header:{name:o.path,mode:o.type==="file"&&o.unixfs.mode,mtime:o.type==="file"&&o.unixfs.mtime?new Date(o.unixfs.mtime.secs*1e3):void 0,size:o.size,type:"file"},body:o.content()}],kJ(),c=>DJ(c,u=>u.slice())):a.push(o.content),n.compress&&a.push(async function*(c){let u=await BJ(c);yield NJ(u,{level:n.compressionLevel||MJ})}),yield*qJ(...a);return}if(o.type==="directory"){let a=[dHe(s,t.blocks,n),async function*(c){for await(let u of c){let l={header:{name:u.path,size:u.size}};if(u.type==="file")l.header.type="file",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,l.body=u.content();else if(u.type==="raw")l.header.type="file",l.body=u.content();else if(u.type==="directory")l.header.type="directory",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw Nb(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield l}},kJ(),c=>DJ(c,u=>u.slice())];if(n.compress){if(!n.archive)throw Nb(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&a.push(async function*(c){let u=await BJ(c);yield NJ(u,{level:n.compressionLevel||MJ})})}yield*qJ(...a);return}throw Nb(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return pHe(r)}});var VJ=p((CPt,jJ)=>{f();"use strict";var{exporter:yHe}=Co(),gHe=ae(),{normalizeCidPath:bHe,mapFile:FJ}=Mi(),mHe=Ce(),{CID:KJ}=(Ae(),ke);jJ.exports=function({repo:t,preload:e}){async function*r(i,n={}){let s=bHe(i),o=s.split("/");n.preload!==!1&&e(KJ.parse(o[0]));let a=KJ.asCID(s)||s,c=await yHe(a,t.blocks,n);if(c.type==="file"){yield FJ(c);return}if(c.type==="directory"){for await(let u of c.content())yield FJ(u);return}throw gHe(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return mHe(r)}});var $J=p((OPt,HJ)=>{f();"use strict";var vHe=KW(),wHe=zX(),_He=SQ(),EHe=UJ(),SHe=VJ(),zJ=class{constructor({preload:e,repo:r,options:i}){let n=wHe({preload:e,repo:r,options:i});this.addAll=n,this.add=vHe({addAll:n}),this.cat=_He({repo:r,preload:e}),this.get=EHe({repo:r,preload:e}),this.ls=SHe({repo:r,preload:e})}};HJ.exports=zJ});var Y_=p((kPt,xHe)=>{xHe.exports={name:"ipfs-core",version:"0.10.2",description:"JavaScript implementation of the IPFS specification",keywords:["IPFS"],homepage:"https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core#readme",bugs:"https://github.com/ipfs/js-ipfs/issues",license:"(Apache-2.0 OR MIT)",leadMaintainer:"Alex Potsides <alex@achingbrain.net>",main:"src/index.js",types:"dist/src/index.d.ts",files:["src","dist","!dist/*.tsbuildinfo"],browser:{"./src/runtime/init-assets-nodejs.js":"./src/runtime/init-assets-browser.js","./src/runtime/config-nodejs.js":"./src/runtime/config-browser.js","./src/runtime/dns-nodejs.js":"./src/runtime/dns-browser.js","./src/runtime/libp2p-nodejs.js":"./src/runtime/libp2p-browser.js","./src/runtime/libp2p-pubsub-routers-nodejs.js":"./src/runtime/libp2p-pubsub-routers-browser.js","./src/runtime/preload-nodejs.js":"./src/runtime/preload-browser.js","./src/runtime/repo-nodejs.js":"./src/runtime/repo-browser.js","ipfs-utils/src/files/glob-source":!1},typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"],"src/":["dist/src/index"]}},repository:{type:"git",url:"git+https://github.com/ipfs/js-ipfs.git"},scripts:{build:"aegir build",lint:"aegir ts -p check && aegir lint",test:"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","test:electron-main":"aegir test -t electron-main","test:electron-renderer":"aegir test -t electron-renderer","test:bootstrapers":"IPFS_TEST=bootstrapers aegir test -t browser -f test/bootstrapers.js",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",clean:"rimraf ./dist","dep-check":"aegir dep-check -i interface-ipfs-core -i ipfs-core-types -i abort-controller"},dependencies:{"@chainsafe/libp2p-noise":"^4.0.0","@ipld/car":"^3.1.0","@ipld/dag-cbor":"^6.0.5","@ipld/dag-pb":"^2.1.3","abort-controller":"^3.0.0","array-shuffle":"^2.0.0","blockstore-datastore-adapter":"^1.0.0","datastore-core":"^5.0.1","datastore-fs":"^5.0.2","datastore-level":"^6.0.2","datastore-pubsub":"^0.7.0",debug:"^4.1.1",dlv:"^1.1.3","err-code":"^3.0.1","hamt-sharding":"^2.0.0",hashlru:"^2.3.0","interface-blockstore":"^1.0.0","interface-datastore":"^5.0.0","ipfs-bitswap":"^6.0.0","ipfs-core-types":"^0.7.0","ipfs-core-utils":"^0.10.1","ipfs-http-client":"^52.0.1","ipfs-repo":"^11.0.1","ipfs-unixfs":"^5.0.0","ipfs-unixfs-exporter":"^6.0.2","ipfs-unixfs-importer":"^8.0.2","ipfs-utils":"^8.1.4",ipns:"^0.13.3","is-domain-name":"^1.0.1","is-ipfs":"^6.0.1","it-all":"^1.0.4","it-drain":"^1.0.3","it-filter":"^1.0.2","it-first":"^1.0.4","it-last":"^1.0.4","it-map":"^1.0.4","it-merge":"^1.0.2","it-peekable":"^1.0.2","it-pipe":"^1.1.0","it-pushable":"^1.4.2","it-tar":"^4.0.0","it-to-buffer":"^2.0.0","just-safe-set":"^2.2.1",libp2p:"^0.32.0","libp2p-bootstrap":"^0.13.0","libp2p-crypto":"^0.19.6","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.0","libp2p-kad-dht":"^0.23.1","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.2","libp2p-record":"^0.10.3","libp2p-tcp":"^0.17.1","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.1",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.0",multiaddr:"^10.0.0","multiaddr-to-uri":"^8.0.0",multiformats:"^9.4.1","native-abort-controller":"^1.0.3","p-queue":"^6.6.1",pako:"^1.0.2","parse-duration":"^1.0.0","peer-id":"^0.15.1","streaming-iterables":"^6.0.0",uint8arrays:"^2.1.6"},devDependencies:{"@types/dlv":"^1.1.2","@types/pako":"^1.0.2","@types/rimraf":"^3.0.1",aegir:"^34.0.2",delay:"^5.0.0","go-ipfs":"0.9.1","interface-blockstore-tests":"^1.0.0","interface-ipfs-core":"^0.150.0","ipfsd-ctl":"^10.0.3","iso-url":"^1.0.0",nanoid:"^3.1.12","p-defer":"^3.0.0",rimraf:"^3.0.2",sinon:"^11.1.1"}}});var WJ=p((qPt,GJ)=>{f();"use strict";var rT=Y_(),AHe=Ce();GJ.exports=({repo:t})=>{async function e(r={}){let i=await t.version.get();return{version:rT.version,repo:`${i}`,commit:rT.gitHead||"","interface-ipfs-core":rT.devDependencies["interface-ipfs-core"]}}return AHe(e)}});var XJ=p((NPt,YJ)=>{f();"use strict";var IHe=Y_().version,{Multiaddr:THe}=tt(),RHe=Ce(),X_=Je(),PHe=et(),{NotStartedError:CHe}=Lu();YJ.exports=({peerId:t,network:e})=>{async function r(i={}){i.peerId===t.toB58String()&&delete i.peerId;let n=e.try();if(!n){if(i.peerId)throw new CHe;return{id:t.toB58String(),publicKey:X_(t.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${IHe}`,protocolVersion:"9000",protocols:[]}}let s=i.peerId?PHe.createFromB58String(i.peerId.toString()):t,{libp2p:o}=n,a=i.peerId?o.peerStore.keyBook.get(s):s.pubKey,c=i.peerId?o.peerStore.addressBook.getMultiaddrsForPeer(s):o.multiaddrs,u=i.peerId?o.peerStore.protoBook.get(s):Array.from(o.upgrader.protocols.keys()),l=X_(o.peerStore.metadataBook.getValue(s,"AgentVersion")||new Uint8Array),d=X_(o.peerStore.metadataBook.getValue(s,"ProtocolVersion")||new Uint8Array),h=s.toB58String();return{id:h,publicKey:X_(a.bytes,"base64pad"),addresses:(c||[]).map(y=>{let g=y.toString();return g.endsWith(`/p2p/${h}`)?g:`${g}/p2p/${h}`}).sort().map(y=>new THe(y)),agentVersion:l,protocolVersion:d,protocols:(u||[]).sort()}}return RHe(r)}});var sT=p((DPt,nT)=>{f();"use strict";var ri=jI(),iT=p_(),Cp=Ce(),OHe=me()("ipfs:core:config");nT.exports=({repo:t})=>{return{getAll:Cp(e),get:Cp(r),set:Cp(i),replace:Cp(n),profiles:{apply:Cp(s),list:Cp(kHe)}};async function e(o={}){return t.config.getAll(o)}async function r(o,a){return o?t.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return t.config.set(o,a,c)}async function n(o,a){return t.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,u=Q_[o];if(!u)throw new Error(`No profile with name '${o}' exists`);try{let l=await t.config.getAll(a),d=JSON.parse(JSON.stringify(l));return d=u.transform(d),c||await t.config.replace(d,a),delete l.Identity.PrivKey,delete d.Identity.PrivKey,{original:l,updated:d}}catch(l){throw OHe(l),new Error(`Could not apply profile '${o}' to config: ${l.message}`)}}};async function kHe(t){return Object.keys(Q_).map(e=>({name:e,description:Q_[e].description}))}var Q_={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:t=>(ri(t,"Discovery.MDNS.Enabled",!1),ri(t,"Discovery.webRTCStar.Enabled",!1),t.Swarm={...t.Swarm||{},DisableNatPortMap:!0},t)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:t=>(ri(t,"Discovery.MDNS.Enabled",!0),ri(t,"Discovery.webRTCStar.Enabled",!0),ri(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:t=>{let e=iT();return ri(t,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),ri(t,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),ri(t,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),ri(t,"Addresses.Delegates",[]),ri(t,"Bootstrap",[]),ri(t,"Discovery.MDNS.Enabled",!1),ri(t,"Discovery.webRTCStar.Enabled",!1),ri(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!0}),t}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:t=>{let e=iT();return ri(t,"Addresses.API",e.Addresses.API),ri(t,"Addresses.Gateway",e.Addresses.Gateway),ri(t,"Addresses.Swarm",e.Addresses.Swarm),ri(t,"Addresses.Delegates",e.Addresses.Delegates),ri(t,"Bootstrap",e.Bootstrap),ri(t,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),ri(t,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),ri(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:t=>{let e=t.Swarm||{},r=e.ConnMgr||{};return r.LowWater=20,r.HighWater=40,e.ConnMgr=r,t.Swarm=e,t}},"default-power":{description:'Inverse of "lowpower" profile.',transform:t=>{let e=iT();return t.Swarm=e.Swarm,t}}};nT.exports.profiles=Q_});function aT(t){let e=ZA({version:1,roots:t}),r=oT.default.encode(e.length),i=new Uint8Array(r.length+e.length);return i.set(r,0),i.set(e,r.length),i}function QJ(t){return{async setRoots(e){let r=aT(e);await t.write(r)},async writeBlock(e){let{cid:r,bytes:i}=e;await t.write(new Uint8Array(oT.default.encode(r.bytes.length+i.length))),await t.write(r.bytes),i.length&&await t.write(i)},async close(){return t.end()}}}var oT,ZJ=Ge(()=>{f();oT=gk(es());Tc()});function Z_(){}function JJ(){let t=[],e=null,r=Z_,i=!1,n=null,s=Z_,o=()=>(e||(e=new Promise(u=>{r=()=>{e=null,r=Z_,u()}})),e),a={write(u){t.push(u);let l=o();return s(),l},async end(){i=!0;let u=o();return s(),u}},c={async next(){let u=t.shift();return u?(t.length===0&&r(),{done:!1,value:u}):i?(r(),{done:!0,value:void 0}):(n||(n=new Promise(l=>{s=()=>(n=null,s=Z_,l(c.next()))})),n)}};return{writer:a,iterator:c}}var eee=Ge(()=>{f()});async function J_(t){let e=await t.upTo(8),r=el.default.decode(e);return t.seek(el.default.decode.bytes),r}async function uT(t){let e=await J_(t);if(e===0)throw new Error("Invalid CAR header (zero length)");let r=await t.exactly(e);t.seek(e);let i=JA(r);if(i==null||Array.isArray(i)||typeof i!="object")throw new Error("Invalid CAR header format");if(i.version!==1)throw typeof i.version=="string"?new Error(`Invalid CAR version: "${i.version}"`):new Error(`Invalid CAR version: ${i.version}`);if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");if(Object.keys(i).filter(n=>n!=="roots"&&n!=="version").length)throw new Error("Invalid CAR header format");return i}async function qHe(t){let e=await t.upTo(8);el.default.decode(e);let r=el.default.decode.bytes,i=el.default.decode(e.subarray(el.default.decode.bytes)),n=el.default.decode.bytes,s=r+n+i,o=await t.exactly(s);return t.seek(s),o}async function NHe(t){let e=await t.exactly(2);if(e[0]===cT.SHA2_256&&e[1]===cT.LENGTH){let o=await t.exactly(34);t.seek(34);let a=Vd(o);return rt.create(0,cT.DAG_PB,a)}let r=await J_(t);if(r!==1)throw new Error(`Unexpected CID version (${r})`);let i=await J_(t),n=await qHe(t),s=Vd(n);return rt.create(r,i,s)}async function tee(t){let e=t.pos,r=await J_(t);if(r===0)throw new Error("Invalid CAR section (zero length)");r+=t.pos-e;let i=await NHe(t),n=r-(t.pos-e);return{cid:i,length:r,blockLength:n}}async function DHe(t){let{cid:e,blockLength:r}=await tee(t),i=await t.exactly(r);return t.seek(r),{bytes:i,cid:e}}async function BHe(t){let e=t.pos,{cid:r,length:i,blockLength:n}=await tee(t),s={cid:r,length:i,blockLength:n,offset:e,blockOffset:t.pos};return t.seek(s.blockLength),s}function ree(t){let e=uT(t);return{header:()=>e,async*blocks(){for(await e;(await t.upTo(8)).length>0;)yield await DHe(t)},async*blocksIndex(){for(await e;(await t.upTo(8)).length>0;)yield await BHe(t)}}}function e2(t){let e=0;return{async upTo(r){return t.subarray(e,e+Math.min(r,t.length-e))},async exactly(r){if(r>t.length-e)throw new Error("Unexpected end of data");return t.subarray(e,e+r)},seek(r){e+=r},get pos(){return e}}}function MHe(t){let e=0,r=0,i=0,n=new Uint8Array(0),s=async o=>{r=n.length-i;let a=[n.subarray(i)];for(;r<o;){let u=await t();if(u==null)break;r<0?u.length>r&&a.push(u.subarray(-r)):a.push(u),r+=u.length}n=new Uint8Array(a.reduce((u,l)=>u+l.length,0));let c=0;for(let u of a)n.set(u,c),c+=u.length;i=0};return{async upTo(o){return n.length-i<o&&await s(o),n.subarray(i,i+Math.min(n.length-i,o))},async exactly(o){if(n.length-i<o&&await s(o),n.length-i<o)throw new Error("Unexpected end of data");return n.subarray(i,i+o)},seek(o){e+=o,i+=o},get pos(){return e}}}function iee(t){let e=t[Symbol.asyncIterator]();async function r(){let i=await e.next();return i.done?null:i.value}return MHe(r)}var el,cT,lT=Ge(()=>{f();el=gk(es());Ae();vn();Tc();cT={SHA2_256:18,LENGTH:32,DAG_PB:112}});var see={};Gt(see,{CarWriter:()=>Db,CarWriterOut:()=>t2,__browser:()=>UHe});function nee(){let t=JJ(),{writer:e,iterator:r}=t;return{encoder:QJ(e),iterator:r}}function LHe(t){if(t===void 0)return[];if(!Array.isArray(t)){let r=rt.asCID(t);if(!r)throw new TypeError("roots must be a single CID or an array of CIDs");return[r]}let e=[];for(let r of t){let i=rt.asCID(r);if(!i)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(i)}return e}var Db,t2,UHe,oee=Ge(()=>{f();Ae();ZJ();eee();lT();Db=class{constructor(e,r){this._encoder=r,this._mutex=r.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let r=rt.asCID(e.cid);if(!r)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:r,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=LHe(e);let{encoder:r,iterator:i}=nee(),n=new Db(e,r),s=new t2(i);return{writer:n,out:s}}static createAppender(){let{encoder:e,iterator:r}=nee();e.setRoots=()=>Promise.resolve();let i=new Db([],e),n=new t2(r);return{writer:i,out:n}}static async updateRootsInBytes(e,r){let i=e2(e);await uT(i);let n=aT(r);if(i.pos!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${i.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},t2=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};UHe=!0});var lee=p((GPt,uee)=>{f();"use strict";var{CID:FHe}=(Ae(),ke),KHe=(jw(),Kw),{base58btc:jHe}=(Zr(),Qr),{CarWriter:VHe}=(oee(),see),zHe=Ce(),aee=me()("ipfs:components:dag:import"),HHe=(Es(),Zn),$He=(d6(),vv),GHe=[HHe.code,$He.code];uee.exports=({repo:t,preload:e,codecs:r})=>{async function*i(n,s={}){s.preload!==!1&&e(n);let o=FHe.asCID(n);if(!o)throw new Error(`Unexpected error converting CID type: ${n}`);aee(`Exporting ${o} as car`);let{writer:a,out:c}=await VHe.create([o]),u=null;(async()=>{try{await cee(t,{signal:s.signal,timeout:s.timeout},o,a,r),a.close()}catch(l){u=l}})();for await(let l of c){if(u)break;yield l}if(u)throw u}return zHe(i)};async function cee(t,e,r,i,n,s=new Set){let o=r.toString(jHe);if(s.has(o))return;let a=await WHe(t,e,r,n);aee(`Adding block ${r} to car`),await i.put(a),s.add(o);for(let c of a.links)await cee(t,e,c,i,n,s)}async function WHe(t,e,r,i){let n=await t.blocks.get(r,e),s=[],o=await i.getCodec(r.code);if(o)s=[...KHe.createUnsafe({bytes:n,cid:r,codec:o}).links()].map(c=>c[1]);else if(!GHe.includes(r.code))throw new Error(`Can't decode links in block with codec 0x${r.code.toString(16)} to form complete DAG`);return{cid:r,bytes:n,links:s}}});var hee=p((WPt,dee)=>{f();"use strict";var YHe=Ce(),XHe=Jh(),QHe=Fn(),{resolve:fee}=Mi(),ZHe=ae();dee.exports=({codecs:t,repo:e,preload:r})=>YHe(async function(s,o={}){if(o.preload!==!1&&r(s),o.path){let d=o.localResolve?await XHe(fee(s,o.path,t,e,o)):await QHe(fee(s,o.path,t,e,o));if(!d)throw ZHe(new Error("Not found"),"ERR_NOT_FOUND");return d}let a=await t.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})});var bee={};Gt(bee,{CarBlockIterator:()=>Bb,CarCIDIterator:()=>Mb,CarIteratorBase:()=>r2});async function pee(t){if(!(t instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return gee(e2(t))}async function yee(t){if(!t||typeof t[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return gee(iee(t))}async function gee(t){let e=ree(t),{version:r,roots:i}=await e.header();return{version:r,roots:i,iterator:e.blocks()}}var r2,Bb,Mb,mee=Ge(()=>{f();lT();r2=class{constructor(e,r,i){this._version=e,this._roots=r,this._iterable=i,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},Bb=class extends r2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:r,roots:i,iterator:n}=await pee(e);return new Bb(r,i,n)}static async fromIterable(e){let{version:r,roots:i,iterator:n}=await yee(e);return new Bb(r,i,n)}},Mb=class extends r2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let r=await e.next();return r.done?r:{done:!1,value:r.value.cid}}}}static async fromBytes(e){let{version:r,roots:i,iterator:n}=await pee(e);return new Mb(r,i,n)}static async fromIterable(e){let{version:r,roots:i,iterator:n}=await yee(e);return new Mb(r,i,n)}}});var _ee=p((XPt,wee)=>{f();"use strict";var{CarBlockIterator:JHe}=(mee(),bee),e$e=Ce(),t$e=pb(),r$e=Ra(),i$e=Io(),vee=me()("ipfs:components:dag:import");wee.exports=({repo:t})=>{async function*e(r,i={}){let n=await t.gcLock.readLock();try{let s={signal:i.signal,timeout:i.timeout},o=t$e(r),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let u;a instanceof Uint8Array?u=[o]:u=o;for await(let l of u){let d=await n$e(t,s,l);if(i.pinRoots!==!1)for(let h of d){let y="";try{await t.blocks.has(h)?(vee(`Pinning root ${h}`),await t.pins.pinRecursively(h)):y="blockstore: block not found"}catch(g){y=g.message}yield{root:{cid:h,pinErrorMsg:y}}}}}finally{n()}}return e$e(e)};async function n$e(t,e,r){let i=await JHe.fromIterable(r),n=await i.getRoots();return await r$e(t.blocks.putMany(i$e(i,({cid:s,bytes:o})=>(vee(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),n}});var See=p((QPt,Eee)=>{f();"use strict";var{CID:s$e}=(Ae(),ke),o$e=Ce();Eee.exports=({repo:t,codecs:e,hashers:r,preload:i})=>{async function n(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=o.format||"dag-cbor",u=o.version!=null?o.version:c==="dag-pb"?0:1,l=await e.getCodec(c);if(!l)throw new Error(`Unknown codec ${o.format}, please configure additional BlockCodecs for this IPFS instance`);let d=await r.getHasher(o.hashAlg||"sha2-256");if(!d)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let h=l.encode(s),y=await d.digest(h),g=s$e.create(u,l.code,y);return await t.blocks.put(g,h,{signal:o.signal}),o.pin&&await t.pins.pinRecursively(g),o.preload!==!1&&i(g),g}finally{a&&a()}}return o$e(n)}});var Aee=p((ZPt,xee)=>{f();"use strict";var a$e=Ce(),c$e=Ug(),{resolvePath:u$e}=Mi();xee.exports=({repo:t,codecs:e,preload:r})=>{async function i(n,s={}){let{cid:o}=c$e(n);return s.preload!==!1&&r(o),u$e(t,e,n,s)}return a$e(i)}});var Ree=p((JPt,Tee)=>{f();"use strict";var l$e=lee(),f$e=hee(),d$e=_ee(),h$e=See(),p$e=Aee(),Iee=class{constructor({repo:e,codecs:r,hashers:i,preload:n}){this.export=l$e({repo:e,preload:n,codecs:r}),this.get=f$e({codecs:r,repo:e,preload:n}),this.import=d$e({repo:e}),this.resolve=p$e({repo:e,codecs:r,preload:n}),this.put=h$e({repo:e,codecs:r,hashers:i,preload:n})}};Tee.exports=Iee});var n2=p((eCt,Pee)=>{f();var{Multiaddr:y$e}=tt(),i2=(t,e)=>e,g$e=(t,e,r,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${t}:${e}`;let n="tcp",s=`:${e}`;return r[r.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${t}${s}`},b$e={ip4:i2,ip6:(t,e,r,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(t,e,r,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${t}:${e}`:g$e(t,e,i,n),udp:(t,e)=>`udp://${t}:${e}`,dnsaddr:i2,dns4:i2,dns6:i2,ipfs:(t,e)=>`${t}/ipfs/${e}`,p2p:(t,e)=>`${t}/p2p/${e}`,http:t=>`http://${t}`,https:t=>`https://${t}`,ws:t=>`ws://${t}`,wss:t=>`wss://${t}`,"p2p-websocket-star":t=>`${t}/p2p-websocket-star`,"p2p-webrtc-star":t=>`${t}/p2p-webrtc-star`,"p2p-webrtc-direct":t=>`${t}/p2p-webrtc-direct`};Pee.exports=(t,e)=>{let r=new y$e(t),i=t.toString().split("/").slice(1);return r.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=b$e[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var Oee=p((tCt,Cee)=>{f();"use strict";Cee.exports=t=>{if(!Array.isArray(t))throw new TypeError(`Expected an array, got ${typeof t}`);t=[...t];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}});var Nee=p((rCt,qee)=>{f();"use strict";var{default:m$e}=Pc(),v$e=ky(),kee=me(),w$e=Object.assign(kee("ipfs:preload"),{error:kee("ipfs:preload:error")}),_$e=new m$e({concurrency:4});qee.exports=function(e,r={}){return w$e(e),_$e.add(async()=>{let n=(await v$e.post(e,{signal:r.signal})).body.getReader();try{for(;;){let{done:s}=await n.read();if(s)return}}finally{n.releaseLock()}})}});var Mee=p((iCt,Bee)=>{f();"use strict";var E$e=n2(),Dee=me(),S$e=Oee(),{AbortController:x$e}=Qi(),A$e=Nee(),I$e=Fg(),Lb=Object.assign(Dee("ipfs:preload"),{error:Dee("ipfs:preload:error")}),T$e=(t={})=>{if(t.enabled=Boolean(t.enabled),t.addresses=t.addresses||[],t.cache=t.cache||1e3,!t.enabled||!t.addresses.length)return Lb("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,r=[],i=t.addresses.map(E$e),n=I$e(t.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=S$e(i),u=!1,l=Date.now();for(let d of c){if(e)throw new Error(`preload aborted for ${a}`);let h;try{h=new x$e,r=r.concat(h),await A$e(`${d}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:h.signal}),u=!0}catch(y){y.type!=="aborted"&&Lb.error(y)}finally{r=r.filter(y=>y!==h)}if(u)break}Lb(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-l}ms`)}catch(a){Lb.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,Lb(`aborting ${r.length} pending preload request(s)`),r.forEach(o=>o.abort()),r=[]},s};Bee.exports=T$e});var Fee=p((nCt,Uee)=>{f();"use strict";var Lee=me(),s2=Object.assign(Lee("ipfs:mfs-preload"),{error:Lee("ipfs:mfs-preload:error")});Uee.exports=({preload:t,files:e,options:r={}})=>{if(r.interval=r.interval||30*1e3,!r.enabled){s2("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();i!==a&&(s2(`preloading updated MFS root ${i} -> ${o.cid}`),await t(o.cid),i=a)}catch(o){s2.error("failed to preload MFS root",o)}finally{n=setTimeout(s,r.interval)}};return{async start(){let o=await e.stat("/");i=o.cid.toString(),s2(`monitoring MFS root ${o.cid}`),n=setTimeout(s,r.interval)},stop(){clearTimeout(n)}}}});var fT=p((sCt,Kee)=>{f();"use strict";var R$e=c4(),o2;Kee.exports=(t=!1)=>{if(o2)return o2;let e=R$e({singleProcess:t});return o2={readLock:r=>async(...i)=>{let n=await e.readLock();try{return await r.apply(null,i)}finally{n()}},writeLock:r=>async(...i)=>{let n=await e.writeLock();try{return await r.apply(null,i)}finally{n()}}},o2}});var a2=p((oCt,$ee)=>{f();"use strict";var{CID:jee}=(Ae(),ke),{UnixFS:P$e}=yi(),C$e=(xt(),St),{sha256:O$e}=(ei(),Ur),Vee=me()("ipfs:mfs:utils:with-mfs-root"),zee=ae(),{MFS_ROOT_KEY:Hee}=Mi(),k$e=async(t,e)=>{if(e&&e.signal&&e.signal.aborted)throw zee(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.root.open();let r;try{let i=await t.repo.root.get(Hee);r=jee.decode(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;Vee("Creating new MFS root");let n=C$e.encode({Data:new P$e({type:"directory"}).marshal(),Links:[]}),s=await O$e.digest(n);if(r=jee.createV0(s),await t.repo.blocks.put(r,n),e&&e.signal&&e.signal.aborted)throw zee(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.root.put(Hee,r.bytes)}return Vee(`Loaded MFS root /ipfs/${r}`),r};$ee.exports=k$e});var c2=p((aCt,Gee)=>{f();"use strict";var q$e=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);Gee.exports=q$e});var Bc=p((cCt,Yee)=>{f();"use strict";var N$e=a2(),D$e=c2(),{exporter:B$e}=Co(),Wee=ae(),{CID:M$e}=(Ae(),ke),dT="ipfs",L$e=async(t,e,r)=>{let i=await N$e(t,r),n={entryType:"file"},s="";if(e instanceof M$e?s=`/ipfs/${e}`:s=e,s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw Wee(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw Wee(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=D$e(s);if(o[0]===dT){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,n={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${dT}/${i}${o.length?"/"+o.join("/"):""}`,u=`/${dT}/${i}/${o.slice(0,o.length-1).join("/")}`;n={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:u,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=n.type==="mfs"?n.mfsPath:n.path;try{let c=await B$e(a,t.repo.blocks,r);n.cid=c.cid,n.mfsPath=`/ipfs/${c.path}`,n.entryType=c.type,n.content=c.content,(n.entryType==="file"||n.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(n.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return n.exists=Boolean(n.cid),n};Yee.exports=L$e});var Ub=p((uCt,Zee)=>{f();"use strict";var U$e=hr().bind({ignoreUndefined:!0}),F$e=Bc(),{exporter:K$e}=Co(),j$e=me()("ipfs:mfs:stat"),V$e=ae(),z$e=Ce(),Xee=(xt(),St),H$e={withLocal:!1};Zee.exports=t=>{async function e(r,i={}){i=U$e(H$e,i),j$e(`Fetching stats for ${r}`);let{type:n,cid:s,mfsPath:o}=await F$e(t,r,i),a=n==="ipfs"&&s?s:o,c;try{c=await K$e(a,t.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?V$e(new Error(`${r} does not exist`),"ERR_NOT_FOUND"):u}if(!Qee[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return Qee[c.type](c)}return z$e(e)};var Qee={raw:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:t=>{let e={cid:t.cid,type:"file",size:t.unixfs.fileSize(),cumulativeSize:Xee.encode(t.node).length+(t.node.Links||[]).reduce((r,i)=>r+(i.Tsize||0),0),blocks:t.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},directory:t=>{let e={cid:t.cid,type:"directory",size:0,cumulativeSize:Xee.encode(t.node).length+(t.node.Links||[]).reduce((r,i)=>r+(i.Tsize||0),0),blocks:t.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},object:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}});var Op=p((lCt,Jee)=>{f();"use strict";var{walkPath:$$e}=Co(),G$e=me()("ipfs:mfs:utils:to-trail"),W$e=async(t,e)=>{G$e(`Creating trail for path ${e}`);let r=[];for await(let i of $$e(e,t.repo.blocks))r.push({name:i.name,cid:i.cid,size:i.size,type:i.type});return r};Jee.exports=W$e});var pT=p((fCt,nte)=>{f();"use strict";var u2=(xt(),St),{Bucket:ete,createHAMT:Y$e}=S_(),X$e=x_(),hT=b_(),l2=me()("ipfs:mfs:core:utils:hamt-utils"),{UnixFS:tte}=yi(),Q$e=Fn(),{CID:Z$e}=(Ae(),ke),J$e=async(t,e,r,i)=>{let n=hT();if(!i.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let s=Uint8Array.from(r._children.bitField().reverse()),o=tte.unmarshal(i.parent.Data),a=new tte({type:"hamt-sharded-directory",data:s,fanout:r.tableSize(),hashType:n.hamtHashCode,mode:o.mode,mtime:o.mtime}),c=await t.hashers.getHasher(i.hashAlg),u={Data:a.marshal(),Links:e.sort((y,g)=>(y.Name||"").localeCompare(g.Name||""))},l=u2.encode(u),d=await c.digest(l),h=Z$e.create(i.cidVersion,u2.code,d);return i.flush&&await t.repo.blocks.put(h,l),{node:u,cid:h,size:e.reduce((y,g)=>y+(g.Tsize||0),l.length)}},rte=async(t,e,r,i)=>{let n=new ete({hash:e._options.hash,bits:e._options.bits},r,i);return r._putObjectAt(i,n),await f2(t,n,e),n},ite=async t=>{let e=hT(),r=Y$e({hashFn:e.hamtHashFn,bits:e.hamtBucketBits});return await f2(t,r,r),r},f2=async(t,e,r)=>{await Promise.all(t.map(i=>{let n=i.Name||"";if(n.length===2){let s=parseInt(n,16);return e._putObjectAt(s,new ete({hash:r._options.hash,bits:r._options.bits},e,s)),Promise.resolve()}return r.put(n.substring(2),{size:i.Tsize,cid:i.Hash})}))},d2=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),eGe=async(t,e,r)=>{let i=await ite(r.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:d2(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:d2(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=r;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let u=c.node.Links.filter(y=>(y.Name||"").substring(0,2)===c.prefix).pop();if(!u){l2(`Link ${c.prefix}${e} will be added`);continue}if(u.Name===`${c.prefix}${e}`){l2(`Link ${c.prefix}${e} will be replaced`);continue}l2(`Found subshard ${c.prefix}`);let l=await t.repo.blocks.get(u.Hash),d=u2.decode(l);if(!s[a+1]){l2(`Loaded new subshard ${c.prefix}`),await rte(d.Links,i,c.bucket,parseInt(c.prefix,16));let y=await i._findNewBucketAndPos(e);s.push({bucket:y.bucket,prefix:d2(y.pos),node:d});continue}let h=s[a+1];await f2(d.Links,h.bucket,i),h.node=d}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},tGe=async(t,e,r={})=>{let i=hT(),n=new X$e({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},{hamtHashFn:i.hamtHashFn,hamtHashCode:i.hamtHashCode,hamtBucketBits:i.hamtBucketBits,hasher:i.hasher,...r,codec:u2});for(let s=0;s<e.length;s++)await n._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});return Q$e(n.flush(t.repo.blocks))};nte.exports={generatePath:eGe,updateHamtDirectory:J$e,recreateHamtLevel:rte,recreateInitialHamtLevel:ite,addLinksToHamtBucket:f2,toPrefix:d2,createShard:tGe}});var Bf=p((dCt,ote)=>{f();"use strict";var Df=(xt(),St),{sha256:rGe,sha512:iGe}=(ei(),Ur),{CID:ste}=(Ae(),ke),Ua=me()("ipfs:mfs:core:utils:add-link"),{UnixFS:yT}=yi(),nGe=x_(),sGe=b_(),{updateHamtDirectory:oGe,recreateHamtLevel:aGe,recreateInitialHamtLevel:cGe,createShard:uGe,toPrefix:gT,addLinksToHamtBucket:lGe}=pT(),Mc=ae(),fGe=Fn(),dGe=async(t,e)=>{let r=e.parent;if(e.parentCid){let n=ste.asCID(e.parentCid);if(n===null)throw Mc(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==Df.code)throw Mc(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");Ua(`Loading parent node ${n}`);let s=await t.repo.blocks.get(n);r=Df.decode(s)}if(!r)throw Mc(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw Mc(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw Mc(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw Mc(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw Mc(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let i=yT.unmarshal(r.Data);return i.type==="hamt-sharded-directory"?(Ua("Adding link to sharded directory"),yGe(t,{...e,parent:r})):r.Links.length>=e.shardSplitThreshold?(Ua("Converting directory to sharded directory"),hGe(t,{...e,parent:r,mtime:i.mtime,mode:i.mode})):(Ua(`Adding ${e.name} (${e.cid}) to regular directory`),pGe(t,{...e,parent:r}))},hGe=async(t,e)=>{let r=await uGe(t,e.parent.Links.map(i=>({name:i.Name||"",size:i.Tsize||0,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return Ua(`Converted directory to sharded directory ${r.cid}`),r},pGe=async(t,e)=>{let r=e.parent.Links.filter(u=>u.Name!==e.name);if(r.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw Mc(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let i=yT.unmarshal(e.parent.Data),n;if(i.mtime){let u=Date.now(),l=Math.floor(u/1e3);i.mtime={secs:l,nsecs:(u-l*1e3)*1e3},n=i.marshal()}else n=e.parent.Data;e.parent=Df.prepare({Data:n,Links:r});let s=await t.hashers.getHasher(e.hashAlg),o=Df.encode(e.parent),a=await s.digest(o),c=ste.create(e.cidVersion,Df.code,a);return e.flush&&await t.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},yGe=async(t,e)=>{let{shard:r,path:i}=await gGe(t,e),n=await fGe(r.flush(t.repo.blocks)),s=await t.repo.blocks.get(n.cid),o=Df.decode(s),a=e.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==i[0].prefix),c=o.Links.find(u=>(u.Name||"").substring(0,2)===i[0].prefix);if(!c)throw new Error(`No link found with prefix ${i[0].prefix}`);return a.push(c),oGe(t,a,i[0].bucket,e)},gGe=async(t,e)=>{let r={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw Mc(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let i=await cGe(e.parent.Links),n=yT.unmarshal(e.parent.Data),s=sGe(),o;switch(e.hashAlg){case"sha2-256":o=rGe;break;case"sha2-512":o=iGe;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${e.hashAlg}`)}let a=new nGe({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mode:n.mode},{hamtHashFn:s.hamtHashFn,hamtHashCode:s.hamtHashCode,hamtBucketBits:s.hamtBucketBits,hasher:o,...e});a._bucket=i,n.mtime&&(a.mtime=new Date);let c=await i._findNewBucketAndPos(r.name),u=bGe(c);u[0].node=e.parent;let l=0;for(;l<u.length;){let d=u[l];l++;let h=d.node;if(!h)throw new Error("Segment had no node");let y=h.Links.find(v=>(v.Name||"").substring(0,2)===d.prefix);if(!y){Ua(`Link ${d.prefix}${r.name} will be added`),l=u.length;break}if(y.Name===`${d.prefix}${r.name}`){Ua(`Link ${d.prefix}${r.name} will be replaced`),l=u.length;break}if((y.Name||"").length>2){Ua(`Link ${y.Name} ${y.Hash} will be replaced with a subshard`),l=u.length;break}Ua(`Found subshard ${d.prefix}`);let g=await t.repo.blocks.get(y.Hash),m=Df.decode(g);if(!u[l]){Ua(`Loaded new subshard ${d.prefix}`),await aGe(m.Links,i,d.bucket,parseInt(d.prefix,16));let v=await i._findNewBucketAndPos(r.name);u.push({bucket:v.bucket,prefix:gT(v.pos),node:m});break}let E=u[l];await lGe(m.Links,E.bucket,i),E.node=m}return await a._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:a,path:u}},bGe=t=>{let e=[{bucket:t.bucket,prefix:gT(t.pos)}],r=t.bucket._parent,i=t.bucket._posAtParent;for(;r;)e.push({bucket:r,prefix:gT(i)}),i=r._posAtParent,r=r._parent;return e.reverse(),e};ote.exports=dGe});var Mf=p((hCt,cte)=>{f();"use strict";var ate=me()("ipfs:mfs:utils:update-tree"),mGe=Bf(),{decode:vGe}=(xt(),St),wGe={shardSplitThreshold:1e3},_Ge=async(t,e,r)=>{r=Object.assign({},wGe,r),ate("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of t.repo.blocks.getMany(e.map(a=>a.cid))){let a=vGe(o),c=e[i].cid,u=e[i].name;if(i++,!n){n={cid:c,name:u,size:o.length};continue}let l=await mGe(t,{parent:a,name:n.name,cid:n.cid,size:n.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});n={cid:l.cid,name:u,size:l.size}}let{cid:s}=n;return ate(`Final CID ${s}`),s};cte.exports=_Ge});var Lf=p((pCt,ute)=>{f();"use strict";var EGe=me()("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:SGe}=Mi(),xGe=ae(),AGe=async(t,e,r)=>{if(r&&r.signal&&r.signal.aborted)throw xGe(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return EGe(`New MFS root will be ${e}`),await t.repo.root.put(SGe,e.bytes),e};ute.exports=AGe});var dte=p((yCt,fte)=>{f();"use strict";var{UnixFS:IGe}=yi(),lte=(xt(),St),{CID:TGe}=(Ae(),ke),RGe=async(t,e,r)=>{let i=new IGe({type:e,mode:r.mode,mtime:r.mtime}),n=await t.hashers.getHasher(r.hashAlg),s={Data:i.marshal(),Links:[]},o=lte.encode(s),a=await n.digest(o),c=TGe.create(r.cidVersion,lte.code,a);return r.flush&&await t.repo.blocks.put(c,o),{cid:c,node:s}};fte.exports=RGe});var h2=p((gCt,pte)=>{f();"use strict";var kp=ae(),hte=me()("ipfs:mfs:mkdir"),{exporter:PGe}=Co(),CGe=dte(),OGe=c2(),kGe=Lf(),qGe=Mf(),NGe=Bf(),DGe=a2(),BGe=hr().bind({ignoreUndefined:!0}),MGe=Ce(),LGe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};pte.exports=t=>{async function e(r,i={}){let n=BGe(LGe,i);if(!r)throw new Error("no path given to Mkdir");if(r=r.trim(),r==="/"){if(n.parents)return;throw kp(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(r.substring(0,1)!=="/")throw kp(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");hte(`Creating ${r}`);let s=OGe(r);if(s[0]==="ipfs")throw kp(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await DGe(t,n),a,c=[],u=await CGe(t,"directory",n);for(let d=0;d<=s.length;d++){let h=s.slice(0,d),y=`/ipfs/${o}/${h.join("/")}`;try{if(a=await PGe(y,t.repo.blocks),a.type!=="file"&&a.type!=="directory")throw kp(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(d===s.length){if(n.parents)return;throw kp(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(g){if(g.code==="ERR_NOT_FOUND"){if(d<s.length&&!n.parents)throw kp(new Error(`Intermediate directory path ${y} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await UGe(t,h[h.length-1],u,c[c.length-1],c,n)}else throw g}}let l=await qGe(t,c,n);await kGe(t,l,n)}return MGe(e)};var UGe=async(t,e,r,i,n,s)=>{hte(`Adding empty dir called ${e} to ${i.cid}`);let o=await NGe(t,{parent:i.node,parentCid:i.cid,size:0,cid:r.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:r.cid})}});var g2=p((bCt,wte)=>{f();"use strict";var yte=h2(),FGe=Ub(),p2=me()("ipfs:mfs:cp"),Uf=ae(),gte=Mf(),bte=Lf(),KGe=Bf(),y2=Bc(),jGe=hr().bind({ignoreUndefined:!0}),VGe=Op(),zGe=Ce(),HGe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};wte.exports=t=>{async function e(r,i,n={}){let s=jGe(HGe,n);Array.isArray(r)||(r=[r]);let o=await Promise.all(r.map(h=>y2(t,h,s))),a=await y2(t,i,s);if(!o.length||!a)throw Uf(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(h=>!h.exists);if(c)throw Uf(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let u=mte(a);if(a.exists){if(p2("Destination exists"),o.length===1&&!u)throw Uf(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(p2("Destination does not exist"),o.length>1){if(!s.parents)throw Uf(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await yte(t)(a.path,s),a=await y2(t,a.path,s)}else if(a.parts.length>1){let h=`/${a.parts.slice(0,-1).join("/")}`;try{await FGe(t)(h,s)}catch(y){if(y.code!=="ERR_NOT_FOUND")throw y;if(!s.parents)throw Uf(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await yte(t)(h,s),a=await y2(t,a.path,s)}}let l=mte(a)?a.mfsPath:a.mfsDirectory,d=await VGe(t,l);if(o.length===1){let h=o.pop();if(!h)throw Uf(new Error("could not find source"),"ERR_INVALID_PARAMS");let y=u?h.name:a.name;return p2(`Only one source, copying to destination ${u?"directory":"file"} ${y}`),$Ge(t,h,y,d,s)}return p2("Multiple sources, wrapping in a directory"),GGe(t,o,a,d,s)}return zGe(e)};var mte=t=>t.unixfs&&t.unixfs.type&&t.unixfs.type.includes("directory"),$Ge=async(t,e,r,i,n)=>{let s=i.pop();if(!s)throw Uf(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await vte(t,e,r,s,n),i.push(s);let o=await gte(t,i,n);await bte(t,o,n)},GGe=async(t,e,r,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];r=await vte(t,a,a.name,r,n)}i[i.length-1]=r;let s=await gte(t,i,n);await bte(t,s,n)},vte=async(t,e,r,i,n)=>{let s=await t.repo.blocks.get(e.cid),{node:o,cid:a}=await KGe(t,{parentCid:i.cid,size:s.length,cid:e.cid,name:r,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=o.size,i}});var xte=p((mCt,Ste)=>{f();"use strict";var bT=(xt(),St),{CID:_te}=(Ae(),ke),tl=me()("ipfs:mfs:core:utils:remove-link"),{UnixFS:WGe}=yi(),{generatePath:YGe,updateHamtDirectory:mT}=pT(),Ff=ae(),XGe=async(t,e)=>{let r=e.parent;if(e.parentCid){let n=_te.asCID(e.parentCid);if(n===null)throw Ff(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");tl(`Loading parent node ${n}`);let s=await t.repo.blocks.get(n);r=bT.decode(s)}if(!r)throw Ff(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw Ff(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw Ff(new Error("Parent node had no data"),"ERR_INVALID_NODE");return WGe.unmarshal(r.Data).type==="hamt-sharded-directory"?(tl(`Removing ${e.name} from sharded directory`),ZGe(t,{...e,parent:r})):(tl(`Removing link ${e.name} regular directory`),QGe(t,{...e,parent:r}))},QGe=async(t,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let r=await bT.encode(e.parent),n=await(await t.hashers.getHasher(e.hashAlg)).digest(r),s=_te.create(e.cidVersion,bT.code,n);return await t.repo.blocks.put(s,r),tl(`Updated regular directory ${s}`),{node:e.parent,cid:s}},ZGe=async(t,e)=>{let{rootBucket:r,path:i}=await YGe(t,e.name,e.parent);await r.del(e.name);let{node:n}=await Ete(t,i,e.name,e);return mT(t,n.Links,r,e)},Ete=async(t,e,r,i)=>{let n=e.pop();if(!n)throw Ff(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw Ff(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(y=>(y.Name||"").substring(0,2)===o);if(!c)throw Ff(new Error(`No link found with prefix ${o} for file ${r}`),"ERR_NOT_FOUND");if(c.Name===`${o}${r}`){tl(`Removing existing link ${c.Name}`);let y=a.Links.filter(g=>g.Name!==c.Name);return await s.del(r),mT(t,y,s,i)}tl(`Descending into sub-shard ${c.Name} for ${o}${r}`);let u=await Ete(t,e,r,i),l=u.cid,d=u.size,h=o;if(u.node.Links.length===1){tl(`Removing subshard for ${o}`);let y=u.node.Links[0];h=`${o}${(y.Name||"").substring(2)}`,l=y.Hash,d=y.Tsize||0}return tl(`Updating shard ${o} with name ${h}`),JGe(t,s,a,o,h,d,l,i)},JGe=(t,e,r,i,n,s,o,a)=>{let c=r.Links.filter(u=>u.Name!==i);return c.push({Name:n,Tsize:s,Hash:o}),mT(t,c,e,a)};Ste.exports=XGe});var m2=p((vCt,Ite)=>{f();"use strict";var b2=ae(),eWe=Mf(),tWe=Lf(),rWe=xte(),Ate=Bc(),iWe=Op(),nWe=Ce(),sWe=hr().bind({ignoreUndefined:!0}),oWe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};Ite.exports=t=>{async function e(r,i={}){let n=sWe(oWe,i);Array.isArray(r)||(r=[r]);let s=await Promise.all(r.map(o=>Ate(t,o,n)));if(!s.length)throw b2(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw b2(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await aWe(t,o.path,n)}return nWe(e)};var aWe=async(t,e,r)=>{let i=await Ate(t,e,r),n=await iWe(t,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw b2(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!r.recursive)throw b2(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await rWe(t,{parentCid:o.cid,name:s.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});o.cid=a;let c=await eWe(t,n,r);await tWe(t,c,r)}});var kte=p((wCt,Ote)=>{f();"use strict";var cWe=hr().bind({ignoreUndefined:!0}),uWe=Bc(),lWe=me()("ipfs:mfs:touch"),Fb=ae(),{UnixFS:Tte}=yi(),fWe=Op(),dWe=Bf(),hWe=Mf(),pWe=Lf(),Kf=(xt(),St),{CID:Rte}=(Ae(),ke),{pipe:yWe}=Er(),{importer:gWe}=A_(),{recursive:bWe}=Co(),mWe=Fn(),vWe=g2(),wWe=m2(),_We=Af(),EWe=Ce(),Pte={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function SWe(t,e,r){let i=0;return(t.includes("x")||t.includes("X")&&(r||e&1||e&8||e&64))&&(i+=1),t.includes("w")&&(i+=2),t.includes("r")&&(i+=4),i}function xWe(t,e){let r=0;return t.includes("u")&&(r+=e<<6),t.includes("g")&&(r+=e<<3),t.includes("o")&&(r+=e),r}function AWe(t,e,r){return e.includes("t")&&(r+=parseInt("1000",8)),e.includes("s")&&(t.includes("u")&&(r+=parseInt("4000",8)),t.includes("g")&&(r+=parseInt("2000",8))),r}function IWe(t,e,r){e||(e=0);let i=t.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${t}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=SWe(o,e,r);return a=xWe(n,a),a=AWe(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function Cte(t,e){if(t instanceof String||typeof t=="string"){let r=`${t}`;r.match(/^\d+$/g)?t=parseInt(r,8):t=0+r.split(",").reduce((i,n)=>IWe(n,i,e.isDirectory()),e.mode||0)}return t}Ote.exports=t=>{async function e(r,i,n={}){let s=cWe(Pte,n);lWe(`Fetching stats for ${r}`);let{cid:o,mfsDirectory:a,name:c}=await uWe(t,r,s);if(o.code!==Kf.code)throw Fb(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let G=await yWe(async function*(){for await(let Y of bWe(o,t.repo.blocks)){if(Y.type!=="file"&&Y.type!=="directory")throw Fb(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");Y.unixfs.mode=Cte(i,Y.unixfs);let P=Kf.prepare({Data:Y.unixfs.marshal(),Links:Y.node.Links});yield{path:Y.path,content:P}}},Y=>gWe(Y,t.repo.blocks,{...s,pin:!1,dagBuilder:async function*(P,b,w){for await(let S of P)yield async function(){let C=S.content,B=Kf.encode(C),W=await _We(B,b,w);if(!C.Data)throw Fb(new Error(`${W} had no data`),"ERR_INVALID_NODE");let j=Tte.unmarshal(C.Data);return{cid:W,size:B.length,path:S.path,unixfs:j}}}}),Y=>mWe(Y));if(!G)throw Fb(new Error(`Could not chmod ${r}`),"ERR_COULD_NOT_CHMOD");await wWe(t)(r,s),await vWe(t)(`/ipfs/${G.cid}`,r,s);return}let u=await t.repo.blocks.get(o),l=Kf.decode(u);if(!l.Data)throw Fb(new Error(`${o} had no data`),"ERR_INVALID_NODE");let d=Tte.unmarshal(l.Data);d.mode=Cte(i,d);let h=Kf.encode({Data:d.marshal(),Links:l.Links}),y=s.hashAlg||Pte.hashAlg,m=await(await t.hashers.getHasher(y)).digest(h),E=Rte.create(s.cidVersion,Kf.code,m);s.flush&&await t.repo.blocks.put(E,h);let v=await fWe(t,a),A=v[v.length-1],R=Rte.decode(A.cid.bytes),F=await t.repo.blocks.get(R),q=Kf.decode(F),N=await dWe(t,{parent:q,name:c,cid:E,size:h.length,flush:s.flush,hashAlg:y,cidVersion:o.version,shardSplitThreshold:1/0});A.cid=N.cid;let z=await hWe(t,v,s);await pWe(t,z,s)}return EWe(e)}});var Nte=p((_Ct,qte)=>{f();"use strict";var TWe=Ub(),RWe=Ce(),PWe=hr().bind({ignoreUndefined:!0}),CWe={};qte.exports=t=>{async function e(r,i={}){i=PWe(CWe,i);let{cid:n}=await TWe(t)(r,i);return n}return RWe(e)}});var Bte=p((ECt,Dte)=>{f();"use strict";var OWe=g2(),kWe=m2(),qWe=hr().bind({ignoreUndefined:!0}),NWe=Ce(),DWe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};Dte.exports=t=>{async function e(r,i,n={}){let s=qWe(DWe,n);await OWe(t)(r,i,s),await kWe(t)(r,{...s,recursive:!0})}return NWe(e)}});var jte=p((SCt,Kte)=>{f();"use strict";var BWe=hr().bind({ignoreUndefined:!0}),MWe=Bc(),LWe=me()("ipfs:mfs:touch"),Mte=ae(),{UnixFS:Lte}=yi(),UWe=Op(),FWe=Bf(),KWe=Mf(),jWe=Lf(),jf=(xt(),St),{CID:Ute}=(Ae(),ke),VWe=Ce(),Fte={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};Kte.exports=t=>{async function e(r,i={}){let n=BWe(Fte,i);n.mtime=n.mtime||new Date,LWe(`Touching ${r} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await MWe(t,r,n),u=i.hashAlg||Fte.hashAlg,l=await t.hashers.getHasher(u),d,h,y=n.cidVersion;if(c){if(s.code!==jf.code)throw Mte(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");y=s.version;let q=await t.repo.blocks.get(s),N=jf.decode(q);if(!N.Data)throw Mte(new Error(`${r} had no data`),"ERR_INVALID_NODE");let z=Lte.unmarshal(N.Data);z.mtime=n.mtime,d=jf.encode({Data:z.marshal(),Links:N.Links});let G=await l.digest(d);h=Ute.create(n.cidVersion,jf.code,G),n.flush&&await t.repo.blocks.put(h,d)}else{let q=new Lte({type:"file",mtime:n.mtime});d=jf.encode({Data:q.marshal(),Links:[]});let N=await l.digest(d);h=Ute.create(n.cidVersion,jf.code,N),n.flush&&await t.repo.blocks.put(h,d)}let g=await UWe(t,o),m=g[g.length-1],E=m.cid,v=await t.repo.blocks.get(E),A=jf.decode(v),R=await FWe(t,{parent:A,name:a,cid:h,size:d.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:y});m.cid=R.cid;let F=await KWe(t,g,n);await jWe(t,F,n)}return VWe(e)}});var $te=p((xCt,Hte)=>{f();"use strict";var Vte=ae(),Kb=me()("ipfs:mfs:utils:to-async-iterator"),{MFS_MAX_CHUNK_SIZE:zte}=Mi(),zWe=ct(),HWe=t=>{if(!t)throw Vte(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof t=="string"||t instanceof String)&&(Kb("Content was a string"),t=zWe(t.toString())),t.length)return Kb("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield t}};if(t[Symbol.asyncIterator])return Kb("Content was an async iterator"),t;if(t[Symbol.iterator])return Kb("Content was an iterator"),t;if(globalThis.Blob&&t instanceof globalThis.Blob){Kb("Content was an HTML5 Blob");let e=0,r={next:()=>e>t.size?{done:!0}:new Promise((i,n)=>{let s=t.slice(e,zte);e+=zte;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>r}}throw Vte(new Error(`Don't know how to convert ${t} into an async iterator`),"ERR_INVALID_PARAMS")};Hte.exports=HWe});var Qte=p((ACt,Xte)=>{f();"use strict";var Fa=me()("ipfs:mfs:write"),{importer:$We}=A_(),{decode:GWe}=(xt(),St),{sha256:WWe,sha512:YWe}=(ei(),Ur),XWe=Ub(),QWe=h2(),ZWe=Bf(),JWe=hr().bind({ignoreUndefined:!0}),Gte=fT(),eYe=$te(),vT=Bc(),tYe=c2(),rYe=Op(),iYe=Mf(),nYe=Lf(),Lc=ae(),{MFS_MAX_CHUNK_SIZE:sYe}=Mi(),oYe=Fn(),aYe=Ce(),{parseMode:cYe,parseMtime:uYe}=yi(),lYe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(t,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};Xte.exports=t=>{async function e(r,i,n={}){let s=JWe(lYe,n),o,a,c;if(Fa("Reading source, destination and parent"),await Gte().readLock(async()=>{o=await eYe(i),a=await vT(t,r,s),c=await vT(t,a.mfsDirectory,s)})(),Fa("Read source, destination and parent"),!s.parents&&!c.exists)throw Lc(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw Lc(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw Lc(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw Lc(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw Lc(new Error("not a file"),"ERR_NOT_A_FILE");return fYe(t,r,o,a,s)}return aYe(e)};var fYe=async(t,e,r,i,n)=>{let s=await dYe(t,r,i,n);await Gte().writeLock(async()=>{let o=tYe(e),a=o.pop();if(a==null)throw Lc(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await XWe(t)(`/${o.join("/")}`,n),c=!0}catch(E){if(E.code!=="ERR_NOT_FOUND")throw E}c||await QWe(t)(`/${o.join("/")}`,n);let u=await vT(t,e,n),l=await rYe(t,u.mfsDirectory),d=l[l.length-1];if(!d)throw Lc(new Error("directory does not exist"),"ERR_NO_EXIST");if(!d.type||!d.type.includes("directory"))throw Lc(new Error(`cannot write to ${d.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let h=await t.repo.blocks.get(d.cid),y=GWe(h),g=await ZWe(t,{parent:y,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});d.cid=g.cid;let m=await iYe(t,l,n);await nYe(t,m,n)})()},dYe=async(t,e,r,i)=>{r.exists?Fa(`Overwriting file ${r.cid} offset ${i.offset} length ${i.length}`):Fa(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(r.unixfs){if(Fa(`Writing first ${i.offset} bytes of original file`),n.push(()=>r.content({offset:0,length:i.offset})),r.unixfs.fileSize()<i.offset){let l=i.offset-r.unixfs.fileSize();Fa(`Writing zeros for extra ${l} bytes`),n.push(Yte(l))}}else Fa(`Writing zeros for first ${i.offset} bytes`),n.push(Yte(i.offset));n.push(Wte(e,i.length));let s=pYe(hYe(n),l=>{if(r.unixfs&&!i.truncate){let d=r.unixfs.fileSize();if(d>l)return Fa(`Writing last ${d-l} of ${d} bytes from original file starting at offset ${l}`),r.content({offset:l});Fa("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=cYe(i.mode):r&&r.unixfs&&(o=r.unixfs.mode);let a;i.mtime!=null?a=uYe(i.mtime):r&&r.unixfs&&(a=r.unixfs.mtime);let c;switch(i.hashAlg){case"sha2-256":c=WWe;break;case"sha2-512":c=YWe;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${i.hashAlg}`)}let u=await oYe($We([{content:s,mode:o,mtime:a}],t.repo.blocks,{progress:i.progress,hasher:c,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType}));if(!u)throw Lc(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return Fa(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},Wte=(t,e)=>async function*(){let i=0;for await(let n of t){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},Yte=(t,e=sYe)=>{let r=new Uint8Array(e);async function*i(){for(;;)yield r.slice()}return Wte(i(),t)},hYe=async function*(t){for(let e=0;e<t.length;e++)yield*t[e]()},pYe=async function*(t,e){let r=0;for await(let i of t)r+=i.length,yield i;for await(let i of e(r))r+=i.length,yield i}});var ere=p((ICt,Jte)=>{f();"use strict";var{exporter:yYe}=Co(),gYe=hr().bind({ignoreUndefined:!0}),bYe=Bc(),Zte=ae(),mYe=Ce(),vYe={offset:0,length:1/0};Jte.exports=t=>{function e(r,i={}){return i=gYe(vYe,i),{[Symbol.asyncIterator]:async function*(){let s=await bYe(t,r,i),o=await yYe(s.mfsPath,t.repo.blocks);if(o.type!=="file")throw Zte(new Error(`${r} was not a file`),"ERR_NOT_FILE");if(!o.content)throw Zte(new Error(`Could not load content stream from ${r}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return mYe(e)}});var ire=p((TCt,rre)=>{f();"use strict";var{exporter:wYe}=Co(),_Ye=Bc(),EYe=Ce(),SYe=Io(),tre=t=>{let e={cid:t.cid,name:t.name,type:t.type==="directory"?"directory":"file",size:t.size};return(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,e.mtime=t.unixfs.mtime),e};rre.exports=t=>{async function*e(r,i={}){let n=await _Ye(t,r,i),s=await wYe(n.mfsPath,t.repo.blocks);if(s.type==="directory"){yield*SYe(s.content(i),tre);return}yield tre(s)}return EYe(e)}});var cre=p((RCt,are)=>{f();"use strict";var xYe=fT(),nre=qh(),AYe={stat:Ub()},IYe={chmod:kte(),cp:g2(),flush:Nte(),mkdir:h2(),mv:Bte(),rm:m2(),touch:jte()},sre={write:Qte(),read:ere(),ls:ire()},ore=({options:t,mfs:e,operations:r,lock:i})=>{Object.keys(r).forEach(n=>{e[n]=i(r[n](t))})},TYe={repoOwner:!0,repo:null};function RYe(t){let{repoOwner:e}=Object.assign({},TYe||{},t),r=xYe(e),i=o=>r.readLock(o),n=o=>r.writeLock(o),s={};return ore({options:t,mfs:s,operations:AYe,lock:i}),ore({options:t,mfs:s,operations:IYe,lock:n}),Object.keys(sre).forEach(o=>{s[o]=sre[o](t)}),s}are.exports=({repo:t,preload:e,hashers:r,options:i})=>{let n=RYe({repo:t,repoOwner:Boolean(i.repoOwner),hashers:r}),s=o=>(...c)=>{let u=c.filter(l=>nre.ipfsPath(l)||nre.cid(l));if(u.length){let l=c[c.length-1];l&&l.preload!==!1&&u.forEach(d=>e(d))}return o(...c)};return{...n,chmod:n.chmod,cp:s(n.cp),mkdir:n.mkdir,stat:s(n.stat),rm:n.rm,read:s(n.read),touch:n.touch,write:n.write,mv:s(n.mv),flush:n.flush,ls:s(async function*(...o){for await(let a of n.ls(...o))yield{...a,size:a.size||0}})}}});var lre=p((PCt,ure)=>{f();"use strict";var PYe=Ce();ure.exports=({keychain:t})=>PYe((r,i)=>t.exportKey(r,i))});var pre=p((CCt,hre)=>{f();"use strict";var CYe=Ce(),fre="ed25519",dre=2048;hre.exports=({keychain:t})=>CYe((r,i={type:fre,size:dre})=>t.createKey(r,i.type||fre,i.size||dre))});var gre=p((OCt,yre)=>{f();"use strict";var OYe=Ce();yre.exports=({keychain:t})=>OYe((r,i,n)=>t.importKey(r,i,n))});var mre=p((kCt,bre)=>{f();"use strict";var kYe=Ce();bre.exports=({keychain:t})=>kYe(r=>t.findKeyByName(r))});var wre=p((qCt,vre)=>{f();"use strict";var qYe=Ce();vre.exports=({keychain:t})=>qYe(()=>t.listKeys())});var Ere=p((NCt,_re)=>{f();"use strict";var NYe=Ce();_re.exports=({keychain:t})=>NYe(async(r,i)=>{let n=await t.renameKey(r,i);return{was:r,now:n.name,id:n.id,overwrite:!1}})});var xre=p((DCt,Sre)=>{f();"use strict";var DYe=Ce();Sre.exports=({keychain:t})=>DYe(r=>t.removeKey(r))});var Tre=p((BCt,Ire)=>{f();"use strict";var BYe=lre(),MYe=pre(),LYe=gre(),UYe=mre(),FYe=wre(),KYe=Ere(),jYe=xre(),Are=class{constructor({keychain:e}){this.gen=MYe({keychain:e}),this.list=FYe({keychain:e}),this.rm=jYe({keychain:e}),this.rename=KYe({keychain:e}),this.export=BYe({keychain:e}),this.import=LYe({keychain:e}),this.info=UYe({keychain:e})}};Ire.exports=Are});var rl=p((MCt,Rre)=>{f();"use strict";var VYe=(xt(),St),zYe=Ce();Rre.exports=({repo:t,preload:e})=>{async function r(i,n={}){n.preload!==!1&&e(i);let s=await t.blocks.get(i,n);return VYe.decode(s)}return zYe(r)}});var Cre=p((LCt,Pre)=>{f();"use strict";var HYe=Ce();Pre.exports=({repo:t,preload:e})=>{let r=rl()({repo:t,preload:e});async function i(n,s={}){return(await r(n,s)).Data||new Uint8Array(0)}return HYe(i)}});var qre=p((UCt,kre)=>{f();"use strict";var $Ye=(xt(),St),GYe=(Tc(),df),WYe=(Es(),Zn),{CID:Ore}=(Ae(),ke),YYe=Ce();function wT(t,e=[]){for(let r in t){let i=t[r];if(r==="/"&&Object.keys(t).length===1)try{e.push({Name:"",Tsize:0,Hash:Ore.parse(i)});continue}catch(n){}if(i instanceof Ore){e.push({Name:"",Tsize:0,Hash:i});continue}Array.isArray(i)&&wT(i,e),i&&typeof i=="object"&&wT(i,e)}return e}kre.exports=({repo:t,codecs:e})=>{async function r(i,n={}){let s=await e.getCodec(i.code),o=await t.blocks.get(i,n),a=s.decode(o);if(i.code===WYe.code)return[];if(i.code===$Ye.code)return a.Links;if(i.code===GYe.code)return wT(a);throw new Error(`Cannot resolve links from codec ${i.code}`)}return YYe(r)}});var Dre=p((FCt,Nre)=>{f();"use strict";var XYe=(xt(),St),{sha256:QYe}=(ei(),Ur),{UnixFS:ZYe}=yi(),JYe=Ce(),{CID:eXe}=(Ae(),ke);Nre.exports=({repo:t,preload:e})=>{async function r(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new ZYe({type:"directory"}).marshal();else throw new Error("unknown template");let s=XYe.encode({Data:n,Links:[]}),o=await QYe.digest(s),a=eXe.createV0(o);return await t.blocks.put(a,s,{signal:i.signal}),i.preload!==!1&&e(a),a}return JYe(r)}});var qp=p((KCt,Bre)=>{f();"use strict";var tXe=(xt(),St),{CID:rXe}=(Ae(),ke),{sha256:iXe}=(ei(),Ur),nXe=Ce();Bre.exports=({repo:t,preload:e})=>{async function r(i,n={}){let s=await t.gcLock.readLock();try{let o=tXe.encode(i),a=await iXe.digest(o),c=rXe.createV0(a);return await t.blocks.put(c,o,{signal:n.signal}),n.preload!==!1&&e(c),n.pin&&await t.pins.pinRecursively(c,{signal:n.signal}),c}finally{s()}}return nXe(r)}});var Lre=p((jCt,Mre)=>{f();"use strict";var sXe=(xt(),St),oXe=Ce();Mre.exports=({repo:t,preload:e})=>{let r=rl()({repo:t,preload:e});async function i(n,s={}){let o=await r(n,s),c=sXe.encode(o).length,u=o.Links.reduce((l,d)=>l+(d.Tsize||0),0);return{Hash:n,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+u}}return oXe(i)}});var Fre=p((VCt,Ure)=>{f();"use strict";var aXe=Ce();Ure.exports=({repo:t,preload:e})=>{let r=rl()({repo:t,preload:e}),i=qp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a);return i({...c,Links:c.Links.concat([o])},a)}return aXe(n)}});var jre=p((zCt,Kre)=>{f();"use strict";var cXe=Ce(),uXe=tn();Kre.exports=({repo:t,preload:e})=>{let r=rl()({repo:t,preload:e}),i=qp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a),u=uXe([c.Data||[],o]);return i({...c,Data:u},a)}return cXe(n)}});var zre=p((HCt,Vre)=>{f();"use strict";var lXe=Ce();Vre.exports=({repo:t,preload:e})=>{let r=rl()({repo:t,preload:e}),i=qp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a),u=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(l=>l.Name!==u),i(c,a)}return lXe(n)}});var $re=p(($Ct,Hre)=>{f();"use strict";var fXe=Ce();Hre.exports=({repo:t,preload:e})=>{let r=rl()({repo:t,preload:e}),i=qp()({repo:t,preload:e});async function n(s,o,a={}){let c=await r(s,a);return i({...c,Data:o},a)}return fXe(n)}});var Yre=p((GCt,Wre)=>{f();"use strict";var dXe=Fre(),hXe=jre(),pXe=zre(),yXe=$re(),Gre=class{constructor({repo:e,preload:r}){this.addLink=dXe({repo:e,preload:r}),this.appendData=hXe({repo:e,preload:r}),this.rmLink=pXe({repo:e,preload:r}),this.setData=yXe({repo:e,preload:r})}};Wre.exports=Gre});var Zre=p((WCt,Qre)=>{f();"use strict";var gXe=Cre(),bXe=rl(),mXe=qre(),vXe=Dre(),wXe=qp(),_Xe=Lre(),EXe=Yre(),Xre=class{constructor({repo:e,codecs:r,preload:i}){this.data=gXe({repo:e,preload:i}),this.get=bXe({repo:e,preload:i}),this.links=mXe({repo:e,codecs:r}),this.new=vXe({repo:e,preload:i}),this.put=wXe({repo:e,preload:i}),this.stat=_Xe({repo:e,preload:i}),this.patch=new EXe({repo:e,preload:i})}};Qre.exports=Xre});var eie=p((YCt,Jre)=>{f();"use strict";var SXe=me()("ipfs:repo:gc"),xXe=Ce(),AXe=a2();Jre.exports=({repo:t,hashers:e})=>{async function*r(i={}){let n=Date.now(),s;try{s=await AXe({repo:t,hashers:e},i),await t.pins.pinRecursively(s),yield*t.gc()}finally{s&&await t.pins.unpin(s)}SXe(`Complete (${Date.now()-n}ms)`)}return xXe(r)}});var _T=p((XCt,tie)=>{f();"use strict";var IXe=Ce();tie.exports=({repo:t})=>{async function e(r={}){let i=await t.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return IXe(e)}});var iie=p((QCt,rie)=>{f();"use strict";var{repoVersion:TXe}=mf(),RXe=Ce();rie.exports=({repo:t})=>{async function e(r={}){try{await t._checkInitialized(r)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return TXe;throw i}return t.version.get()}return RXe(e)}});var oie=p((ZCt,sie)=>{f();"use strict";var PXe=eie(),CXe=_T(),OXe=iie(),nie=class{constructor({repo:e,hashers:r}){this.gc=PXe({repo:e,hashers:r}),this.stat=CXe({repo:e}),this.version=OXe({repo:e}),this.setApiAddr=i=>e.apiAddr.set(i)}};sie.exports=nie});var uie=p((JCt,cie)=>{f();"use strict";var{default:kXe}=Mg(),qXe=ae(),NXe=Ce();function aie(t,e){let r;if(t.metrics?e.peer?r=t.metrics.forPeer(e.peer):e.proto?r=t.metrics.forProtocol(e.proto):r=t.metrics.global:r=void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let{movingAverages:i,snapshot:n}=r;return{totalIn:BigInt(n.dataReceived.integerValue().toString()),totalOut:BigInt(n.dataSent.integerValue().toString()),rateIn:i.dataReceived[6e4].movingAverage()/60,rateOut:i.dataSent[6e4].movingAverage()/60}}cie.exports=({network:t})=>NXe(async function*(r={}){let{libp2p:i}=await t.use(r);if(!r.poll){yield aie(i,r);return}let n=r.interval||1e3,s=-1;try{if(s=typeof n=="string"?kXe(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw qXe(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield aie(i,r),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})});var die=p((eOt,fie)=>{f();"use strict";var DXe=uie(),BXe=_T(),MXe=z4(),lie=class{constructor({repo:e,network:r}){this.repo=BXe({repo:e}),this.bw=DXe({network:r}),this.bitswap=MXe({network:r})}};fie.exports=lie});var ET=p((tOt,hie)=>{f();"use strict";hie.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),i=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[r]=n;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,r);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var jb=p((rOt,pie)=>{f();"use strict";var LXe=ET();pie.exports=function(){return LXe()&&!!Symbol.toStringTag}});var bie=p((iOt,gie)=>{f();"use strict";var yie=typeof Symbol!="undefined"&&Symbol,UXe=ET();gie.exports=function(){return typeof yie!="function"||typeof Symbol!="function"||typeof yie("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:UXe()}});var vie=p((nOt,mie)=>{f();"use strict";var FXe="Function.prototype.bind called on incompatible ",ST=Array.prototype.slice,KXe=Object.prototype.toString,jXe="[object Function]";mie.exports=function(e){var r=this;if(typeof r!="function"||KXe.call(r)!==jXe)throw new TypeError(FXe+r);for(var i=ST.call(arguments,1),n,s=function(){if(this instanceof n){var l=r.apply(this,i.concat(ST.call(arguments)));return Object(l)===l?l:this}else return r.apply(e,i.concat(ST.call(arguments)))},o=Math.max(0,r.length-i.length),a=[],c=0;c<o;c++)a.push("$"+c);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),r.prototype){var u=function(){};u.prototype=r.prototype,n.prototype=new u,u.prototype=null}return n}});var v2=p((sOt,wie)=>{f();"use strict";var VXe=vie();wie.exports=Function.prototype.bind||VXe});var Eie=p((oOt,_ie)=>{f();"use strict";var zXe=v2();_ie.exports=zXe.call(Function.call,Object.prototype.hasOwnProperty)});var S2=p((aOt,Iie)=>{f();"use strict";var Pt,Vb=SyntaxError,Sie=Function,Np=TypeError,xT=function(t){try{return Sie('"use strict"; return ('+t+").constructor;")()}catch(e){}},Vf=Object.getOwnPropertyDescriptor;if(Vf)try{Vf({},"")}catch(t){Vf=null}var AT=function(){throw new Np},HXe=Vf?function(){try{return arguments.callee,AT}catch(t){try{return Vf(arguments,"callee").get}catch(e){return AT}}}():AT,Dp=bie()(),il=Object.getPrototypeOf||function(t){return t.__proto__},Bp={},$Xe=typeof Uint8Array=="undefined"?Pt:il(Uint8Array),Mp={"%AggregateError%":typeof AggregateError=="undefined"?Pt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Pt:ArrayBuffer,"%ArrayIteratorPrototype%":Dp?il([][Symbol.iterator]()):Pt,"%AsyncFromSyncIteratorPrototype%":Pt,"%AsyncFunction%":Bp,"%AsyncGenerator%":Bp,"%AsyncGeneratorFunction%":Bp,"%AsyncIteratorPrototype%":Bp,"%Atomics%":typeof Atomics=="undefined"?Pt:Atomics,"%BigInt%":typeof BigInt=="undefined"?Pt:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Pt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?Pt:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Pt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Pt:FinalizationRegistry,"%Function%":Sie,"%GeneratorFunction%":Bp,"%Int8Array%":typeof Int8Array=="undefined"?Pt:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Pt:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Pt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Dp?il(il([][Symbol.iterator]())):Pt,"%JSON%":typeof JSON=="object"?JSON:Pt,"%Map%":typeof Map=="undefined"?Pt:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!Dp?Pt:il(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Pt:Promise,"%Proxy%":typeof Proxy=="undefined"?Pt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?Pt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Pt:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!Dp?Pt:il(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Pt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Dp?il(""[Symbol.iterator]()):Pt,"%Symbol%":Dp?Symbol:Pt,"%SyntaxError%":Vb,"%ThrowTypeError%":HXe,"%TypedArray%":$Xe,"%TypeError%":Np,"%Uint8Array%":typeof Uint8Array=="undefined"?Pt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Pt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Pt:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Pt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?Pt:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Pt:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Pt:WeakSet},GXe=function t(e){var r;if(e==="%AsyncFunction%")r=xT("async function () {}");else if(e==="%GeneratorFunction%")r=xT("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=xT("async function* () {}");else if(e==="%AsyncGenerator%"){var i=t("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=t("%AsyncGenerator%");n&&(r=il(n.prototype))}return Mp[e]=r,r},xie={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},w2=v2(),_2=Eie(),WXe=w2.call(Function.call,Array.prototype.concat),YXe=w2.call(Function.apply,Array.prototype.splice),Aie=w2.call(Function.call,String.prototype.replace),E2=w2.call(Function.call,String.prototype.slice),XXe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,QXe=/\\(\\)?/g,ZXe=function(e){var r=E2(e,0,1),i=E2(e,-1);if(r==="%"&&i!=="%")throw new Vb("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&r!=="%")throw new Vb("invalid intrinsic syntax, expected opening `%`");var n=[];return Aie(e,XXe,function(s,o,a,c){n[n.length]=a?Aie(c,QXe,"$1"):o||s}),n},JXe=function(e,r){var i=e,n;if(_2(xie,i)&&(n=xie[i],i="%"+n[0]+"%"),_2(Mp,i)){var s=Mp[i];if(s===Bp&&(s=GXe(i)),typeof s=="undefined"&&!r)throw new Np("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new Vb("intrinsic "+e+" does not exist!")};Iie.exports=function(e,r){if(typeof e!="string"||e.length===0)throw new Np("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Np('"allowMissing" argument must be a boolean');var i=ZXe(e),n=i.length>0?i[0]:"",s=JXe("%"+n+"%",r),o=s.name,a=s.value,c=!1,u=s.alias;u&&(n=u[0],YXe(i,WXe([0,1],u)));for(var l=1,d=!0;l<i.length;l+=1){var h=i[l],y=E2(h,0,1),g=E2(h,-1);if((y==='"'||y==="'"||y==="`"||g==='"'||g==="'"||g==="`")&&y!==g)throw new Vb("property names with quotes must have matching quotes");if((h==="constructor"||!d)&&(c=!0),n+="."+h,o="%"+n+"%",_2(Mp,o))a=Mp[o];else if(a!=null){if(!(h in a)){if(!r)throw new Np("base intrinsic for "+e+" exists, but the property is not available.");return}if(Vf&&l+1>=i.length){var m=Vf(a,h);d=!!m,d&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[h]}else d=_2(a,h),a=a[h];d&&!c&&(Mp[o]=a)}}return a}});var kie=p((cOt,x2)=>{f();"use strict";var IT=v2(),Lp=S2(),Tie=Lp("%Function.prototype.apply%"),Rie=Lp("%Function.prototype.call%"),Pie=Lp("%Reflect.apply%",!0)||IT.call(Rie,Tie),Cie=Lp("%Object.getOwnPropertyDescriptor%",!0),zf=Lp("%Object.defineProperty%",!0),eQe=Lp("%Math.max%");if(zf)try{zf({},"a",{value:1})}catch(t){zf=null}x2.exports=function(e){var r=Pie(IT,Rie,arguments);if(Cie&&zf){var i=Cie(r,"length");i.configurable&&zf(r,"length",{value:1+eQe(0,e.length-(arguments.length-1))})}return r};var Oie=function(){return Pie(IT,Tie,arguments)};zf?zf(x2.exports,"apply",{value:Oie}):x2.exports.apply=Oie});var A2=p((uOt,Die)=>{f();"use strict";var qie=S2(),Nie=kie(),tQe=Nie(qie("String.prototype.indexOf"));Die.exports=function(e,r){var i=qie(e,!!r);return typeof i=="function"&&tQe(e,".prototype.")>-1?Nie(i):i}});var Lie=p((lOt,Mie)=>{f();"use strict";var rQe=jb()(),iQe=A2(),TT=iQe("Object.prototype.toString"),I2=function(e){return rQe&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:TT(e)==="[object Arguments]"},Bie=function(e){return I2(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&TT(e)!=="[object Array]"&&TT(e.callee)==="[object Function]"},nQe=function(){return I2(arguments)}();I2.isLegacyArguments=Bie;Mie.exports=nQe?I2:Bie});var Kie=p((fOt,Fie)=>{f();"use strict";var sQe=Object.prototype.toString,oQe=Function.prototype.toString,aQe=/^\s*(?:function)?\*/,Uie=jb()(),RT=Object.getPrototypeOf,cQe=function(){if(!Uie)return!1;try{return Function("return function*() {}")()}catch(t){}},PT;Fie.exports=function(e){if(typeof e!="function")return!1;if(aQe.test(oQe.call(e)))return!0;if(!Uie){var r=sQe.call(e);return r==="[object GeneratorFunction]"}if(!RT)return!1;if(typeof PT=="undefined"){var i=cQe();PT=i?RT(i):!1}return RT(e)===PT}});var CT=p((dOt,jie)=>{f();var uQe=Object.prototype.hasOwnProperty,lQe=Object.prototype.toString;jie.exports=function(e,r,i){if(lQe.call(r)!=="[object Function]")throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var s=0;s<n;s++)r.call(i,e[s],s,e);else for(var o in e)uQe.call(e,o)&&r.call(i,e[o],o,e)}});var kT=p((hOt,Vie)=>{f();"use strict";var OT=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];Vie.exports=function(){for(var e=[],r=0;r<OT.length;r++)typeof globalThis[OT[r]]=="function"&&(e[e.length]=OT[r]);return e}});var qT=p((pOt,zie)=>{f();"use strict";var fQe=S2(),T2=fQe("%Object.getOwnPropertyDescriptor%");if(T2)try{T2([],"length")}catch(t){T2=null}zie.exports=T2});var BT=p((yOt,Yie)=>{f();"use strict";var Hie=CT(),dQe=kT(),NT=A2(),hQe=NT("Object.prototype.toString"),$ie=jb()(),Gie=dQe(),pQe=NT("Array.prototype.indexOf",!0)||function(e,r){for(var i=0;i<e.length;i+=1)if(e[i]===r)return i;return-1},yQe=NT("String.prototype.slice"),Wie={},R2=qT(),DT=Object.getPrototypeOf;$ie&&R2&&DT&&Hie(Gie,function(t){var e=new globalThis[t];if(Symbol.toStringTag in e){var r=DT(e),i=R2(r,Symbol.toStringTag);if(!i){var n=DT(r);i=R2(n,Symbol.toStringTag)}Wie[t]=i.get}});var gQe=function(e){var r=!1;return Hie(Wie,function(i,n){if(!r)try{r=i.call(e)===n}catch(s){}}),r};Yie.exports=function(e){if(!e||typeof e!="object")return!1;if(!$ie||!(Symbol.toStringTag in e)){var r=yQe(hQe(e),8,-1);return pQe(Gie,r)>-1}return R2?gQe(e):!1}});var tne=p((gOt,ene)=>{f();"use strict";var Xie=CT(),bQe=kT(),Qie=A2(),mQe=Qie("Object.prototype.toString"),Zie=jb()(),vQe=bQe(),wQe=Qie("String.prototype.slice"),Jie={},MT=qT(),LT=Object.getPrototypeOf;Zie&&MT&&LT&&Xie(vQe,function(t){if(typeof globalThis[t]=="function"){var e=new globalThis[t];if(Symbol.toStringTag in e){var r=LT(e),i=MT(r,Symbol.toStringTag);if(!i){var n=LT(r);i=MT(n,Symbol.toStringTag)}Jie[t]=i.get}}});var _Qe=function(e){var r=!1;return Xie(Jie,function(i,n){if(!r)try{var s=i.call(e);s===n&&(r=s)}catch(o){}}),r},EQe=BT();ene.exports=function(e){return EQe(e)?!Zie||!(Symbol.toStringTag in e)?wQe(mQe(e),8,-1):_Qe(e):!1}});var yne=p(mt=>{f();"use strict";var SQe=Lie(),xQe=Kie(),qo=tne(),rne=BT();function Up(t){return t.call.bind(t)}var ine=typeof BigInt!="undefined",nne=typeof Symbol!="undefined",js=Up(Object.prototype.toString),AQe=Up(Number.prototype.valueOf),IQe=Up(String.prototype.valueOf),TQe=Up(Boolean.prototype.valueOf);ine&&(sne=Up(BigInt.prototype.valueOf));var sne;nne&&(one=Up(Symbol.prototype.valueOf));var one;function zb(t,e){if(typeof t!="object")return!1;try{return e(t),!0}catch(r){return!1}}mt.isArgumentsObject=SQe;mt.isGeneratorFunction=xQe;mt.isTypedArray=rne;function RQe(t){return typeof Promise!="undefined"&&t instanceof Promise||t!==null&&typeof t=="object"&&typeof t.then=="function"&&typeof t.catch=="function"}mt.isPromise=RQe;function PQe(t){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(t):rne(t)||cne(t)}mt.isArrayBufferView=PQe;function CQe(t){return qo(t)==="Uint8Array"}mt.isUint8Array=CQe;function OQe(t){return qo(t)==="Uint8ClampedArray"}mt.isUint8ClampedArray=OQe;function kQe(t){return qo(t)==="Uint16Array"}mt.isUint16Array=kQe;function qQe(t){return qo(t)==="Uint32Array"}mt.isUint32Array=qQe;function NQe(t){return qo(t)==="Int8Array"}mt.isInt8Array=NQe;function DQe(t){return qo(t)==="Int16Array"}mt.isInt16Array=DQe;function BQe(t){return qo(t)==="Int32Array"}mt.isInt32Array=BQe;function MQe(t){return qo(t)==="Float32Array"}mt.isFloat32Array=MQe;function LQe(t){return qo(t)==="Float64Array"}mt.isFloat64Array=LQe;function UQe(t){return qo(t)==="BigInt64Array"}mt.isBigInt64Array=UQe;function FQe(t){return qo(t)==="BigUint64Array"}mt.isBigUint64Array=FQe;function P2(t){return js(t)==="[object Map]"}P2.working=typeof Map!="undefined"&&P2(new Map);function KQe(t){return typeof Map=="undefined"?!1:P2.working?P2(t):t instanceof Map}mt.isMap=KQe;function C2(t){return js(t)==="[object Set]"}C2.working=typeof Set!="undefined"&&C2(new Set);function jQe(t){return typeof Set=="undefined"?!1:C2.working?C2(t):t instanceof Set}mt.isSet=jQe;function O2(t){return js(t)==="[object WeakMap]"}O2.working=typeof WeakMap!="undefined"&&O2(new WeakMap);function VQe(t){return typeof WeakMap=="undefined"?!1:O2.working?O2(t):t instanceof WeakMap}mt.isWeakMap=VQe;function UT(t){return js(t)==="[object WeakSet]"}UT.working=typeof WeakSet!="undefined"&&UT(new WeakSet);function zQe(t){return UT(t)}mt.isWeakSet=zQe;function k2(t){return js(t)==="[object ArrayBuffer]"}k2.working=typeof ArrayBuffer!="undefined"&&k2(new ArrayBuffer);function ane(t){return typeof ArrayBuffer=="undefined"?!1:k2.working?k2(t):t instanceof ArrayBuffer}mt.isArrayBuffer=ane;function q2(t){return js(t)==="[object DataView]"}q2.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&q2(new DataView(new ArrayBuffer(1),0,1));function cne(t){return typeof DataView=="undefined"?!1:q2.working?q2(t):t instanceof DataView}mt.isDataView=cne;var FT=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function Hb(t){return js(t)==="[object SharedArrayBuffer]"}function une(t){return typeof FT=="undefined"?!1:(typeof Hb.working=="undefined"&&(Hb.working=Hb(new FT)),Hb.working?Hb(t):t instanceof FT)}mt.isSharedArrayBuffer=une;function HQe(t){return js(t)==="[object AsyncFunction]"}mt.isAsyncFunction=HQe;function $Qe(t){return js(t)==="[object Map Iterator]"}mt.isMapIterator=$Qe;function GQe(t){return js(t)==="[object Set Iterator]"}mt.isSetIterator=GQe;function WQe(t){return js(t)==="[object Generator]"}mt.isGeneratorObject=WQe;function YQe(t){return js(t)==="[object WebAssembly.Module]"}mt.isWebAssemblyCompiledModule=YQe;function lne(t){return zb(t,AQe)}mt.isNumberObject=lne;function fne(t){return zb(t,IQe)}mt.isStringObject=fne;function dne(t){return zb(t,TQe)}mt.isBooleanObject=dne;function hne(t){return ine&&zb(t,sne)}mt.isBigIntObject=hne;function pne(t){return nne&&zb(t,one)}mt.isSymbolObject=pne;function XQe(t){return lne(t)||fne(t)||dne(t)||hne(t)||pne(t)}mt.isBoxedPrimitive=XQe;function QQe(t){return typeof Uint8Array!="undefined"&&(ane(t)||une(t))}mt.isAnyArrayBuffer=QQe;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(t){Object.defineProperty(mt,t,{enumerable:!1,value:function(){throw new Error(t+" is not supported in userland")}})})});var bne=p((mOt,gne)=>{f();gne.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var Sne=p(vt=>{f();var mne=Object.getOwnPropertyDescriptors||function(e){for(var r=Object.keys(e),i={},n=0;n<r.length;n++)i[r[n]]=Object.getOwnPropertyDescriptor(e,r[n]);return i},ZQe=/%[sdj%]/g;vt.format=function(t){if(!L2(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(nl(arguments[r]));return e.join(" ")}for(var r=1,i=arguments,n=i.length,s=String(t).replace(ZQe,function(a){if(a==="%%")return"%";if(r>=n)return a;switch(a){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(c){return"[Circular]"}default:return a}}),o=i[r];r<n;o=i[++r])M2(o)||!Fp(o)?s+=" "+o:s+=" "+nl(o);return s};vt.deprecate=function(t,e){if(typeof process!="undefined"&&process.noDeprecation===!0)return t;if(typeof process=="undefined")return function(){return vt.deprecate(t,e).apply(this,arguments)};var r=!1;function i(){if(!r){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}return i};var N2={},vne=/^$/;process.env.NODE_DEBUG&&(D2=process.env.NODE_DEBUG,D2=D2.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),vne=new RegExp("^"+D2+"$","i"));var D2;vt.debuglog=function(t){if(t=t.toUpperCase(),!N2[t])if(vne.test(t)){var e=process.pid;N2[t]=function(){var r=vt.format.apply(vt,arguments);console.error("%s %d: %s",t,e,r)}}else N2[t]=function(){};return N2[t]};function nl(t,e){var r={seen:[],stylize:eZe};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),VT(e)?r.showHidden=e:e&&vt._extend(r,e),Hf(r.showHidden)&&(r.showHidden=!1),Hf(r.depth)&&(r.depth=2),Hf(r.colors)&&(r.colors=!1),Hf(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=JQe),B2(r,t,r.depth)}vt.inspect=nl;nl.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};nl.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function JQe(t,e){var r=nl.styles[e];return r?"["+nl.colors[r][0]+"m"+t+"["+nl.colors[r][1]+"m":t}function eZe(t,e){return t}function tZe(t){var e={};return t.forEach(function(r,i){e[r]=!0}),e}function B2(t,e,r){if(t.customInspect&&e&&F2(e.inspect)&&e.inspect!==vt.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(r,t);return L2(i)||(i=B2(t,i,r)),i}var n=rZe(t,e);if(n)return n;var s=Object.keys(e),o=tZe(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),Gb(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return KT(e);if(s.length===0){if(F2(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if($b(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(U2(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Gb(e))return KT(e)}var c="",u=!1,l=["{","}"];if(wne(e)&&(u=!0,l=["[","]"]),F2(e)){var d=e.name?": "+e.name:"";c=" [Function"+d+"]"}if($b(e)&&(c=" "+RegExp.prototype.toString.call(e)),U2(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Gb(e)&&(c=" "+KT(e)),s.length===0&&(!u||e.length==0))return l[0]+c+l[1];if(r<0)return $b(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var h;return u?h=iZe(t,e,r,o,s):h=s.map(function(y){return jT(t,e,r,o,y,u)}),t.seen.pop(),nZe(h,c,l)}function rZe(t,e){if(Hf(e))return t.stylize("undefined","undefined");if(L2(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(_ne(e))return t.stylize(""+e,"number");if(VT(e))return t.stylize(""+e,"boolean");if(M2(e))return t.stylize("null","null")}function KT(t){return"["+Error.prototype.toString.call(t)+"]"}function iZe(t,e,r,i,n){for(var s=[],o=0,a=e.length;o<a;++o)Ene(e,String(o))?s.push(jT(t,e,r,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(jT(t,e,r,i,c,!0))}),s}function jT(t,e,r,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=t.stylize("[Getter/Setter]","special"):a=t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),Ene(i,n)||(o="["+n+"]"),a||(t.seen.indexOf(c.value)<0?(M2(r)?a=B2(t,c.value,null):a=B2(t,c.value,r-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=t.stylize("[Circular]","special")),Hf(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function nZe(t,e,r){var i=0,n=t.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}vt.types=yne();function wne(t){return Array.isArray(t)}vt.isArray=wne;function VT(t){return typeof t=="boolean"}vt.isBoolean=VT;function M2(t){return t===null}vt.isNull=M2;function sZe(t){return t==null}vt.isNullOrUndefined=sZe;function _ne(t){return typeof t=="number"}vt.isNumber=_ne;function L2(t){return typeof t=="string"}vt.isString=L2;function oZe(t){return typeof t=="symbol"}vt.isSymbol=oZe;function Hf(t){return t===void 0}vt.isUndefined=Hf;function $b(t){return Fp(t)&&zT(t)==="[object RegExp]"}vt.isRegExp=$b;vt.types.isRegExp=$b;function Fp(t){return typeof t=="object"&&t!==null}vt.isObject=Fp;function U2(t){return Fp(t)&&zT(t)==="[object Date]"}vt.isDate=U2;vt.types.isDate=U2;function Gb(t){return Fp(t)&&(zT(t)==="[object Error]"||t instanceof Error)}vt.isError=Gb;vt.types.isNativeError=Gb;function F2(t){return typeof t=="function"}vt.isFunction=F2;function aZe(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t=="undefined"}vt.isPrimitive=aZe;vt.isBuffer=bne();function zT(t){return Object.prototype.toString.call(t)}function HT(t){return t<10?"0"+t.toString(10):t.toString(10)}var cZe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function uZe(){var t=new Date,e=[HT(t.getHours()),HT(t.getMinutes()),HT(t.getSeconds())].join(":");return[t.getDate(),cZe[t.getMonth()],e].join(" ")}vt.log=function(){console.log("%s - %s",uZe(),vt.format.apply(vt,arguments))};vt.inherits=Vi();vt._extend=function(t,e){if(!e||!Fp(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t};function Ene(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var $f=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;vt.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if($f&&e[$f]){var r=e[$f];if(typeof r!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,$f,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var i,n,s=new Promise(function(c,u){i=c,n=u}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,u){c?n(c):i(u)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),$f&&Object.defineProperty(r,$f,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,mne(e))};vt.promisify.custom=$f;function lZe(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}function fZe(t){if(typeof t!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var r=[],i=0;i<arguments.length;i++)r.push(arguments[i]);var n=r.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};t.apply(this,r).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(lZe.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,mne(t)),e}vt.callbackify=fZe});var $T=p((wOt,xne)=>{f();"use strict";xne.exports=function(...e){let r=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(r,{bufferKeys:r.bufferKeys||!1,snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,status:r.status||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,openCallback:r.openCallback||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:r.encodings||!1,additionalMethods:Object.assign({},r.additionalMethods)})}});var Ine=p((_Ot,Ane)=>{f();Ane.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var K2=p((EOt,Rne)=>{f();var Tne;Rne.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):t=>(Tne||(Tne=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0))});var j2=p((SOt,Cne)=>{f();"use strict";var Pne=K2();Cne.exports=function(t,...e){e.length===0?Pne(t):Pne(()=>t(...e))}});var GT=p((xOt,One)=>{f();"use strict";function sl(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}sl.prototype.next=function(t){if(typeof t!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(t,new Error("cannot call next() after end()")),this):this._nexting?(this._nextTick(t,new Error("cannot call next() before previous next() has completed")),this):(this._nexting=!0,this._next((e,...r)=>{this._nexting=!1,t(e,...r)}),this)};sl.prototype._next=function(t){this._nextTick(t)};sl.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)};sl.prototype._seek=function(t){};sl.prototype.end=function(t){if(typeof t!="function")throw new Error("end() requires a callback argument");if(this._ended)return this._nextTick(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)};sl.prototype._end=function(t){this._nextTick(t)};sl.prototype._nextTick=j2();One.exports=sl});var WT=p((AOt,qne)=>{f();"use strict";var kne=Object.freeze({});function No(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}No.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};No.prototype.put=function(t,e,r){this._checkWritten();let i=this.db._checkKey(t)||this.db._checkValue(e);if(i)throw i;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e,r??kne),this};No.prototype._put=function(t,e,r){this._operations.push({...r,type:"put",key:t,value:e})};No.prototype.del=function(t,e){this._checkWritten();let r=this.db._checkKey(t);if(r)throw r;return t=this.db._serializeKey(t),this._del(t,e??kne),this};No.prototype._del=function(t,e){this._operations.push({...e,type:"del",key:t})};No.prototype.clear=function(){return this._checkWritten(),this._clear(),this};No.prototype._clear=function(){this._operations=[]};No.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)};No.prototype._write=function(t,e){this.db._batch(this._operations,t,e)};No.prototype._nextTick=j2();qne.exports=No});var Bne=p((IOt,Dne)=>{f();"use strict";var dZe=$T(),hZe=Ine(),pZe=GT(),yZe=WT(),gZe=Object.prototype.hasOwnProperty,bZe=["lt","lte","gt","gte"];function br(t){this.status="new",this.supports=dZe(t,{status:!0})}br.prototype.open=function(t,e){let r=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,i=>{if(i)return this.status=r,e(i);this.status="open",e()})};br.prototype._open=function(t,e){this._nextTick(e)};br.prototype.close=function(t){let e=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(r=>{if(r)return this.status=e,t(r);this.status="closed",t()})};br.prototype._close=function(t){this._nextTick(t)};br.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(t);if(i)return this._nextTick(r,i);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)};br.prototype._get=function(t,e,r){this._nextTick(function(){r(new Error("NotFound"))})};br.prototype.put=function(t,e,r,i){if(typeof r=="function"&&(i=r),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(t)||this._checkValue(e);if(n)return this._nextTick(i,n);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,i)};br.prototype._put=function(t,e,r,i){this._nextTick(i)};br.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(t);if(i)return this._nextTick(r,i);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)};br.prototype._del=function(t,e,r){this._nextTick(r)};br.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return this._nextTick(r,new Error("batch(array) requires an array argument"));if(t.length===0)return this._nextTick(r);(typeof e!="object"||e===null)&&(e={});let i=new Array(t.length);for(let n=0;n<t.length;n++){if(typeof t[n]!="object"||t[n]===null)return this._nextTick(r,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},t[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(r,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(r,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(r,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,r)};br.prototype._batch=function(t,e,r){this._nextTick(r)};br.prototype.clear=function(t,e){if(typeof t=="function")e=t;else if(typeof e!="function")throw new Error("clear() requires a callback argument");t=Nne(this,t),t.reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)};br.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;let r=this._iterator(t),i={},n=s=>{if(s)return r.end(function(){e(s)});r.next((o,a)=>{if(o)return n(o);if(a===void 0)return r.end(e);this._del(a,i,n)})};n()};br.prototype._setupIteratorOptions=function(t){return t=Nne(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function Nne(t,e){let r={};for(let i in e){if(!gZe.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];mZe(i)&&(n=t._serializeKey(n)),r[i]=n}return r}function mZe(t){return bZe.indexOf(t)!==-1}br.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)};br.prototype._iterator=function(t){return new pZe(this)};br.prototype._chainedBatch=function(){return new yZe(this)};br.prototype._serializeKey=function(t){return t};br.prototype._serializeValue=function(t){return t};br.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(hZe(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")};br.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")};br.prototype._nextTick=j2();Dne.exports=br});var ol=p(V2=>{f();"use strict";V2.AbstractLevelDOWN=Bne();V2.AbstractIterator=GT();V2.AbstractChainedBatch=WT()});var Une=p((ROt,Lne)=>{f();"use strict";var Mne=ol().AbstractIterator,vZe=Vi();function Kp(t,e){Mne.call(this,t),this._options=e,this._iterator=null,this._operations=[]}vZe(Kp,Mne);Kp.prototype.setDb=function(t){let e=this._iterator=t.iterator(this._options);for(let r of this._operations)e[r.method](...r.args)};Kp.prototype._operation=function(t,e){if(this._iterator)return this._iterator[t](...e);this._operations.push({method:t,args:e})};for(let t of["next","end"])Kp.prototype["_"+t]=function(...e){this._operation(t,e)};Kp.prototype.seek=function(...t){this._operation("seek",t)};Lne.exports=Kp});var zne=p((POt,YT)=>{f();"use strict";var Fne=ol().AbstractLevelDOWN,wZe=Vi(),Kne=Une(),jne="put get del batch clear".split(" "),_Ze="approximateSize compactRange".split(" ");function Gf(t){Fne.call(this,t.supports||{});for(let e of _Ze)typeof t[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this._db=t,this._operations=[],Vne(this)}wZe(Gf,Fne);Gf.prototype.type="deferred-leveldown";Gf.prototype._open=function(t,e){this._db.open(t,r=>{if(r)return e(r);for(let i of this._operations)i.iterator?i.iterator.setDb(this._db):this._db[i.method](...i.args);this._operations=[],EZe(this),e()})};Gf.prototype._close=function(t){this._db.close(e=>{if(e)return t(e);Vne(this),t()})};function EZe(t){for(let e of jne.concat("iterator"))t["_"+e]=function(...r){return this._db[e](...r)};for(let e of Object.keys(t.supports.additionalMethods))t[e]=function(...r){return this._db[e](...r)}}function Vne(t){for(let e of jne)t["_"+e]=function(...r){this._operations.push({method:e,args:r})};for(let e of Object.keys(t.supports.additionalMethods))t[e]=function(...r){this._operations.push({method:e,args:r})};t._iterator=function(e){let r=new Kne(t,e);return this._operations.push({iterator:r}),r}}Gf.prototype._serializeKey=function(t){return t};Gf.prototype._serializeValue=function(t){return t};YT.exports=Gf;YT.exports.DeferredIterator=Kne});var XT=p((COt,Hne)=>{f();Hne.exports=dr().EventEmitter});var QT=p(()=>{f()});var Yne=p((qOt,Wne)=>{f();"use strict";function $ne(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function SZe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$ne(Object(r),!0).forEach(function(i){xZe(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$ne(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function xZe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gne(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function IZe(t,e,r){return e&&Gne(t.prototype,e),r&&Gne(t,r),t}var TZe=Ut(),z2=TZe.Buffer,RZe=QT(),ZT=RZe.inspect,PZe=ZT&&ZT.custom||"inspect";function CZe(t,e,r){z2.prototype.copy.call(t,e,r)}Wne.exports=function(){function t(){AZe(this,t),this.head=null,this.tail=null,this.length=0}return IZe(t,[{key:"push",value:function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n}},{key:"concat",value:function(r){if(this.length===0)return z2.alloc(0);for(var i=z2.allocUnsafe(r>>>0),n=this.head,s=0;n;)CZe(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(r,i){var n;return r<this.head.data.length?(n=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?n=this.shift():n=i?this._getString(r):this._getBuffer(r),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var i=this.head,n=1,s=i.data;for(r-=s.length;i=i.next;){var o=i.data,a=r>o.length?o.length:r;if(a===o.length?s+=o:s+=o.slice(0,r),r-=a,r===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(r){var i=z2.allocUnsafe(r),n=this.head,s=1;for(n.data.copy(i),r-=n.data.length;n=n.next;){var o=n.data,a=r>o.length?o.length:r;if(o.copy(i,i.length-r,0,a),r-=a,r===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:PZe,value:function(r,i){return ZT(this,SZe({},i,{depth:0,customInspect:!1}))}}]),t}()});var eR=p((NOt,Qne)=>{f();"use strict";function OZe(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(JT,this,t)):process.nextTick(JT,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(H2,r):(r._writableState.errorEmitted=!0,process.nextTick(Xne,r,s)):process.nextTick(Xne,r,s):e?(process.nextTick(H2,r),e(s)):process.nextTick(H2,r)}),this)}function Xne(t,e){JT(t,e),H2(t)}function H2(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function kZe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function JT(t,e){t.emit("error",e)}function qZe(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}Qne.exports={destroy:OZe,undestroy:kZe,errorOrDestroy:qZe}});var Wf=p((DOt,ese)=>{f();"use strict";function NZe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Zne={};function Vs(t,e,r){r||(r=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){NZe(o,s);function o(a,c,u){return s.call(this,i(a,c,u))||this}return o}(r);n.prototype.name=r.name,n.prototype.code=t,Zne[t]=n}function Jne(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(i){return String(i)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function DZe(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function BZe(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function MZe(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}Vs("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Vs("ERR_INVALID_ARG_TYPE",function(t,e,r){var i;typeof e=="string"&&DZe(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(BZe(t," argument"))n="The ".concat(t," ").concat(i," ").concat(Jne(e,"type"));else{var s=MZe(t,".")?"property":"argument";n='The "'.concat(t,'" ').concat(s," ").concat(i," ").concat(Jne(e,"type"))}return n+=". Received type ".concat(typeof r),n},TypeError);Vs("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Vs("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Vs("ERR_STREAM_PREMATURE_CLOSE","Premature close");Vs("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Vs("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Vs("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Vs("ERR_STREAM_WRITE_AFTER_END","write after end");Vs("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Vs("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Vs("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");ese.exports.codes=Zne});var tR=p((BOt,tse)=>{f();"use strict";var LZe=Wf().codes.ERR_INVALID_OPT_VALUE;function UZe(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function FZe(t,e,r,i){var n=UZe(e,i,r);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?r:"highWaterMark";throw new LZe(s,n)}return Math.floor(n)}return t.objectMode?16:16*1024}tse.exports={getHighWaterMark:FZe}});var ise=p((MOt,rse)=>{f();rse.exports=KZe;function KZe(t,e){if(rR("noDeprecation"))return t;var r=!1;function i(){if(!r){if(rR("throwDeprecation"))throw new Error(e);rR("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return i}function rR(t){try{if(!globalThis.localStorage)return!1}catch(r){return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var sR=p((LOt,use)=>{f();"use strict";use.exports=Kr;function nse(t){var e=this;this.next=null,this.entry=null,this.finish=function(){pJe(e,t)}}var jp;Kr.WritableState=Wb;var jZe={deprecate:ise()},sse=XT(),$2=Ut().Buffer,VZe=globalThis.Uint8Array||function(){};function zZe(t){return $2.from(t)}function HZe(t){return $2.isBuffer(t)||t instanceof VZe}var iR=eR(),$Ze=tR(),GZe=$Ze.getHighWaterMark,al=Wf().codes,WZe=al.ERR_INVALID_ARG_TYPE,YZe=al.ERR_METHOD_NOT_IMPLEMENTED,XZe=al.ERR_MULTIPLE_CALLBACK,QZe=al.ERR_STREAM_CANNOT_PIPE,ZZe=al.ERR_STREAM_DESTROYED,JZe=al.ERR_STREAM_NULL_VALUES,eJe=al.ERR_STREAM_WRITE_AFTER_END,tJe=al.ERR_UNKNOWN_ENCODING,Vp=iR.errorOrDestroy;Vi()(Kr,sse);function rJe(){}function Wb(t,e,r){jp=jp||Yf(),t=t||{},typeof r!="boolean"&&(r=e instanceof jp),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=GZe(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=t.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){uJe(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new nse(this)}Wb.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Wb.prototype,"buffer",{get:jZe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}})();var G2;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(G2=Function.prototype[Symbol.hasInstance],Object.defineProperty(Kr,Symbol.hasInstance,{value:function(e){return G2.call(this,e)?!0:this!==Kr?!1:e&&e._writableState instanceof Wb}})):G2=function(e){return e instanceof this};function Kr(t){jp=jp||Yf();var e=this instanceof jp;if(!e&&!G2.call(Kr,this))return new Kr(t);this._writableState=new Wb(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),sse.call(this)}Kr.prototype.pipe=function(){Vp(this,new QZe)};function iJe(t,e){var r=new eJe;Vp(t,r),process.nextTick(e,r)}function nJe(t,e,r,i){var n;return r===null?n=new JZe:typeof r!="string"&&!e.objectMode&&(n=new WZe("chunk",["string","Buffer"],r)),n?(Vp(t,n),process.nextTick(i,n),!1):!0}Kr.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&HZe(t);return s&&!$2.isBuffer(t)&&(t=zZe(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=rJe),i.ending?iJe(this,r):(s||nJe(this,i,t,r))&&(i.pendingcb++,n=oJe(this,i,s,t,e,r)),n};Kr.prototype.cork=function(){this._writableState.corked++};Kr.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&ase(this,t))};Kr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new tJe(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Kr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function sJe(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=$2.from(e,r)),e}Object.defineProperty(Kr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function oJe(t,e,r,i,n,s){if(!r){var o=sJe(e,i,n);i!==o&&(r=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else nR(t,e,!1,a,i,n,s);return c}function nR(t,e,r,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new ZZe("write")):r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function aJe(t,e,r,i,n){--e.pendingcb,r?(process.nextTick(n,i),process.nextTick(Yb,t,e),t._writableState.errorEmitted=!0,Vp(t,i)):(n(i),t._writableState.errorEmitted=!0,Vp(t,i),Yb(t,e))}function cJe(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function uJe(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(typeof n!="function")throw new XZe;if(cJe(r),e)aJe(t,r,i,e,n);else{var s=cse(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&ase(t,r),i?process.nextTick(ose,t,r,s,n):ose(t,r,s,n)}}function ose(t,e,r,i){r||lJe(t,e),e.pendingcb--,i(),Yb(t,e)}function lJe(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function ase(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var o=0,a=!0;r;)n[o]=r,r.isBuf||(a=!1),r=r.next,o+=1;n.allBuffers=a,nR(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new nse(e),e.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,l=r.callback,d=e.objectMode?1:c.length;if(nR(t,e,!1,d,c,u,l),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Kr.prototype._write=function(t,e,r){r(new YZe("_write()"))};Kr.prototype._writev=null;Kr.prototype.end=function(t,e,r){var i=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||hJe(this,i,r),this};Object.defineProperty(Kr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function cse(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function fJe(t,e){t._final(function(r){e.pendingcb--,r&&Vp(t,r),e.prefinished=!0,t.emit("prefinish"),Yb(t,e)})}function dJe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(fJe,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Yb(t,e){var r=cse(e);if(r&&(dJe(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}function hJe(t,e,r){e.ending=!0,Yb(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function pJe(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(Kr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Kr.prototype.destroy=iR.destroy;Kr.prototype._undestroy=iR.undestroy;Kr.prototype._destroy=function(t,e){e(t)}});var Yf=p((UOt,fse)=>{f();"use strict";var yJe=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};fse.exports=Ka;var lse=cR(),oR=sR();Vi()(Ka,lse);for(aR=yJe(oR.prototype),W2=0;W2<aR.length;W2++)Y2=aR[W2],Ka.prototype[Y2]||(Ka.prototype[Y2]=oR.prototype[Y2]);var aR,Y2,W2;function Ka(t){if(!(this instanceof Ka))return new Ka(t);lse.call(this,t),oR.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",gJe)))}Object.defineProperty(Ka.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(Ka.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Ka.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function gJe(){this._writableState.ended||process.nextTick(bJe,this)}function bJe(t){t.end()}Object.defineProperty(Ka.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var lR=p((uR,hse)=>{f();var X2=Ut(),ja=X2.Buffer;function dse(t,e){for(var r in t)e[r]=t[r]}ja.from&&ja.alloc&&ja.allocUnsafe&&ja.allocUnsafeSlow?hse.exports=X2:(dse(X2,uR),uR.Buffer=Xf);function Xf(t,e,r){return ja(t,e,r)}Xf.prototype=Object.create(ja.prototype);dse(ja,Xf);Xf.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return ja(t,e,r)};Xf.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=ja(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};Xf.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ja(t)};Xf.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return X2.SlowBuffer(t)}});var hR=p(yse=>{f();"use strict";var fR=lR().Buffer,pse=fR.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function mJe(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function vJe(t){var e=mJe(t);if(typeof e!="string"&&(fR.isEncoding===pse||!pse(t)))throw new Error("Unknown encoding: "+t);return e||t}yse.StringDecoder=Xb;function Xb(t){this.encoding=vJe(t);var e;switch(this.encoding){case"utf16le":this.text=AJe,this.end=IJe,e=4;break;case"utf8":this.fillLast=EJe,e=4;break;case"base64":this.text=TJe,this.end=RJe,e=3;break;default:this.write=PJe,this.end=CJe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=fR.allocUnsafe(e)}Xb.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};Xb.prototype.end=xJe;Xb.prototype.text=SJe;Xb.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function dR(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function wJe(t,e,r){var i=e.length-1;if(i<r)return 0;var n=dR(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=dR(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=dR(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function _Je(t,e,r){if((e[0]&192)!=128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return t.lastNeed=2,"\uFFFD"}}function EJe(t){var e=this.lastTotal-this.lastNeed,r=_Je(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function SJe(t,e){var r=wJe(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function xJe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function AJe(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function IJe(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function TJe(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function RJe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function PJe(t){return t.toString(this.encoding)}function CJe(t){return t&&t.length?this.write(t):""}});var Q2=p((KOt,mse)=>{f();"use strict";var gse=Wf().codes.ERR_STREAM_PREMATURE_CLOSE;function OJe(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];t.apply(this,i)}}}function kJe(){}function qJe(t){return t.setHeader&&typeof t.abort=="function"}function bse(t,e,r){if(typeof e=="function")return bse(t,null,e);e||(e={}),r=OJe(r||kJe);var i=e.readable||e.readable!==!1&&t.readable,n=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||a()},o=t._writableState&&t._writableState.finished,a=function(){n=!1,o=!0,i||r.call(t)},c=t._readableState&&t._readableState.endEmitted,u=function(){i=!1,c=!0,n||r.call(t)},l=function(g){r.call(t,g)},d=function(){var g;if(i&&!c)return(!t._readableState||!t._readableState.ended)&&(g=new gse),r.call(t,g);if(n&&!o)return(!t._writableState||!t._writableState.ended)&&(g=new gse),r.call(t,g)},h=function(){t.req.on("finish",a)};return qJe(t)?(t.on("complete",a),t.on("abort",d),t.req?h():t.on("request",h)):n&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",u),t.on("finish",a),e.error!==!1&&t.on("error",l),t.on("close",d),function(){t.removeListener("complete",a),t.removeListener("abort",d),t.removeListener("request",h),t.req&&t.req.removeListener("finish",a),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",a),t.removeListener("end",u),t.removeListener("error",l),t.removeListener("close",d)}}mse.exports=bse});var wse=p((jOt,vse)=>{f();"use strict";var Z2;function cl(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var NJe=Q2(),ul=Symbol("lastResolve"),Qf=Symbol("lastReject"),Qb=Symbol("error"),J2=Symbol("ended"),Zf=Symbol("lastPromise"),pR=Symbol("handlePromise"),Jf=Symbol("stream");function ll(t,e){return{value:t,done:e}}function DJe(t){var e=t[ul];if(e!==null){var r=t[Jf].read();r!==null&&(t[Zf]=null,t[ul]=null,t[Qf]=null,e(ll(r,!1)))}}function BJe(t){process.nextTick(DJe,t)}function MJe(t,e){return function(r,i){t.then(function(){if(e[J2]){r(ll(void 0,!0));return}e[pR](r,i)},i)}}var LJe=Object.getPrototypeOf(function(){}),UJe=Object.setPrototypeOf((Z2={get stream(){return this[Jf]},next:function(){var e=this,r=this[Qb];if(r!==null)return Promise.reject(r);if(this[J2])return Promise.resolve(ll(void 0,!0));if(this[Jf].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[Qb]?a(e[Qb]):o(ll(void 0,!0))})});var i=this[Zf],n;if(i)n=new Promise(MJe(i,this));else{var s=this[Jf].read();if(s!==null)return Promise.resolve(ll(s,!1));n=new Promise(this[pR])}return this[Zf]=n,n}},cl(Z2,Symbol.asyncIterator,function(){return this}),cl(Z2,"return",function(){var e=this;return new Promise(function(r,i){e[Jf].destroy(null,function(n){if(n){i(n);return}r(ll(void 0,!0))})})}),Z2),LJe),FJe=function(e){var r,i=Object.create(UJe,(r={},cl(r,Jf,{value:e,writable:!0}),cl(r,ul,{value:null,writable:!0}),cl(r,Qf,{value:null,writable:!0}),cl(r,Qb,{value:null,writable:!0}),cl(r,J2,{value:e._readableState.endEmitted,writable:!0}),cl(r,pR,{value:function(s,o){var a=i[Jf].read();a?(i[Zf]=null,i[ul]=null,i[Qf]=null,s(ll(a,!1))):(i[ul]=s,i[Qf]=o)},writable:!0}),r));return i[Zf]=null,NJe(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[Qf];s!==null&&(i[Zf]=null,i[ul]=null,i[Qf]=null,s(n)),i[Qb]=n;return}var o=i[ul];o!==null&&(i[Zf]=null,i[ul]=null,i[Qf]=null,o(ll(void 0,!0))),i[J2]=!0}),e.on("readable",BJe.bind(null,i)),i};vse.exports=FJe});var Ese=p((VOt,_se)=>{f();_se.exports=function(){throw new Error("Readable.from is not available in the browser")}});var cR=p((HOt,kse)=>{f();"use strict";kse.exports=kt;var zp;kt.ReadableState=xse;var zOt=dr().EventEmitter,Sse=function(e,r){return e.listeners(r).length},Zb=XT(),eE=Ut().Buffer,KJe=globalThis.Uint8Array||function(){};function jJe(t){return eE.from(t)}function VJe(t){return eE.isBuffer(t)||t instanceof KJe}var yR=QT(),pt;yR&&yR.debuglog?pt=yR.debuglog("stream"):pt=function(){};var zJe=Yne(),gR=eR(),HJe=tR(),$Je=HJe.getHighWaterMark,tE=Wf().codes,GJe=tE.ERR_INVALID_ARG_TYPE,WJe=tE.ERR_STREAM_PUSH_AFTER_EOF,YJe=tE.ERR_METHOD_NOT_IMPLEMENTED,XJe=tE.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Hp,bR,mR;Vi()(kt,Zb);var Jb=gR.errorOrDestroy,vR=["error","close","destroy","pause","resume"];function QJe(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function xse(t,e,r){zp=zp||Yf(),t=t||{},typeof r!="boolean"&&(r=e instanceof zp),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=$Je(this,t,"readableHighWaterMark",r),this.buffer=new zJe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(Hp||(Hp=hR().StringDecoder),this.decoder=new Hp(t.encoding),this.encoding=t.encoding)}function kt(t){if(zp=zp||Yf(),!(this instanceof kt))return new kt(t);var e=this instanceof zp;this._readableState=new xse(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Zb.call(this)}Object.defineProperty(kt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});kt.prototype.destroy=gR.destroy;kt.prototype._undestroy=gR.undestroy;kt.prototype._destroy=function(t,e){e(t)};kt.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=eE.from(t,e),e=""),i=!0),Ase(this,t,e,!1,i)};kt.prototype.unshift=function(t){return Ase(this,t,null,!0,!1)};function Ase(t,e,r,i,n){pt("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,eet(t,s);else{var o;if(n||(o=ZJe(s,e)),o)Jb(t,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==eE.prototype&&(e=jJe(e)),i)s.endEmitted?Jb(t,new XJe):wR(t,s,e,!0);else if(s.ended)Jb(t,new WJe);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?wR(t,s,e,!1):_R(t,s)):wR(t,s,e,!1)}else i||(s.reading=!1,_R(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function wR(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&rE(t)),_R(t,e)}function ZJe(t,e){var r;return!VJe(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new GJe("chunk",["string","Buffer","Uint8Array"],e)),r}kt.prototype.isPaused=function(){return this._readableState.flowing===!1};kt.prototype.setEncoding=function(t){Hp||(Hp=hR().StringDecoder);var e=new Hp(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";r!==null;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var Ise=1073741824;function JJe(t){return t>=Ise?t=Ise:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function Tse(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=JJe(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}kt.prototype.read=function(t){pt("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return pt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?SR(this):rE(this),null;if(t=Tse(t,e),t===0&&e.ended)return e.length===0&&SR(this),null;var i=e.needReadable;pt("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,pt("length less than watermark",i)),e.ended||e.reading?(i=!1,pt("reading or ended",i)):i&&(pt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Tse(r,e)));var n;return t>0?n=Cse(t,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&SR(this)),n!==null&&this.emit("data",n),n};function eet(t,e){if(pt("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?rE(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Rse(t)))}}function rE(t){var e=t._readableState;pt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(pt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Rse,t))}function Rse(t){var e=t._readableState;pt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,ER(t)}function _R(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(tet,t,e))}function tet(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(pt("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}kt.prototype._read=function(t){Jb(this,new YJe("_read()"))};kt.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,pt("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?a:m;i.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",o);function o(E,v){pt("onunpipe"),E===r&&v&&v.hasUnpiped===!1&&(v.hasUnpiped=!0,l())}function a(){pt("onend"),t.end()}var c=ret(r);t.on("drain",c);var u=!1;function l(){pt("cleanup"),t.removeListener("close",y),t.removeListener("finish",g),t.removeListener("drain",c),t.removeListener("error",h),t.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",m),r.removeListener("data",d),u=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}r.on("data",d);function d(E){pt("ondata");var v=t.write(E);pt("dest.write",v),v===!1&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&Ose(i.pipes,t)!==-1)&&!u&&(pt("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function h(E){pt("onerror",E),m(),t.removeListener("error",h),Sse(t,"error")===0&&Jb(t,E)}QJe(t,"error",h);function y(){t.removeListener("finish",g),m()}t.once("close",y);function g(){pt("onfinish"),t.removeListener("close",y),m()}t.once("finish",g);function m(){pt("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(pt("pipe resume"),r.resume()),t};function ret(t){return function(){var r=t._readableState;pt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&Sse(t,"data")&&(r.flowing=!0,ER(t))}}kt.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Ose(e.pipes,t);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};kt.prototype.on=function(t,e){var r=Zb.prototype.on.call(this,t,e),i=this._readableState;return t==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):t==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,pt("on readable",i.length,i.reading),i.length?rE(this):i.reading||process.nextTick(iet,this)),r};kt.prototype.addListener=kt.prototype.on;kt.prototype.removeListener=function(t,e){var r=Zb.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(Pse,this),r};kt.prototype.removeAllListeners=function(t){var e=Zb.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(Pse,this),e};function Pse(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function iet(t){pt("readable nexttick read 0"),t.read(0)}kt.prototype.resume=function(){var t=this._readableState;return t.flowing||(pt("resume"),t.flowing=!t.readableListening,net(this,t)),t.paused=!1,this};function net(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(set,t,e))}function set(t,e){pt("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),ER(t),e.flowing&&!e.reading&&t.read(0)}kt.prototype.pause=function(){return pt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(pt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ER(t){var e=t._readableState;for(pt("flow",e.flowing);e.flowing&&t.read()!==null;);}kt.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(pt("wrapped end"),r.decoder&&!r.ended){var o=r.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),t.on("data",function(o){if(pt("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!(r.objectMode&&o==null)&&!(!r.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(a){return function(){return t[a].apply(t,arguments)}}(n));for(var s=0;s<vR.length;s++)t.on(vR[s],this.emit.bind(this,vR[s]));return this._read=function(o){pt("wrapped _read",o),i&&(i=!1,t.resume())},this};typeof Symbol=="function"&&(kt.prototype[Symbol.asyncIterator]=function(){return bR===void 0&&(bR=wse()),bR(this)});Object.defineProperty(kt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(kt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(kt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});kt._fromList=Cse;Object.defineProperty(kt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Cse(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function SR(t){var e=t._readableState;pt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(oet,e,t))}function oet(t,e){if(pt("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(kt.from=function(t,e){return mR===void 0&&(mR=Ese()),mR(kt,t,e)});function Ose(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var xR=p(($Ot,Nse)=>{f();"use strict";Nse.exports=Uc;var iE=Wf().codes,aet=iE.ERR_METHOD_NOT_IMPLEMENTED,cet=iE.ERR_MULTIPLE_CALLBACK,uet=iE.ERR_TRANSFORM_ALREADY_TRANSFORMING,fet=iE.ERR_TRANSFORM_WITH_LENGTH_0,nE=Yf();Vi()(Uc,nE);function det(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(i===null)return this.emit("error",new cet);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function Uc(t){if(!(this instanceof Uc))return new Uc(t);nE.call(this,t),this._transformState={afterTransform:det.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",het)}function het(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){qse(t,e,r)}):qse(this,null,null)}Uc.prototype.push=function(t,e){return this._transformState.needTransform=!1,nE.prototype.push.call(this,t,e)};Uc.prototype._transform=function(t,e,r){r(new aet("_transform()"))};Uc.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};Uc.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Uc.prototype._destroy=function(t,e){nE.prototype._destroy.call(this,t,function(r){e(r)})};function qse(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new fet;if(t._transformState.transforming)throw new uet;return t.push(null)}});var Mse=p((GOt,Bse)=>{f();"use strict";Bse.exports=e1;var Dse=xR();Vi()(e1,Dse);function e1(t){if(!(this instanceof e1))return new e1(t);Dse.call(this,t)}e1.prototype._transform=function(t,e,r){r(null,t)}});var jse=p((WOt,Kse)=>{f();"use strict";var AR;function pet(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var Lse=Wf().codes,yet=Lse.ERR_MISSING_ARGS,get=Lse.ERR_STREAM_DESTROYED;function Use(t){if(t)throw t}function bet(t){return t.setHeader&&typeof t.abort=="function"}function met(t,e,r,i){i=pet(i);var n=!1;t.on("close",function(){n=!0}),AR===void 0&&(AR=Q2()),AR(t,{readable:e,writable:r},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,bet(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(o||new get("pipe"))}}}function Fse(t){t()}function vet(t,e){return t.pipe(e)}function wet(t){return!t.length||typeof t[t.length-1]!="function"?Use:t.pop()}function _et(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=wet(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new yet("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,u=a>0;return met(o,c,u,function(l){n||(n=l),l&&s.forEach(Fse),!c&&(s.forEach(Fse),i(n))})});return e.reduce(vet)}Kse.exports=_et});var IR=p((zs,Vse)=>{f();zs=Vse.exports=cR();zs.Stream=zs;zs.Readable=zs;zs.Writable=sR();zs.Duplex=Yf();zs.Transform=xR();zs.PassThrough=Mse();zs.finished=Q2();zs.pipeline=jse()});var $se=p((YOt,Hse)=>{f();"use strict";var Eet=Vi(),{Readable:zse}=IR();Hse.exports=$p;Eet($p,zse);function $p(t,e){if(!(this instanceof $p))return new $p(t,e);e=e||{},zse.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=t,this._options=e,this.on("end",this.destroy.bind(this,null,null))}$p.prototype._read=function(){this.destroyed||this._iterator.next((t,e,r)=>{if(!this.destroyed){if(t)return this.destroy(t);e===void 0&&r===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(r):this.push({key:e,value:r})}})};$p.prototype._destroy=function(t,e){this._iterator.end(function(r){e(t||r)})}});var Wse=p((Gse,sE)=>{f();(function(t,e,r){typeof sE!="undefined"&&sE.exports?sE.exports=r():e[t]=r()})("prr",Gse,function(){var t=typeof Object.defineProperty=="function"?function(i,n,s){return Object.defineProperty(i,n,s),i}:function(i,n,s){return i[n]=s.value,i},e=function(i,n){var s=typeof n=="object",o=!s&&typeof n=="string",a=function(c){return s?!!n[c]:o?n.indexOf(c[0])>-1:!1};return{enumerable:a("enumerable"),configurable:a("configurable"),writable:a("writable"),value:i}},r=function(i,n,s,o){var a;if(o=e(s,o),typeof n=="object"){for(a in n)Object.hasOwnProperty.call(n,a)&&(o.value=n[a],t(i,a,o));return i}return t(i,n,o)};return r})});var Qse=p((XOt,Xse)=>{f();var xet=Wse();function Yse(t,e,r){!!e&&typeof e!="string"&&(e=e.message||e.name),xet(this,{type:t,name:t,cause:typeof e!="string"?e:r,message:e},"ewr")}function TR(t,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),Yse.call(this,"CustomError",t,e)}TR.prototype=new Error;function Aet(t,e,r){var i=function(n,s){Yse.call(this,e,n,s),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(t.errno[this.cause.errno]?t.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,i)};return i.prototype=r?new r:new TR,i}Xse.exports=function(t){var e=function(r,i){return Aet(t,r,i)};return{CustomError:TR,FilesystemError:e("FilesystemError"),createError:e}}});var Zse=p((QOt,Va)=>{f();var Iet=Va.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];Va.exports.errno={};Va.exports.code={};Iet.forEach(function(t){Va.exports.errno[t.errno]=t,Va.exports.code[t.code]=t});Va.exports.custom=Qse()(Va.exports);Va.exports.create=Va.exports.custom.createError});var oE=p((ZOt,Jse)=>{f();"use strict";var ed=Zse().create,td=ed("LevelUPError"),RR=ed("NotFoundError",td);RR.prototype.notFound=!0;RR.prototype.status=404;Jse.exports={LevelUPError:td,InitializationError:ed("InitializationError",td),OpenError:ed("OpenError",td),ReadError:ed("ReadError",td),WriteError:ed("WriteError",td),NotFoundError:RR,EncodingError:ed("EncodingError",td)}});var CR=p(PR=>{f();"use strict";PR.fromCallback=function(t){if(t===void 0){var e=new Promise(function(r,i){t=function(n,s){n?i(n):r(s)}});t.promise=e}return t};PR.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){process.nextTick(e,null,r)}).catch(function(r){process.nextTick(e,r)})}});var t1=p(OR=>{f();"use strict";OR.getCallback=function(t,e){return typeof t=="function"?t:e};OR.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}});var toe=p((tkt,eoe)=>{f();"use strict";var r1=oE().WriteError,Tet=CR(),Ret=t1().getCallback,Pet=t1().getOptions;function i1(t){this.db=t,this.batch=t.db.batch(),this.ops=[],this.length=0}i1.prototype.put=function(t,e,r){try{this.batch.put(t,e,r)}catch(i){throw new r1(i)}return this.ops.push({...r,type:"put",key:t,value:e}),this.length++,this};i1.prototype.del=function(t,e){try{this.batch.del(t,e)}catch(r){throw new r1(r)}return this.ops.push({...e,type:"del",key:t}),this.length++,this};i1.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new r1(t)}return this.ops=[],this.length=0,this};i1.prototype.write=function(t,e){let r=this.db,i=this.ops;e=Ret(t,e),e=Tet.fromCallback(e),t=Pet(t);try{this.batch.write(t,function(n){if(n)return e(new r1(n));r.emit("batch",i),e()})}catch(n){throw new r1(n)}return e.promise};eoe.exports=i1});var noe=p((rkt,ioe)=>{f();"use strict";var roe=K2();ioe.exports=function(t,...e){e.length===0?roe(t):roe(()=>t(...e))}});var coe=p((ikt,aoe)=>{f();"use strict";var aE=dr().EventEmitter,Cet=Sne().inherits,soe=zne(),Oet=$se(),ket=toe(),Gp=oE(),qet=$T(),rd=CR(),n1=t1().getCallback,Wp=t1().getOptions,cE=noe(),uE=Gp.WriteError,ooe=Gp.ReadError,Net=Gp.NotFoundError,Det=Gp.OpenError,Bet=Gp.InitializationError;function ar(t,e,r){if(!(this instanceof ar))return new ar(t,e,r);let i;if(aE.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(r=e,e={}),e=e||{},!t||typeof t!="object"){if(i=new Bet("First argument must be an abstract-leveldown compliant store"),typeof r=="function")return cE(r,i);throw i}if(typeof t.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=Wp(e),this._db=t,this.db=new soe(t),this.open(r||(n=>{n&&this.emit("error",n)})),this.supports=qet(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}ar.prototype.emit=aE.prototype.emit;ar.prototype.once=aE.prototype.once;Cet(ar,aE);ar.prototype.open=function(t,e){return typeof t=="function"&&(e=t,t=null),e=rd.fromCallback(e),t||(t=this.options),this.isOpen()?(cE(e,null,this),e.promise):this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.emit("opening"),this.db.open(t,r=>{if(r)return e(new Det(r));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};ar.prototype.close=function(t){return t=rd.fromCallback(t),this.isOpen()?(this.db.close((e,...r)=>{this.emit("closed"),t(e,...r)}),this.emit("closing"),this.db=new soe(this._db)):this.isClosed()?cE(t):this.db.status==="closing"?this.once("closed",t):this._isOpening()&&this.once("open",()=>{this.close(t)}),t.promise};ar.prototype.isOpen=function(){return this.db.status==="open"};ar.prototype._isOpening=function(){return this.db.status==="opening"};ar.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};ar.prototype.get=function(t,e,r){return r=n1(e,r),r=rd.fromCallback(r),s1(this,r)||(e=Wp(e),this.db.get(t,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new Net("Key not found in database ["+t+"]",i):i=new ooe(i),r(i);r(null,n)})),r.promise};ar.prototype.put=function(t,e,r,i){return i=n1(r,i),i=rd.fromCallback(i),s1(this,i)||(r=Wp(r),this.db.put(t,e,r,n=>{if(n)return i(new uE(n));this.emit("put",t,e),i()})),i.promise};ar.prototype.del=function(t,e,r){return r=n1(e,r),r=rd.fromCallback(r),s1(this,r)||(e=Wp(e),this.db.del(t,e,i=>{if(i)return r(new uE(i));this.emit("del",t),r()})),r.promise};ar.prototype.batch=function(t,e,r){return arguments.length?(typeof t=="function"?r=t:r=n1(e,r),r=rd.fromCallback(r),s1(this,r)||(e=Wp(e),this.db.batch(t,e,i=>{if(i)return r(new uE(i));this.emit("batch",t),r()})),r.promise):new ket(this)};ar.prototype.iterator=function(t){return this.db.iterator(t)};ar.prototype.clear=function(t,e){return e=n1(t,e),t=Wp(t),e=rd.fromCallback(e),s1(this,e)||this.db.clear(t,r=>{if(r)return e(new uE(r));this.emit("clear",t),e()}),e.promise};ar.prototype.readStream=ar.prototype.createReadStream=function(t){return t=Object.assign({keys:!0,values:!0},t),typeof t.limit!="number"&&(t.limit=-1),new Oet(this.db.iterator(t),t)};ar.prototype.keyStream=ar.prototype.createKeyStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!0,values:!1}))};ar.prototype.valueStream=ar.prototype.createValueStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!1,values:!0}))};ar.prototype.toString=function(){return"LevelUP"};ar.prototype.type="levelup";function s1(t,e){if(!t._isOpening()&&!t.isOpen())return cE(e,new ooe("Database is not open")),!0}ar.errors=Gp;aoe.exports=ar});var uoe=p(Fc=>{f();"use strict";var{Buffer:kR}=Ut();Fc.utf8=Fc["utf-8"]={encode:function(t){return qR(t)?t:String(t)},decode:lE,buffer:!1,type:"utf8"};Fc.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};Fc.binary={encode:function(t){return qR(t)?t:kR.from(t)},decode:lE,buffer:!0,type:"binary"};Fc.none={encode:lE,decode:lE,buffer:!1,type:"id"};Fc.id=Fc.none;var Met=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let t of Met)Fc[t]={encode:function(e){return qR(e)?e:kR.from(e,t)},decode:function(e){return e.toString(t)},buffer:!0,type:t};function lE(t){return t}function qR(t){return t==null||kR.isBuffer(t)}});var foe=p((skt,loe)=>{f();"use strict";var NR=uoe(),Let=new Set(["lt","gt","lte","gte"]);loe.exports=Tn;function Tn(t){if(!(this instanceof Tn))return new Tn(t);this.opts=t||{},this.encodings=NR}Tn.prototype._encoding=function(t){return typeof t=="string"&&(t=NR[t]),t||(t=NR.id),t};Tn.prototype._keyEncoding=function(t,e){return this._encoding(e&&e.keyEncoding||t&&t.keyEncoding||this.opts.keyEncoding)};Tn.prototype._valueEncoding=function(t,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||t&&(t.valueEncoding||t.encoding)||this.opts.valueEncoding||this.opts.encoding)};Tn.prototype.encodeKey=function(t,e,r){return this._keyEncoding(e,r).encode(t)};Tn.prototype.encodeValue=function(t,e,r){return this._valueEncoding(e,r).encode(t)};Tn.prototype.decodeKey=function(t,e){return this._keyEncoding(e).decode(t)};Tn.prototype.decodeValue=function(t,e){return this._valueEncoding(e).decode(t)};Tn.prototype.encodeBatch=function(t,e){return t.map(r=>{let i={type:r.type,key:this.encodeKey(r.key,e,r)};return this.keyAsBuffer(e,r)&&(i.keyEncoding="binary"),r.prefix&&(i.prefix=r.prefix),"value"in r&&(i.value=this.encodeValue(r.value,e,r),this.valueAsBuffer(e,r)&&(i.valueEncoding="binary")),i})};Tn.prototype.encodeLtgt=function(t){let e={};for(let r of Object.keys(t)){if(r==="start"||r==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[r]=Let.has(r)?this.encodeKey(t[r],t):t[r]}return e};Tn.prototype.createStreamDecoder=function(t){return t.keys&&t.values?(e,r)=>({key:this.decodeKey(e,t),value:this.decodeValue(r,t)}):t.keys?e=>this.decodeKey(e,t):t.values?(e,r)=>this.decodeValue(r,t):function(){}};Tn.prototype.keyAsBuffer=function(t){return this._keyEncoding(t).buffer};Tn.prototype.valueAsBuffer=function(t){return this._valueEncoding(t).buffer}});var boe=p((okt,goe)=>{f();"use strict";var doe=ol().AbstractLevelDOWN,hoe=ol().AbstractChainedBatch,poe=ol().AbstractIterator,DR=Vi(),Uet=foe(),yoe=oE().EncodingError,Fet=["approximateSize","compactRange"];goe.exports=fn;function fn(t,e){if(!(this instanceof fn))return new fn(t,e);let r=t.supports||{},i=r.additionalMethods||{};doe.call(this,r),this.supports.encodings=!0,this.supports.additionalMethods={},Fet.forEach(function(n){let s=typeof t[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,u){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,u)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=t,this.codec=new Uet(e)}DR(fn,doe);fn.prototype.type="encoding-down";fn.prototype._serializeKey=fn.prototype._serializeValue=function(t){return t};fn.prototype._open=function(t,e){this.db.open(t,e)};fn.prototype._close=function(t){this.db.close(t)};fn.prototype._put=function(t,e,r,i){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.db.put(t,e,r,i)};fn.prototype._get=function(t,e,r){t=this.codec.encodeKey(t,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(t,e,(i,n)=>{if(i)return r(i);try{n=this.codec.decodeValue(n,e)}catch(s){return r(new yoe(s))}r(null,n)})};fn.prototype._del=function(t,e,r){t=this.codec.encodeKey(t,e),this.db.del(t,e,r)};fn.prototype._chainedBatch=function(){return new Yp(this)};fn.prototype._batch=function(t,e,r){t=this.codec.encodeBatch(t,e),this.db.batch(t,e,r)};fn.prototype._iterator=function(t){return t.keyAsBuffer=this.codec.keyAsBuffer(t),t.valueAsBuffer=this.codec.valueAsBuffer(t),new o1(this,t)};fn.prototype._clear=function(t,e){t=this.codec.encodeLtgt(t),this.db.clear(t,e)};function o1(t,e){poe.call(this,t),this.codec=t.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=t.db.iterator(this.opts)}DR(o1,poe);o1.prototype._next=function(t){this.it.next((e,r,i)=>{if(e)return t(e);try{this.keys&&typeof r!="undefined"?r=this.codec.decodeKey(r,this.opts):r=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return t(new yoe(n))}t(null,r,i)})};o1.prototype._seek=function(t){t=this.codec.encodeKey(t,this.opts),this.it.seek(t)};o1.prototype._end=function(t){this.it.end(t)};function Yp(t,e){hoe.call(this,t),this.codec=t.codec,this.batch=t.db.batch()}DR(Yp,hoe);Yp.prototype._put=function(t,e,r){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.batch.put(t,e)};Yp.prototype._del=function(t,e){t=this.codec.encodeKey(t,e),this.batch.del(t)};Yp.prototype._clear=function(){this.batch.clear()};Yp.prototype._write=function(t,e){this.batch.write(t,e)}});var woe=p((akt,voe)=>{f();"use strict";var moe=coe(),Ket=boe();function jet(t){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),r(n)||(n=r(i)?i:{}),moe(Ket(t(i,n),n),n,s)}function r(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof t[i]=="function"&&(e[i]=function(...n){t[i](...n)});return e.errors=moe.errors,e}voe.exports=jet});var Eoe=p(ii=>{f();ii.compare=function(t,e){if(Buffer.isBuffer(t)){for(var r=Math.min(t.length,e.length),i=0;i<r;i++){var n=t[i]-e[i];if(n)return n}return t.length-e.length}return t<e?-1:t>e?1:0};function _oe(t){return t!==void 0&&t!==""}function Xp(t,e){return Object.hasOwnProperty.call(t,e)}function za(t,e){return Object.hasOwnProperty.call(t,e)&&e}var Vet=ii.lowerBoundKey=function(t){return za(t,"gt")||za(t,"gte")||za(t,"min")||(t.reverse?za(t,"end"):za(t,"start"))||void 0},BR=ii.lowerBound=function(t,e){var r=Vet(t);return r?t[r]:e},MR=ii.lowerBoundInclusive=function(t){return!Xp(t,"gt")},LR=ii.upperBoundInclusive=function(t){return!Xp(t,"lt")},zet=ii.lowerBoundExclusive=function(t){return!MR(t)},Het=ii.upperBoundExclusive=function(t){return!LR(t)},$et=ii.upperBoundKey=function(t){return za(t,"lt")||za(t,"lte")||za(t,"max")||(t.reverse?za(t,"start"):za(t,"end"))||void 0},UR=ii.upperBound=function(t,e){var r=$et(t);return r?t[r]:e};ii.start=function(t,e){return t.reverse?UR(t,e):BR(t,e)};ii.end=function(t,e){return t.reverse?BR(t,e):UR(t,e)};ii.startInclusive=function(t){return t.reverse?LR(t):MR(t)};ii.endInclusive=function(t){return t.reverse?MR(t):LR(t)};function Get(t){return t}ii.toLtgt=function(t,e,r,i,n){e=e||{},r=r||Get;var s=arguments.length>3,o=ii.lowerBoundKey(t),a=ii.upperBoundKey(t);return o?o==="gt"?e.gt=r(t.gt,!1):e.gte=r(t[o],!1):s&&(e.gte=r(i,!1)),a?a==="lt"?e.lt=r(t.lt,!0):e.lte=r(t[a],!0):s&&(e.lte=r(n,!0)),t.reverse!=null&&(e.reverse=!!t.reverse),Xp(e,"max")&&delete e.max,Xp(e,"min")&&delete e.min,Xp(e,"start")&&delete e.start,Xp(e,"end")&&delete e.end,e};ii.contains=function(t,e,r){r=r||ii.compare;var i=BR(t);if(_oe(i)){var n=r(e,i);if(n<0||n===0&&zet(t))return!1}var s=UR(t);if(_oe(s)){var n=r(e,s);if(n>0||n===0&&Het(t))return!1}return!0};ii.filter=function(t,e){return function(r){return ii.contains(t,r,e)}}});var FR=p((ukt,Soe)=>{f();"use strict";var fE=Eoe(),fl=Symbol("none");Soe.exports=function(e){let r=fE.lowerBound(e,fl),i=fE.upperBound(e,fl),n=fE.lowerBoundExclusive(e,fl),s=fE.upperBoundExclusive(e,fl);return r!==fl&&i!==fl?IDBKeyRange.bound(r,i,n,s):r!==fl?IDBKeyRange.lowerBound(r,n):i!==fl?IDBKeyRange.upperBound(i,s):null}});var KR=p((lkt,Aoe)=>{f();"use strict";var dE=Ut().Buffer,Wet=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return xoe(e).toString()}}(),Yet=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return dE.from(e).toString()}}();function xoe(t){let e=dE.from(t.buffer);return t.byteLength===t.buffer.byteLength?e:e.slice(t.byteOffset,t.byteOffset+t.byteLength)}Aoe.exports=function(t,e){return t instanceof Uint8Array?e?xoe(t):Wet(t):t instanceof ArrayBuffer?e?dE.from(t):Yet(t):e?dE.from(String(t)):String(t)}});var Poe=p((fkt,Roe)=>{f();"use strict";var Xet=Vi(),Ioe=ol().AbstractIterator,Qet=FR(),Toe=KR(),Zet=function(){};Roe.exports=Do;function Do(t,e,r){if(Ioe.call(this,t),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=r.keys,this._values=r.values,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=Qet(r)}catch(n){this._completed=!0;return}this.createIterator(e,i,r.reverse)}Xet(Do,Ioe);Do.prototype.createIterator=function(t,e,r){let i=this.db.db.transaction([t],"readonly"),s=i.objectStore(t).openCursor(e,r?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};Do.prototype.onItem=function(t){this._cache.push(t.key,t.value),(this._limit<=0||++this._count<this._limit)&&t.continue(),this.maybeNext()};Do.prototype.onAbort=function(t){this._aborted=!0,this._error=t,this.maybeNext()};Do.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};Do.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};Do.prototype._next=function(t){if(this._aborted){let e=this._error;this._error=null,this._nextTick(t,e)}else if(this._cache.length>0){let e=this._cache.shift(),r=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&r!==void 0?r=this._deserializeValue(r,this._valueAsBuffer):r=void 0,this._nextTick(t,null,e,r)}else this._completed?this._nextTick(t):this._callback=t};Do.prototype._deserializeKey=Toe;Do.prototype._deserializeValue=Toe;Do.prototype._end=function(t){if(this._aborted||this._completed)return this._nextTick(t,this._error);this.onItem=Zet,this.onAbort=t,this.onComplete=t}});var koe=p((dkt,Ooe)=>{f();"use strict";var Coe=Ut().Buffer,Jet=function(){if(globalThis.TextEncoder){let t=new TextEncoder("utf-8");return t.encode.bind(t)}else return Coe.from}();Ooe.exports=function(t,e){return e?Coe.isBuffer(t)?t:Jet(String(t)):String(t)}});var qoe=p(hE=>{f();"use strict";var ett=Ut().Buffer;hE.test=function(t){return function(r){try{return r.cmp(t,0),!0}catch(i){return!1}}};hE.bufferKeys=hE.test(ett.alloc(0))});var Doe=p((pkt,Noe)=>{f();"use strict";Noe.exports=function(e,r,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([r],"readwrite"),a=o.objectStore(r),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",l=n.reverse?"prev":"next";a[u](i,l).onsuccess=function(d){let h=d.target.result;h&&(a.delete(h.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&h.continue()})}}});var Foe=p((ykt,Uoe)=>{f();"use strict";Uoe.exports=mi;var Boe=ol().AbstractLevelDOWN,ttt=Vi(),rtt=Poe(),Moe=koe(),jR=KR(),itt=qoe(),ntt=Doe(),stt=FR(),Loe="level-js-";function mi(t,e){if(!(this instanceof mi))return new mi(t,e);if(Boe.call(this,{bufferKeys:itt.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),e=e||{},typeof t!="string")throw new Error("constructor requires a location string argument");this.location=t,this.prefix=e.prefix==null?Loe:e.prefix,this.version=parseInt(e.version||1,10)}ttt(mi,Boe);mi.prototype.type="level-js";mi.prototype._open=function(t,e){let r=indexedDB.open(this.prefix+this.location,this.version);r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};mi.prototype.store=function(t){return this.db.transaction([this.location],t).objectStore(this.location)};mi.prototype.await=function(t,e){let r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}};mi.prototype._get=function(t,e,r){let i=this.store("readonly"),n;try{n=i.get(t)}catch(s){return this._nextTick(r,s)}this.await(n,function(s,o){if(s)return r(s);if(o===void 0)return r(new Error("NotFound"));r(null,jR(o,e.asBuffer))})};mi.prototype._del=function(t,e,r){let i=this.store("readwrite"),n;try{n=i.delete(t)}catch(s){return this._nextTick(r,s)}this.await(n,r)};mi.prototype._put=function(t,e,r,i){let n=this.store("readwrite"),s;try{s=n.put(e,t)}catch(o){return this._nextTick(i,o)}this.await(s,i)};mi.prototype._serializeKey=function(t){return Moe(t,this.supports.bufferKeys)};mi.prototype._serializeValue=function(t){return Moe(t,!0)};mi.prototype._iterator=function(t){return new rtt(this,this.location,t)};mi.prototype._batch=function(t,e,r){if(t.length===0)return this._nextTick(r);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){r(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){r()};function a(){let c=t[s++],u=c.key,l;try{l=c.type==="del"?i.delete(u):i.put(c.value,u)}catch(d){o=d,n.abort();return}s<t.length&&(l.onsuccess=a)}a()};mi.prototype._clear=function(t,e){let r,i;try{r=stt(t)}catch(n){return this._nextTick(e)}if(t.limit>=0)return ntt(this,this.location,r,t,e);try{let n=this.store("readwrite");i=r?n.delete(r):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};mi.prototype._close=function(t){this.db.close(),this._nextTick(t)};mi.prototype.upgrade=function(t){if(this.status!=="open")return this._nextTick(t,new Error("cannot upgrade() before open()"));let e=this.iterator(),r={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,u,l){if(c||u===void 0)return o(c);let d=i._serializeKey(jR(u,!0)),h=i._serializeValue(jR(l,!0));i._batch([{type:"del",key:u},{type:"put",key:d,value:h}],r,n)}function o(c){e.end(function(u){t(c||u)})}function a(c){return c}};mi.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=Loe);let i=indexedDB.deleteDatabase(e+t);i.onsuccess=function(){r()},i.onerror=function(n){r(n)}}});var joe=p((gkt,Koe)=>{f();Koe.exports=woe()(Foe())});var Goe=p((bkt,$oe)=>{f();"use strict";var{Key:ott,Errors:a1,Adapter:att,utils:{sortAll:Voe}}=Ft(),pE=Pa(),ctt=Io(),zoe=$h(),Hoe=class extends att{constructor(e,r){super();this.path=e,this.opts=r,r&&r.db?(this.database=r.db,delete r.db):this.database=joe()}_initDb(){return new Promise((e,r)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return r(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw a1.dbOpenFailedError(e)}}async put(e,r){try{await this.db.put(e.toString(),r)}catch(i){throw a1.dbWriteFailedError(i)}}async get(e){let r;try{r=await this.db.get(e.toString())}catch(i){throw i.notFound?a1.notFoundError(i):a1.dbWriteFailedError(i)}return r}async has(e){try{await this.db.get(e.toString())}catch(r){if(r.notFound)return!1;throw r}return!0}async delete(e){try{await this.db.del(e.toString())}catch(r){throw a1.dbDeleteFailedError(r)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(r,i)=>{e.push({type:"put",key:r.toString(),value:i})},delete:r=>{e.push({type:"del",key:r.toString()})},commit:()=>this.db.batch(e)}}query(e){let r=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>pE(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>Voe(s,o),r));let{offset:i,limit:n}=e;if(i){let s=0;r=pE(r,()=>s++>=i)}return n&&(r=zoe(r,n)),r}queryKeys(e){let r=ctt(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(r=e.filters.reduce((s,o)=>pE(s,o),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((s,o)=>Voe(s,o),r));let{offset:i,limit:n}=e;if(i){let s=0;r=pE(r,()=>s++>=i)}return n&&(r=zoe(r,n)),r}_query(e){let r={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();r.gte=i,r.lt=i+"\xFF"}return utt(this.db.iterator(r))}};function utt(t){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,r)=>{t.next((i,n,s)=>{if(i)return r(i);if(n==null)return t.end(o=>{if(o)return r(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new ott(n,!1),value:s}})})}),return:()=>new Promise((e,r)=>{t.end(i=>{if(i)return r(i);e({done:!0,value:void 0})})})}}}}$oe.exports=Hoe});var VR=p((mkt,Zoe)=>{f();"use strict";var Woe=Ra(),Qp=Pa(),Yoe=$h(),ltt=Hh(),Xoe=(t,e)=>async function*(){yield*(await ltt(t)).sort(e)}(),Qoe=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,i){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:i,value:n}of e)await this.put(i,n,r),yield{key:i,value:n}}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}async*deleteMany(e,r={}){for await(let i of e)await this.delete(i,r),yield i}batch(){let e=[],r=[];return{put(i,n){e.push({key:i,value:n})},delete(i){r.push(i)},commit:async i=>{await Woe(this.putMany(e,i)),e=[],await Woe(this.deleteMany(r,i)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let i=this._all(e,r);if(e.prefix!=null&&(i=Qp(i,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>Qp(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Xoe(n,s),i)),e.offset!=null){let n=0;i=Qp(i,()=>n++>=(e.offset||0))}return e.limit!=null&&(i=Yoe(i,e.limit)),i}queryKeys(e,r){let i=this._allKeys(e,r);if(e.prefix!=null&&(i=Qp(i,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>Qp(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Xoe(n,s),i)),e.offset!=null){let n=0;i=Qp(i,()=>n++>=e.offset)}return e.limit!=null&&(i=Yoe(i,e.limit)),i}};Zoe.exports=Qoe});var eae=p((vkt,Joe)=>{f();"use strict";var ftt=ae();function dtt(t){return t=t||new Error("Not Found"),ftt(t,"ERR_NOT_FOUND")}Joe.exports={notFoundError:dtt}});var oae=p((wkt,sae)=>{f();"use strict";var htt=VR(),{base32:Zp}=(Ji(),Zi),tae=(Es(),Zn),{CID:rae}=(Ae(),ke),iae=(vn(),mn),ptt=eae(),nae=class extends htt{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[Zp.encode(e.multihash.bytes)]=r}async get(e){if(!await this.has(e))throw ptt.notFoundError();return this.data[Zp.encode(e.multihash.bytes)]}async has(e){return this.data[Zp.encode(e.multihash.bytes)]!==void 0}async delete(e){delete this.data[Zp.encode(e.multihash.bytes)]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:rae.createV1(tae.code,iae.decode(Zp.decode(e))),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>rae.createV1(tae.code,iae.decode(Zp.decode(e))))}};sae.exports=nae});var yE=p((_kt,aae)=>{f();"use strict";var ytt=VR(),gtt=oae();aae.exports={BlockstoreAdapter:ytt,MemoryBlockstore:gtt}});var pae=p((Ekt,hae)=>{f();"use strict";var cae=Ra(),uae=Oa(),{Key:btt}=Ft(),{CID:lae}=(Ae(),ke),mtt=(Es(),Zn),vtt=(vn(),mn),{base32:c1,base32pad:wtt}=(Ji(),Zi),{base58btc:fae}=(Zr(),Qr),_tt=ae(),{BlockstoreAdapter:Ett}=yE();function Jp(t){if(!(t instanceof lae))throw _tt(new Error("Not a valid cid"),"ERR_INVALID_CID");return new btt("/"+c1.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function dl(t){return lae.createV1(mtt.code,vtt.decode(c1.decode("b"+t.toString().slice(1).toLowerCase())))}function zR(t){let e,r=t.substring(0,1);return r==="/"?zR(t.substring(1)):(r.toLowerCase()==="b"?e=c1.decode(t.toLowerCase()).subarray(2):r.toLowerCase()==="c"?e=wtt.decode(t.toLowerCase()).subarray(2):r==="z"?e=fae.decode(t).subarray(2):r==="Q"?e=fae.decode("z"+t):e=c1.decode("b"+t.toLowerCase()).subarray(2),c1.encode(e).substring(1).toUpperCase()||"C")}function Stt(t){return{...t,prefix:t.prefix?`/${zR(t.prefix)}`:void 0,filters:t.filters?t.filters.map(e=>r=>e({key:dl(r.key),value:r.value})):void 0,orders:t.orders?t.orders.map(e=>(r,i)=>e({key:dl(r.key),value:r.value},{key:dl(i.key),value:i.value})):void 0}}function xtt(t){return{...t,prefix:t.prefix?`/${zR(t.prefix)}`:void 0,filters:t.filters?t.filters.map(e=>r=>e(dl(r))):void 0,orders:t.orders?t.orders.map(e=>(r,i)=>e(dl(r),dl(i))):void 0}}var dae=class extends Ett{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,r){for await(let{key:i,value:n}of this.child.query(Stt(e),r))yield{key:dl(i),value:n}}async*queryKeys(e,r){for await(let i of this.child.queryKeys(xtt(e),r))yield dl(i)}async get(e,r){return this.child.get(Jp(e),r)}async*getMany(e,r){for await(let i of e)yield this.get(i,r)}async put(e,r,i){await this.child.put(Jp(e),r,i)}async*putMany(e,r){let i=uae();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{let s=this.child;await cae(this.child.putMany(async function*(){for await(let o of e){let a=Jp(o.key);await s.has(a,r)||(yield{key:a,value:o.value}),i.push(o)}}())),i.end()}catch(s){i.end(s)}}),yield*i}has(e,r){return this.child.has(Jp(e),r)}delete(e,r){return this.child.delete(Jp(e),r)}deleteMany(e,r){let i=uae();return cae(this.child.deleteMany(async function*(){for await(let n of e)yield Jp(n),i.push(n);i.end()}(),r)).catch(n=>{i.end(n)}),i}};hae.exports=dae});var gae=p((Skt,yae)=>{f();"use strict";var{createRepo:Att}=mf(),u1=Goe(),Itt=pae();yae.exports=(t,e,r)=>{let i=r.path||"ipfs";return Att(i,n=>e.getCodec(n),{root:new u1(i,{prefix:"",version:2}),blocks:new Itt(new u1(`${i}/blocks`,{prefix:"",version:2})),datastore:new u1(`${i}/datastore`,{prefix:"",version:2}),keys:new u1(`${i}/keys`,{prefix:"",version:2}),pins:new u1(`${i}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||t})}});var HR=p((xkt,wae)=>{f();"use strict";var bae=()=>{},mae=Symbol.for("@libp2p/js-interfaces/topology"),vae=class{constructor({min:e=0,max:r=1/0,handlers:i={}}){this.min=e,this.max=r,this._onConnect=i.onConnect||bae,this._onDisconnect=i.onDisconnect||bae,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[mae](){return!0}static isTopology(e){return Boolean(e&&e[mae])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};wae.exports=vae});var gE=p((Akt,Sae)=>{f();"use strict";var Ttt=HR(),_ae=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),Eae=class extends Ttt{constructor({min:e,max:r,multicodecs:i,handlers:n}){super({min:e,max:r,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[_ae](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[_ae])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(let{id:r,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(r.toB58String());let n=this._registrar.getConnection(r);n&&this._onConnect(r,n)}else this.peers.delete(r.toB58String())}_onProtocolChange({peerId:e,protocols:r}){let i=this.peers.has(e.toB58String()),n=r.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of r)if(this.multicodecs.includes(s)){let o=this._registrar.peerStore.get(e);this._updatePeers([o]);return}}_onPeerConnect(e){let r=e.remotePeer,i=this._registrar.peerStore.protoBook.get(r);!i||this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(r.toB58String()),this._onConnect(r,e))}};Sae.exports=Eae});var bE=p(xae=>{f();"use strict";xae.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var GR=p((Tkt,Aae)=>{f();"use strict";var hl=Ti(),e0=hl.Reader,$R=hl.Writer,wt=hl.util,vi=hl.roots["libp2p-pubsub-rpc"]||(hl.roots["libp2p-pubsub-rpc"]={});vi.RPC=function(){function t(e){if(this.subscriptions=[],this.msgs=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.subscriptions=wt.emptyArray,t.prototype.msgs=wt.emptyArray,t.encode=function(r,i){if(i||(i=$R.create()),r.subscriptions!=null&&r.subscriptions.length)for(var n=0;n<r.subscriptions.length;++n)vi.RPC.SubOpts.encode(r.subscriptions[n],i.uint32(10).fork()).ldelim();if(r.msgs!=null&&r.msgs.length)for(var n=0;n<r.msgs.length;++n)vi.RPC.Message.encode(r.msgs[n],i.uint32(18).fork()).ldelim();return i},t.decode=function(r,i){r instanceof e0||(r=e0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new vi.RPC;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(vi.RPC.SubOpts.decode(r,r.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(vi.RPC.Message.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof vi.RPC)return r;var i=new vi.RPC;if(r.subscriptions){if(!Array.isArray(r.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<r.subscriptions.length;++n){if(typeof r.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=vi.RPC.SubOpts.fromObject(r.subscriptions[n])}}if(r.msgs){if(!Array.isArray(r.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<r.msgs.length;++n){if(typeof r.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=vi.RPC.Message.fromObject(r.msgs[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),r.subscriptions&&r.subscriptions.length){n.subscriptions=[];for(var s=0;s<r.subscriptions.length;++s)n.subscriptions[s]=vi.RPC.SubOpts.toObject(r.subscriptions[s],i)}if(r.msgs&&r.msgs.length){n.msgs=[];for(var s=0;s<r.msgs.length;++s)n.msgs[s]=vi.RPC.Message.toObject(r.msgs[s],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,hl.util.toJSONOptions)},t.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var r;return Object.defineProperty(e.prototype,"_subscribe",{get:wt.oneOfGetter(r=["subscribe"]),set:wt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_topicID",{get:wt.oneOfGetter(r=["topicID"]),set:wt.oneOfSetter(r)}),e.encode=function(n,s){return s||(s=$R.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof e0||(n=e0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new vi.RPC.SubOpts;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.subscribe=n.bool();break;case 2:a.topicID=n.string();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof vi.RPC.SubOpts)return n;var s=new vi.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,hl.util.toJSONOptions)},e}(),t.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=wt.emptyArray,e.prototype.signature=null,e.prototype.key=null;var r;return Object.defineProperty(e.prototype,"_from",{get:wt.oneOfGetter(r=["from"]),set:wt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_data",{get:wt.oneOfGetter(r=["data"]),set:wt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_seqno",{get:wt.oneOfGetter(r=["seqno"]),set:wt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_signature",{get:wt.oneOfGetter(r=["signature"]),set:wt.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_key",{get:wt.oneOfGetter(r=["key"]),set:wt.oneOfSetter(r)}),e.encode=function(n,s){if(s||(s=$R.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof e0||(n=e0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new vi.RPC.Message;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.from=n.bytes();break;case 2:a.data=n.bytes();break;case 3:a.seqno=n.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(n.string());break;case 5:a.signature=n.bytes();break;case 6:a.key=n.bytes();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof vi.RPC.Message)return n;var s=new vi.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?wt.base64.decode(n.from,s.from=wt.newBuffer(wt.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?wt.base64.decode(n.data,s.data=wt.newBuffer(wt.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?wt.base64.decode(n.seqno,s.seqno=wt.newBuffer(wt.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?wt.base64.decode(n.signature,s.signature=wt.newBuffer(wt.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?wt.base64.decode(n.key,s.key=wt.newBuffer(wt.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?wt.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?wt.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?wt.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var a=0;a<n.topicIDs.length;++a)o.topicIDs[a]=n.topicIDs[a]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?wt.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?wt.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,hl.util.toJSONOptions)},e}(),t}();Aae.exports=vi});var WR=p((Rkt,Rae)=>{f();"use strict";var Iae=es(),{Buffer:Rtt}=Ut(),Tae=(t,e,r)=>{let i=Iae.encode(t,e,r);return Tae.bytes=Iae.encode.bytes,e||Rtt.from(i)};Rae.exports=Tae});var Nae=p((Pkt,mE)=>{f();"use strict";var{Buffer:Pae}=Ut(),Cae=ln(),Oae=WR(),YR=8,kae=10*1024;function qae(t){t=t||{};let e=Math.max(t.poolSize||kae,t.minPoolSize||YR),r=t.lengthEncoder||Oae;return async function*(n){let s=Pae.alloc(e),o=0;for await(let a of n){r(a.length,s,o);let c=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<YR&&(s=Pae.alloc(e),o=0),yield new Cae().append(c).append(a)}}}qae.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||Oae;return new Cae([r(t.length),t.slice()])};mE.exports=qae;mE.exports.MIN_POOL_SIZE=YR;mE.exports.DEFAULT_POOL_SIZE=kae});var XR=p((Ckt,Mae)=>{f();"use strict";var Dae=es(),{Buffer:Ptt}=Ut(),Ctt=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),Bae=t=>{let e=Dae.decode(Ptt.isBuffer(t)?t:Ctt(t));return Bae.bytes=Dae.decode.bytes,e};Mae.exports=Bae});var Kae=p((Okt,vE)=>{f();"use strict";var{Buffer:Ott}=Ut(),QR=ln(),ktt=XR(),Lae=8,Uae=1024*1024*4,Fae=Ott.alloc(0),pl={LENGTH:"readLength",DATA:"readData"},qtt={[pl.LENGTH]:(t,e,r,i)=>{e=e.append(t);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:pl.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(i.lengthDecoder.bytes),e=new QR,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(Fae),{mode:pl.LENGTH,chunk:t,buffer:e,data:Fae}):{mode:pl.DATA,chunk:t,buffer:e,state:{dataLength:n},data:void 0}},[pl.DATA]:(t,e,r,i)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:pl.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:n}=r,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new QR,i.onData&&i.onData(s),{mode:pl.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function ZR(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||ktt,maxLengthLength:t.maxLengthLength||Lae,maxDataLength:t.maxDataLength||Uae,onLength:t.onLength,onData:t.onData};return async function*(i){let n=new QR,s=pl.LENGTH,o;for await(let a of i){let c=a;for(;c;){let u=qtt[s](c,n,o,e);s=u.mode,c=u.chunk,n=u.buffer,o=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}ZR.fromReader=(t,e)=>{let r=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return ZR({...e||{},onLength:s=>{r=s}})(i)};vE.exports=ZR;vE.exports.MAX_LENGTH_LENGTH=Lae;vE.exports.MAX_DATA_LENGTH=Uae});var zae=p((kkt,Vae)=>{f();"use strict";var{Buffer:Ntt}=Ut(),jae=(t,e,r)=>(e=e||Ntt.allocUnsafe(4),e.writeInt32BE(t,r),e);jae.bytes=4;Vae.exports=jae});var Gae=p((qkt,$ae)=>{f();"use strict";var Hae=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};Hae.bytes=4;$ae.exports=Hae});var Bo=p(id=>{f();"use strict";id.encode=Nae();id.decode=Kae();id.varintEncode=WR();id.varintDecode=XR();id.int32BEEncode=zae();id.int32BEDecode=Gae()});var wE=p((Dkt,Wae)=>{f();Wae.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Xae=p((Mkt,Yae)=>{f();Yae.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var Ha=p((Lkt,nd)=>{f();var Dtt=wE(),JR=Xae(),Qae=(t,e,r)=>e8(t,Array.isArray(e)?e:[{signal:e,options:r}]),e8=(t,e)=>{t=Dtt(t),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*r(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new JR(u,l)}let o=new Promise((a,c)=>{i=()=>{let{options:u}=e.find(({signal:h})=>h.aborted),{abortMessage:l,abortCode:d}=u;c(new JR(l,d))}});s=await Promise.race([o,t.next()]),i=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",n);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(t),typeof t.return=="function"&&await t.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return r()},Zae=(t,e,r)=>Jae(t,Array.isArray(e)?e:[{signal:e,options:r}]),Jae=(t,e)=>r=>t(e8(r,e)),Btt=(t,e,r)=>Mtt(t,Array.isArray(e)?e:[{signal:e,options:r}]),Mtt=(t,e)=>({sink:Jae(t.sink,e),source:e8(t.source,e)});nd.exports=Qae;nd.exports.AbortError=JR;nd.exports.source=Qae;nd.exports.sink=Zae;nd.exports.transform=Zae;nd.exports.duplex=Btt});var sce=p((Ukt,nce)=>{f();"use strict";var ece=me(),Ltt=Object.assign(ece("libp2p-pubsub:peer-streams"),{error:ece("libp2p-pubsub:peer-streams:err")}),{EventEmitter:Utt}=dr(),tce=Bo(),Ftt=Oa(),{pipe:rce}=Er(),{source:Ktt}=Ha(),jtt=Ll().default,ice=class extends Utt{constructor({id:e,protocol:r}){super();this.id=e,this.protocol=r,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new jtt,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let r=this.id.toB58String();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=Ktt(rce(this._rawInboundStream,tce.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=Ftt({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),rce(this.outboundStream,tce.encode(),this._rawOutboundStream).catch(i=>{Ltt.error(i)}),r||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};nce.exports=ice});var ace=p(oce=>{f();"use strict";var Vtt={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};oce.SignaturePolicy=Vtt});var t8=p((Kkt,lce)=>{f();"use strict";var ztt=Qy(),Htt=Je(),cce=ct(),uce=et(),{sha256:$tt}=(ei(),Ur),Gtt=()=>ztt(8),Wtt=(t,e)=>{let r;t instanceof Uint8Array?r=uce.createFromBytes(t).id:r=uce.parse(t).id;let i=new Uint8Array(r.length+e.length);return i.set(r,0),i.set(e,r.length),i},Ytt=t=>$tt.encode(t),Xtt=(t,e)=>{let r;Array.isArray(e)?r=i=>e.indexOf(i)>-1:r=i=>e.has(i);for(let i of t)if(r(i))return!0;return!1},Qtt=t=>Array.isArray(t)?t:[t],Ztt=(t,e)=>{let r=Object.assign({},t);return t.from instanceof Uint8Array&&(r.from=Htt(t.from,"base58btc")),e&&(r.receivedFrom=e),r},Jtt=t=>{let e=Object.assign({},t);return typeof t.from=="string"&&(e.from=cce(t.from,"base58btc")),typeof t.data=="string"&&(e.data=cce(t.data)),e};lce.exports={randomSeqno:Gtt,msgId:Wtt,noSignMsgId:Ytt,anyMatch:Xtt,ensureArray:Qtt,normalizeInRpcMessage:Ztt,normalizeOutRpcMessage:Jtt}});var yce=p((jkt,pce)=>{f();"use strict";var r8=et(),{RPC:fce}=GR(),dce=tn(),ert=ct(),i8=ert("libp2p-pubsub:"),{normalizeOutRpcMessage:trt}=t8();async function rrt(t,e){let r=dce([i8,fce.Message.encode(trt(e)).finish()]),i=await t.privKey.sign(r);return{...e,signature:i,key:t.pubKey.bytes}}async function irt(t){if(!t.signature)throw new Error("Message must contain a signature to be verified");if(!t.from)throw new Error("Message must contain a from property to be verified");let e=dce([i8,fce.Message.encode({...t,from:r8.createFromB58String(t.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await hce(t)).verify(e,t.signature)}async function hce(t){if(!t.from)throw new Error("Could not get the public key from the originator id");let e=r8.createFromB58String(t.from);if(t.key){let r=await r8.createFromPubKey(t.key);if(r.equals(e))return r.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}pce.exports={messagePublicKey:hce,signMessage:rrt,SignPrefix:i8,verifySignature:irt}});var vce=p((Vkt,mce)=>{f();"use strict";var gce=me(),{EventEmitter:nrt}=dr(),$n=ae(),{pipe:srt}=Er(),ort=gE(),{codes:Mo}=bE(),{RPC:bce}=GR(),art=sce(),{SignaturePolicy:Kc}=ace(),yl=t8(),{signMessage:crt,verifySignature:urt}=yce(),_E=class extends nrt{constructor({debugName:e,multicodecs:r,libp2p:i,globalSignaturePolicy:n=Kc.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!r)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(gce(e),{err:gce(`${e}:error`)}),this.multicodecs=yl.ensureArray(r),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!Kc[n])throw $n(new Error("Invalid global signature policy"),Mo.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new ort({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:r,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(r);this._processMessages(s,a,o)}async _onPeerConnected(e,r){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await r.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,r){let i=e.toB58String();this.log("connection ended",i,r?r.message:""),this._removePeer(e)}_addPeer(e,r){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new art({id:e,protocol:r});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let r=e.toB58String(),i=this.peers.get(r);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",r),this.peers.delete(r);for(let n of this.topics.values())n.delete(r);return i}}async _processMessages(e,r,i){try{await srt(r,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);await this._processRpc(e,i,a)}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,r,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;if(n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",r.id,n)),!this._acceptFrom(e))return this.log("received message from unacceptable peer %s",e),!1;if(s.length)for(let o of s){if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");continue}let a=yl.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}return!0}_processRpcSubOpt(e,r){let i=r.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),r.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(r){this.log("Message is invalid, dropping it. %O",r);return}return this._emitMessage(e),this._publish(yl.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(r=>{this.subscriptions.has(r)&&this.emit(r,e)})}getMsgId(e){let r=this.globalSignaturePolicy;switch(r){case Kc.StrictSign:return yl.msgId(e.from,e.seqno);case Kc.StrictNoSign:return yl.noSignMsgId(e.data);default:throw $n(new Error("Cannot get message id: unhandled signature policy: "+r),Mo.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return bce.decode(e)}_encodeRpc(e){return bce.encode(e).finish()}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(r))}_sendSubscriptions(e,r,i){return this._sendRpc(e,{subscriptions:r.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let r=this.globalSignaturePolicy;switch(r){case Kc.StrictNoSign:if(e.from)throw $n(new Error("StrictNoSigning: from should not be present"),Mo.ERR_UNEXPECTED_FROM);if(e.signature)throw $n(new Error("StrictNoSigning: signature should not be present"),Mo.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw $n(new Error("StrictNoSigning: key should not be present"),Mo.ERR_UNEXPECTED_KEY);if(e.seqno)throw $n(new Error("StrictNoSigning: seqno should not be present"),Mo.ERR_UNEXPECTED_SEQNO);break;case Kc.StrictSign:if(!e.signature)throw $n(new Error("StrictSigning: Signing required and no signature was present"),Mo.ERR_MISSING_SIGNATURE);if(!e.seqno)throw $n(new Error("StrictSigning: Signing required and no seqno was present"),Mo.ERR_MISSING_SEQNO);if(!await urt(e))throw $n(new Error("StrictSigning: Invalid message signature"),Mo.ERR_INVALID_SIGNATURE);break;default:throw $n(new Error("Cannot validate message: unhandled signature policy: "+r),Mo.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let r=this.globalSignaturePolicy;switch(r){case Kc.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=yl.randomSeqno(),crt(this.peerId,e);case Kc.StrictNoSign:return Promise.resolve(e);default:throw $n(new Error("Cannot build message: unhandled signature policy: "+r),Mo.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw $n(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw $n(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let r=this.topics.get(e);return r?Array.from(r):[]}async publish(e,r){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,r);let n={receivedFrom:this.peerId.toB58String(),data:r,topicIDs:[e]},s=await this._buildMessage(n),o=yl.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw $n(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((r,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};_E.utils=yl;_E.SignaturePolicy=Kc;mce.exports=_E});var wce=p(EE=>{f();"use strict";Object.defineProperty(EE,"__esModule",{value:!0});EE.createGossipRpc=void 0;function lrt(t=[],e={}){return{subscriptions:[],msgs:t,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}EE.createGossipRpc=lrt});var _ce=p(SE=>{f();"use strict";Object.defineProperty(SE,"__esModule",{value:!0});SE.shuffle=void 0;function frt(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let i=e(),n=t[r];t[r]=t[i],t[i]=n}return t}SE.shuffle=frt});var sd=p(Pe=>{f();"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.ERR_TOPIC_VALIDATOR_IGNORE=Pe.ERR_TOPIC_VALIDATOR_REJECT=Pe.TimeCacheDuration=Pe.GossipsubIWantFollowupTime=Pe.GossipsubMaxIHaveMessages=Pe.GossipsubMaxIHaveLength=Pe.GossipsubGraftFloodThreshold=Pe.GossipsubOpportunisticGraftPeers=Pe.GossipsubOpportunisticGraftTicks=Pe.GossipsubDirectConnectInitialDelay=Pe.GossipsubDirectConnectTicks=Pe.GossipsubConnectionTimeout=Pe.GossipsubMaxPendingConnections=Pe.GossipsubConnectors=Pe.GossipsubPruneBackoffTicks=Pe.GossipsubPruneBackoff=Pe.GossipsubPrunePeers=Pe.GossipsubFanoutTTL=Pe.GossipsubHeartbeatInterval=Pe.GossipsubHeartbeatInitialDelay=Pe.GossipsubGossipRetransmission=Pe.GossipsubGossipFactor=Pe.GossipsubDlazy=Pe.GossipsubHistoryGossip=Pe.GossipsubHistoryLength=Pe.GossipsubDout=Pe.GossipsubDscore=Pe.GossipsubDhi=Pe.GossipsubDlo=Pe.GossipsubD=Pe.GossipsubIDv11=Pe.GossipsubIDv10=Pe.FloodsubID=Pe.minute=Pe.second=void 0;Pe.second=1e3;Pe.minute=60*Pe.second;Pe.FloodsubID="/floodsub/1.0.0";Pe.GossipsubIDv10="/meshsub/1.0.0";Pe.GossipsubIDv11="/meshsub/1.1.0";Pe.GossipsubD=6;Pe.GossipsubDlo=4;Pe.GossipsubDhi=12;Pe.GossipsubDscore=4;Pe.GossipsubDout=2;Pe.GossipsubHistoryLength=5;Pe.GossipsubHistoryGossip=3;Pe.GossipsubDlazy=6;Pe.GossipsubGossipFactor=.25;Pe.GossipsubGossipRetransmission=3;Pe.GossipsubHeartbeatInitialDelay=100;Pe.GossipsubHeartbeatInterval=Pe.second;Pe.GossipsubFanoutTTL=Pe.minute;Pe.GossipsubPrunePeers=16;Pe.GossipsubPruneBackoff=Pe.minute;Pe.GossipsubPruneBackoffTicks=15;Pe.GossipsubConnectors=8;Pe.GossipsubMaxPendingConnections=128;Pe.GossipsubConnectionTimeout=30*Pe.second;Pe.GossipsubDirectConnectTicks=300;Pe.GossipsubDirectConnectInitialDelay=Pe.second;Pe.GossipsubOpportunisticGraftTicks=60;Pe.GossipsubOpportunisticGraftPeers=2;Pe.GossipsubGraftFloodThreshold=10*Pe.second;Pe.GossipsubMaxIHaveLength=5e3;Pe.GossipsubMaxIHaveMessages=10;Pe.GossipsubIWantFollowupTime=3*Pe.second;Pe.TimeCacheDuration=120*1e3;Pe.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";Pe.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"});var Sce=p(xE=>{f();"use strict";Object.defineProperty(xE,"__esModule",{value:!0});xE.hasGossipProtocol=void 0;var Ece=sd();function drt(t){return t===Ece.GossipsubIDv10||t===Ece.GossipsubIDv11}xE.hasGossipProtocol=drt});var xce=p(AE=>{f();"use strict";Object.defineProperty(AE,"__esModule",{value:!0});AE.messageIdToString=void 0;var hrt=Je();function prt(t){return hrt(t,"base64")}AE.messageIdToString=prt});var od=p($a=>{f();"use strict";var yrt=$a&&$a.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),IE=$a&&$a.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&yrt(e,t,r)};Object.defineProperty($a,"__esModule",{value:!0});IE(wce(),$a);IE(_ce(),$a);IE(Sce(),$a);IE(xce(),$a)});var Ice=p(RE=>{f();"use strict";Object.defineProperty(RE,"__esModule",{value:!0});RE.MessageCache=void 0;var TE=od(),Ace=class{constructor(e,r,i){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let n=0;n<r;n++)this.history[n]=[];this.gossip=e,this.msgIdFn=i}put(e){let r=this.getMsgId(e),i=TE.messageIdToString(r);this.msgs.set(i,e),this.history[0].push({msgID:r,topics:e.topicIDs})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(TE.messageIdToString(e))}getForPeer(e,r){let i=TE.messageIdToString(e),n=this.msgs.get(i);if(!n)return[void 0,0];let s=this.peertx.get(i);s||(s=new Map,this.peertx.set(i,s));let o=(s.get(r)||0)+1;return s.set(r,o),[n,o]}getGossipIDs(e){let r=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){r.push(n.msgID);break}});return r}shift(){this.history[this.history.length-1].forEach(r=>{let i=TE.messageIdToString(r.msgID);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};RE.MessageCache=Ace});var Rce=p((Tce,l1)=>{f();(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Wo=="function"&&typeof l1=="object"&&l1&&l1.exports&&(l1.exports=e(Ti()))})(Tce,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots.default||(t.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,u){if(u||(u=r.create()),c.subscriptions!=null&&c.subscriptions.length)for(var l=0;l<c.subscriptions.length;++l)n.RPC.SubOpts.encode(c.subscriptions[l],u.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var l=0;l<c.msgs.length;++l)n.RPC.Message.encode(c.msgs[l],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.RPC;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.subscriptions&&d.subscriptions.length||(d.subscriptions=[]),d.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:d.msgs&&d.msgs.length||(d.msgs=[]),d.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:d.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(h&7);break}}return d},s.fromObject=function(c){if(c instanceof n.RPC)return c;var u=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var l=0;l<c.subscriptions.length;++l){if(typeof c.subscriptions[l]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[l]=n.RPC.SubOpts.fromObject(c.subscriptions[l])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var l=0;l<c.msgs.length;++l){if(typeof c.msgs[l]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[l]=n.RPC.Message.fromObject(c.msgs[l])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.subscriptions=[],l.msgs=[]),c.subscriptions&&c.subscriptions.length){l.subscriptions=[];for(var d=0;d<c.subscriptions.length;++d)l.subscriptions[d]=n.RPC.SubOpts.toObject(c.subscriptions[d],u)}if(c.msgs&&c.msgs.length){l.msgs=[];for(var d=0;d<c.msgs.length;++d)l.msgs[d]=n.RPC.Message.toObject(c.msgs[d],u)}return c.control!=null&&c.hasOwnProperty("control")&&(l.control=n.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(l._control="control")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=r.create()),l.subscribe!=null&&Object.hasOwnProperty.call(l,"subscribe")&&d.uint32(8).bool(l.subscribe),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(18).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,y=new n.RPC.SubOpts;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:y.subscribe=l.bool();break;case 2:y.topicID=l.string();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.SubOpts)return l;var d=new n.RPC.SubOpts;return l.subscribe!=null&&(d.subscribe=Boolean(l.subscribe)),l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.subscribe!=null&&l.hasOwnProperty("subscribe")&&(h.subscribe=l.subscribe,d.oneofs&&(h._subscribe="subscribe")),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(this.topicIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=r.create()),l.from!=null&&Object.hasOwnProperty.call(l,"from")&&d.uint32(10).bytes(l.from),l.data!=null&&Object.hasOwnProperty.call(l,"data")&&d.uint32(18).bytes(l.data),l.seqno!=null&&Object.hasOwnProperty.call(l,"seqno")&&d.uint32(26).bytes(l.seqno),l.topicIDs!=null&&l.topicIDs.length)for(var h=0;h<l.topicIDs.length;++h)d.uint32(34).string(l.topicIDs[h]);return l.signature!=null&&Object.hasOwnProperty.call(l,"signature")&&d.uint32(42).bytes(l.signature),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&d.uint32(50).bytes(l.key),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,y=new n.RPC.Message;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:y.from=l.bytes();break;case 2:y.data=l.bytes();break;case 3:y.seqno=l.bytes();break;case 4:y.topicIDs&&y.topicIDs.length||(y.topicIDs=[]),y.topicIDs.push(l.string());break;case 5:y.signature=l.bytes();break;case 6:y.key=l.bytes();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.Message)return l;var d=new n.RPC.Message;if(l.from!=null&&(typeof l.from=="string"?i.base64.decode(l.from,d.from=i.newBuffer(i.base64.length(l.from)),0):l.from.length&&(d.from=l.from)),l.data!=null&&(typeof l.data=="string"?i.base64.decode(l.data,d.data=i.newBuffer(i.base64.length(l.data)),0):l.data.length&&(d.data=l.data)),l.seqno!=null&&(typeof l.seqno=="string"?i.base64.decode(l.seqno,d.seqno=i.newBuffer(i.base64.length(l.seqno)),0):l.seqno.length&&(d.seqno=l.seqno)),l.topicIDs){if(!Array.isArray(l.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");d.topicIDs=[];for(var h=0;h<l.topicIDs.length;++h)d.topicIDs[h]=String(l.topicIDs[h])}return l.signature!=null&&(typeof l.signature=="string"?i.base64.decode(l.signature,d.signature=i.newBuffer(i.base64.length(l.signature)),0):l.signature.length&&(d.signature=l.signature)),l.key!=null&&(typeof l.key=="string"?i.base64.decode(l.key,d.key=i.newBuffer(i.base64.length(l.key)),0):l.key.length&&(d.key=l.key)),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.topicIDs=[]),l.from!=null&&l.hasOwnProperty("from")&&(h.from=d.bytes===String?i.base64.encode(l.from,0,l.from.length):d.bytes===Array?Array.prototype.slice.call(l.from):l.from,d.oneofs&&(h._from="from")),l.data!=null&&l.hasOwnProperty("data")&&(h.data=d.bytes===String?i.base64.encode(l.data,0,l.data.length):d.bytes===Array?Array.prototype.slice.call(l.data):l.data,d.oneofs&&(h._data="data")),l.seqno!=null&&l.hasOwnProperty("seqno")&&(h.seqno=d.bytes===String?i.base64.encode(l.seqno,0,l.seqno.length):d.bytes===Array?Array.prototype.slice.call(l.seqno):l.seqno,d.oneofs&&(h._seqno="seqno")),l.topicIDs&&l.topicIDs.length){h.topicIDs=[];for(var y=0;y<l.topicIDs.length;++y)h.topicIDs[y]=l.topicIDs[y]}return l.signature!=null&&l.hasOwnProperty("signature")&&(h.signature=d.bytes===String?i.base64.encode(l.signature,0,l.signature.length):d.bytes===Array?Array.prototype.slice.call(l.signature):l.signature,d.oneofs&&(h._signature="signature")),l.key!=null&&l.hasOwnProperty("key")&&(h.key=d.bytes===String?i.base64.encode(l.key,0,l.key.length):d.bytes===Array?Array.prototype.slice.call(l.key):l.key,d.oneofs&&(h._key="key")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(u,l){if(l||(l=r.create()),u.ihave!=null&&u.ihave.length)for(var d=0;d<u.ihave.length;++d)n.RPC.ControlIHave.encode(u.ihave[d],l.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var d=0;d<u.iwant.length;++d)n.RPC.ControlIWant.encode(u.iwant[d],l.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var d=0;d<u.graft.length;++d)n.RPC.ControlGraft.encode(u.graft[d],l.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var d=0;d<u.prune.length;++d)n.RPC.ControlPrune.encode(u.prune[d],l.uint32(34).fork()).ldelim();return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlMessage;u.pos<d;){var y=u.uint32();switch(y>>>3){case 1:h.ihave&&h.ihave.length||(h.ihave=[]),h.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:h.iwant&&h.iwant.length||(h.iwant=[]),h.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:h.graft&&h.graft.length||(h.graft=[]),h.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:h.prune&&h.prune.length||(h.prune=[]),h.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(y&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var l=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");l.ihave=[];for(var d=0;d<u.ihave.length;++d){if(typeof u.ihave[d]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");l.ihave[d]=n.RPC.ControlIHave.fromObject(u.ihave[d])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");l.iwant=[];for(var d=0;d<u.iwant.length;++d){if(typeof u.iwant[d]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");l.iwant[d]=n.RPC.ControlIWant.fromObject(u.iwant[d])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");l.graft=[];for(var d=0;d<u.graft.length;++d){if(typeof u.graft[d]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");l.graft[d]=n.RPC.ControlGraft.fromObject(u.graft[d])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");l.prune=[];for(var d=0;d<u.prune.length;++d){if(typeof u.prune[d]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");l.prune[d]=n.RPC.ControlPrune.fromObject(u.prune[d])}}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.ihave=[],d.iwant=[],d.graft=[],d.prune=[]),u.ihave&&u.ihave.length){d.ihave=[];for(var h=0;h<u.ihave.length;++h)d.ihave[h]=n.RPC.ControlIHave.toObject(u.ihave[h],l)}if(u.iwant&&u.iwant.length){d.iwant=[];for(var h=0;h<u.iwant.length;++h)d.iwant[h]=n.RPC.ControlIWant.toObject(u.iwant[h],l)}if(u.graft&&u.graft.length){d.graft=[];for(var h=0;h<u.graft.length;++h)d.graft[h]=n.RPC.ControlGraft.toObject(u.graft[h],l)}if(u.prune&&u.prune.length){d.prune=[];for(var h=0;h<u.prune.length;++h)d.prune[h]=n.RPC.ControlPrune.toObject(u.prune[h],l)}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.messageIDs!=null&&l.messageIDs.length)for(var h=0;h<l.messageIDs.length;++h)d.uint32(18).bytes(l.messageIDs[h]);return d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,y=new n.RPC.ControlIHave;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:y.topicID=l.string();break;case 2:y.messageIDs&&y.messageIDs.length||(y.messageIDs=[]),y.messageIDs.push(l.bytes());break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.ControlIHave)return l;var d=new n.RPC.ControlIHave;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");d.messageIDs=[];for(var h=0;h<l.messageIDs.length;++h)typeof l.messageIDs[h]=="string"?i.base64.decode(l.messageIDs[h],d.messageIDs[h]=i.newBuffer(i.base64.length(l.messageIDs[h])),0):l.messageIDs[h].length&&(d.messageIDs[h]=l.messageIDs[h])}return d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.messageIDs=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.messageIDs&&l.messageIDs.length){h.messageIDs=[];for(var y=0;y<l.messageIDs.length;++y)h.messageIDs[y]=d.bytes===String?i.base64.encode(l.messageIDs[y],0,l.messageIDs[y].length):d.bytes===Array?Array.prototype.slice.call(l.messageIDs[y]):l.messageIDs[y]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(u,l){if(l||(l=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var d=0;d<u.messageIDs.length;++d)l.uint32(10).bytes(u.messageIDs[d]);return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlIWant;u.pos<d;){var y=u.uint32();switch(y>>>3){case 1:h.messageIDs&&h.messageIDs.length||(h.messageIDs=[]),h.messageIDs.push(u.bytes());break;default:u.skipType(y&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var l=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");l.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)typeof u.messageIDs[d]=="string"?i.base64.decode(u.messageIDs[d],l.messageIDs[d]=i.newBuffer(i.base64.length(u.messageIDs[d])),0):u.messageIDs[d].length&&(l.messageIDs[d]=u.messageIDs[d])}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.messageIDs=[]),u.messageIDs&&u.messageIDs.length){d.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)d.messageIDs[h]=l.bytes===String?i.base64.encode(u.messageIDs[h],0,u.messageIDs[h].length):l.bytes===Array?Array.prototype.slice.call(u.messageIDs[h]):u.messageIDs[h]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,y=new n.RPC.ControlGraft;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:y.topicID=l.string();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.ControlGraft)return l;var d=new n.RPC.ControlGraft;return l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.peers!=null&&l.peers.length)for(var h=0;h<l.peers.length;++h)n.RPC.PeerInfo.encode(l.peers[h],d.uint32(18).fork()).ldelim();return l.backoff!=null&&Object.hasOwnProperty.call(l,"backoff")&&d.uint32(24).uint64(l.backoff),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,y=new n.RPC.ControlPrune;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:y.topicID=l.string();break;case 2:y.peers&&y.peers.length||(y.peers=[]),y.peers.push(n.RPC.PeerInfo.decode(l,l.uint32()));break;case 3:y.backoff=l.uint64();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.ControlPrune)return l;var d=new n.RPC.ControlPrune;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.peers){if(!Array.isArray(l.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");d.peers=[];for(var h=0;h<l.peers.length;++h){if(typeof l.peers[h]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");d.peers[h]=n.RPC.PeerInfo.fromObject(l.peers[h])}}return l.backoff!=null&&(i.Long?(d.backoff=i.Long.fromValue(l.backoff)).unsigned=!0:typeof l.backoff=="string"?d.backoff=parseInt(l.backoff,10):typeof l.backoff=="number"?d.backoff=l.backoff:typeof l.backoff=="object"&&(d.backoff=new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0))),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.peers=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.peers&&l.peers.length){h.peers=[];for(var y=0;y<l.peers.length;++y)h.peers[y]=n.RPC.PeerInfo.toObject(l.peers[y],d)}return l.backoff!=null&&l.hasOwnProperty("backoff")&&(typeof l.backoff=="number"?h.backoff=d.longs===String?String(l.backoff):l.backoff:h.backoff=d.longs===String?i.Long.prototype.toString.call(l.backoff):d.longs===Number?new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0):l.backoff,d.oneofs&&(h._backoff="backoff")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=r.create()),l.peerID!=null&&Object.hasOwnProperty.call(l,"peerID")&&d.uint32(10).bytes(l.peerID),l.signedPeerRecord!=null&&Object.hasOwnProperty.call(l,"signedPeerRecord")&&d.uint32(18).bytes(l.signedPeerRecord),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,y=new n.RPC.PeerInfo;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:y.peerID=l.bytes();break;case 2:y.signedPeerRecord=l.bytes();break;default:l.skipType(g&7);break}}return y},a.fromObject=function(l){if(l instanceof n.RPC.PeerInfo)return l;var d=new n.RPC.PeerInfo;return l.peerID!=null&&(typeof l.peerID=="string"?i.base64.decode(l.peerID,d.peerID=i.newBuffer(i.base64.length(l.peerID)),0):l.peerID.length&&(d.peerID=l.peerID)),l.signedPeerRecord!=null&&(typeof l.signedPeerRecord=="string"?i.base64.decode(l.signedPeerRecord,d.signedPeerRecord=i.newBuffer(i.base64.length(l.signedPeerRecord)),0):l.signedPeerRecord.length&&(d.signedPeerRecord=l.signedPeerRecord)),d},a.toObject=function(l,d){d||(d={});var h={};return l.peerID!=null&&l.hasOwnProperty("peerID")&&(h.peerID=d.bytes===String?i.base64.encode(l.peerID,0,l.peerID.length):d.bytes===Array?Array.prototype.slice.call(l.peerID):l.peerID,d.oneofs&&(h._peerID="peerID")),l.signedPeerRecord!=null&&l.hasOwnProperty("signedPeerRecord")&&(h.signedPeerRecord=d.bytes===String?i.base64.encode(l.signedPeerRecord,0,l.signedPeerRecord.length):d.bytes===Array?Array.prototype.slice.call(l.signedPeerRecord):l.signedPeerRecord,d.oneofs&&(h._signedPeerRecord="signedPeerRecord")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s}(),n})});var n8=p(PE=>{f();"use strict";Object.defineProperty(PE,"__esModule",{value:!0});PE.getGossipPeers=void 0;var Pce=od();function grt(t,e,r,i=()=>!0){let n=t.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=t.peers.get(o);!a||Pce.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=Pce.shuffle(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}PE.getGossipPeers=grt});var Oce=p(Ga=>{f();"use strict";var brt=Ga&&Ga.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),mrt=Ga&&Ga.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vrt=Ga&&Ga.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&brt(e,t,r);return mrt(e,t),e};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.Heartbeat=void 0;var f1=vrt(sd()),CE=n8(),wrt=od(),Cce=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),r=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,f1.GossipsubHeartbeatInterval)},f1.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(r),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:r,Dhi:i,Dscore:n,Dout:s}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let o=new Map,a=h=>{let y=o.get(h);return y===void 0&&(y=this.gossipsub.score.score(h),o.set(h,y)),y},c=new Map,u=new Map,l=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((h,y)=>{let g=E=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",E,y),this.gossipsub.score.prune(E,y),this.gossipsub._addBackoff(E,y),h.delete(E);let v=u.get(E);v?v.push(y):u.set(E,[y])},m=E=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",E,y),this.gossipsub.score.graft(E,y),h.add(E);let v=c.get(E);v?v.push(y):c.set(E,[y])};if(h.forEach(E=>{let v=a(E);v<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",E,v,y),g(E),l.set(E,!0))}),h.size<r){let E=this.gossipsub.backoff.get(y),v=e-h.size;CE.getGossipPeers(this.gossipsub,y,v,R=>!h.has(R)&&!this.gossipsub.direct.has(R)&&(!E||!E.has(R))&&a(R)>=0).forEach(m)}if(h.size>i){let E=Array.from(h);E.sort((A,R)=>a(R)-a(A)),E=E.slice(0,n).concat(wrt.shuffle(E.slice(n)));let v=0;if(E.slice(0,e).forEach(A=>{this.gossipsub.outbound.get(A)&&v++}),v<s){let A=F=>{let q=E[F];for(let N=F;N>0;N--)E[N]=E[N-1];E[0]=q};if(v>0){let F=v;for(let q=1;q<e&&F>0;q++)this.gossipsub.outbound.get(E[q])&&(A(q),F--)}let R=e-v;for(let F=e;F<E.length&&R>0;F++)this.gossipsub.outbound.get(E[F])&&(A(F),R--)}E.slice(e).forEach(g)}if(h.size>=r){let E=0;if(h.forEach(v=>{this.gossipsub.outbound.get(v)&&E++}),E<s){let v=s-E,A=this.gossipsub.backoff.get(y);CE.getGossipPeers(this.gossipsub,y,v,R=>!h.has(R)&&!this.gossipsub.direct.has(R)&&(!A||!A.has(R))&&a(R)>=0).forEach(m)}}if(this.gossipsub.heartbeatTicks%f1.GossipsubOpportunisticGraftTicks==0&&h.size>1){let E=Array.from(h).sort((R,F)=>a(R)-a(F)),v=h.size/2,A=a(E[v]);if(A<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let R=this.gossipsub.backoff.get(y);CE.getGossipPeers(this.gossipsub,y,f1.GossipsubOpportunisticGraftPeers,q=>h.has(q)&&!this.gossipsub.direct.has(q)&&(!R||!R.has(q))&&a(q)>A).forEach(q=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",q,y),m(q)})}}this.gossipsub._emitGossip(y,h)});let d=this.gossipsub._now();this.gossipsub.lastpub.forEach((h,y)=>{h+f1.GossipsubFanoutTTL<d&&(this.gossipsub.fanout.delete(y),this.gossipsub.lastpub.delete(y))}),this.gossipsub.fanout.forEach((h,y)=>{let g=this.gossipsub.topics.get(y);if(h.forEach(m=>{(!g.has(m)||a(m)<this.gossipsub._options.scoreThresholds.publishThreshold)&&h.delete(m)}),h.size<e){let m=e-h.size;CE.getGossipPeers(this.gossipsub,y,m,v=>!h.has(v)&&!this.gossipsub.direct.has(v)&&a(v)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(v=>{h.add(v)})}this.gossipsub._emitGossip(y,h)}),this.gossipsub._sendGraftPrune(c,u,l),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};Ga.Heartbeat=Cce});var s8=p(t0=>{f();"use strict";Object.defineProperty(t0,"__esModule",{value:!0});t0.ERR_INVALID_PEER_SCORE_THRESHOLDS=t0.ERR_INVALID_PEER_SCORE_PARAMS=void 0;t0.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";t0.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var o8=p(dn=>{f();"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.validateTopicScoreParams=dn.validatePeerScoreParams=dn.createTopicScoreParams=dn.createPeerScoreParams=dn.defaultTopicScoreParams=dn.defaultPeerScoreParams=void 0;var Zt=s8(),Jt=ae();dn.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};dn.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function _rt(t={}){return Object.assign(Object.assign(Object.assign({},dn.defaultPeerScoreParams),t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=kce(i),e),{}):{}})}dn.createPeerScoreParams=_rt;function kce(t={}){return Object.assign(Object.assign({},dn.defaultTopicScoreParams),t)}dn.createTopicScoreParams=kce;function Ert(t){for(let[e,r]of Object.entries(t.topics))try{qce(r)}catch(i){throw Jt(new Error(`invalid score parameters for topic ${e}: ${i.message}`),Zt.ERR_INVALID_PEER_SCORE_PARAMS)}if(t.topicScoreCap<0)throw Jt(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw Jt(new Error("missing application specific score function"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight>0)throw Jt(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw Jt(new Error("invalid IPColocationFactorThreshold; must be at least 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight>0)throw Jt(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw Jt(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayInterval<1e3)throw Jt(new Error("invalid DecayInterval; must be at least 1s"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayToZero<=0||t.decayToZero>=1)throw Jt(new Error("invalid DecayToZero; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS)}dn.validatePeerScoreParams=Ert;function qce(t){if(t.topicWeight<0)throw Jt(new Error("invalid topic weight; must be >= 0"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshQuantum===0)throw Jt(new Error("invalid TimeInMeshQuantum; must be non zero"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight<0)throw Jt(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw Jt(new Error("invalid TimeInMeshQuantum; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw Jt(new Error("invalid TimeInMeshCap; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight<0)throw Jt(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw Jt(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw Jt(new Error("invalid FirstMessageDeliveriesCap; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight>0)throw Jt(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw Jt(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw Jt(new Error("invalid MeshMessageDeliveriesCap; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw Jt(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWindow<0)throw Jt(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw Jt(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight>0)throw Jt(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw Jt(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesWeight>0)throw Jt(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),Zt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw Jt(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),Zt.ERR_INVALID_PEER_SCORE_PARAMS)}dn.validateTopicScoreParams=qce});var Nce=p(jc=>{f();"use strict";Object.defineProperty(jc,"__esModule",{value:!0});jc.validatePeerScoreThresholds=jc.createPeerScoreThresholds=jc.defaultPeerScoreThresholds=void 0;var d1=s8(),h1=ae();jc.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function Srt(t={}){return Object.assign(Object.assign({},jc.defaultPeerScoreThresholds),t)}jc.createPeerScoreThresholds=Srt;function xrt(t){if(t.gossipThreshold>0)throw h1(new Error("invalid gossip threshold; it must be <= 0"),d1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.publishThreshold>0||t.publishThreshold>t.gossipThreshold)throw h1(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),d1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.graylistThreshold>0||t.graylistThreshold>t.publishThreshold)throw h1(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),d1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.acceptPXThreshold<0)throw h1(new Error("invalid accept PX threshold; it must be >= 0"),d1.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.opportunisticGraftThreshold<0)throw h1(new Error("invalid opportunistic grafting threshold; it must be >= 0"),d1.ERR_INVALID_PEER_SCORE_THRESHOLDS)}jc.validatePeerScoreThresholds=xrt});var Dce=p(gl=>{f();"use strict";Object.defineProperty(gl,"__esModule",{value:!0});gl.ensureTopicStats=gl.createTopicStats=gl.createPeerStats=void 0;function Art(t={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=a8(i),e),{}):{}})}gl.createPeerStats=Art;function a8(t={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},t)}gl.createTopicStats=a8;function Irt(t,e,r){let i=e.topics[t];if(i)return i;if(!!r.topics[t])return e.topics[t]=i=a8(),i}gl.ensureTopicStats=Irt});var Bce=p(OE=>{f();"use strict";Object.defineProperty(OE,"__esModule",{value:!0});OE.computeScore=void 0;function Trt(t,e,r,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let u=r.topics[a];if(!u)return;let l=0;if(c.inMesh){let g=c.meshTime/u.timeInMeshQuantum;g>u.timeInMeshCap&&(g=u.timeInMeshCap),l+=g*u.timeInMeshWeight}if(l+=c.firstMessageDeliveries*u.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let g=u.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;l+=g*g*u.meshMessageDeliveriesWeight}l+=c.meshFailurePenalty*u.meshFailurePenaltyWeight,l+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,n+=l*u.topicWeight}),r.topicScoreCap>0&&n>r.topicScoreCap&&(n=r.topicScoreCap),n+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(a=>{if(r.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),u=c?c.size:0;if(u>r.IPColocationFactorThreshold){let l=u-r.IPColocationFactorThreshold;n+=l*l*r.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,n}OE.computeScore=Trt});var Lce=p((nqt,Mce)=>{f();"use strict";function jr(t,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}jr.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var i=this.size();if(!(r>=i||r<-i))return r<0&&(r+=i),r=this._head+r&this._capacityMask,this._list[r]}};jr.prototype.get=function(e){return this.peekAt(e)};jr.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};jr.prototype.peekFront=function(){return this.peek()};jr.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(jr.prototype,"length",{get:function(){return this.size()}});jr.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};jr.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};jr.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};jr.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};jr.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),i}};jr.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(r>=i||r<-i)){r<0&&(r+=i),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<i/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};jr.prototype.remove=function(e,r){var i=e,n,s=r;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||r<1)){if(i<0&&(i+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+r>=o)return n=this.toArray(),this.clear(),n;i+r>o&&(r=o-i);var c;for(n=new Array(r),c=0;c<r;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,c=r;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+a&this._capacityMask,c=r-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+r+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+r+a&this._capacityMask,c=o-(r+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};jr.prototype.splice=function(e,r){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,l=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(a=this.remove(i,r),this._head=this._head+i+u&this._capacityMask);c>l;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+r));var d=o.length;for(s=0;s<d;s++)o[s]=this._list[this._head+i+r+s&this._capacityMask];for(r===0?(a=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(a=this.remove(i,r),this._tail=this._tail-d+u&this._capacityMask);l<c;)this.push(arguments[l++]);for(s=0;s<d;s++)this.push(o[s])}return a}else return this.remove(i,r)}};jr.prototype.clear=function(){this._head=0,this._tail=0};jr.prototype.isEmpty=function(){return this._head===this._tail};jr.prototype.toArray=function(){return this._copyArray(!1)};jr.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};jr.prototype._copyArray=function(e){var r=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)r.push(i[s]);for(s=0;s<this._tail;s++)r.push(i[s])}else for(s=this._head;s<this._tail;s++)r.push(i[s]);return r};jr.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1};jr.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Mce.exports=jr});var Kce=p(Vc=>{f();"use strict";var Rrt=Vc&&Vc.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Vc,"__esModule",{value:!0});Vc.MessageDeliveries=Vc.DeliveryRecordStatus=void 0;var Prt=sd(),Crt=Rrt(Lce()),Ort=od(),Uce;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(Uce=Vc.DeliveryRecordStatus||(Vc.DeliveryRecordStatus={}));var Fce=class{constructor(){this.records=new Map,this.queue=new Crt.default}ensureRecord(e){let r=Ort.messageIdToString(e),i=this.records.get(r);if(i)return i;i={status:Uce.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(r,i);let n={msgId:r,expire:Date.now()+Prt.TimeCacheDuration};return this.queue.push(n),i}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};Vc.MessageDeliveries=Fce});var Vce=p(n0=>{f();"use strict";var krt=n0&&n0.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n0,"__esModule",{value:!0});n0.PeerScore=void 0;var qrt=o8(),r0=Dce(),Nrt=Bce(),Lo=Kce(),Drt=sd(),Brt=krt(et()),Mrt=me(),Lrt=bE(),{ERR_INVALID_SIGNATURE:Urt,ERR_MISSING_SIGNATURE:Frt}=Lrt.codes,i0=Mrt("libp2p:gossipsub:score"),jce=class{constructor(e,r,i){qrt.validatePeerScoreParams(e),this.params=e,this._connectionManager=r,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new Lo.MessageDeliveries,this.msgId=i}start(){if(this._backgroundInterval){i0("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),i0("started")}stop(){if(!this._backgroundInterval){i0("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),i0("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<r&&(i.behaviourPenalty=0)})}score(e){let r=this.peerStats.get(e);return r?Nrt.computeScore(e,r,this.params,this.peerIPs):0}addPenalty(e,r){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=r)}addPeer(e){let r=r0.createPeerStats({connected:!0});this.peerStats.set(e,r);let i=this._getIPs(e);this._setIPs(e,i,r.ips),r.ips=i}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this._removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let i=this.peerStats.get(e);if(!i)return;let n=r0.ensureTopicStats(r,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}prune(e,r){let i=this.peerStats.get(e);if(!i)return;let n=r0.ensureTopicStats(r,i,this.params);if(!n)return;let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}validateMessage(e){this.deliveryRecords.ensureRecord(this.msgId(e))}deliverMessage(e){let r=e.receivedFrom;this._markFirstMessageDelivery(r,e);let i=this.deliveryRecords.ensureRecord(this.msgId(e)),n=Date.now();if(i.status!==Lo.DeliveryRecordStatus.unknown){i0("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",r,n-i.firstSeen,Lo.DeliveryRecordStatus[i.status]);return}i.status=Lo.DeliveryRecordStatus.valid,i.validated=n,i.peers.forEach(s=>{s!==r&&this._markDuplicateMessageDelivery(s,e)})}rejectMessage(e,r){let i=e.receivedFrom;switch(r){case Frt:case Urt:this._markInvalidMessageDelivery(i,e);return}let n=this.deliveryRecords.ensureRecord(this.msgId(e));if(n.status!==Lo.DeliveryRecordStatus.unknown){i0("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",i,Date.now()-n.firstSeen,Lo.DeliveryRecordStatus[n.status]);return}switch(r){case Drt.ERR_TOPIC_VALIDATOR_IGNORE:n.status=Lo.DeliveryRecordStatus.ignored;return}n.status=Lo.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(i,e),n.peers.forEach(s=>{this._markInvalidMessageDelivery(s,e)})}duplicateMessage(e){let r=e.receivedFrom,i=this.deliveryRecords.ensureRecord(this.msgId(e));if(!i.peers.has(r))switch(i.status){case Lo.DeliveryRecordStatus.unknown:i.peers.add(r);break;case Lo.DeliveryRecordStatus.valid:i.peers.add(r),this._markDuplicateMessageDelivery(r,e,i.validated);break;case Lo.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(r,e);break}}_markInvalidMessageDelivery(e,r){let i=this.peerStats.get(e);!i||r.topicIDs.forEach(n=>{let s=r0.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,r){let i=this.peerStats.get(e);!i||r.topicIDs.forEach(n=>{let s=r0.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))})}_markDuplicateMessageDelivery(e,r,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;r.topicIDs.forEach(o=>{let a=r0.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let u=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>u&&(a.meshMessageDeliveries=u)})}_getIPs(e){return this._connectionManager.getAll(Brt.default.createFromB58String(e)).map(r=>r.remoteAddr.toOptions().host)}_setIPs(e,r,i){e:for(let n of r){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of r)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}}_removeIPs(e,r){r.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))})}_updateIPs(){this.peerStats.forEach((e,r)=>{let i=this._getIPs(r);this._setIPs(r,i,e.ips),e.ips=i})}};n0.PeerScore=jce});var zce=p(zc=>{f();"use strict";var Krt=zc&&zc.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),c8=zc&&zc.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Krt(e,t,r)};Object.defineProperty(zc,"__esModule",{value:!0});c8(o8(),zc);c8(Nce(),zc);c8(Vce(),zc)});var $ce=p(kE=>{f();"use strict";Object.defineProperty(kE,"__esModule",{value:!0});kE.IWantTracer=void 0;var jrt=sd(),u8=od(),Vrt=bE(),{ERR_INVALID_SIGNATURE:zrt,ERR_MISSING_SIGNATURE:Hrt}=Vrt.codes,Hce=class{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,r){let i=Math.floor(Math.random()*r.length),n=r[i],s=u8.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+jrt.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),r=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(r.set(o,(r.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),r}deliverMessage(e){let r=this.getMsgId(e),i=u8.messageIdToString(r);this.promises.delete(i)}rejectMessage(e,r){switch(r){case zrt:case Hrt:return}let i=this.getMsgId(e),n=u8.messageIdToString(i);this.promises.delete(n)}clear(){this.promises.clear()}};kE.IWantTracer=Hce});var Qce=p((uqt,Xce)=>{f();var Gce="Expected a function",Wce=0/0,$rt="[object Symbol]",Grt=/^\s+|\s+$/g,Wrt=/^[-+]0x[0-9a-f]+$/i,Yrt=/^0b[01]+$/i,Xrt=/^0o[0-7]+$/i,Qrt=parseInt,Zrt=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Jrt=typeof self=="object"&&self&&self.Object===Object&&self,eit=Zrt||Jrt||Function("return this")(),tit=Object.prototype,rit=tit.toString,iit=Math.max,nit=Math.min,l8=function(){return eit.Date.now()};function sit(t,e,r){var i,n,s,o,a,c,u=0,l=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(Gce);e=Yce(e)||0,qE(r)&&(l=!!r.leading,d="maxWait"in r,s=d?iit(Yce(r.maxWait)||0,e):s,h="trailing"in r?!!r.trailing:h);function y(N){var z=i,G=n;return i=n=void 0,u=N,o=t.apply(G,z),o}function g(N){return u=N,a=setTimeout(v,e),l?y(N):o}function m(N){var z=N-c,G=N-u,Y=e-z;return d?nit(Y,s-G):Y}function E(N){var z=N-c,G=N-u;return c===void 0||z>=e||z<0||d&&G>=s}function v(){var N=l8();if(E(N))return A(N);a=setTimeout(v,m(N))}function A(N){return a=void 0,h&&i?y(N):(i=n=void 0,o)}function R(){a!==void 0&&clearTimeout(a),u=0,i=c=n=a=void 0}function F(){return a===void 0?o:A(l8())}function q(){var N=l8(),z=E(N);if(i=arguments,n=this,c=N,z){if(a===void 0)return g(c);if(d)return a=setTimeout(v,e),y(c)}return a===void 0&&(a=setTimeout(v,e)),o}return q.cancel=R,q.flush=F,q}function oit(t,e,r){var i=!0,n=!0;if(typeof t!="function")throw new TypeError(Gce);return qE(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),sit(t,e,{leading:i,maxWait:e,trailing:n})}function qE(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function ait(t){return!!t&&typeof t=="object"}function cit(t){return typeof t=="symbol"||ait(t)&&rit.call(t)==$rt}function Yce(t){if(typeof t=="number")return t;if(cit(t))return Wce;if(qE(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=qE(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(Grt,"");var r=Yrt.test(t);return r||Xrt.test(t)?Qrt(t.slice(2),r?2:8):Wrt.test(t)?Wce:+t}Xce.exports=oit});var eue=p((Zce,Jce)=>{f();"use strict";var uit=Qce();Zce=Jce.exports=f8;function f8(t){if(!(this instanceof f8))return new f8(t);t=t||{};let e=t.validity||30,r=new Map,i=uit(()=>{r.forEach((n,s)=>{let o=n.validity||e;lit(n.timestamp)>o&&r.delete(s)})},200);this.put=(n,s,o)=>{this.has(n)||r.set(n,{value:s,timestamp:new Date,validity:o}),i()},this.get=n=>{if(r.has(n))return r.get(n).value;throw new Error("key does not exist")},this.has=n=>r.has(n)}function lit(t){let r=new Date().getTime()-t.getTime();return Math.floor(r/1e3)}});var li=p(d8=>{f();"use strict";d8.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"};d8.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var iue=p((fqt,rue)=>{f();"use strict";var s0=Ti(),tue=s0.Reader,fit=s0.Writer,mr=s0.util,p1=s0.roots["libp2p-envelope"]||(s0.roots["libp2p-envelope"]={});p1.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.publicKey=mr.newBuffer([]),t.prototype.payloadType=mr.newBuffer([]),t.prototype.payload=mr.newBuffer([]),t.prototype.signature=mr.newBuffer([]),t.encode=function(r,i){return i||(i=fit.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&i.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&i.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(42).bytes(r.signature),i},t.decode=function(r,i){r instanceof tue||(r=tue.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new p1.Envelope;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof p1.Envelope)return r;var i=new p1.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?mr.base64.decode(r.publicKey,i.publicKey=mr.newBuffer(mr.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?mr.base64.decode(r.payloadType,i.payloadType=mr.newBuffer(mr.base64.length(r.payloadType)),0):r.payloadType.length&&(i.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?mr.base64.decode(r.payload,i.payload=mr.newBuffer(mr.base64.length(r.payload)),0):r.payload.length&&(i.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?mr.base64.decode(r.signature,i.signature=mr.newBuffer(mr.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=mr.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=mr.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=mr.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=mr.newBuffer(n.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?mr.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?mr.base64.encode(r.payloadType,0,r.payloadType.length):i.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(n.payload=i.bytes===String?mr.base64.encode(r.payload,0,r.payload.length):i.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?mr.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s0.util.toJSONOptions)},t}();rue.exports=p1});var y1=p((dqt,oue)=>{f();"use strict";var dit=ae(),hit=tn(),pit=ct(),yit=Xv(),git=et(),h8=es(),NE=ci(),{codes:bit}=li(),{Envelope:nue}=iue(),bl=class{constructor({peerId:e,payloadType:r,payload:i,signature:n}){this.peerId=e,this.payloadType=r,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=yit.marshalPublicKey(this.peerId.pubKey);return this._marshal=nue.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return NE(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&NE(this.payloadType,e.payloadType)&&NE(this.payload,e.payload)&&NE(this.signature,e.signature)}validate(e){let r=sue(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},sue=(t,e,r)=>{let i=pit(t),n=h8.encode(i.byteLength),s=h8.encode(e.length),o=h8.encode(r.length);return hit([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),r])};bl.createFromProtobuf=async t=>{let e=nue.decode(t),r=await git.createFromPubKey(e.publicKey);return new bl({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};bl.seal=async(t,e)=>{let r=t.domain,i=t.codec,n=t.marshal(),s=sue(r,i,n),o=await e.privKey.sign(s);return new bl({peerId:e,payloadType:i,payload:n,signature:o})};bl.openAndCertify=async(t,e)=>{let r=await bl.createFromProtobuf(t);if(!await r.validate(e))throw dit(new Error("envelope signature is not valid for the given domain"),bit.ERR_SIGNATURE_NOT_VALID);return r};oue.exports=bl});var v8=p((Hc,cue)=>{f();"use strict";var mit=Hc&&Hc.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),vit=Hc&&Hc.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),aue=Hc&&Hc.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&mit(e,t,r);return vit(e,t),e},o0=Hc&&Hc.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(t,e||[])).next())})},p8=aue(vce()),wit=Ice(),y8=Rce(),qt=aue(sd()),_it=Oce(),DE=n8(),Li=od(),g8=zce(),Eit=$ce(),Sit=eue(),b8=et(),xit=y1(),m8=class extends p8.default{constructor(e,r={}){let i=[qt.GossipsubIDv11,qt.GossipsubIDv10],n=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:qt.GossipsubD,Dlo:qt.GossipsubDlo,Dhi:qt.GossipsubDhi,Dscore:qt.GossipsubDscore,Dout:qt.GossipsubDout,Dlazy:qt.GossipsubDlazy},r),{scoreParams:g8.createPeerScoreParams(r.scoreParams),scoreThresholds:g8.createPeerScoreThresholds(r.scoreThresholds)});n.fallbackToFloodsub&&i.push(qt.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:i,libp2p:e},n));this._options=n,this.direct=new Set(n.directPeers.map(s=>s.id.toB58String())),n.directPeers.forEach(s=>{e.peerStore.addressBook.add(s.id,s.addrs)}),this.seenCache=new Sit,this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=r.messageCache||new wit.MessageCache(qt.GossipsubHistoryGossip,qt.GossipsubHistoryLength,this.getMsgId.bind(this)),this.heartbeat=new _it.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new Eit.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new g8.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return y8.RPC.decode(e)}_encodeRpc(e){return y8.RPC.encode(e).finish()}_addPeer(e,r){let i=super._addPeer(e,r);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>r===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let r=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),r}_processRpc(e,r,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return o0(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,r,i))?(i.control&&this._processRpcControlMessage(e,i.control),!0):!1})}_processRpcControlMessage(e,r){if(!r)return;let i=r.ihave?this._handleIHave(e,r.ihave):[],n=r.iwant?this._handleIWant(e,r.iwant):[],s=r.graft?this._handleGraft(e,r.graft):[];if(r.prune&&this._handlePrune(e,r.prune),!i.length&&!n.length&&!s.length)return;let o=Li.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)}_processRpcMessage(e){let r=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return o0(this,void 0,void 0,function*(){let i=yield this.getMsgId(e),n=Li.messageIdToString(i);if(this.seenCache.has(n)){this.score.duplicateMessage(e);return}this.seenCache.put(n),this.score.validateMessage(e),yield r._processRpcMessage.call(this,e)})}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){let r=Object.create(null,{validate:{get:()=>super.validate}});return o0(this,void 0,void 0,function*(){try{yield r.validate.call(this,e)}catch(i){throw this.score.rejectMessage(e,i.code),this.gossipTracer.rejectMessage(e,i.code),i}})}_handleIHave(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>qt.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=qt.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:l})=>{!u||!l||!this.mesh.has(u)||l.forEach(d=>{let h=Li.messageIdToString(d);this.seenCache.has(h)||o.set(h,d)})}),!o.size)return[];let a=o.size;a+s>qt.GossipsubMaxIHaveLength&&(a=qt.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Li.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return r.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let[a,c]=this.messageCache.getForPeer(o,e);if(!!a){if(c>qt.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(Li.messageIdToString(o),a)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(p8.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,r){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return r.forEach(({topicID:a})=>{var c;if(!a)return;let u=this.mesh.get(a);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let l=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof l=="number"&&s<l){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let d=l+qt.GossipsubGraftFloodThreshold-qt.GossipsubPruneBackoff;s<d&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),u.add(e)}),i.length?i.map(a=>this._makePrune(e,a,o)):[]}_handlePrune(e,r){let i=this.score.score(e);r.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,r){this._doAddBackoff(e,r,qt.GossipsubPruneBackoff)}_doAddBackoff(e,r,i){let n=this.backoff.get(r);n||(n=new Map,this.backoff.set(r,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e)})}_clearBackoff(){if(this.heartbeatTicks%qt.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((r,i)=>{r.forEach((n,s)=>{n<e&&r.delete(s)}),r.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%qt.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(r=>{let i=this.peers.get(r);(!i||!i.isWritable)&&e.push(r)}),e.length&&e.forEach(r=>{this._connect(r)})}_pxConnect(e){return o0(this,void 0,void 0,function*(){e.length>qt.GossipsubPrunePeers&&(Li.shuffle(e),e=e.slice(0,qt.GossipsubPrunePeers));let r=[];yield Promise.all(e.map(i=>o0(this,void 0,void 0,function*(){if(!i.peerID)return;let s=b8.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){r.push(s);return}try{let o=yield xit.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!r.length&&r.forEach(i=>this._connect(i))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},qt.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(b8.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let r=this.fanout.get(e);if(r)r.forEach(i=>{this.score.score(i)<0&&r.delete(i)}),r.size<this._options.D&&DE.getGossipPeers(this,e,this._options.D-r.size,i=>!r.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>r.add(i)),this.mesh.set(e,r),this.fanout.delete(e),this.lastpub.delete(e);else{let i=DE.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let r=this.mesh.get(e);r&&(r.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}_publish(e){return o0(this,void 0,void 0,function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));let r=yield this.getMsgId(e),i=Li.messageIdToString(r);this.seenCache.put(i),this.messageCache.put(e);let n=new Set;e.topicIDs.forEach(o=>{let a=this.topics.get(o);if(!!a)if(this._options.floodPublish&&e.from===this.peerId.toB58String())a.forEach(c=>{(this.direct.has(c)||this.score.score(c)>=this._options.scoreThresholds.publishThreshold)&&n.add(c)});else{this.direct.forEach(u=>{n.add(u)}),a.forEach(u=>{let l=this.score.score(u),d=this.peers.get(u);!d||d.protocol===qt.FloodsubID&&l>=this._options.scoreThresholds.publishThreshold&&n.add(u)});let c=this.mesh.get(o);if(!c||!c.size){if(c=this.fanout.get(o),!c){let u=DE.getGossipPeers(this,o,this._options.D,l=>this.score.score(l)>=this._options.scoreThresholds.publishThreshold);u.size>0?(c=u,this.fanout.set(o,u)):c=new Set}this.lastpub.set(o,this._now())}c.forEach(u=>{n.add(u)})}});let s=Li.createGossipRpc([p8.utils.normalizeOutRpcMessage(e)]);n.forEach(o=>{o!==e.from&&this._sendRpc(o,s)})})}_sendGraft(e,r){let i=[{topicID:r}],n=Li.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,r){let i=[this._makePrune(e,r,this._options.doPX)],n=Li.createGossipRpc([],{prune:i});this._sendRpc(e,n)}_sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,r,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,r,s),this.gossip.delete(e)),i.write(y8.RPC.encode(r).finish())}_piggybackControl(e,r,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(n),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,r,i){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=i}_sendGraftPrune(e,r,i){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(d=>({topicID:d})),c=[],u=r.get(s);u&&(c=u.map(d=>this._makePrune(s,d,n&&!i.get(s))),r.delete(s));let l=Li.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,l)}for(let[s,o]of r){let a=o.map(u=>this._makePrune(s,u,n&&!i.get(s))),c=Li.createGossipRpc([],{prune:a});this._sendRpc(s,c)}}_emitGossip(e,r){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;Li.shuffle(i),i.length>qt.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!r.has(c)&&!this.direct.has(c)&&Li.hasGossipProtocol(u.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=qt.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:Li.shuffle(n),n.slice(0,o).forEach(c=>{let u=i;i.length>qt.GossipsubMaxIHaveLength&&(u=Li.shuffle(u.slice()).slice(0,qt.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:u})})}_flush(){for(let[e,r]of this.gossip.entries()){this.gossip.delete(e);let i=Li.createGossipRpc([],{ihave:r});this._sendRpc(e,i)}for(let[e,r]of this.control.entries()){this.control.delete(e);let i=Li.createGossipRpc([],{graft:r.graft,prune:r.prune});this._sendRpc(e,i)}}_pushGossip(e,r){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(r))}_now(){return Date.now()}_makePrune(e,r,i){if(this.peers.get(e).protocol===qt.GossipsubIDv10)return{topicID:r,peers:[]};let n=qt.GossipsubPruneBackoff/1e3,s=[];return i&&DE.getGossipPeers(this,r,qt.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0).forEach(a=>{let c=b8.createFromB58String(a);s.push({peerID:c.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(c)})}),{topicID:r,peers:s,backoff:n}}};m8.multicodec=qt.GossipsubIDv11;cue.exports=m8});var lue=p((hqt,uue)=>{f();"use strict";uue.exports={gossipsub:v8()}});var gue=p((pqt,yue)=>{f();"use strict";var w8=et(),{base58btc:Ait}=(Zr(),Qr),{default:Iit}=Pc(),fue=Hu(),due=me(),ml=due("libp2p-delegated-peer-routing");ml.error=due("libp2p-delegated-peer-routing:error");var hue=3e4,Tit=4,pue=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new Iit({concurrency:Tit});let{protocol:r,host:i,port:n}=e.getEndpointConfig();ml(`enabled DelegatedPeerRouting via ${r}://${i}:${n}`)}async findPeer(e,r={}){let i=e;w8.isPeerId(i)&&(i=e.toB58String()),ml("findPeer starts: "+e),r.timeout=r.timeout||hue;try{return await this._httpQueue.add(async()=>{let{addrs:n}=await this._client.dht.findPeer(i,{timeout:r.timeout});return{id:e,multiaddrs:n}})}catch(n){if(n.message.includes("not found"))return;throw n}finally{ml("findPeer finished: "+e)}}async*getClosestPeers(e,r={}){let i=Ait.encode(e).substring(1);ml("getClosestPeers starts:",i),r.timeout=r.timeout||hue;let n=fue(),s=fue();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;let o=new Map;for await(let a of this._client.dht.query(i,{timeout:r.timeout}))switch(a.type){case 1:a.responses.forEach(c=>{o.set(c.id,{id:w8.parse(c.id),multiaddrs:c.addrs})});break;case 2:yield o.get(a.id.string)||{id:w8.createFromCID(a.id),multiaddrs:[]};break;default:ml("getClosestPeers unhandled response",a)}}catch(o){throw ml.error("getClosestPeers errored:",o),o}finally{s.resolve(),ml("getClosestPeers finished:",i)}}};yue.exports=pue});var Eue=p((yqt,_ue)=>{f();"use strict";var bue=me(),Rit=et(),Pit=Ra(),{default:mue}=Pc(),vue=Hu(),ad=bue("libp2p-delegated-content-routing");ad.error=bue("libp2p-delegated-content-routing:error");var Cit=3e4,Oit=4,wue=class{constructor(e,r){if(e==null)throw new Error("missing self peerId");if(r==null)throw new Error("missing ipfs http client");this._client=r,this.peerId=e;let i={concurrency:Oit};this._httpQueue=new mue(i),this._httpQueueRefs=new mue(Object.assign({},i,{concurrency:2}));let{protocol:n,host:s,port:o}=r.getEndpointConfig();ad(`enabled DelegatedContentRouting via ${n}://${s}:${o}`)}async*findProviders(e,r={}){ad(`findProviders starts: ${e}`),r.timeout=r.timeout||Cit;let i=0,n=vue(),s=vue();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:r.numProviders,timeout:r.timeout}))yield{id:Rit.parse(o),multiaddrs:a},i++}catch(o){throw ad.error("findProviders errored:",o),o}finally{s.resolve(),ad(`findProviders finished: ${e} found ${i} providers`)}}async provide(e){ad(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await Pit(this._client.dht.provide(e))}),ad(`provide finished: ${e}`)}};_ue.exports=wue});var _8=p((gqt,xue)=>{f();"use strict";var kit=t=>Promise.reject(new Error(`No codec found for "${t}"`)),Sue=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||kit;for(let r of e.codecs)this.addCodec(r)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let r=typeof e=="string"?this._codecsByName:this._codecsByCode;if(r[e])return r[e];let i=await this._loadCodec(e);return r[e]==null&&this.addCodec(i),i}listCodecs(){return Object.values(this._codecsByName)}};xue.exports=Sue});var E8=p((bqt,Iue)=>{f();"use strict";var qit=t=>Promise.reject(new Error(`No hasher found for "${t}"`)),Aue=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||qit;for(let r of e.hashers)this.addHasher(r)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let r=typeof e=="string"?this._hashersByName:this._hashersByCode;if(r[e])return r[e];let i=await this._loadHasher(e);return r[e]==null&&this.addHasher(i),i}listHashers(){return Object.values(this._hashersByName)}};Iue.exports=Aue});var S8=p((mqt,Rue)=>{f();"use strict";var Nit=t=>Promise.reject(new Error(`No base found for "${t}"`)),Tue=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||Nit;for(let r of e.bases)this.addBase(r)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let r=await this._loadBase(e);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}};Rue.exports=Tue});var Vr=p((vqt,Pue)=>{f();"use strict";Pue.exports=t=>{if(t==null)return t;let e=/^[A-Z]+$/,r={};return Object.keys(t).reduce((i,n)=>(e.test(n)?i[n.toLowerCase()]=t[n]:e.test(n[0])?i[n[0].toLowerCase()+n.slice(1)]=t[n]:i[n]=t[n],i),r)}});var Oue=p((wqt,Cue)=>{f();"use strict";var{Multiaddr:Dit}=tt(),Bit=n2();Cue.exports=t=>{try{t=Bit(new Dit(t))}catch(e){}return t=t.toString(),t}});var kue=p(()=>{f()});var que=p(()=>{f()});var ME=p((Aqt,Uue)=>{f();"use strict";var{Multiaddr:Nue}=tt(),{isBrowser:x8,isWebWorker:A8,isNode:Mit}=Py(),{default:Lit}=Mg(),Due=me()("ipfs-http-client:lib:error-handler"),BE=ky(),Uit=hr().bind({ignoreUndefined:!0}),Bue=Oue(),Fit=kue(),Kit=que(),jit=x8||A8?location.protocol:"http",Vit=x8||A8?location.hostname:"localhost",zit=x8||A8?location.port:"5001",Hit=(t={})=>{let e,r={},i;if(typeof t=="string"||Nue.isMultiaddr(t))e=new URL(Bue(t));else if(t instanceof URL)e=t;else if(typeof t.url=="string"||Nue.isMultiaddr(t.url))e=new URL(Bue(t.url)),r=t;else if(t.url instanceof URL)e=t.url,r=t;else{r=t||{};let n=(r.protocol||jit).replace(":",""),s=(r.host||Vit).split(":")[0],o=r.port||zit;e=new URL(`${n}://${s}:${o}`)}if(r.apiPath?e.pathname=r.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),Mit){let n=e.protocol.startsWith("https")?Kit.Agent:Fit.Agent;i=r.agent||new n({keepAlive:!0,maxSockets:6})}return{...r,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:i}},Mue=async t=>{let e;try{if((t.headers.get("Content-Type")||"").startsWith("application/json")){let i=await t.json();Due(i),e=i.Message||i.message}else e=await t.text()}catch(i){Due("Failed to parse error response",i),e=i.message}let r=new BE.HTTPError(t);throw e&&e.includes("context deadline exceeded")&&(r=new BE.TimeoutError("Request timed out")),e&&e.includes("request timed out")&&(r=new BE.TimeoutError("Request timed out")),e&&(r.message=e),r},$it=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Lue=t=>t.replace($it,function(e){return"-"+e.toLowerCase()}),Git=t=>typeof t=="string"?Lit(t):t,I8=class extends BE{constructor(e={}){let r=Hit(e);super({timeout:Git(r.timeout||0)||6e4*20,headers:r.headers,base:`${r.url}`,handleError:Mue,transformSearchParams:n=>{let s=new URLSearchParams;for(let[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(Lue(o),a),o==="timeout"&&!isNaN(a)&&s.append(Lue(o),a);return s},agent:r.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let i=this.fetch;this.fetch=(n,s={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${r.url}/${n}`),i.call(this,n,Uit(s,{method:"POST"})))}};I8.errorHandler=Mue;Uue.exports=I8});var ve=p((Iqt,Fue)=>{f();"use strict";var Wit=ME(),Yit=t=>e=>t(new Wit(e),e);Fue.exports=Yit});var zue=p((Tqt,Vue)=>{f();"use strict";var Xit=ae(),Qit=pb(),Zit=hb(),Jit=Hh(),{isBytes:Kue,isBlob:ent,isReadableStream:tnt}=I_();async function rnt(t){if(Kue(t))return new Blob([t]);if(typeof t=="string"||t instanceof String)return new Blob([t.toString()]);if(ent(t))return t;if(tnt(t)&&(t=Zit(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=Qit(t),{value:r,done:i}=await e.peek();if(i)return jue(e);if(e.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await Jit(e))]);if(Kue(r)||typeof r=="string"||r instanceof String)return jue(e)}throw Xit(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}async function jue(t){let e=[];for await(let r of t)e.push(r);return new Blob(e)}Vue.exports=rnt});var $ue=p((Rqt,Hue)=>{f();"use strict";var int=zue(),nnt=o5();function snt(t){return nnt(t,int)}Hue.exports={normaliseInput:snt}});var LE=p((Pqt,Gue)=>{f();"use strict";Gue.exports=t=>{if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}});var Uo=p((Cqt,Wue)=>{f();"use strict";var{normaliseInput:ont}=$ue(),ant=LE();async function cnt(t,e,r={}){let i=[],n=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:u,mtime:l}of ont(t)){let d="",h=a?"file":"dir";s>0&&(d=`-${s}`);let y=h+d,g=[];if(u!=null&&g.push(`mode=${ant(u)}`),l!=null){let{secs:m,nsecs:E}=l;g.push(`mtime=${m}`),E!=null&&g.push(`mtime-nsecs=${E}`)}if(g.length&&(y=`${y}?${g.join("&")}`),a){n.set(y,a,c!=null?encodeURIComponent(c):void 0);let m=o+a.size;i.push({name:c,start:o,end:m}),o=m}else if(c!=null)n.set(y,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:i,headers:r,body:n}}Wue.exports=cnt});var T8=p((Oqt,Yue)=>{f();"use strict";var unt=ae();function lnt(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),i=Math.floor(r/1e3);e={secs:i,nsecs:(r-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw unt(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}Yue.exports=lnt});var Se=p((kqt,Xue)=>{f();"use strict";var fnt=LE(),dnt=T8();Xue.exports=({arg:t,searchParams:e,hashAlg:r,mtime:i,mode:n,...s}={})=>{e&&(s={...s,...e}),r&&(s.hash=r),i!=null&&(i=dnt(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),n!=null&&(s.mode=fnt(n)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),t==null?t=[]:Array.isArray(t)||(t=[t]);let o=new URLSearchParams(s);return t.forEach(a=>o.append("arg",a)),o}});var Fo=p((qqt,Que)=>{f();"use strict";var{anySignal:hnt}=Ul();function pnt(t){return t.filter(Boolean)}Que.exports=(...t)=>hnt(pnt(t))});var R8=p((Nqt,Zue)=>{f();"use strict";var{CID:ynt}=(Ae(),ke),gnt=Vr(),bnt=ve(),mnt=Uo(),vnt=Se(),wnt=Fo(),{AbortController:_nt}=Qi();Zue.exports=bnt(t=>{async function*e(r,i={}){let n=new _nt,s=wnt(n.signal,i.signal),{headers:o,body:a,total:c,parts:u}=await mnt(r,n,i.headers),[l,d]=typeof i.progress=="function"?Ent(c,u,i.progress):[void 0,void 0],h=await t.post("add",{searchParams:vnt({"stream-channels":!0,...i,progress:Boolean(l)}),timeout:i.timeout,onUploadProgress:d,signal:s,headers:o,body:a});for await(let y of h.ndjson())y=gnt(y),y.hash!==void 0?yield xnt(y):l&&l(y.bytes||0,y.name)}return e});var Ent=(t,e,r)=>e?[void 0,Snt(t,e,r)]:[r,void 0],Snt=(t,e,r)=>{let i=0,n=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*t);for(;i<n;){let{start:c,end:u,name:l}=e[i];if(a<u){r(a-c,l);break}else r(u-c,l),i+=1}}};function xnt({name:t,hash:e,size:r,mode:i,mtime:n,mtimeNsecs:s}){let o={path:t,cid:ynt.parse(e),size:parseInt(r)};return i!=null&&(o.mode=parseInt(i,8)),n!=null&&(o.mtime={secs:n,nsecs:s||0}),o}});var ele=p((Dqt,Jue)=>{f();"use strict";var Ant=R8(),Int=Fn(),Tnt=ve();Jue.exports=t=>{let e=Ant(t);return Tnt(()=>{async function r(i,n={}){return await Int(e(i,n))}return r})(t)}});var rle=p((Bqt,tle)=>{f();"use strict";var{CID:Rnt}=(Ae(),ke),Pnt=ve(),Cnt=Se();tle.exports=Pnt(t=>{async function e(r={}){return((await(await t.post("bitswap/wantlist",{timeout:r.timeout,signal:r.signal,searchParams:Cnt(r),headers:r.headers})).json()).Keys||[]).map(n=>Rnt.parse(n["/"]))}return e})});var nle=p((Mqt,ile)=>{f();"use strict";var{CID:Ont}=(Ae(),ke),knt=ve(),qnt=Se();ile.exports=knt(t=>{async function e(r,i={}){return((await(await t.post("bitswap/wantlist",{timeout:i.timeout,signal:i.signal,searchParams:qnt({...i,peer:r.toString()}),headers:i.headers})).json()).Keys||[]).map(s=>Ont.parse(s["/"]))}return e})});var P8=p((Lqt,sle)=>{f();"use strict";var{CID:Nnt}=(Ae(),ke),Dnt=ve(),Bnt=Se();sle.exports=Dnt(t=>{async function e(r={}){let i=await t.post("bitswap/stat",{searchParams:Bnt(r),timeout:r.timeout,signal:r.signal,headers:r.headers});return Mnt(await i.json())}return e});function Mnt(t){return{provideBufLen:t.ProvideBufLen,wantlist:(t.Wantlist||[]).map(e=>Nnt.parse(e["/"])),peers:t.Peers||[],blocksReceived:BigInt(t.BlocksReceived),dataReceived:BigInt(t.DataReceived),blocksSent:BigInt(t.BlocksSent),dataSent:BigInt(t.DataSent),dupBlksReceived:BigInt(t.DupBlksReceived),dupDataReceived:BigInt(t.DupDataReceived)}}});var ale=p((Uqt,ole)=>{f();"use strict";var Lnt=ve(),Unt=Se();ole.exports=Lnt(t=>{async function e(r,i={}){return(await t.post("bitswap/unwant",{timeout:i.timeout,signal:i.signal,searchParams:Unt({arg:r.toString(),...i}),headers:i.headers})).json()}return e})});var ule=p((Fqt,cle)=>{f();"use strict";cle.exports=t=>({wantlist:rle()(t),wantlistForPeer:nle()(t),stat:P8()(t),unwant:ale()(t)})});var C8=p((Kqt,lle)=>{f();"use strict";var Fnt=ve(),Knt=Se();lle.exports=Fnt(t=>{async function e(r,i={}){let n=await t.post("block/get",{timeout:i.timeout,signal:i.signal,searchParams:Knt({arg:r.toString(),...i}),headers:i.headers});return new Uint8Array(await n.arrayBuffer())}return e})});var dle=p((jqt,fle)=>{f();"use strict";var{CID:jnt}=(Ae(),ke),Vnt=ve(),znt=Se();fle.exports=Vnt(t=>{async function e(r,i={}){let s=await(await t.post("block/stat",{timeout:i.timeout,signal:i.signal,searchParams:znt({arg:r.toString(),...i}),headers:i.headers})).json();return{cid:jnt.parse(s.Key),size:s.Size}}return e})});var ple=p((Vqt,hle)=>{f();"use strict";var{CID:Hnt}=(Ae(),ke),$nt=Uo(),Gnt=ve(),Wnt=Se(),Ynt=Fo(),{AbortController:Xnt}=Qi();hle.exports=Gnt(t=>{async function e(r,i={}){let n=new Xnt,s=Ynt(n.signal,i.signal),o;try{o=await(await t.post("block/put",{timeout:i.timeout,signal:s,searchParams:Wnt(i),...await $nt(r,n,i.headers)})).json()}catch(a){if(i.format==="dag-pb")return e(r,{...i,format:"protobuf"});if(i.format==="dag-cbor")return e(r,{...i,format:"cbor"});throw a}return Hnt.parse(o.Key)}return e})});var gle=p((zqt,yle)=>{f();"use strict";var{CID:Qnt}=(Ae(),ke),Znt=ve(),Jnt=Se();yle.exports=Znt(t=>{async function*e(r,i={}){Array.isArray(r)||(r=[r]);let n=await t.post("block/rm",{timeout:i.timeout,signal:i.signal,searchParams:Jnt({arg:r.map(s=>s.toString()),"stream-channels":!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield est(s)}return e});function est(t){let e={cid:Qnt.parse(t.Hash)};return t.Error&&(e.error=new Error(t.Error)),e}});var mle=p((Hqt,ble)=>{f();"use strict";ble.exports=t=>({get:C8()(t),stat:dle()(t),put:ple()(t),rm:gle()(t)})});var wle=p(($qt,vle)=>{f();"use strict";var tst=ve(),rst=Se(),{Multiaddr:ist}=tt();vle.exports=tst(t=>{async function e(r,i={}){let n=await t.post("bootstrap/add",{timeout:i.timeout,signal:i.signal,searchParams:rst({arg:r,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new ist(o))}}return e})});var Ele=p((Gqt,_le)=>{f();"use strict";var nst=ve(),sst=Se(),{Multiaddr:ost}=tt();_le.exports=nst(t=>{async function e(r={}){let i=await t.post("bootstrap/rm",{timeout:r.timeout,signal:r.signal,searchParams:sst({...r,all:!0}),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new ost(s))}}return e})});var xle=p((Wqt,Sle)=>{f();"use strict";var ast=ve(),cst=Se(),{Multiaddr:ust}=tt();Sle.exports=ast(t=>{async function e(r,i={}){let n=await t.post("bootstrap/rm",{timeout:i.timeout,signal:i.signal,searchParams:cst({arg:r,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new ust(o))}}return e})});var Ile=p((Yqt,Ale)=>{f();"use strict";var lst=ve(),fst=Se(),{Multiaddr:dst}=tt();Ale.exports=lst(t=>{async function e(r={}){let i=await t.post("bootstrap/add",{timeout:r.timeout,signal:r.signal,searchParams:fst({...r,default:!0}),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new dst(s))}}return e})});var Rle=p((Xqt,Tle)=>{f();"use strict";var hst=ve(),pst=Se(),{Multiaddr:yst}=tt();Tle.exports=hst(t=>{async function e(r={}){let i=await t.post("bootstrap/list",{timeout:r.timeout,signal:r.signal,searchParams:pst(r),headers:r.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new yst(s))}}return e})});var Cle=p((Qqt,Ple)=>{f();"use strict";Ple.exports=t=>({add:wle()(t),clear:Ele()(t),rm:xle()(t),reset:Ile()(t),list:Rle()(t)})});var kle=p((Zqt,Ole)=>{f();"use strict";var gst=ve(),bst=Se();Ole.exports=gst(t=>{async function*e(r,i={}){yield*(await t.post("cat",{timeout:i.timeout,signal:i.signal,searchParams:bst({arg:r.toString(),...i}),headers:i.headers})).iterator()}return e})});var Nle=p((Jqt,qle)=>{f();"use strict";var mst=ve(),vst=Se();qle.exports=mst(t=>async(r={})=>(await t.post("commands",{timeout:r.timeout,signal:r.signal,searchParams:vst(r),headers:r.headers})).json())});var Ble=p((eNt,Dle)=>{f();"use strict";var wst=ve(),_st=Se();Dle.exports=wst(t=>async(r={})=>await(await t.post("config/show",{timeout:r.timeout,signal:r.signal,searchParams:_st({...r}),headers:r.headers})).json())});var Lle=p((tNt,Mle)=>{f();"use strict";var Est=ve(),Sst=Se();Mle.exports=Est(t=>async(r,i={})=>{if(!r)throw new Error("key argument is required");return(await(await t.post("config",{timeout:i.timeout,signal:i.signal,searchParams:Sst({arg:r,...i}),headers:i.headers})).json()).Value})});var Fle=p((rNt,Ule)=>{f();"use strict";var xst=ve(),Ast=Se();Ule.exports=xst(t=>async(r,i,n={})=>{if(typeof r!="string")throw new Error("Invalid key type");let s={...n,...Ist(r,i)};await(await t.post("config",{timeout:n.timeout,signal:n.signal,searchParams:Ast(s),headers:n.headers})).text()});var Ist=(t,e)=>{switch(typeof e){case"boolean":return{arg:[t,e.toString()],bool:!0};case"string":return{arg:[t,e]};default:return{arg:[t,JSON.stringify(e)],json:!0}}}});var jle=p((iNt,Kle)=>{f();"use strict";var Tst=ct(),Rst=Uo(),Pst=ve(),Cst=Se(),Ost=Fo(),{AbortController:kst}=Qi();Kle.exports=Pst(t=>async(r,i={})=>{let n=new kst,s=Ost(n.signal,i.signal);await(await t.post("config/replace",{timeout:i.timeout,signal:s,searchParams:Cst(i),...await Rst(Tst(JSON.stringify(r)),n,i.headers)})).text()})});var zle=p((nNt,Vle)=>{f();"use strict";var qst=ve(),Nst=Se();Vle.exports=qst(t=>{async function e(r,i={}){let s=await(await t.post("config/profile/apply",{timeout:i.timeout,signal:i.signal,searchParams:Nst({arg:r,...i}),headers:i.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e})});var $le=p((sNt,Hle)=>{f();"use strict";var Dst=Vr(),Bst=ve(),Mst=Se();Hle.exports=Bst(t=>{async function e(r={}){return(await(await t.post("config/profile/list",{timeout:r.timeout,signal:r.signal,searchParams:Mst(r),headers:r.headers})).json()).map(s=>Dst(s))}return e})});var Wle=p((oNt,Gle)=>{f();"use strict";Gle.exports=t=>({apply:zle()(t),list:$le()(t)})});var Xle=p((aNt,Yle)=>{f();"use strict";Yle.exports=t=>({getAll:Ble()(t),get:Lle()(t),set:Fle()(t),replace:jle()(t),profiles:Wle()(t)})});var Zle=p((cNt,Qle)=>{f();"use strict";var Lst=ve(),Ust=Se();Qle.exports=Lst(t=>{async function*e(r,i={}){yield*(await t.post("dag/export",{timeout:i.timeout,signal:i.signal,searchParams:Ust({arg:r.toString()}),headers:i.headers})).iterator()}return e})});var tfe=p((uNt,efe)=>{f();"use strict";var{CID:Fst}=(Ae(),ke),Jle=ae(),Kst=async function*(t,e,r,i,n){let s=async u=>{let l=await r.getCodec(u.code),d=await i(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(t),c=t;for(o.length||(yield{value:a,remainderPath:""});o.length;){let u=o.shift();if(!u)throw Jle(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw Jle(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");a instanceof Fst&&(c=a,a=await s(a))}};efe.exports=Kst});var ife=p((lNt,rfe)=>{f();"use strict";var jst=async t=>{for await(let e of t)return e};rfe.exports=jst});var ofe=p((fNt,sfe)=>{f();"use strict";var Vst=ve(),nfe=tfe(),zst=ife(),Hst=Fn(),$st=ae();sfe.exports=(t,e)=>Vst((i,n)=>{let s=C8()(n);return async(a,c={})=>{if(c.path){let y=c.localResolve?await zst(nfe(a,c.path,t,s,c)):await Hst(nfe(a,c.path,t,s,c));if(!y)throw $st(new Error("Not found"),"ERR_NOT_FOUND");return y}let u=await t.getCodec(a.code),l=await s(a,c);return{value:u.decode(l),remainderPath:""}}})(e)});var cfe=p((dNt,afe)=>{f();"use strict";var Gst=ve(),Wst=Se(),Yst=Fo(),Xst=Uo(),{AbortController:Qst}=Qi(),{CID:Zst}=(Ae(),ke);afe.exports=Gst(t=>{async function*e(r,i={}){let n=new Qst,s=Yst(n.signal,i.signal),{headers:o,body:a}=await Xst(r,n,i.headers),c=await t.post("dag/import",{timeout:i.timeout,signal:s,headers:o,body:a,searchParams:Wst({"pin-roots":i.pinRoots})});for await(let{Root:u}of c.ndjson())if(u!==void 0){let{Cid:{"/":l},PinErrorMsg:d}=u;yield{root:{cid:Zst.parse(l),pinErrorMsg:d}}}}return e})});var O8=p((hNt,ufe)=>{f();"use strict";var{CID:Jst}=(Ae(),ke),eot=ve(),tot=Uo(),rot=Se(),iot=Fo(),{AbortController:not}=Qi();ufe.exports=(t,e)=>eot(i=>async(s,o={})=>{let a={format:"dag-cbor",hashAlg:"sha2-256",inputEnc:"raw",...o},u=(await t.getCodec(a.format)).encode(s),l=new not,d=iot(l.signal,a.signal),y=await(await i.post("dag/put",{timeout:a.timeout,signal:d,searchParams:rot(a),...await tot(u,l,a.headers)})).json();return Jst.parse(y.Cid["/"])})(e)});var ffe=p((pNt,lfe)=>{f();"use strict";var{CID:sot}=(Ae(),ke),oot=ve(),aot=Se();lfe.exports=oot(t=>async(r,i={})=>{let s=await(await t.post("dag/resolve",{timeout:i.timeout,signal:i.signal,searchParams:aot({arg:`${r}${i.path?`/${i.path}`.replace(/\/[/]+/g,"/"):""}`,...i}),headers:i.headers})).json();return{cid:sot.parse(s.Cid["/"]),remainderPath:s.RemPath}})});var hfe=p((yNt,dfe)=>{f();"use strict";dfe.exports=(t,e)=>({export:Zle()(e),get:ofe()(t,e),import:cfe()(e),put:O8()(t,e),resolve:ffe()(e)})});var UE=p((gNt,pfe)=>{f();"use strict";pfe.exports={SendingQuery:0,PeerResponse:1,FinalPeer:2,QueryError:3,Provider:4,Value:5,AddingPeer:6,DialingPeer:7}});var gfe=p((bNt,yfe)=>{f();"use strict";var cot=ve(),uot=Se(),{Value:lot}=UE(),fot=Je(),dot=ct();yfe.exports=cot(t=>{async function e(r,i={}){let n=await t.post("dht/get",{timeout:i.timeout,signal:i.signal,searchParams:uot({arg:r instanceof Uint8Array?fot(r):r,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===lot)return dot(s.Extra,"base64pad");throw new Error("not found")}return e})});var mfe=p((mNt,bfe)=>{f();"use strict";var{Multiaddr:hot}=tt(),pot=Vr(),yot=ve(),got=Se(),bot=Uo(),mot=Fo(),{AbortController:vot}=Qi(),wot=Je();bfe.exports=yot(t=>{async function*e(r,i,n={}){let s=new vot,o=mot(s.signal,n.signal),a=await t.post("dht/put",{timeout:n.timeout,signal:o,searchParams:got({arg:wot(r),...n}),...await bot(i,s,n.headers)});for await(let c of a.ndjson())c=pot(c),c.responses&&(c.responses=c.responses.map(({ID:u,Addrs:l})=>({id:u,addrs:(l||[]).map(d=>new hot(d))}))),yield c}return e})});var wfe=p((vNt,vfe)=>{f();"use strict";var{Multiaddr:_ot}=tt(),Eot=ve(),Sot=Se(),{Provider:xot}=UE();vfe.exports=Eot(t=>{async function*e(r,i={}){let n=await t.post("dht/findprovs",{timeout:i.timeout,signal:i.signal,searchParams:Sot({arg:r.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===xot&&s.Responses)for(let{ID:o,Addrs:a}of s.Responses)yield{id:o,addrs:(a||[]).map(c=>new _ot(c))}}return e})});var Efe=p((wNt,_fe)=>{f();"use strict";var{Multiaddr:Aot}=tt(),Iot=ve(),Tot=Se(),{FinalPeer:Rot}=UE();_fe.exports=Iot(t=>{async function e(r,i={}){let n=await t.post("dht/findpeer",{timeout:i.timeout,signal:i.signal,searchParams:Tot({arg:r,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===Rot&&s.Responses){let{ID:o,Addrs:a}=s.Responses[0];return{id:o,addrs:(a||[]).map(c=>new Aot(c))}}throw new Error("not found")}return e})});var xfe=p((_Nt,Sfe)=>{f();"use strict";var{Multiaddr:Pot}=tt(),Cot=Vr(),Oot=ve(),kot=Se();Sfe.exports=Oot(t=>{async function*e(r,i={recursive:!1}){let n=Array.isArray(r)?r:[r],s=await t.post("dht/provide",{timeout:i.timeout,signal:i.signal,searchParams:kot({arg:n.map(o=>o.toString()),...i}),headers:i.headers});for await(let o of s.ndjson())o=Cot(o),o.responses?o.responses=o.responses.map(({ID:a,Addrs:c})=>({id:a,addrs:(c||[]).map(u=>new Pot(u))})):o.responses=[],yield o}return e})});var Ife=p((ENt,Afe)=>{f();"use strict";var{Multiaddr:qot}=tt(),Not=Vr(),Dot=ve(),Bot=Se();Afe.exports=Dot(t=>{async function*e(r,i={}){let n=await t.post("dht/query",{timeout:i.timeout,signal:i.signal,searchParams:Bot({arg:r.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())s=Not(s),s.responses=(s.responses||[]).map(({ID:o,Addrs:a})=>({id:o,addrs:(a||[]).map(c=>new qot(c))})),yield s}return e})});var Rfe=p((SNt,Tfe)=>{f();"use strict";Tfe.exports=t=>({get:gfe()(t),put:mfe()(t),findProvs:wfe()(t),findPeer:Efe()(t),provide:xfe()(t),query:Ife()(t)})});var Cfe=p((xNt,Pfe)=>{f();"use strict";var Mot=ve(),Lot=Se();Pfe.exports=Mot(t=>{async function e(r={}){return(await t.post("diag/net",{timeout:r.timeout,signal:r.signal,searchParams:Lot(r),headers:r.headers})).json()}return e})});var kfe=p((ANt,Ofe)=>{f();"use strict";var Uot=ve(),Fot=Se();Ofe.exports=Uot(t=>{async function e(r={}){return(await t.post("diag/sys",{timeout:r.timeout,signal:r.signal,searchParams:Fot(r),headers:r.headers})).json()}return e})});var Nfe=p((INt,qfe)=>{f();"use strict";var Kot=ve(),jot=Se();qfe.exports=Kot(t=>{async function e(r={}){return(await t.post("diag/cmds",{timeout:r.timeout,signal:r.signal,searchParams:jot(r),headers:r.headers})).json()}return e})});var Bfe=p((TNt,Dfe)=>{f();"use strict";Dfe.exports=t=>({net:Cfe()(t),sys:kfe()(t),cmds:Nfe()(t)})});var Lfe=p((RNt,Mfe)=>{f();"use strict";var Vot=ve(),zot=Se();Mfe.exports=Vot(t=>async(r,i={})=>(await(await t.post("dns",{timeout:i.timeout,signal:i.signal,searchParams:zot({arg:r,...i}),headers:i.headers})).json()).Path)});var Ffe=p((PNt,Ufe)=>{f();"use strict";var Hot=ve(),$ot=Se();Ufe.exports=Hot(t=>{async function e(r,i,n={}){await(await t.post("files/chmod",{timeout:n.timeout,signal:n.signal,searchParams:$ot({arg:r,mode:i,...n}),headers:n.headers})).text()}return e})});var jfe=p((CNt,Kfe)=>{f();"use strict";var{CID:Got}=(Ae(),ke),Wot=ve(),Yot=Se();Kfe.exports=Wot(t=>{async function e(r,i,n={}){let s=Array.isArray(r)?r:[r];await(await t.post("files/cp",{timeout:n.timeout,signal:n.signal,searchParams:Yot({arg:s.concat(i).map(a=>a instanceof Got?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e})});var zfe=p((ONt,Vfe)=>{f();"use strict";var{CID:Xot}=(Ae(),ke),Qot=ve(),Zot=Se();Vfe.exports=Qot(t=>{async function e(r,i={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await t.post("files/flush",{timeout:i.timeout,signal:i.signal,searchParams:Zot({arg:r,...i}),headers:i.headers})).json();return Xot.parse(s.Cid)}return e})});var k8=p((kNt,Hfe)=>{f();"use strict";var Jot=Vr();function eat(t){let e=Jot(t);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}Hfe.exports=eat});var Xfe=p((qNt,Yfe)=>{f();"use strict";var{CID:$fe}=(Ae(),ke),Gfe=k8(),tat=ve(),rat=Se();Yfe.exports=tat(t=>{async function*e(r,i={}){if(!r)throw new Error("ipfs.files.ls requires a path");let n=await t.post("files/ls",{timeout:i.timeout,signal:i.signal,searchParams:rat({arg:r instanceof $fe?`/ipfs/${r}`:r,long:!0,...i,stream:!0}),headers:i.headers});for await(let s of n.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield Wfe(Gfe(o));else yield Wfe(Gfe(s))}return e});function Wfe(t){return t.hash&&(t.cid=$fe.parse(t.hash)),delete t.hash,t.type=t.type===1?"directory":"file",t}});var Zfe=p((NNt,Qfe)=>{f();"use strict";var iat=ve(),nat=Se();Qfe.exports=iat(t=>{async function e(r,i={}){await(await t.post("files/mkdir",{timeout:i.timeout,signal:i.signal,searchParams:nat({arg:r,...i}),headers:i.headers})).text()}return e})});var ede=p((DNt,Jfe)=>{f();"use strict";var sat=ve(),oat=Se();Jfe.exports=sat(t=>{async function e(r,i,n={}){Array.isArray(r)||(r=[r]),await(await t.post("files/mv",{timeout:n.timeout,signal:n.signal,searchParams:oat({arg:r.concat(i),...n}),headers:n.headers})).text()}return e})});var g1=p((BNt,tde)=>{f();tde.exports=t=>{if(t[Symbol.asyncIterator])return t;if(t.getReader)return async function*(){let e=t.getReader();try{for(;;){let{done:r,value:i}=await e.read();if(r)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var ide=p((MNt,rde)=>{f();"use strict";var aat=g1(),cat=ve(),uat=Se();rde.exports=cat(t=>{async function*e(r,i={}){let n=await t.post("files/read",{timeout:i.timeout,signal:i.signal,searchParams:uat({arg:r,count:i.length,...i}),headers:i.headers});yield*aat(n.body)}return e})});var sde=p((LNt,nde)=>{f();"use strict";var lat=ve(),fat=Se();nde.exports=lat(t=>{async function e(r,i={}){await(await t.post("files/rm",{timeout:i.timeout,signal:i.signal,searchParams:fat({arg:r,...i}),headers:i.headers})).text()}return e})});var q8=p((UNt,ade)=>{f();"use strict";var{CID:ode}=(Ae(),ke),dat=k8(),hat=ve(),pat=Se();ade.exports=hat(t=>{async function e(r,i={}){r&&!(r instanceof ode)&&typeof r!="string"&&(i=r||{},r="/"),i=i||{};let s=await(await t.post("files/stat",{timeout:i.timeout,signal:i.signal,searchParams:pat({arg:r,...i}),headers:i.headers})).json();return s.WithLocality=s.WithLocality||!1,yat(dat(s))}return e});function yat(t){return t.cid=ode.parse(t.hash),delete t.hash,t}});var ude=p((FNt,cde)=>{f();"use strict";var gat=ve(),bat=Se();cde.exports=gat(t=>{async function e(r,i={}){await(await t.post("files/touch",{timeout:i.timeout,signal:i.signal,searchParams:bat({arg:r,...i}),headers:i.headers})).text()}return e})});var fde=p((KNt,lde)=>{f();"use strict";var mat=LE(),vat=T8(),wat=ve(),_at=Uo(),Eat=Se(),Sat=Fo(),{AbortController:xat}=Qi();lde.exports=wat(t=>{async function e(r,i,n={}){let s=new xat,o=Sat(s.signal,n.signal);await(await t.post("files/write",{timeout:n.timeout,signal:o,searchParams:Eat({arg:r,streamChannels:!0,count:n.length,...n}),...await _at({content:i,path:"arg",mode:mat(n.mode),mtime:vat(n.mtime)},s,n.headers)})).text()}return e})});var hde=p((jNt,dde)=>{f();"use strict";dde.exports=t=>({chmod:Ffe()(t),cp:jfe()(t),flush:zfe()(t),ls:Xfe()(t),mkdir:Zfe()(t),mv:ede()(t),read:ide()(t),rm:sde()(t),stat:q8()(t),touch:ude()(t),write:fde()(t)})});var yde=p((VNt,pde)=>{f();"use strict";var{CID:Aat}=(Ae(),ke),Iat=ve(),Tat=Se();pde.exports=Iat(t=>{async function*e(r,i={}){let n={arg:`${r instanceof Uint8Array?Aat.decode(r):r}`,...i};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel),yield*(await t.post("get",{timeout:i.timeout,signal:i.signal,searchParams:Tat(n),headers:i.headers})).iterator()}return e})});var bde=p((zNt,gde)=>{f();"use strict";var Rat=ve();gde.exports=Rat(t=>()=>{let e=new URL(t.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}})});var N8=p((HNt,mde)=>{f();"use strict";var Pat=Vr(),{Multiaddr:Cat}=tt(),Oat=ve(),kat=Se();mde.exports=Oat(t=>{async function e(r={}){let n=await(await t.post("id",{timeout:r.timeout,signal:r.signal,searchParams:kat({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),s={...Pat(n)};return s.addresses&&(s.addresses=s.addresses.map(o=>new Cat(o))),s}return e})});var wde=p(($Nt,vde)=>{f();"use strict";var qat=N8();vde.exports=t=>{let e=qat(t);async function r(i={}){let n=await e(i);return Boolean(n&&n.addresses&&n.addresses.length)}return r}});var Ede=p((GNt,_de)=>{f();"use strict";var Nat=Vr(),Dat=ve(),Bat=Se();_de.exports=Dat(t=>{async function e(r,i={type:"rsa",size:2048}){let s=await(await t.post("key/gen",{timeout:i.timeout,signal:i.signal,searchParams:Bat({arg:r,...i}),headers:i.headers})).json();return Nat(s)}return e})});var xde=p((WNt,Sde)=>{f();"use strict";var Mat=Vr(),Lat=ve(),Uat=Se();Sde.exports=Lat(t=>{async function e(r={}){return((await(await t.post("key/list",{timeout:r.timeout,signal:r.signal,searchParams:Uat(r),headers:r.headers})).json()).Keys||[]).map(s=>Mat(s))}return e})});var Ide=p((YNt,Ade)=>{f();"use strict";var Fat=Vr(),Kat=ve(),jat=Se();Ade.exports=Kat(t=>{async function e(r,i,n={}){let s=await t.post("key/rename",{timeout:n.timeout,signal:n.signal,searchParams:jat({arg:[r,i],...n}),headers:n.headers});return Fat(await s.json())}return e})});var Rde=p((XNt,Tde)=>{f();"use strict";var Vat=Vr(),zat=ve(),Hat=Se();Tde.exports=zat(t=>{async function e(r,i={}){let s=await(await t.post("key/rm",{timeout:i.timeout,signal:i.signal,searchParams:Hat({arg:r,...i}),headers:i.headers})).json();return Vat(s.Keys[0])}return e})});var Cde=p((QNt,Pde)=>{f();"use strict";var $at=Vr(),Gat=ve(),Wat=Se();Pde.exports=Gat(t=>{async function e(r,i,n,s={}){let a=await(await t.post("key/import",{timeout:s.timeout,signal:s.signal,searchParams:Wat({arg:r,pem:i,password:n,...s}),headers:s.headers})).json();return $at(a)}return e})});var kde=p((ZNt,Ode)=>{f();"use strict";var Yat=ve(),Xat=ae();Ode.exports=Yat(t=>async(r,i,n={})=>{throw Xat(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Nde=p((JNt,qde)=>{f();"use strict";var Qat=ve(),Zat=ae();qde.exports=Qat(t=>async(r,i={})=>{throw Zat(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Bde=p((eDt,Dde)=>{f();"use strict";Dde.exports=t=>({gen:Ede()(t),list:xde()(t),rename:Ide()(t),rm:Rde()(t),import:Cde()(t),export:kde()(t),info:Nde()(t)})});var Lde=p((tDt,Mde)=>{f();"use strict";var Jat=ve(),ect=Se();Mde.exports=Jat(t=>{async function*e(r={}){yield*(await t.post("log/tail",{timeout:r.timeout,signal:r.signal,searchParams:ect(r),headers:r.headers})).ndjson()}return e})});var Fde=p((rDt,Ude)=>{f();"use strict";var tct=ve(),rct=Se();Ude.exports=tct(t=>{async function e(r={}){return(await(await t.post("log/ls",{timeout:r.timeout,signal:r.signal,searchParams:rct(r),headers:r.headers})).json()).Strings}return e})});var jde=p((iDt,Kde)=>{f();"use strict";var ict=Vr(),nct=ve(),sct=Se();Kde.exports=nct(t=>{async function e(r,i,n={}){let s=await t.post("log/level",{timeout:n.timeout,signal:n.signal,searchParams:sct({arg:[r,i],...n}),headers:n.headers});return ict(await s.json())}return e})});var zde=p((nDt,Vde)=>{f();"use strict";Vde.exports=t=>({tail:Lde()(t),ls:Fde()(t),level:jde()(t)})});var Gde=p((sDt,$de)=>{f();"use strict";var{CID:Hde}=(Ae(),ke),oct=ve(),act=Se(),cct=q8();$de.exports=oct((t,e)=>{async function*r(i,n={}){let s=`${i instanceof Uint8Array?Hde.decode(i):i}`;async function o(c){let u=c.Hash;if(u.includes("/")){let d=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await cct(e)(d)).cid}else u=Hde.parse(u);let l={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:u,type:uct(c)};return c.Mode&&(l.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(l.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(l.mtime.nsecs=c.MtimeNsecs)),l}let a=await t.post("ls",{timeout:n.timeout,signal:n.signal,searchParams:act({arg:s,...n}),headers:n.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let u=c.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield o(c);return}yield*u.map(o)}}return r});function uct(t){switch(t.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}});var Yde=p((oDt,Wde)=>{f();"use strict";var lct=Vr(),fct=ve(),dct=Se();Wde.exports=fct(t=>{async function e(r={}){let i=await t.post("dns",{timeout:r.timeout,signal:r.signal,searchParams:dct(r),headers:r.headers});return lct(await i.json())}return e})});var Qde=p((aDt,Xde)=>{f();"use strict";var hct=Vr(),pct=ve(),yct=Se();Xde.exports=pct(t=>{async function e(r,i={}){let n=await t.post("name/publish",{timeout:i.timeout,signal:i.signal,searchParams:yct({arg:`${r}`,...i}),headers:i.headers});return hct(await n.json())}return e})});var Jde=p((cDt,Zde)=>{f();"use strict";var gct=ve(),bct=Se();Zde.exports=gct(t=>{async function*e(r,i={}){let n=await t.post("name/resolve",{timeout:i.timeout,signal:i.signal,searchParams:bct({arg:r,stream:!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield s.Path}return e})});var the=p((uDt,ehe)=>{f();"use strict";var mct=Vr(),vct=ve(),wct=Se();ehe.exports=vct(t=>{async function e(r,i={}){let n=await t.post("name/pubsub/cancel",{timeout:i.timeout,signal:i.signal,searchParams:wct({arg:r,...i}),headers:i.headers});return mct(await n.json())}return e})});var ihe=p((lDt,rhe)=>{f();"use strict";var _ct=Vr(),Ect=ve(),Sct=Se();rhe.exports=Ect(t=>{async function e(r={}){let i=await t.post("name/pubsub/state",{timeout:r.timeout,signal:r.signal,searchParams:Sct(r),headers:r.headers});return _ct(await i.json())}return e})});var she=p((fDt,nhe)=>{f();"use strict";var xct=ve(),Act=Se();nhe.exports=xct(t=>{async function e(r={}){return(await(await t.post("name/pubsub/subs",{timeout:r.timeout,signal:r.signal,searchParams:Act(r),headers:r.headers})).json()).Strings||[]}return e})});var ahe=p((dDt,ohe)=>{f();"use strict";ohe.exports=t=>({cancel:the()(t),state:ihe()(t),subs:she()(t)})});var uhe=p((hDt,che)=>{f();"use strict";che.exports=t=>({publish:Qde()(t),resolve:Jde()(t),pubsub:ahe()(t)})});var fhe=p((pDt,lhe)=>{f();"use strict";var{CID:Ict}=(Ae(),ke),Tct=ve(),Rct=Se();lhe.exports=Tct(t=>{async function e(r,i={}){let s=await(await t.post("object/data",{timeout:i.timeout,signal:i.signal,searchParams:Rct({arg:`${r instanceof Uint8Array?Ict.decode(r):r}`,...i}),headers:i.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e})});var phe=p((yDt,hhe)=>{f();"use strict";var{CID:dhe}=(Ae(),ke),Pct=ve(),Cct=Se(),Oct=ct();hhe.exports=Pct(t=>{async function e(r,i={}){let s=await(await t.post("object/get",{timeout:i.timeout,signal:i.signal,searchParams:Cct({arg:`${r instanceof Uint8Array?dhe.decode(r):r}`,dataEncoding:"base64",...i}),headers:i.headers})).json();return{Data:Oct(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:dhe.parse(o.Hash),Tsize:o.Size}))}}return e})});var bhe=p((gDt,ghe)=>{f();"use strict";var{CID:yhe}=(Ae(),ke),kct=ve(),qct=Se();ghe.exports=kct(t=>{async function e(r,i={}){return((await(await t.post("object/links",{timeout:i.timeout,signal:i.signal,searchParams:qct({arg:`${r instanceof Uint8Array?yhe.decode(r):r}`,...i}),headers:i.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:yhe.parse(o.Hash)}))}return e})});var vhe=p((bDt,mhe)=>{f();"use strict";var{CID:Nct}=(Ae(),ke),Dct=ve(),Bct=Se();mhe.exports=Dct(t=>{async function e(r={}){let i=await t.post("object/new",{timeout:r.timeout,signal:r.signal,searchParams:Bct({arg:r.template,...r}),headers:r.headers}),{Hash:n}=await i.json();return Nct.parse(n)}return e})});var _he=p((mDt,whe)=>{f();"use strict";var{CID:Mct}=(Ae(),ke),Lct=ve(),Uct=Se();whe.exports=Lct(t=>{async function e(r,i,n={}){let s=await t.post("object/patch/add-link",{timeout:n.timeout,signal:n.signal,searchParams:Uct({arg:[`${r}`,i.Name||i.name||"",(i.Hash||i.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return Mct.parse(o)}return e})});var She=p((vDt,Ehe)=>{f();"use strict";var{CID:Fct}=(Ae(),ke),Kct=Uo(),jct=ve(),Vct=Se(),zct=Fo(),{AbortController:Hct}=Qi();Ehe.exports=jct(t=>{async function e(r,i,n={}){let s=new Hct,o=zct(s.signal,n.signal),a=await t.post("object/patch/append-data",{timeout:n.timeout,signal:o,searchParams:Vct({arg:`${r}`,...n}),...await Kct(i,s,n.headers)}),{Hash:c}=await a.json();return Fct.parse(c)}return e})});var Ahe=p((wDt,xhe)=>{f();"use strict";var{CID:$ct}=(Ae(),ke),Gct=ve(),Wct=Se();xhe.exports=Gct(t=>{async function e(r,i,n={}){let s=await t.post("object/patch/rm-link",{timeout:n.timeout,signal:n.signal,searchParams:Wct({arg:[`${r}`,i.Name||i.name||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return $ct.parse(o)}return e})});var The=p((_Dt,Ihe)=>{f();"use strict";var{CID:Yct}=(Ae(),ke),Xct=Uo(),Qct=ve(),Zct=Se(),Jct=Fo(),{AbortController:eut}=Qi();Ihe.exports=Qct(t=>{async function e(r,i,n={}){let s=new eut,o=Jct(s.signal,n.signal),a=await t.post("object/patch/set-data",{timeout:n.timeout,signal:o,searchParams:Zct({arg:[`${r}`],...n}),...await Xct(i,s,n.headers)}),{Hash:c}=await a.json();return Yct.parse(c)}return e})});var Phe=p((EDt,Rhe)=>{f();"use strict";Rhe.exports=t=>({addLink:_he()(t),appendData:She()(t),rmLink:Ahe()(t),setData:The()(t)})});var Ohe=p((SDt,Che)=>{f();"use strict";var tut=ve();Che.exports=(t,e)=>tut(i=>{let n=O8()(t,e);async function s(o,a={}){return n(o,{...a,format:"dag-pb",hashAlg:"sha2-256",version:0})}return s})(e)});var qhe=p((xDt,khe)=>{f();"use strict";var{CID:rut}=(Ae(),ke),iut=ve(),nut=Se();khe.exports=iut(t=>{async function e(r,i={}){let s=await(await t.post("object/stat",{timeout:i.timeout,signal:i.signal,searchParams:nut({arg:`${r}`,...i}),headers:i.headers})).json();return{...s,Hash:rut.parse(s.Hash)}}return e})});var Dhe=p((ADt,Nhe)=>{f();"use strict";Nhe.exports=(t,e)=>({data:fhe()(e),get:phe()(e),links:bhe()(e),new:vhe()(e),patch:Phe()(e),put:Ohe()(t,e),stat:qhe()(e)})});var Mhe=p((IDt,Bhe)=>{f();"use strict";var sut=ME(),D8=Se(),$c=class{constructor(e){this.client=new sut(e)}static encodeEndpoint(e){let r=String(e);if(r==="undefined")throw Error("endpoint is required");return r[r.length-1]==="/"?r.slice(0,-1):r}static decodeRemoteService(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:$c.decodeStat(e.Stat)}}}static decodeStat(e){switch(e.Status){case"valid":{let{Pinning:r,Pinned:i,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:r,pinned:i,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}};$c.prototype.add=async function(e,r){let{endpoint:i,key:n,headers:s,timeout:o,signal:a}=r;await this.client.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:D8({arg:[e,$c.encodeEndpoint(i),n]}),headers:s})};$c.prototype.rm=async function(e,r={}){await this.client.post("pin/remote/service/rm",{timeout:r.timeout,signal:r.signal,headers:r.headers,searchParams:D8({arg:e})})};$c.prototype.ls=async function(e={}){let{stat:r,headers:i,timeout:n,signal:s}=e,o=await this.client.post("pin/remote/service/ls",{timeout:n,signal:s,headers:i,searchParams:r===!0?D8({stat:r}):void 0}),{RemoteServices:a}=await o.json();return a.map($c.decodeRemoteService)};Bhe.exports=$c});var zhe=p((TDt,Vhe)=>{f();"use strict";var{CID:Lhe}=(Ae(),ke),out=ME(),aut=Mhe(),Uhe=Se(),a0=class{constructor(e){this.client=new out(e),this.service=new aut(e)}};a0.prototype.add=async function(e,{timeout:r,signal:i,headers:n,...s}){let o=await this.client.post("pin/remote/add",{timeout:r,signal:i,headers:n,searchParams:cut({cid:e,...s})});return Fhe(await o.json())};a0.prototype.ls=async function*({timeout:e,signal:r,headers:i,...n}){let s=await this.client.post("pin/remote/ls",{timeout:e,signal:r,headers:i,searchParams:B8(n)});for await(let o of s.ndjson())yield Fhe(o)};a0.prototype.rm=async function({timeout:e,signal:r,headers:i,...n}){await this.client.post("pin/remote/rm",{timeout:e,signal:r,headers:i,searchParams:B8({...n,all:!1})})};a0.prototype.rmAll=async function({timeout:t,signal:e,headers:r,...i}){await this.client.post("pin/remote/rm",{timeout:t,signal:e,headers:r,searchParams:B8({...i,all:!0})})};var Fhe=({Name:t,Status:e,Cid:r})=>({cid:Lhe.parse(r),name:t,status:e}),Khe=t=>{if(typeof t=="string"&&t!=="")return t;throw new TypeError("service name must be passed")},jhe=t=>{if(t instanceof Lhe)return t.toString();throw new TypeError(`CID instance expected instead of ${typeof t}`)},B8=({service:t,cid:e,name:r,status:i,all:n})=>{let s=Uhe({service:Khe(t),name:r,force:n?!0:void 0});if(e)for(let o of e)s.append("cid",jhe(o));if(i)for(let o of i)s.append("status",o);return s},cut=({cid:t,service:e,background:r,name:i,origins:n})=>{let s=Uhe({arg:jhe(t),service:Khe(e),name:i,background:r?!0:void 0});if(n)for(let o of n)s.append("origin",o.toString());return s};Vhe.exports=a0});var M8=p((RDt,$he)=>{f();"use strict";var{CID:Hhe}=(Ae(),ke),uut=ve(),{normaliseInput:lut}=Yh(),fut=Se();$he.exports=uut(t=>{async function*e(r,i={}){for await(let{path:n,recursive:s,metadata:o}of lut(r)){let a=await t.post("pin/add",{timeout:i.timeout,signal:i.signal,searchParams:fut({...i,arg:n,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:i.headers});for await(let c of a.ndjson()){if(c.Pins){for(let u of c.Pins)yield Hhe.parse(u);continue}yield Hhe.parse(c)}}}return e})});var Whe=p((PDt,Ghe)=>{f();"use strict";var dut=M8(),hut=Fn(),put=ve();Ghe.exports=t=>{let e=dut(t);return put(()=>{async function r(i,n={}){return hut(e([{path:i,...n}],n))}return r})(t)}});var Qhe=p((CDt,Xhe)=>{f();"use strict";var{CID:yut}=(Ae(),ke),gut=ve(),but=Se();function Yhe(t,e,r){let i={type:t,cid:yut.parse(e)};return r&&(i.metadata=r),i}Xhe.exports=gut(t=>{async function*e(r={}){let i=[];r.paths&&(i=Array.isArray(r.paths)?r.paths:[r.paths]);let n=await t.post("pin/ls",{timeout:r.timeout,signal:r.signal,searchParams:but({...r,arg:i.map(s=>`${s}`),stream:!0}),headers:r.headers});for await(let s of n.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield Yhe(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield Yhe(s.Type,s.Cid,s.Metadata)}}return e})});var L8=p((ODt,Jhe)=>{f();"use strict";var{CID:Zhe}=(Ae(),ke),mut=ve(),{normaliseInput:vut}=Yh(),wut=Se();Jhe.exports=mut(t=>{async function*e(r,i={}){for await(let{path:n,recursive:s}of vut(r)){let o=new URLSearchParams(i.searchParams);o.append("arg",`${n}`),s!=null&&o.set("recursive",String(s));let a=await t.post("pin/rm",{timeout:i.timeout,signal:i.signal,headers:i.headers,searchParams:wut({...i,arg:`${n}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(u=>Zhe.parse(u));continue}yield Zhe.parse(c)}}}return e})});var tpe=p((kDt,epe)=>{f();"use strict";var _ut=L8(),Eut=Fn(),Sut=ve();epe.exports=t=>{let e=_ut(t);return Sut(()=>{async function r(i,n={}){return Eut(e([{path:i,...n}],n))}return r})(t)}});var ipe=p((qDt,rpe)=>{f();"use strict";var xut=zhe();rpe.exports=t=>({add:Whe()(t),addAll:M8()(t),ls:Qhe()(t),rm:tpe()(t),rmAll:L8()(t),remote:new xut(t)})});var spe=p((NDt,npe)=>{f();"use strict";var Aut=Vr(),Iut=ve(),Tut=Se();npe.exports=Iut(t=>{async function*e(r,i={}){yield*(await t.post("ping",{timeout:i.timeout,signal:i.signal,searchParams:Tut({arg:`${r}`,...i}),headers:i.headers,transform:Aut})).ndjson()}return e})});var cpe=p((DDt,ape)=>{f();"use strict";var{AbortController:Rut}=Qi(),ope=class{constructor(){this._subs=new Map}subscribe(e,r,i){let n=this._subs.get(e)||[];if(n.find(o=>o.handler===r))throw new Error(`Already subscribed to ${e} with this handler`);let s=new Rut;return this._subs.set(e,[{handler:r,controller:s}].concat(n)),i&&i.addEventListener("abort",()=>this.unsubscribe(e,r)),s.signal}unsubscribe(e,r){let i=this._subs.get(e)||[],n;r?(this._subs.set(e,i.filter(s=>s.handler!==r)),n=i.filter(s=>s.handler===r)):(this._subs.set(e,[]),n=i),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(s=>s.controller.abort())}};ape.exports=ope});var lpe=p((BDt,upe)=>{f();"use strict";var Put=ve(),Cut=Se();upe.exports=Put(t=>{async function e(r={}){let{Strings:i}=await(await t.post("pubsub/ls",{timeout:r.timeout,signal:r.signal,searchParams:Cut(r),headers:r.headers})).json();return i||[]}return e})});var dpe=p((MDt,fpe)=>{f();"use strict";var Out=ve(),kut=Se();fpe.exports=Out(t=>{async function e(r,i={}){let n=await t.post("pubsub/peers",{timeout:i.timeout,signal:i.signal,searchParams:kut({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var ppe=p((LDt,hpe)=>{f();"use strict";var qut=ve(),Nut=Se(),Dut=Uo(),But=Fo(),{AbortController:Mut}=Qi();hpe.exports=qut(t=>{async function e(r,i,n={}){let s=Nut({arg:r,...n}),o=new Mut,a=But(o.signal,n.signal);await(await t.post("pubsub/pub",{timeout:n.timeout,signal:a,searchParams:s,...await Dut(i,o,n.headers)})).text()}return e})});var gpe=p((UDt,ype)=>{f();"use strict";var U8=ct(),Lut=Je(),Uut=me()("ipfs-http-client:pubsub:subscribe"),Fut=ve(),Kut=Se();ype.exports=(t,e)=>Fut(r=>{async function i(n,s,o={}){o.signal=e.subscribe(n,s,o.signal);let a,c,u=new Promise((d,h)=>{a=d,c=h}),l=setTimeout(()=>a(),1e3);return r.post("pubsub/sub",{timeout:o.timeout,signal:o.signal,searchParams:Kut({arg:n,...o}),headers:o.headers}).catch(d=>{e.unsubscribe(n,s),c(d)}).then(d=>{clearTimeout(l),!!d&&(jut(d,{onMessage:s,onEnd:()=>e.unsubscribe(n,s),onError:o.onError}),a())}),u}return i})(t);async function jut(t,{onMessage:e,onEnd:r,onError:i}){i=i||Uut;try{for await(let n of t.ndjson())try{if(!n.from)continue;e({from:Lut(U8(n.from,"base64pad"),"base58btc"),data:U8(n.data,"base64pad"),seqno:U8(n.seqno,"base64pad"),topicIDs:n.topicIDs})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,i(s,!1,n)}}catch(n){Vut(n)||i(n,!0)}finally{r()}}var Vut=t=>{switch(t.type){case"aborted":return!0;case"abort":return!0;default:return t.name==="AbortError"}}});var mpe=p((FDt,bpe)=>{f();"use strict";bpe.exports=(t,e)=>{async function r(i,n){e.unsubscribe(i,n)}return r}});var wpe=p((KDt,vpe)=>{f();"use strict";var zut=cpe();vpe.exports=t=>{let e=new zut;return{ls:lpe()(t),peers:dpe()(t),publish:ppe()(t),subscribe:gpe()(t,e),unsubscribe:mpe()(t,e)}}});var Epe=p((jDt,_pe)=>{f();"use strict";var Hut=Vr(),$ut=ve(),Gut=Se();_pe.exports=$ut(t=>{async function*e(r={}){yield*(await t.post("refs/local",{timeout:r.timeout,signal:r.signal,transform:Hut,searchParams:Gut(r),headers:r.headers})).ndjson()}return e})});var xpe=p((VDt,Spe)=>{f();"use strict";var{CID:Wut}=(Ae(),ke),Yut=Vr(),Xut=ve(),Qut=Se();Spe.exports=Xut((t,e)=>Object.assign(async function*(i,n={}){let s=Array.isArray(i)?i:[i];yield*(await t.post("refs",{timeout:n.timeout,signal:n.signal,searchParams:Qut({arg:s.map(a=>`${a instanceof Uint8Array?Wut.decode(a):a}`),...n}),headers:n.headers,transform:Yut})).ndjson()},{local:Epe()(e)}))});var Ipe=p((zDt,Ape)=>{f();"use strict";var{CID:Zut}=(Ae(),ke),Jut=ve(),elt=Se();Ape.exports=Jut(t=>{async function*e(r={}){yield*(await t.post("repo/gc",{timeout:r.timeout,signal:r.signal,searchParams:elt(r),headers:r.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?Zut.parse(n.Key["/"]):null})})).ndjson()}return e})});var F8=p((HDt,Tpe)=>{f();"use strict";var tlt=ve(),rlt=Se();Tpe.exports=tlt(t=>{async function e(r={}){let n=await(await t.post("repo/stat",{timeout:r.timeout,signal:r.signal,searchParams:rlt(r),headers:r.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e})});var Ppe=p(($Dt,Rpe)=>{f();"use strict";var ilt=ve(),nlt=Se();Rpe.exports=ilt(t=>{async function e(r={}){return(await(await t.post("repo/version",{timeout:r.timeout,signal:r.signal,searchParams:nlt(r),headers:r.headers})).json()).Version}return e})});var Ope=p((GDt,Cpe)=>{f();"use strict";Cpe.exports=t=>({gc:Ipe()(t),stat:F8()(t),version:Ppe()(t)})});var qpe=p((WDt,kpe)=>{f();"use strict";var slt=ve(),olt=Se();kpe.exports=slt(t=>{async function e(r,i={}){let n=await t.post("resolve",{timeout:i.timeout,signal:i.signal,searchParams:olt({arg:r,...i}),headers:i.headers}),{Path:s}=await n.json();return s}return e})});var Dpe=p((YDt,Npe)=>{f();"use strict";var alt=ve(),clt=ae();Npe.exports=alt(t=>async(r={})=>{throw clt(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Mpe=p((XDt,Bpe)=>{f();"use strict";var ult=ve(),llt=Se();Bpe.exports=ult(t=>{async function*e(r={}){yield*(await t.post("stats/bw",{timeout:r.timeout,signal:r.signal,searchParams:llt(r),headers:r.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return e})});var Upe=p((QDt,Lpe)=>{f();"use strict";Lpe.exports=t=>({bitswap:P8()(t),bw:Mpe()(t),repo:F8()(t)})});var Kpe=p((ZDt,Fpe)=>{f();"use strict";var flt=ve(),dlt=Se();Fpe.exports=flt(t=>{async function e(r={}){await(await t.post("shutdown",{timeout:r.timeout,signal:r.signal,searchParams:dlt(r),headers:r.headers})).text()}return e})});var Vpe=p((JDt,jpe)=>{f();"use strict";var{Multiaddr:hlt}=tt(),plt=ve(),ylt=Se();jpe.exports=plt(t=>{async function e(r={}){let i=await t.post("swarm/addrs",{timeout:r.timeout,signal:r.signal,searchParams:ylt(r),headers:r.headers}),{Addrs:n}=await i.json();return Object.keys(n).map(s=>({id:s,addrs:(n[s]||[]).map(o=>new hlt(o))}))}return e})});var Hpe=p((eBt,zpe)=>{f();"use strict";var glt=ve(),blt=Se();zpe.exports=glt(t=>{async function e(r,i={}){let n=await t.post("swarm/connect",{timeout:i.timeout,signal:i.signal,searchParams:blt({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var Gpe=p((tBt,$pe)=>{f();"use strict";var mlt=ve(),vlt=Se();$pe.exports=mlt(t=>{async function e(r,i={}){let n=await t.post("swarm/disconnect",{timeout:i.timeout,signal:i.signal,searchParams:vlt({arg:r,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var Ype=p((rBt,Wpe)=>{f();"use strict";var{Multiaddr:wlt}=tt(),_lt=ve(),Elt=Se();Wpe.exports=_lt(t=>{async function e(r={}){let i=await t.post("swarm/addrs/local",{timeout:r.timeout,signal:r.signal,searchParams:Elt(r),headers:r.headers}),{Strings:n}=await i.json();return(n||[]).map(s=>new wlt(s))}return e})});var Qpe=p((iBt,Xpe)=>{f();"use strict";var{Multiaddr:Slt}=tt(),xlt=ve(),Alt=Se();Xpe.exports=xlt(t=>{async function e(r={}){let i=await t.post("swarm/peers",{timeout:r.timeout,signal:r.signal,searchParams:Alt(r),headers:r.headers}),{Peers:n}=await i.json();return(n||[]).map(s=>({addr:new Slt(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e})});var Jpe=p((nBt,Zpe)=>{f();"use strict";Zpe.exports=t=>({addrs:Vpe()(t),connect:Hpe()(t),disconnect:Gpe()(t),localAddrs:Ype()(t),peers:Qpe()(t)})});var t0e=p((sBt,e0e)=>{f();"use strict";var Ilt=Vr(),Tlt=ve(),Rlt=Se();e0e.exports=Tlt(t=>{async function e(r={}){let i=await t.post("version",{timeout:r.timeout,signal:r.signal,searchParams:Rlt(r),headers:r.headers});return Ilt(await i.json())}return e})});var n0e=p((oBt,i0e)=>{f();"use strict";var{CID:Plt}=(Ae(),ke),{multiaddr:Clt}=tt(),Olt=ox(),klt=bx(),qlt=_8(),Nlt=E8(),Dlt=S8(),Blt=(xt(),St),Mlt=(Tc(),df),{identity:r0e}=(bc(),ua),{bases:Llt,hashes:Ult,codecs:Flt}=(_v(),wv);function Klt(t={}){let e={name:r0e.name,code:r0e.code,encode:u=>u,decode:u=>u},r=Object.values(Llt);(t.ipld&&t.ipld.bases?t.ipld.bases:[]).forEach(u=>r.push(u));let i=new Dlt({bases:r,loadBase:t.ipld&&t.ipld.loadBase}),n=Object.values(Flt);[Blt,Mlt,e].concat(t.ipld&&t.ipld.codecs||[]).forEach(u=>n.push(u));let s=new qlt({codecs:n,loadCodec:t.ipld&&t.ipld.loadCodec}),o=Object.values(Ult);(t.ipld&&t.ipld.hashers?t.ipld.hashers:[]).forEach(u=>o.push(u));let a=new Nlt({hashers:o,loadHasher:t.ipld&&t.ipld.loadHasher});return{add:ele()(t),addAll:R8()(t),bitswap:ule()(t),block:mle()(t),bootstrap:Cle()(t),cat:kle()(t),commands:Nle()(t),config:Xle()(t),dag:hfe()(s,t),dht:Rfe()(t),diag:Bfe()(t),dns:Lfe()(t),files:hde()(t),get:yde()(t),getEndpointConfig:bde()(t),id:N8()(t),isOnline:wde()(t),key:Bde()(t),log:zde()(t),ls:Gde()(t),mount:Yde()(t),name:uhe()(t),object:Dhe()(s,t),pin:ipe()(t),ping:spe()(t),pubsub:wpe()(t),refs:xpe()(t),repo:Ope()(t),resolve:qpe()(t),start:Dpe()(t),stats:Upe()(t),stop:Kpe()(t),swarm:Jpe()(t),version:t0e()(t),bases:i,codecs:s,hashers:a}}i0e.exports={create:Klt,CID:Plt,multiaddr:Clt,globSource:Olt,urlSource:klt}});var K8=p((aBt,s0e)=>{f();"use strict";var jlt=ae(),Vlt=Pa(),zlt=Io(),Hlt=$h();function $lt(t,e){return zlt(t,r=>(e.addressBook.add(r.id,r.multiaddrs),r))}function Glt(t){let e=new Set;return Vlt(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*Wlt(t,e=1){let r=0;for await(let i of t)r++,yield i;if(r<e)throw jlt(new Error("not found"),"NOT_FOUND")}function Ylt(t,e){return e?Hlt(t,e):t}s0e.exports={storeAddresses:$lt,uniquePeers:Glt,requirePeers:Wlt,maybeLimitSource:Ylt}});var j8=p((cBt,o0e)=>{f();"use strict";var c0=new Map,Xlt=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function Qlt(t,e,r){for(;c0.get(r);){try{await t()}catch(i){setTimeout(()=>{throw i},1);break}if(!c0.get(r))break;await new Promise(i=>{let n=setTimeout(i,e);c0.set(r,n)})}}function Zlt(t,e,r){r=r||e;let i=Xlt(),n=setTimeout(()=>{Qlt(t,e,i)},r);return c0.set(i,n),i}function Jlt(t){let e=c0.get(t);e&&(clearTimeout(e),c0.delete(t))}o0e.exports={setDelayedInterval:Zlt,clearDelayedInterval:Jlt}});var h0e=p((uBt,d0e)=>{f();"use strict";var a0e=me(),eft=Object.assign(a0e("libp2p:peer-routing"),{error:a0e("libp2p:peer-routing:err")}),FE=ae(),{storeAddresses:c0e,uniquePeers:tft,requirePeers:rft}=K8(),u0e=ip(),{pipe:l0e}=Er(),ift=Jh(),nft=Ra(),sft=Pa(),{setDelayedInterval:oft,clearDelayedInterval:aft}=j8(),f0e=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(e._dht),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=oft(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await nft(this.getClosestPeers(this._peerId.id))}catch(e){eft.error(e)}}stop(){aft(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw FE(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw FE(new Error("Should not try to find self"),"ERR_FIND_SELF");let i=await l0e(u0e(...this._routers.map(n=>[n.findPeer(e,r)])),n=>sft(n,Boolean),n=>c0e(n,this._peerStore),n=>ift(n));if(i)return i;throw FE(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw FE(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*l0e(u0e(...this._routers.map(i=>i.getClosestPeers(e,r))),i=>c0e(i,this._peerStore),i=>tft(i),i=>rft(i))}};d0e.exports=f0e});var g0e=p((lBt,y0e)=>{f();"use strict";var b1=ae(),{messages:V8,codes:z8}=li(),{storeAddresses:cft,uniquePeers:uft,requirePeers:lft,maybeLimitSource:fft}=K8(),dft=ip(),{pipe:hft}=Er(),p0e=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(this.dht)}async*findProviders(e,r={}){if(!this.routers.length)throw b1(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*hft(dft(...this.routers.map(i=>i.findProviders(e,r))),i=>cft(i,this.libp2p.peerStore),i=>uft(i),i=>fft(i,r.maxNumProviders),i=>lft(i))}async provide(e){if(!this.routers.length)throw b1(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(r=>r.provide(e)))}put(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw b1(new Error(V8.NOT_STARTED_YET),z8.DHT_NOT_STARTED);return this.dht.put(e,r,i)}get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw b1(new Error(V8.NOT_STARTED_YET),z8.DHT_NOT_STARTED);return this.dht.get(e,r)}async getMany(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw b1(new Error(V8.NOT_STARTED_YET),z8.DHT_NOT_STARTED);return this.dht.getMany(e,r,i)}};y0e.exports=p0e});var H8=p((fBt,w0e)=>{f();"use strict";var pft=et(),{Multiaddr:b0e}=tt(),m0e=ae(),{codes:v0e}=li();function yft(t){typeof t=="string"&&(t=new b0e(t));let e;if(b0e.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw m0e(new Error(`${t} does not have a valid peer type`),v0e.ERR_INVALID_MULTIADDR);try{t=pft.createFromB58String(r)}catch(i){throw m0e(new Error(`${t} is not a valid peer type`),v0e.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}w0e.exports=yft});var E0e=p((dBt,_0e)=>{f();var u0=1e3,l0=u0*60,f0=l0*60,cd=f0*24,gft=cd*7,bft=cd*365.25;_0e.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return mft(t);if(r==="number"&&isFinite(t))return e.long?wft(t):vft(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function mft(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*bft;case"weeks":case"week":case"w":return r*gft;case"days":case"day":case"d":return r*cd;case"hours":case"hour":case"hrs":case"hr":case"h":return r*f0;case"minutes":case"minute":case"mins":case"min":case"m":return r*l0;case"seconds":case"second":case"secs":case"sec":case"s":return r*u0;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function vft(t){var e=Math.abs(t);return e>=cd?Math.round(t/cd)+"d":e>=f0?Math.round(t/f0)+"h":e>=l0?Math.round(t/l0)+"m":e>=u0?Math.round(t/u0)+"s":t+"ms"}function wft(t){var e=Math.abs(t);return e>=cd?KE(t,e,cd,"day"):e>=f0?KE(t,e,f0,"hour"):e>=l0?KE(t,e,l0,"minute"):e>=u0?KE(t,e,u0,"second"):t+" ms"}function KE(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var A0e=p((hBt,x0e)=>{f();"use strict";x0e.exports=S0e;var _ft=E0e(),vl=S0e.prototype,Eft=new Date%1e9;function Sft(){return(Math.random()*1e9>>>0)+Eft++}function S0e(t){t=t||{},this.id=t.id||Sft(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,i=this.items.length;i--;)e=this.items[i],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}vl.has=function(t){return t in this._lookup};vl.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};vl.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};vl.set=function(t,e,r){var i=this._lookup[t],n=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(n.meta=r.meta),r.refresh&&(n.refresh=r.ttl)),this};vl.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};vl.expire=function(t,e){var r=e||0,i=this._lookup[t];if(!i)return this;if(typeof r=="string"&&(r=_ft(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),r),i.expires=Number(new Date)+r,this};vl.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};vl.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var T0e=p((pBt,I0e)=>{f();"use strict";var{default:xft,Headers:Aft}=lx();function Ift({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function Tft(t){return xft(t,{headers:new Aft({accept:"application/dns-json"})})}function Rft(t,e){return`${e}_${t}`}I0e.exports={buildResource:Ift,fetch:Tft,getCacheKey:Rft}});var C0e=p((yBt,P0e)=>{f();"use strict";var R0e=me(),jE=R0e("dns-over-http-resolver");jE.error=R0e("dns-over-http-resolver:error");var Pft=A0e(),Hs=T0e(),VE=class{constructor({maxCache:e=100}={}){this._cache=new Pft({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let i=Math.floor(Math.random()*r),n=e[r];e[r]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",i=this._cache.get(Hs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Hs.fetch(Hs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Hs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){jE.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",i=this._cache.get(Hs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Hs.fetch(Hs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Hs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){jE.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",i=this._cache.get(Hs.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Hs.fetch(Hs.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Hs.getCacheKey(e,r),a,{ttl:c}),a}catch(s){jE.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};VE.Resolver=VE;P0e.exports=VE});var k0e=p((gBt,O0e)=>{f();"use strict";var Cft=C0e();O0e.exports=Cft});var N0e=p((bBt,q0e)=>{f();"use strict";var Oft=dg(),{code:kft}=Oft("dnsaddr");async function qft(t){let e=k0e(),r=new e,i=t.getPeerId(),[,n]=t.stringTuples().find(([a])=>a===kft)||[],o=(await r.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}q0e.exports={dnsaddrResolver:qft}});var zE=p((mBt,D0e)=>{f();"use strict";D0e.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var $8=p((vBt,Nft)=>{Nft.exports={name:"libp2p",version:"0.32.3",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-minor":"aegir release --type minor -t node -t browser","release-major":"aegir release --type major -t node -t browser",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=14.0.0"},browser:{"@motrix/nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use"]},dependencies:{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^6.1.1",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^5.1.1","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-take":"^1.0.0","libp2p-crypto":"^0.19.4","libp2p-interfaces":"^1.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.15.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^1.1.1",uint8arrays:"^2.1.3",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^0.10.1","@types/varint":"^6.0.0","abortable-iterator":"^3.0.0",aegir:"^33.1.1",buffer:"^6.0.3",delay:"^5.0.0","interop-libp2p":"^0.4.0","into-stream":"^6.0.0","ipfs-http-client":"^50.1.1","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.13.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.10.0","libp2p-interfaces-compliance-tests":"^1.0.0","libp2p-kad-dht":"^0.23.0","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.1","libp2p-noise":"^4.0.0","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.0",multihashes:"^4.0.2",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^11.1.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","dirkmc <dirkmdev@gmail.com>","Richard Littauer <richard.littauer@gmail.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Ryan Bell <ryan@piing.net>","a1300 <matthias-knopp@gmx.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Elven <mon.samuel@qq.com>","Franck Royer <franck@royer.one>","Giovanni T. Parra <fiatjaf@gmail.com>","Samlior <samlior@foxmail.com>","Thomas Eizinger <thomas@eizinger.io>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Didrik Nordstr\xF6m <didrik@betamos.se>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Ethan Lam <elmemphis2000@gmail.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Diogo Silva <fsdiogo@gmail.com>","Robert Kiel <robert.kiel@hoprnet.org>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","TJKoury <TJKoury@gmail.com>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","swedneck <40505480+swedneck@users.noreply.github.com>","Aleksei <vozhdb@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","Chris Bratlien <chrisbratlien@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","Bernd Strehl <bernd.strehl@gmail.com>","Francis Gulotta <wizard@roborooter.com>","isan_rivkin <isanrivkin@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","mcclure <andi.m.mcclure@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Fei Liu <liu.feiwood@gmail.com>"]}});var G8=p((wBt,Wa)=>{f();"use strict";var Dft=$8().version;Wa.exports.PROTOCOL_VERSION="ipfs/0.1.0";Wa.exports.AGENT_VERSION=`js-libp2p/${Dft}`;Wa.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";Wa.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";Wa.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";Wa.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";Wa.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";Wa.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";Wa.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var HE=p((_Bt,M0e)=>{f();"use strict";var B0e=60*1e3;M0e.exports={ADVERTISE_BOOT_DELAY:15*B0e,ADVERTISE_TTL:30*B0e,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var L0e=p(m1=>{f();(function(){var t,e,r,i,n,s,o,a;a=function(c){var u,l,d,h;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,d=(c&255<<8)>>>8,h=c&255,[u,l,d,h].join(".")},o=function(c){var u,l,d,h,y,g;for(u=[],d=h=0;h<=3&&c.length!==0;d=++h){if(d>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}g=e(c),y=g[0],l=g[1],c=c.substring(l),u.push(y)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},i=r("0"),s=r("a"),n=r("A"),e=function(c){var u,l,d,h,y;for(h=0,u=10,l="9",d=0,c.length>1&&c[d]==="0"&&(c[d+1]==="x"||c[d+1]==="X"?(d+=2,u=16):"0"<=c[d+1]&&c[d+1]<="9"&&(d++,u=8,l="7")),y=d;d<c.length;){if("0"<=c[d]&&c[d]<=l)h=h*u+(r(c[d])-i)>>>0;else if(u===16)if("a"<=c[d]&&c[d]<="f")h=h*u+(10+r(c[d])-s)>>>0;else if("A"<=c[d]&&c[d]<="F")h=h*u+(10+r(c[d])-n)>>>0;else break;else break;if(h>4294967295)throw new Error("too large");d++}if(d===y)throw new Error("empty octet");return[h,d]},t=function(){function c(u,l){var d,h,y,g;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(g=u.split("/",2),u=g[0],l=g[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(m){throw d=m,new Error("Invalid mask: "+l)}for(h=y=32;y>=0;h=--y)if(this.maskLong===4294967295<<32-h>>>0){this.bitmask=h;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(m){throw d=m,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,d,h;for(h=o(this.first),d=o(this.last),l=0;h<=d;)u(a(h),h,l),l++,h++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),m1.ip2long=o,m1.long2ip=a,m1.Netmask=t}).call(m1)});var K0e=p((SBt,F0e)=>{f();var Bft=L0e().Netmask,U0e=cA(),Mft=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],Lft=Mft.map(t=>new Bft(t));function Uft(t){for(let e of Lft)if(e.contains(t))return!0;return!1}function Fft(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}F0e.exports=t=>U0e.v6().test(t)?Fft(t):U0e().test(t)||t.startsWith("0")?Uft(t):!1});var W8=p((xBt,j0e)=>{f();"use strict";j0e.exports=K0e()});var z0e=p((ABt,V0e)=>{f();"use strict";var Kft=W8();function jft(t){let{address:e}=t.nodeAddress();return Kft(e)}V0e.exports=jft});var Y8=p((IBt,$0e)=>{f();"use strict";var H0e=z0e();function Vft(t,e){let r=H0e(t.multiaddr),i=H0e(e.multiaddr);return r&&!i?1:!r&&i||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function zft(t){return[...t].sort(Vft)}$0e.exports.publicAddressesFirst=zft});var W0e=p((TBt,X8)=>{f();"use strict";var G0e=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};X8.exports=G0e;X8.exports.default=G0e});var X0e=p((RBt,Q8)=>{f();"use strict";var Y0e=(t,...e)=>new Promise(r=>{r(t(...e))});Q8.exports=Y0e;Q8.exports.default=Y0e});var Z0e=p((PBt,Z8)=>{f();"use strict";var Hft=X0e(),Q0e=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,i=()=>{r--,e.length>0&&e.shift()()},n=(a,c,...u)=>{r++;let l=Hft(a,...u);c(l),l.then(i,i)},s=(a,c,...u)=>{r<t?n(a,c,...u):e.push(n.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};Z8.exports=Q0e;Z8.exports.default=Q0e});var eye=p((CBt,J0e)=>{f();"use strict";var J8=W0e(),$ft=Z0e();J0e.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,i=$ft(r);return Promise.all(t.map(n=>n&&typeof n.then=="function"?J8(n):typeof n=="function"?J8(i(()=>n())):J8(Promise.resolve(n))))}});var rye=p((OBt,tye)=>{f();"use strict";function Gft(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,i)=>e[i].equals(r))}tye.exports=Gft});var sye=p((kBt,nye)=>{f();"use strict";var ud=Ti(),$E=ud.Reader,iye=ud.Writer,zr=ud.util,$s=ud.roots["libp2p-peer-record"]||(ud.roots["libp2p-peer-record"]={});$s.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.peerId=zr.newBuffer([]),t.prototype.seq=zr.Long?zr.Long.fromBits(0,0,!0):0,t.prototype.addresses=zr.emptyArray,t.encode=function(r,i){if(i||(i=iye.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&i.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&i.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var n=0;n<r.addresses.length;++n)$s.PeerRecord.AddressInfo.encode(r.addresses[n],i.uint32(26).fork()).ldelim();return i},t.decode=function(r,i){r instanceof $E||(r=$E.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new $s.PeerRecord;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push($s.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof $s.PeerRecord)return r;var i=new $s.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?zr.base64.decode(r.peerId,i.peerId=zr.newBuffer(zr.base64.length(r.peerId)),0):r.peerId.length&&(i.peerId=r.peerId)),r.seq!=null&&(zr.Long?(i.seq=zr.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?i.seq=parseInt(r.seq,10):typeof r.seq=="number"?i.seq=r.seq:typeof r.seq=="object"&&(i.seq=new zr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<r.addresses.length;++n){if(typeof r.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=$s.PeerRecord.AddressInfo.fromObject(r.addresses[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=zr.newBuffer(n.peerId))),zr.Long){var s=new zr.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?zr.base64.encode(r.peerId,0,r.peerId.length):i.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?n.seq=i.longs===String?String(r.seq):r.seq:n.seq=i.longs===String?zr.Long.prototype.toString.call(r.seq):i.longs===Number?new zr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){n.addresses=[];for(var o=0;o<r.addresses.length;++o)n.addresses[o]=$s.PeerRecord.AddressInfo.toObject(r.addresses[o],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,ud.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.multiaddr=zr.newBuffer([]),e.encode=function(i,n){return n||(n=iye.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof $E||(i=$E.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new $s.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof $s.PeerRecord.AddressInfo)return i;var n=new $s.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?zr.base64.decode(i.multiaddr,n.multiaddr=zr.newBuffer(zr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=zr.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?zr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,ud.util.toJSONOptions)},e}(),t}();nye.exports=$s});var aye=p((qBt,oye)=>{f();"use strict";var Wft="libp2p-peer-record",Yft=Uint8Array.from([3,1]);oye.exports={ENVELOPE_DOMAIN_PEER_RECORD:Wft,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Yft}});var GE=p((NBt,lye)=>{f();"use strict";var{Multiaddr:Xft}=tt(),Qft=et(),Zft=rye(),{PeerRecord:cye}=sye(),{ENVELOPE_DOMAIN_PEER_RECORD:uye,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Jft}=aye(),ld=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:i=Date.now()}){this.domain=uye,this.codec=Jft,this.peerId=e,this.multiaddrs=r,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=cye.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof ld)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!Zft(this.multiaddrs,e.multiaddrs))}};ld.createFromProtobuf=t=>{let e=cye.decode(t),r=Qft.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new Xft(s.multiaddr)),n=Number(e.seq);return new ld({peerId:r,multiaddrs:i,seqNumber:n})};ld.DOMAIN=uye;lye.exports=ld});var eP=p((DBt,fye)=>{f();"use strict";var edt=y1(),tdt=GE();async function rdt(t){let e=new tdt({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await edt.seal(e,t.peerId);t.peerStore.addressBook.consumePeerRecord(r)}fye.exports.updateSelfPeerRecord=rdt});var rP=p((BBt,pye)=>{f();"use strict";var dye=me(),fd=Object.assign(dye("libp2p:transports"),{error:dye("libp2p:transports:err")}),idt=eye(),{codes:d0}=li(),v1=ae(),{updateSelfPeerRecord:hye}=eP(),tP=class{constructor({libp2p:e,upgrader:r,faultTolerance:i=WE.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,r,i={}){if(fd("adding %s",e),!e)throw v1(new Error(`Transport must have a valid key, was given '${e}'`),d0.ERR_INVALID_KEY);if(this._transports.has(e))throw v1(new Error("There is already a transport with this key"),d0.ERR_DUPLICATE_TRANSPORT);let n=new r({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,i]of this._listeners)for(fd("closing listeners for %s",r);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),fd("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let i=this.transportForMultiaddr(e);if(!i)throw v1(new Error(`No transport available for address ${String(e)}`),d0.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,r)}catch(n){throw n.code||(n.code=d0.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let i of r)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){fd("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let u of s){fd("creating listener for %s on %s",i,u);let l=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(l),l.on("listening",()=>hye(this.libp2p)),l.on("close",()=>hye(this.libp2p)),o.push(l.listen(u))}if(o.length===0){r.push(i);continue}if(!(await idt(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==WE.NO_FATAL)throw v1(new Error(`Transport (${i}) could not listen on any available address`),d0.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let i=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===WE.FATAL_ALL)throw v1(new Error(i),d0.ERR_NO_VALID_ADDRESSES);fd(`libp2p in dial mode only: ${i}`)}}async remove(e){if(fd("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},WE={FATAL_ALL:0,NO_FATAL:1};tP.FaultTolerance=WE;pye.exports=tP});var bye=p((MBt,gye)=>{f();"use strict";var ndt=hr(),{dnsaddrResolver:sdt}=N0e(),iP=zE(),{AGENT_VERSION:odt}=G8(),yye=HE(),{publicAddressesFirst:adt}=Y8(),{FaultTolerance:cdt}=rP(),udt={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},transportManager:{faultTolerance:cdt.FATAL_ALL},dialer:{maxParallelDials:iP.MAX_PARALLEL_DIALS,maxDialsPerPeer:iP.MAX_PER_PEER_DIALS,dialTimeout:iP.DIAL_TIMEOUT,resolvers:{dnsaddr:sdt},addressSorter:adt},host:{agentVersion:odt},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:yye.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:yye.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};gye.exports.validate=t=>{let e=ndt(udt,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var wye=p((LBt,vye)=>{f();"use strict";var{EventEmitter:ldt}=dr(),{Multiaddr:w1}=tt(),fdt=et(),mye=class extends ldt{constructor(e,{listen:r=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new w1(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new w1(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new w1(e))}addObservedAddr(e){let r=new w1(e),i=r.getPeerId();i&&fdt.createFromB58String(i).equals(this.peerId)&&(r=r.decapsulate(new w1(`/p2p/${this.peerId}`)));let n=r.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};vye.exports=mye});var Sye=p((UBt,Eye)=>{f();"use strict";var{EventEmitter:ddt}=dr(),nP=me()("latency-monitor:VisibilityChangeEmitter"),_ye=class extends ddt{constructor(){super();if(typeof document=="undefined"){nP('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?nP("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];nP(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};Eye.exports=_ye});var Iye=p((FBt,Aye)=>{f();"use strict";var{EventEmitter:hdt}=dr(),pdt=Sye(),Gc=me()("latency-monitor:LatencyMonitor"),xye=class extends hdt{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,Gc("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?Gc("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):Gc("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(Gc("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(Gc("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(Gc("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),ydt()&&(this._visibilityChangeEmitter=new pdt,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),Gc("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,Gc("MS: %s Data: %O",s,e._latencyData)};Gc("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function ydt(){return typeof window!="undefined"}Aye.exports=xye});var Rye=p((KBt,Tye)=>{f();"use strict";Tye.exports=function(){return Date.now()}});var sP=p((jBt,Cye)=>{f();"use strict";var YE=Rye(),Pye=class{constructor(e,r,i){let n=this;this._started=YE(),this._rescheduled=0,this._scheduled=r,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(YE()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=YE();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=YE(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function gdt(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new Pye(arguments[0],arguments[1],t)}Cye.exports=gdt});var Bye=p((VBt,Dye)=>{f();"use strict";var Oye=me(),Ko=Object.assign(Oye("libp2p:connection-manager"),{error:Oye("libp2p:connection-manager:err")}),kye=ae(),bdt=hr(),mdt=Iye(),XE=sP(),{EventEmitter:vdt}=dr(),wdt=et(),{codes:{ERR_INVALID_PARAMETERS:qye}}=li(),_dt={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},Nye=class extends vdt{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=bdt.call({ignoreUndefined:!0},_dt,r),this._options.maxConnections<this._options.minConnections)throw kye(new Error("Connection Manager maxConnections must be greater than minConnections"),qye);Ko("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this),this._latencyMonitor=new mdt({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||XE(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,Ko("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),Ko("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let i of r)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",r);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",i);let n=r+i;this._checkMaxLimit("maxData",n),Ko("metrics update",n),this._timer=XE(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let r=e.remotePeer,i=r.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let r=e.remotePeer.toB58String(),i=this.connections.get(r);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(r,i)):i&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!wdt.isPeerId(e))throw kye(new Error("peerId must be an instance of peer-id"),qye);let r=e.toB58String(),i=this.connections.get(r);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,r){let i=this._options[e];Ko("checking limit of %s. current value: %d of %d",e,r,i),r>i&&(Ko("%s: limit exceeded: %s, %d",this._peerId,e,r),this._maybeDisconnectOne())}async _autoDial(){let e=this._options.minConnections;if(this.size>=e){this._autoDialTimeout=XE(this._autoDial,this._options.autoDialInterval);return}let r=Array.from(this._libp2p.peerStore.peers.values()).sort((i,n)=>n.protocols&&n.protocols.length&&(!i.protocols||!i.protocols.length)||n.id.pubKey&&!i.id.pubKey?1:-1);for(let i=0;i<r.length&&this.size<e;i++)if(!this.get(r[i].id)){Ko("connecting to a peerStore stored peer %s",r[i].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(r[i].id),!this._started)return}catch(n){Ko.error("could not connect to peerStore stored peer",n)}}this._autoDialTimeout=XE(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));Ko("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let i=r[0];Ko("%s: lowest value peer is %s",this._peerId,i),Ko("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close();break}}}}};Dye.exports=Nye});var h0=p((zBt,Lye)=>{f();"use strict";var dd=Ti(),QE=dd.Reader,Mye=dd.Writer,Gs=dd.util,Ui=dd.roots["libp2p-circuit"]||(dd.roots["libp2p-circuit"]={});Ui.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,i){return i||(i=Mye.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&i.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&Ui.CircuitRelay.Peer.encode(r.srcPeer,i.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&Ui.CircuitRelay.Peer.encode(r.dstPeer,i.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&i.uint32(32).int32(r.code),i},t.decode=function(r,i){r instanceof QE||(r=QE.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Ui.CircuitRelay;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=Ui.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=Ui.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Ui.CircuitRelay)return r;var i=new Ui.CircuitRelay;switch(r.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=Ui.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=Ui.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(n.type=i.enums===String?Ui.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(n.srcPeer=Ui.CircuitRelay.Peer.toObject(r.srcPeer,i)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(n.dstPeer=Ui.CircuitRelay.Peer.toObject(r.dstPeer,i)),r.code!=null&&r.hasOwnProperty("code")&&(n.code=i.enums===String?Ui.CircuitRelay.Status[r.code]:r.code),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,dd.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.id=Gs.newBuffer([]),e.prototype.addrs=Gs.emptyArray,e.encode=function(i,n){if(n||(n=Mye.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof QE||(i=QE.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ui.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw Gs.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof Ui.CircuitRelay.Peer)return i;var n=new Ui.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?Gs.base64.decode(i.id,n.id=Gs.newBuffer(Gs.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?Gs.base64.decode(i.addrs[s],n.addrs[s]=Gs.newBuffer(Gs.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=Gs.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?Gs.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?Gs.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,dd.util.toJSONOptions)},e}(),t}();Lye.exports=Ui});var Kye=p((HBt,Fye)=>{f();"use strict";var{source:Uye}=Ha(),Edt=me(),Sdt=Edt("libp2p:stream:converter");function xdt({stream:t,remoteAddr:e,localAddr:r},i={}){let{sink:n,source:s}=t,o={async sink(c){i.signal&&(c=Uye(c,i.signal));try{await n(c)}catch(u){u.type!=="aborted"&&Sdt(u)}a()},source:i.signal?Uye(s,i.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}Fye.exports=xdt});var _1=p(($Bt,jye)=>{f();"use strict";jye.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var zye=p((GBt,Vye)=>{f();"use strict";var{EventEmitter:Adt}=dr(),{Multiaddr:Idt}=tt();Vye.exports=t=>{let e=new Map;async function r(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await t.dial(new Idt(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new Adt,{close:()=>Promise.resolve(),listen:r,getAddrs:i});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var oP=p((WBt,Gye)=>{f();"use strict";var{Multiaddr:Hye}=tt(),{CircuitRelay:hd}=h0();function $ye(t,e){t.write({type:hd.Type.STATUS,code:e})}function Tdt(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new Hye(r))}catch(r){throw $ye(e,t.type===hd.Type.HOP?hd.Status.HOP_DST_MULTIADDR_INVALID:hd.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new Hye(r))}catch(r){throw $ye(e,t.type===hd.Type.HOP?hd.Status.HOP_SRC_MULTIADDR_INVALID:hd.Status.STOP_SRC_MULTIADDR_INVALID),r}}Gye.exports={validateAddrs:Tdt}});var p0=p((YBt,Wye)=>{f();"use strict";var Rdt=O_(),Pdt=Oa(),Cdt=Hu();Wye.exports=t=>{let e=Pdt(),r=Rdt(t.source),i=Cdt(),n,s=t.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:r,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var JE=p((XBt,Jye)=>{f();"use strict";var Yye=me(),ZE=Object.assign(Yye("libp2p:circuit:stream-handler"),{error:Yye("libp2p:circuit:stream-handler:err")}),Xye=Bo(),Odt=p0(),{CircuitRelay:Qye}=h0(),Zye=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=Odt(this.stream),this.decoder=Xye.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=Qye.decode(e.value.slice());return ZE("read message type",r.type),r}ZE("read received no value, closing stream"),this.close()}write(e){ZE("write message type %s",e.type),this.shake.write(Xye.encode.single(Qye.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){ZE("closing the stream"),this.rest().sink([])}};Jye.exports=Zye});var uP=p((QBt,cP)=>{f();"use strict";var ege=me(),E1=Object.assign(ege("libp2p:circuit:stop"),{error:ege("libp2p:circuit:stop:err")}),{CircuitRelay:aP}=h0(),kdt=_1(),qdt=JE(),{validateAddrs:Ndt}=oP();cP.exports.handleStop=function({connection:e,request:r,streamHandler:i}){try{Ndt(r,i)}catch(n){return E1.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return E1("stop request is valid"),i.write({type:aP.Type.STATUS,code:aP.Status.SUCCESS}),i.rest()};cP.exports.stop=async function({connection:e,request:r}){let{stream:i}=await e.newStream([kdt.relay]);E1("starting stop request to %s",e.remotePeer.toB58String());let n=new qdt({stream:i});n.write(r);let s=await n.read();if(!s)return n.close();if(s.code===aP.Status.SUCCESS)return E1("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();E1("stop request failed with code %d",s.code),n.close()}});var lP=p((ZBt,oge)=>{f();"use strict";var tge=me(),Wc=Object.assign(tge("libp2p:circuit:hop"),{error:tge("libp2p:circuit:hop:err")}),rge=ae(),Ddt=et(),{validateAddrs:Bdt}=oP(),ige=JE(),{CircuitRelay:ls}=h0(),{pipe:Mdt}=Er(),{codes:nge}=li(),{stop:Ldt}=uP(),sge=_1();async function Udt({connection:t,request:e,streamHandler:r,circuit:i}){if(!i._options.hop.enabled)return Wc("HOP request received but we are not acting as a relay"),r.end({type:ls.Type.STATUS,code:ls.Status.HOP_CANT_SPEAK_RELAY});try{Bdt(e,r)}catch(u){return Wc.error("invalid hop request via peer %s",t.remotePeer.toB58String(),u)}if(!e.dstPeer){Wc("HOP request received but we do not receive a dstPeer");return}let n=new Ddt(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return Wc("HOP request received but we are not connected to the destination peer"),r.end({type:ls.Type.STATUS,code:ls.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:ls.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await Ldt({connection:s,request:o})}catch(u){return Wc.error(u)}Wc("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:ls.Type.STATUS,code:ls.Status.SUCCESS});let c=r.rest();return Mdt(c,a,c)}async function Fdt({connection:t,request:e}){let{stream:r}=await t.newStream([sge.relay]),i=new ige({stream:r});i.write(e);let n=await i.read();if(!n)throw rge(new Error("HOP request had no response"),nge.ERR_HOP_REQUEST_FAILED);if(n.code===ls.Status.SUCCESS)return Wc("hop request was successful"),i.rest();throw Wc("hop request failed with code %d, closing stream",n.code),i.close(),rge(new Error(`HOP request failed with code ${n.code}`),nge.ERR_HOP_REQUEST_FAILED)}async function Kdt({connection:t}){let{stream:e}=await t.newStream([sge.relay]),r=new ige({stream:e});r.write({type:ls.Type.CAN_HOP});let i=await r.read();return await r.close(),!(!i||i.code!==ls.Status.SUCCESS)}function jdt({connection:t,streamHandler:e,circuit:r}){let i=r._options.hop.enabled;Wc("can hop (%s) request from %s",i,t.remotePeer.toB58String()),e.end({type:ls.Type.STATUS,code:i?ls.Status.SUCCESS:ls.Status.HOP_CANT_SPEAK_RELAY})}oge.exports={handleHop:Udt,hop:Fdt,canHop:Kdt,handleCanHop:jdt}});var dge=p((JBt,fge)=>{f();"use strict";var age=me(),Yc=Object.assign(age("libp2p:circuit"),{error:age("libp2p:circuit:err")}),Vdt=ae(),zdt=lf(),{Multiaddr:S1}=tt(),cge=et(),{CircuitRelay:x1}=h0(),{codes:Hdt}=li(),uge=Kye(),{relay:$dt}=_1(),Gdt=zye(),{handleCanHop:Wdt,handleHop:Ydt,hop:Xdt}=lP(),{handleStop:Qdt}=uP(),Zdt=JE(),Jdt=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),lge=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle($dt,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let i=new Zdt({stream:r}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case x1.Type.CAN_HOP:{Yc("received CAN_HOP request from %s",e.remotePeer.toB58String()),await Wdt({circuit:s,connection:e,streamHandler:i});break}case x1.Type.HOP:{Yc("received HOP request from %s",e.remotePeer.toB58String()),o=await Ydt({connection:e,request:n,streamHandler:i,circuit:s});break}case x1.Type.STOP:{Yc("received STOP request from %s",e.remotePeer.toB58String()),o=await Qdt({connection:e,request:n,streamHandler:i});break}default:Yc("Request of type %s not supported",n.type)}if(o){let a=new S1(n.dstPeer.addrs[0]),c=new S1(n.srcPeer.addrs[0]),u=uge({stream:o,remoteAddr:a,localAddr:c}),l=n.type===x1.Type.HOP?"relay":"inbound";Yc("new %s connection %s",l,u.remoteAddr);let d=await this._upgrader.upgradeInbound(u);Yc("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(d)}}async dial(e,r){let i=e.toString().split("/p2p-circuit"),n=new S1(i[0]),s=new S1(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let h="Circuit relay dial failed as addresses did not have peer id";throw Yc.error(h),Vdt(new Error(h),Hdt.ERR_RELAYED_DIAL)}let c=cge.createFromB58String(o),u=cge.createFromB58String(a),l=!1,d=this._connectionManager.get(c);d||(d=await this._dialer.connectToPeer(n,r),l=!0);try{let h=await Xdt({connection:d,request:{type:x1.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(m=>m.bytes)},dstPeer:{id:u.toBytes(),addrs:[new S1(s).bytes]}}}),y=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),g=uge({stream:h,remoteAddr:e,localAddr:y});return Yc("new outbound connection %s",g.remoteAddr),this._upgrader.upgradeOutbound(g)}catch(h){throw Yc.error("Circuit relay dial failed",h),l&&await d.close(),h}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,Gdt(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>zdt.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[Jdt])}};fge.exports=lge});var fP=p((eMt,hge)=>{f();"use strict";var{CID:eht}=(Ae(),ke),{sha256:tht}=(ei(),Ur);hge.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await tht.digest(e);return eht.createV0(r)}});var wge=p((tMt,vge)=>{f();"use strict";var pge=me(),yge=Object.assign(pge("libp2p:auto-relay"),{error:pge("libp2p:auto-relay:err")}),rht=ct(),iht=Je(),{Multiaddr:nht}=tt(),sht=et(),{relay:oht}=_1(),{canHop:aht}=lP(),{namespaceToCid:cht}=fP(),{CIRCUIT_PROTO_CODE:uht,HOP_METADATA_KEY:gge,HOP_METADATA_VALUE:bge,RELAY_RENDEZVOUS_NS:lht}=HE(),mge=class{constructor({libp2p:e,maxListeners:r=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{yge.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:r}){let i=e.toB58String(),n=r.find(s=>s===oht);if(!n&&this._listenRelays.has(i)){this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(uht)){yge(`relayed connection to ${i} will not be used to hop on`);return}await aht({connection:s})&&(this._peerStore.metadataBook.set(e,gge,rht(bge)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i)}async _addListenRelay(e,r){if(this._listenRelays.size>=this.maxListeners)return;let i=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!i||!i.length)return;let n=`${i[0].toString()}/p2p-circuit`;this._listenRelays.add(r);try{await this._transportManager.listen([new nht(n)])}catch(s){this._onError(s),this._listenRelays.delete(r)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[];for(let[i,n]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(i)||e.includes(i))continue;let s=n.get(gge);if(!s||iht(s)!==bge)continue;let o=sht.createFromB58String(i),a=this._connectionManager.get(o);if(!a){r.push(o);continue}if(await this._addListenRelay(a,i),this._listenRelays.size>=this.maxListeners)return}for(let i of r)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await cht(lht);for await(let n of this._libp2p.contentRouting.findProviders(i)){if(!n.multiaddrs.length)continue;let s=n.id;if(this._peerStore.addressBook.add(s,n.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};vge.exports=mge});var Age=p((rMt,xge)=>{f();"use strict";var _ge=me(),Ege=Object.assign(_ge("libp2p:relay"),{error:_ge("libp2p:relay:err")}),{setDelayedInterval:fht,clearDelayedInterval:dht}=j8(),hht=wge(),{namespaceToCid:pht}=fP(),{RELAY_RENDEZVOUS_NS:yht}=HE(),Sge=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new hht({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=fht(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){dht(this._timeout)}async _advertiseService(){try{let e=await pht(yht);await this._libp2p.contentRouting.provide(e)}catch(e){e.code==="NO_ROUTERS_AVAILABLE"?(Ege.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):Ege.error(e)}}};xge.exports=Sge});var Pge=p((nMt,Rge)=>{f();var Ige=WI(),Tge=Hu();Rge.exports=class{constructor(){this._buffer=new Ige,this._waitingConsumers=new Ige}push(e){let{promise:r,resolve:i}=Tge();return this._buffer.push({chunk:e,resolve:i}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=Tge();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var Oge=p((sMt,Cge)=>{f();"use strict";Cge.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let i=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(i,r.indent.repeat(e))}});var kge=p(()=>{f()});var Bge=p((cMt,Dge)=>{f();"use strict";var qge=kge(),Nge=/\s+at.*(?:\(|\s)(.*)\)?/,ght=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,bht=typeof qge.homedir=="undefined"?"":qge.homedir();Dge.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let i=r.match(Nge);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!ght.test(n)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(Nge,(i,n)=>i.replace(n,n.replace(bht,"~"))):r).join(`
`))});var dP=p((uMt,Lge)=>{f();"use strict";var mht=Oge(),vht=Bge(),wht=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Mge=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let r=e.map(i=>typeof i.stack=="string"?wht(vht(i.stack)):String(i)).join(`
`);r=`
`+mht(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};Lge.exports=Mge});var Uge=p((lMt,pP)=>{f();"use strict";var hP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},A1=class{static fn(e){return(...r)=>new A1((i,n,s)=>{r.push(s),e(...r).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new hP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(A1.prototype,Promise.prototype);pP.exports=A1;pP.exports.CancelError=hP});var Kge=p((fMt,eS)=>{f();"use strict";var Fge=dP(),_ht=Uge(),yP=class extends Error{},Eht=(t,e)=>new _ht((r,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,d=new Set,h=()=>(a.length===s&&(r(a),l=!0),u-c.length<s&&(i(new Fge(c)),l=!0),l),y=()=>{for(let g of t)!d.has(g)&&typeof g.cancel=="function"&&g.cancel()};n(y);for(let g of t)u++,(async()=>{try{let m=await g;if(l)return;if(!o(m))throw new yP("Value does not satisfy filter");a.push(m)}catch(m){c.push(m)}finally{d.add(g),!l&&h()&&y()}})();s>u&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),y())});eS.exports=Eht;eS.exports.AggregateError=Fge;eS.exports.FilterError=yP});var jge=p((dMt,bP)=>{f();"use strict";var gP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},I1=class{static fn(e){return(...r)=>new I1((i,n,s)=>{r.push(s),e(...r).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new gP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(I1.prototype,Promise.prototype);bP.exports=I1;bP.exports.CancelError=gP});var zge=p((hMt,mP)=>{f();"use strict";var Vge=Kge(),Sht=jge();mP.exports=(t,e)=>{let r=Vge(t,{...e,count:1});return Sht.fn(async i=>{i(()=>{r.cancel()});let[n]=await r;return n})()};mP.exports.AggregateError=Vge.AggregateError});var Gge=p((pMt,$ge)=>{f();"use strict";var xht=ae(),Aht=Ll().default,{anySignal:Iht}=Ul(),Tht=Pge(),Rht=zge(),Hge=class{constructor({addrs:e,dialAction:r,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw xht(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");let i=new Tht;r.forEach(o=>i.push(o));let n=this.addrs.map(()=>new Aht),s=0;try{return await Rht(this.addrs.map(async(o,a)=>{let c=await i.shift(),u;try{let l=n[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?Iht([l,e.signal]):l}),n.splice(a,1)}finally{s++,this.addrs.length-s>=r.length?i.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return u}))}finally{n.map(o=>o.abort()),r.forEach(o=>this.dialer.releaseToken(o))}}};$ge.exports=Hge});var Qge=p((yMt,Xge)=>{f();"use strict";var Wge=me(),y0=Object.assign(Wge("libp2p:dialer"),{error:Wge("libp2p:dialer:err")}),vP=ae(),{Multiaddr:wP}=tt(),Pht=cI(),{AbortError:Cht}=Ha(),{anySignal:Oht}=Ul(),kht=Gge(),{publicAddressesFirst:qht}=Y8(),Nht=H8(),{codes:tS}=li(),{DIAL_TIMEOUT:Dht,MAX_PARALLEL_DIALS:Bht,MAX_PER_PEER_DIALS:Mht,MAX_ADDRS_TO_DIAL:Lht}=zE(),Yge=class{constructor({transportManager:e,peerStore:r,addressSorter:i=qht,maxParallelDials:n=Bht,maxAddrsToDial:s=Lht,dialTimeout:o=Dht,maxDialsPerPeer:a=Mht,resolvers:c={}}){this.transportManager=e,this.peerStore=r,this.addressSorter=i,this.maxParallelDials=n,this.maxAddrsToDial=s,this.timeout=o,this.maxDialsPerPeer=a,this.tokens=[...new Array(n)].map((u,l)=>l),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(let[u,l]of Object.entries(c))wP.resolvers.set(u,l)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){y0.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new Cht("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,r={}){let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw vP(new Error("The dial request has no valid addresses"),tS.ERR_NO_VALID_ADDRESSES);let n=this._pendingDials.get(i.id)||this._createPendingDial(i,r);try{let s=await n.promise;return y0("dial succeeded to %s",i.id),s}catch(s){throw n.controller.signal.aborted&&(s.code=tS.ERR_TIMEOUT),y0.error(s),s}finally{n.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((s,o)=>{this._pendingDialTargets.set(r,{resolve:s,reject:o})}),n=await Promise.race([this._createDialTarget(e),i]);return this._pendingDialTargets.delete(r),n}async _createDialTarget(e){let{id:r,multiaddrs:i}=Nht(e);i&&this.peerStore.addressBook.add(r,i);let n=this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter)||[];wP.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw this.peerStore.delete(r),vP(new Error("dial with more addresses than allowed"),tS.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:o}}_createPendingDial(e,r={}){let i=(u,l)=>{if(l.signal.aborted)throw vP(new Error("already aborted"),tS.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},n=new kht({addrs:e.addrs,dialAction:i,dialer:this}),s=new Pht(this.timeout),o=[s.signal];r.signal&&o.push(r.signal);let a=Oht(o),c={dialRequest:n,controller:s,promise:n.run({...r,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,r);return y0("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(y0("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new wP(e.toString()),await e.resolve()}catch(r){return y0.error(`multiaddr ${e} could not be resolved`),[]}}};Xge.exports=Yge});var Jge=p((gMt,Zge)=>{f();"use strict";function Uht(t){return t>=55296&&t<=56319}function Fht(t){return t>=56320&&t<=57343}Zge.exports=function(e,r,i){if(typeof r!="string")throw new Error("Input must be string");for(var n=r.length,s=0,o,a,c=0;c<n;c+=1){if(o=r.charCodeAt(c),a=r[c],Uht(o)&&Fht(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===i)return r.slice(0,c+1);if(s>i)return r.slice(0,c-a.length+1)}return r}});var tbe=p((bMt,ebe)=>{f();"use strict";function Kht(t){return t>=55296&&t<=56319}function jht(t){return t>=56320&&t<=57343}ebe.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,i=0,n=null,s=null,o=0;o<r;o++)n=e.charCodeAt(o),jht(n)?s!=null&&Kht(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var ibe=p((mMt,rbe)=>{f();"use strict";var Vht=Jge(),zht=tbe();rbe.exports=Vht.bind(null,zht)});var obe=p((vMt,sbe)=>{f();"use strict";var Hht=ibe(),$ht=/[\/\?<>\\:\*\|"]/g,Ght=/[\x00-\x1f\x80-\x9f]/g,Wht=/^\.+$/,Yht=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,Xht=/[\. ]+$/;function nbe(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace($ht,e).replace(Ght,e).replace(Wht,e).replace(Yht,e).replace(Xht,e);return Hht(r,255)}sbe.exports=function(t,e){var r=e&&e.replacement||"",i=nbe(t,r);return r===""?i:nbe(i,"")}});var lbe=p((wMt,ube)=>{f();var g0=lt();hc();Wt();var Me=g0.asn1,b0=ube.exports=g0.pkcs7asn1=g0.pkcs7asn1||{};g0.pkcs7=g0.pkcs7||{};g0.pkcs7.asn1=b0;var abe={name:"ContentInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};b0.contentInfoValidator=abe;var cbe={name:"EncryptedContentInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};b0.envelopedDataValidator={name:"EnvelopedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(cbe)};b0.encryptedDataValidator={name:"EncryptedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"}].concat(cbe)};var Qht={name:"SignerInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Me.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};b0.signedDataValidator={name:"SignedData",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},abe,{name:"SignedData.Certificates",tagClass:Me.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Me.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SET,capture:"signerInfos",optional:!0,value:[Qht]}]};b0.recipientInfoValidator={name:"RecipientInfo",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Me.Class.UNIVERSAL,type:Me.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Me.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:Me.Class.UNIVERSAL,type:Me.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var dbe=p((_Mt,fbe)=>{f();var pd=lt();Wt();pd.mgf=pd.mgf||{};var Zht=fbe.exports=pd.mgf.mgf1=pd.mgf1=pd.mgf1||{};Zht.create=function(t){var e={generate:function(r,i){for(var n=new pd.util.ByteBuffer,s=Math.ceil(i/t.digestLength),o=0;o<s;o++){var a=new pd.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),n.putBuffer(t.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var pbe=p((EMt,hbe)=>{f();var rS=lt();dbe();hbe.exports=rS.mgf=rS.mgf||{};rS.mgf.mgf1=rS.mgf1});var gbe=p((SMt,ybe)=>{f();var yd=lt();mu();Wt();var Jht=ybe.exports=yd.pss=yd.pss||{};Jht.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,i=e.digestLength,n=t.salt||null;typeof n=="string"&&(n=yd.util.createBuffer(n));var s;if("saltLength"in t)s=t.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||yd.random,a={};return a.encode=function(c,u){var l,d=u-1,h=Math.ceil(d/8),y=c.digest().getBytes();if(h<i+s+2)throw new Error("Message is too long to encrypt.");var g;n===null?g=o.getBytesSync(s):g=n.bytes();var m=new yd.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(y),m.putBytes(g),e.start(),e.update(m.getBytes());var E=e.digest().getBytes(),v=new yd.util.ByteBuffer;v.fillWithByte(0,h-s-i-2),v.putByte(1),v.putBytes(g);var A=v.getBytes(),R=h-i-1,F=r.generate(E,R),q="";for(l=0;l<R;l++)q+=String.fromCharCode(A.charCodeAt(l)^F.charCodeAt(l));var N=65280>>8*h-d&255;return q=String.fromCharCode(q.charCodeAt(0)&~N)+q.substr(1),q+E+String.fromCharCode(188)},a.verify=function(c,u,l){var d,h=l-1,y=Math.ceil(h/8);if(u=u.substr(-y),y<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(y-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=y-i-1,m=u.substr(0,g),E=u.substr(g,i),v=65280>>8*y-h&255;if((m.charCodeAt(0)&v)!=0)throw new Error("Bits beyond keysize not zero as expected.");var A=r.generate(E,g),R="";for(d=0;d<g;d++)R+=String.fromCharCode(m.charCodeAt(d)^A.charCodeAt(d));R=String.fromCharCode(R.charCodeAt(0)&~v)+R.substr(1);var F=y-i-s-2;for(d=0;d<F;d++)if(R.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(F)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var q=R.substr(-s),N=new yd.util.ByteBuffer;N.fillWithByte(0,8),N.putBytes(c),N.putBytes(q),e.start(),e.update(N.getBytes());var z=e.digest().getBytes();return E===z},a}});var EP=p((xMt,wbe)=>{f();var Oe=lt();Qd();hc();cv();bu();pbe();Wd();dv();gbe();$y();Wt();var O=Oe.asn1,Ie=wbe.exports=Oe.pki=Oe.pki||{},nt=Ie.oids,Hr={};Hr.CN=nt.commonName;Hr.commonName="CN";Hr.C=nt.countryName;Hr.countryName="C";Hr.L=nt.localityName;Hr.localityName="L";Hr.ST=nt.stateOrProvinceName;Hr.stateOrProvinceName="ST";Hr.O=nt.organizationName;Hr.organizationName="O";Hr.OU=nt.organizationalUnitName;Hr.organizationalUnitName="OU";Hr.E=nt.emailAddress;Hr.emailAddress="E";var bbe=Oe.pki.rsa.publicKeyValidator,ept={name:"Certificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},bbe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},tpt={name:"rsapss",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},rpt={name:"CertificationRequestInfo",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},bbe,{name:"CertificationRequestInfo.attributes",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:O.Class.UNIVERSAL,type:O.Type.SET,constructed:!0}]}]}]},ipt={name:"CertificationRequest",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[rpt,{name:"CertificationRequest.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Ie.RDNAttributesAsArray=function(t,e){for(var r=[],i,n,s,o=0;o<t.value.length;++o){i=t.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=O.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in nt&&(s.name=nt[s.type],s.name in Hr&&(s.shortName=Hr[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};Ie.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var i=t[r],n=O.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in nt&&(a.name=nt[a.type],a.name in Hr&&(a.shortName=Hr[a.name])),a.type===nt.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Ie.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function wl(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,i,n=0;r===null&&n<t.attributes.length;++n)i=t.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(r=i);return r}var iS=function(t,e,r){var i={};if(t!==nt["RSASSA-PSS"])return i;r&&(i={hash:{algorithmOid:nt.sha1},mgf:{algorithmOid:nt.mgf1,hash:{algorithmOid:nt.sha1}},saltLength:20});var n={},s=[];if(!O.validate(e,tpt,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=O.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=O.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=O.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i};Ie.certificateFromPem=function(t,e,r){var i=Oe.pem.decode(t)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=O.fromDer(i.body,r);return Ie.certificateFromAsn1(s,e)};Ie.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:O.toDer(Ie.certificateToAsn1(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Ie.publicKeyFromPem=function(t){var e=Oe.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=O.fromDer(e.body);return Ie.publicKeyFromAsn1(i)};Ie.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:O.toDer(Ie.publicKeyToAsn1(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Ie.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:O.toDer(Ie.publicKeyToRSAPublicKey(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Ie.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||Oe.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=O.toDer(Ie.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":n=O.toDer(Ie.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(n);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Ie.certificationRequestFromPem=function(t,e,r){var i=Oe.pem.decode(t)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=O.fromDer(i.body,r);return Ie.certificationRequestFromAsn1(s,e)};Ie.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:O.toDer(Ie.certificationRequestToAsn1(t)).getBytes()};return Oe.pem.encode(r,{maxline:e})};Ie.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return wl(t.issuer,e)},t.issuer.addField=function(e){Ws([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return wl(t.subject,e)},t.subject.addField=function(e){Ws([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){Ws(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){Ws(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)mbe(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,i,n=0;r===null&&n<t.extensions.length;++n)i=t.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(r=i);return r},t.sign=function(e,r){t.md=r||Oe.md.sha1.create();var i=nt[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.tbsCertificate=Ie.getTBSCertificate(t);var s=O.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var i=e.issuer,n=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in nt){var a=nt[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o=Oe.md.sha512.create();break;case"RSASSA-PSS":o=Oe.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||Ie.getTBSCertificate(e),u=O.toDer(c);o.update(u.getBytes())}if(o!==null){var l;switch(e.signatureOid){case nt.sha1WithRSAEncryption:l=void 0;break;case nt["RSASSA-PSS"]:var d,h;if(d=nt[e.signatureParameters.mgf.hash.algorithmOid],d===void 0||Oe.md[d]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=d,s}if(h=nt[e.signatureParameters.mgf.algorithmOid],h===void 0||Oe.mgf[h]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=h,s}if(h=Oe.mgf[h].create(Oe.md[d].create()),d=nt[e.signatureParameters.hash.algorithmOid],d===void 0||Oe.md[d]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:d};l=Oe.pss.create(Oe.md[d].create(),h,e.signatureParameters.saltLength);break}r=t.publicKey.verify(o.digest().getBytes(),e.signature,l)}return r},t.isIssuer=function(e){var r=!1,i=t.issuer,n=e.subject;if(i.hash&&n.hash)r=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){r=!0;for(var s,o,a=0;r&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return Ie.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=nt.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var i=t.extensions[r];if(i.id===e){var n=t.generateSubjectKeyIdentifier().getBytes();return Oe.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},t};Ie.certificateFromAsn1=function(t,e){var r={},i=[];if(!O.validate(t,ept,r,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=O.derToOid(r.publicKeyOid);if(s!==Ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Ie.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=Oe.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=Oe.asn1.derToOid(r.certSignatureOid),o.signatureParameters=iS(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=Oe.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=iS(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(O.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(O.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,e){if(o.md=null,o.signatureOid in nt){var s=nt[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Oe.md.sha512.create();break;case"RSASSA-PSS":o.md=Oe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var u=O.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=Oe.md.sha1.create();o.issuer.getField=function(h){return wl(o.issuer,h)},o.issuer.addField=function(h){Ws([h]),o.issuer.attributes.push(h)},o.issuer.attributes=Ie.RDNAttributesAsArray(r.certIssuer,l),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var d=Oe.md.sha1.create();return o.subject.getField=function(h){return wl(o.subject,h)},o.subject.addField=function(h){Ws([h]),o.subject.attributes.push(h)},o.subject.attributes=Ie.RDNAttributesAsArray(r.certSubject,d),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=d.digest().toHex(),r.certExtensions?o.extensions=Ie.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=Ie.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};Ie.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var i=t.value[r],n=0;n<i.value.length;++n)e.push(Ie.certificateExtensionFromAsn1(i.value[n]));return e};Ie.certificateExtensionFromAsn1=function(t){var e={};if(e.id=O.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===O.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in nt){if(e.name=nt[e.id],e.name==="keyUsage"){var r=O.fromDer(e.value),i=0,n=0;r.value.length>1&&(i=r.value.charCodeAt(1),n=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var r=O.fromDer(e.value);r.value.length>0&&r.value[0].type===O.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===O.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=O.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=O.fromDer(e.value),o=0;o<r.value.length;++o){var a=O.derToOid(r.value[o].value);a in nt?e[nt[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=O.fromDer(e.value),i=0;r.value.length>1&&(i=r.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=O.fromDer(e.value),u=0;u<r.value.length;++u){c=r.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=Oe.util.bytesToIP(c.value);break;case 8:l.oid=O.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=O.fromDer(e.value);e.subjectKeyIdentifier=Oe.util.bytesToHex(r.value)}}return e};Ie.certificationRequestFromAsn1=function(t,e){var r={},i=[];if(!O.validate(t,ipt,r,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=O.derToOid(r.publicKeyOid);if(s!==Ie.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Ie.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=Oe.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=iS(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=Oe.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=iS(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){if(o.md=null,o.signatureOid in nt){var s=nt[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Oe.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Oe.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Oe.md.sha512.create();break;case"RSASSA-PSS":o.md=Oe.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var a=O.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=Oe.md.sha1.create();return o.subject.getField=function(u){return wl(o.subject,u)},o.subject.addField=function(u){Ws([u]),o.subject.attributes.push(u)},o.subject.attributes=Ie.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Ie.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(u){return wl(o,u)},o.addAttribute=function(u){Ws([u]),o.attributes.push(u)},o.attributes=Ie.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};Ie.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return wl(t.subject,e)},t.subject.addField=function(e){Ws([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return wl(t,e)},t.addAttribute=function(e){Ws([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){Ws(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){Ws(e),t.attributes=e},t.sign=function(e,r){t.md=r||Oe.md.sha1.create();var i=nt[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.certificationRequestInfo=Ie.getCertificationRequestInfo(t);var s=O.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){if(t.signatureOid in nt){var i=nt[t.signatureOid];switch(i){case"sha1WithRSAEncryption":r=Oe.md.sha1.create();break;case"md5WithRSAEncryption":r=Oe.md.md5.create();break;case"sha256WithRSAEncryption":r=Oe.md.sha256.create();break;case"sha384WithRSAEncryption":r=Oe.md.sha384.create();break;case"sha512WithRSAEncryption":r=Oe.md.sha512.create();break;case"RSASSA-PSS":r=Oe.md.sha256.create();break}}if(r===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=t.signatureOid,n}var s=t.certificationRequestInfo||Ie.getCertificationRequestInfo(t),o=O.toDer(s);r.update(o.getBytes())}if(r!==null){var a;switch(t.signatureOid){case nt.sha1WithRSAEncryption:break;case nt["RSASSA-PSS"]:var c,u;if(c=nt[t.signatureParameters.mgf.hash.algorithmOid],c===void 0||Oe.md[c]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=t.signatureParameters.mgf.hash.algorithmOid,n.name=c,n}if(u=nt[t.signatureParameters.mgf.algorithmOid],u===void 0||Oe.mgf[u]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=t.signatureParameters.mgf.algorithmOid,n.name=u,n}if(u=Oe.mgf[u].create(Oe.md[c].create()),c=nt[t.signatureParameters.hash.algorithmOid],c===void 0||Oe.md[c]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=t.signatureParameters.hash.algorithmOid,n.name=c,n}a=Oe.pss.create(Oe.md[c].create(),u,t.signatureParameters.saltLength);break}e=t.publicKey.verify(r.digest().getBytes(),t.signature,a)}return e},t};function m0(t){for(var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),r,i,n=t.attributes,s=0;s<n.length;++s){r=n[s];var o=r.value,a=O.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===O.Type.UTF8&&(o=Oe.util.encodeUtf8(o))),i=O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(r.type).getBytes()),O.create(O.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function Ws(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name=="undefined"&&(e.type&&e.type in Ie.oids?e.name=Ie.oids[e.type]:e.shortName&&e.shortName in Hr&&(e.name=Ie.oids[Hr[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in Ie.oids)e.type=Ie.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in Hr&&(e.shortName=Hr[e.name]),e.type===nt.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=O.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(Ie.certificateExtensionToAsn1(mbe(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function mbe(t,e){if(e=e||{},typeof t.name=="undefined"&&t.id&&t.id in Ie.oids&&(t.name=Ie.oids[t.id]),typeof t.id=="undefined")if(t.name&&t.name in Ie.oids)t.id=Ie.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value!="undefined")return t;if(t.name==="keyUsage"){var i=0,n=0,s=0;t.digitalSignature&&(n|=128,i=7),t.nonRepudiation&&(n|=64,i=6),t.keyEncipherment&&(n|=32,i=5),t.dataEncipherment&&(n|=16,i=4),t.keyAgreement&&(n|=8,i=3),t.keyCertSign&&(n|=4,i=2),t.cRLSign&&(n|=2,i=1),t.encipherOnly&&(n|=1,i=0),t.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),t.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var c in t)t[c]===!0&&(c in nt?a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(nt[c]).getBytes())):c.indexOf(".")!==-1&&a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var i=0,n=0;t.client&&(n|=128,i=7),t.server&&(n|=64,i=6),t.email&&(n|=32,i=5),t.objsign&&(n|=16,i=4),t.reserved&&(n|=8,i=3),t.sslCA&&(n|=4,i=2),t.emailCA&&(n|=2,i=1),t.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),t.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Oe.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=O.oidToDer(O.oidToDer(u.oid)):o=O.oidToDer(o));t.value.value.push(O.create(O.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=O.create(O.Class.UNIVERSAL,O.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var d=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=d.toHex(),t.value=O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,d.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var h=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!1,h))}if(t.authorityCertIssuer){var y=[O.create(O.Class.CONTEXT_SPECIFIC,4,!0,[m0(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,y))}if(t.serialNumber){var g=Oe.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(t.name==="cRLDistributionPoints"){t.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var a=t.value.value,m=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),E=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Oe.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=O.oidToDer(O.oidToDer(u.oid)):o=O.oidToDer(o));E.value.push(O.create(O.Class.CONTEXT_SPECIFIC,u.type,!1,o))}m.value.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[E])),a.push(m)}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function _P(t,e){switch(t){case nt["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.saltLength).getBytes())])),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,r);default:return O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")}}function npt(t){var e=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,i=0;i<r.length;++i){var n=r[i],s=n.value,o=O.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===O.Type.UTF8&&(s=Oe.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(n.type).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var spt=new Date("1950-01-01T00:00:00Z"),opt=new Date("2050-01-01T00:00:00Z");function vbe(t){return t>=spt&&t<opt?O.create(O.Class.UNIVERSAL,O.Type.UTCTIME,!1,O.dateToUtcTime(t)):O.create(O.Class.UNIVERSAL,O.Type.GENERALIZEDTIME,!1,O.dateToGeneralizedTime(t))}Ie.getTBSCertificate=function(t){var e=vbe(t.validity.notBefore),r=vbe(t.validity.notAfter),i=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.version).getBytes())]),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Oe.util.hexToBytes(t.serialNumber)),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.siginfo.algorithmOid).getBytes()),_P(t.siginfo.algorithmOid,t.siginfo.parameters)]),m0(t.issuer),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,r]),m0(t.subject),Ie.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&i.value.push(Ie.certificateExtensionsToAsn1(t.extensions)),i};Ie.getCertificationRequestInfo=function(t){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(t.version).getBytes()),m0(t.subject),Ie.publicKeyToAsn1(t.publicKey),npt(t)]);return e};Ie.distinguishedNameToAsn1=function(t){return m0(t)};Ie.certificateToAsn1=function(t){var e=t.tbsCertificate||Ie.getTBSCertificate(t);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.signatureOid).getBytes()),_P(t.signatureOid,t.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Ie.certificateExtensionsToAsn1=function(t){var e=O.create(O.Class.CONTEXT_SPECIFIC,3,!0,[]),r=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(r);for(var i=0;i<t.length;++i)r.value.push(Ie.certificateExtensionToAsn1(t[i]));return e};Ie.certificateExtensionToAsn1=function(t){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.id).getBytes())),t.critical&&e.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=O.toDer(r).getBytes()),e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,r)),e};Ie.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||Ie.getCertificationRequestInfo(t);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.signatureOid).getBytes()),_P(t.signatureOid,t.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Ie.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=Oe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];Oe.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=Oe.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;Oe.util.isArray(a)||(a=[a]);for(var c=O.toDer(Ie.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=O.toDer(Ie.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!Oe.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=Oe.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=r(o.subject);if(!Oe.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=O.toDer(Ie.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var d=O.toDer(Ie.certificateToAsn1(c[l])).getBytes();u===d&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function r(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=Oe.md.sha1.create();o.attributes=Ie.RDNAttributesAsArray(m0(o),a),o.hash=a.digest().toHex()}}if(t)for(var n=0;n<t.length;++n){var s=t[n];e.addCertificate(s)}return e};Ie.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Ie.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var i=e.slice(0),n=r.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Ie.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(u=e[0]||t.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var d=u;Oe.util.isArray(d)||(d=[d]);for(var h=!1;!h&&d.length>0;){u=d.shift();try{h=u.verify(c)}catch(q){}}h||(o={message:"Certificate signature is invalid.",error:Ie.certificateError.bad_certificate})}o===null&&(!u||l)&&!t.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Ie.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:Ie.certificateError.bad_certificate}),o===null)for(var y={keyUsage:!0,basicConstraints:!0},g=0;o===null&&g<c.extensions.length;++g){var m=c.extensions[g];m.critical&&!(m.name in y)&&(o={message:"Certificate has an unsupported critical extension.",error:Ie.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var E=c.getExtension("basicConstraints"),v=c.getExtension("keyUsage");if(v!==null&&(!v.keyCertSign||E===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Ie.certificateError.bad_certificate}),o===null&&E!==null&&!E.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Ie.certificateError.bad_certificate}),o===null&&v!==null&&"pathLenConstraint"in E){var A=a-1;A>E.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Ie.certificateError.bad_certificate})}}var R=o===null?!0:o.error,F=r.verify?r.verify(R,a,i):R;if(F===!0)o=null;else throw R===!0&&(o={message:"The application rejected the certificate.",error:Ie.certificateError.bad_certificate}),(F||F===0)&&(typeof F=="object"&&!Oe.util.isArray(F)?(F.message&&(o.message=F.message),F.error&&(o.error=F.error)):typeof F=="string"&&(o.error=F)),o;s=!1,++a}while(e.length>0);return!0}});var Sbe=p((AMt,Ebe)=>{f();var Ne=lt();Qd();hc();cv();Wd();dv();lbe();mu();Wt();EP();var te=Ne.asn1,Rn=Ebe.exports=Ne.pkcs7=Ne.pkcs7||{};Rn.messageFromPem=function(t){var e=Ne.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=te.fromDer(e.body);return Rn.messageFromAsn1(i)};Rn.messageToPem=function(t,e){var r={type:"PKCS7",body:te.toDer(t.toAsn1()).getBytes()};return Ne.pem.encode(r,{maxline:e})};Rn.messageFromAsn1=function(t){var e={},r=[];if(!te.validate(t,Rn.asn1.contentInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=r,i}var n=te.derToOid(e.contentType),s;switch(n){case Ne.pki.oids.envelopedData:s=Rn.createEnvelopedData();break;case Ne.pki.oids.encryptedData:s=Rn.createEncryptedData();break;case Ne.pki.oids.signedData:s=Rn.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Rn.createSignedData=function(){var t=null;return t={type:Ne.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(xP(t,i,Rn.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var n=t.rawCapture.certificates.value,s=0;s<n.length;++s)t.certificates.push(Ne.pki.certificateFromAsn1(n[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var i=[],n=0;n<t.certificates.length;++n)i.push(Ne.pki.certificateToAsn1(t.certificates[n]));var s=[],o=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return i.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(te.create(te.Class.UNIVERSAL,te.Type.SET,!0,t.signerInfos)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=Ne.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=Ne.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||Ne.pki.oids.sha1;switch(c){case Ne.pki.oids.sha1:case Ne.pki.oids.sha256:case Ne.pki.oids.sha384:case Ne.pki.oids.sha512:case Ne.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=i.authenticatedAttributes||[];if(u.length>0){for(var l=!1,d=!1,h=0;h<u.length;++h){var y=u[h];if(!l&&y.type===Ne.pki.oids.contentType){if(l=!0,d)break;continue}if(!d&&y.type===Ne.pki.oids.messageDigest){if(d=!0,l)break;continue}}if(!l||!d)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:Ne.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Ne.pki.oids.data).getBytes())]),"content"in t)){var n;t.content instanceof Ne.util.ByteBuffer?n=t.content.bytes():typeof t.content=="string"&&(n=Ne.util.encodeUtf8(t.content)),i.detached?t.detachedContent=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n):t.contentInfo.value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=Ne.pki.certificateFromPem(i)),t.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var i={},n=0;n<t.signers.length;++n){var s=t.signers[n],o=s.digestAlgorithm;o in i||(i[o]=Ne.md[Ne.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=Ne.md[Ne.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in i)t.digestAlgorithmIdentifiers.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(o).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]));return i}function r(i){var n;if(t.detachedContent?n=t.detachedContent:(n=t.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=te.derToOid(t.contentInfo.value[0].value),o=te.toDer(n);o.getByte(),te.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,u=0;u<t.signers.length;++u){var l=t.signers[u];if(l.authenticatedAttributes.length===0){if(s!==Ne.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var d=te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[]),h=0;h<l.authenticatedAttributes.length;++h){var y=l.authenticatedAttributes[h];y.type===Ne.pki.oids.messageDigest?y.value=i[l.digestAlgorithm].digest():y.type===Ne.pki.oids.signingTime&&(y.value||(y.value=c)),d.value.push(SP(y)),l.authenticatedAttributesAsn1.value.push(SP(y))}o=te.toDer(d).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=dpt(t.signers)}};Rn.createEncryptedData=function(){var t=null;return t={type:Ne.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Ne.pki.oids["aes256-CBC"]},fromAsn1:function(e){xP(t,e,Rn.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),_be(t)}},t};Rn.createEnvelopedData=function(){var t=null;return t={type:Ne.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Ne.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=xP(t,e,Rn.asn1.envelopedDataValidator);t.recipients=upt(r.recipientInfos.value)},toAsn1:function(){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,lpt(t.recipients)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,hpt(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,i=0;i<t.recipients.length;++i){var n=t.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case Ne.pki.oids.rsaEncryption:case Ne.pki.oids.desCBC:var i=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=Ne.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}_be(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Ne.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var i,n,s;switch(r){case Ne.pki.oids["aes128-CBC"]:i=16,n=16,s=Ne.aes.createEncryptionCipher;break;case Ne.pki.oids["aes192-CBC"]:i=24,n=16,s=Ne.aes.createEncryptionCipher;break;case Ne.pki.oids["aes256-CBC"]:i=32,n=16,s=Ne.aes.createEncryptionCipher;break;case Ne.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=Ne.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=Ne.util.createBuffer(Ne.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=Ne.util.createBuffer(Ne.random.getBytes(n));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var c=t.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case Ne.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function apt(t){var e={},r=[];if(!te.validate(t,Rn.asn1.recipientInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=r,i}return{version:e.version.charCodeAt(0),issuer:Ne.pki.RDNAttributesAsArray(e.issuer),serialNumber:Ne.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:te.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function cpt(t){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Ne.pki.distinguishedNameToAsn1({attributes:t.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Ne.util.hexToBytes(t.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.encryptedContent.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function upt(t){for(var e=[],r=0;r<t.length;++r)e.push(apt(t[r]));return e}function lpt(t){for(var e=[],r=0;r<t.length;++r)e.push(cpt(t[r]));return e}function fpt(t){var e=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(t.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Ne.pki.distinguishedNameToAsn1({attributes:t.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Ne.util.hexToBytes(t.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.digestAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.signatureAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=te.create(te.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<t.unauthenticatedAttributes.length;++i){var n=t.unauthenticatedAttributes[i];r.values.push(SP(n))}e.value.push(r)}return e}function dpt(t){for(var e=[],r=0;r<t.length;++r)e.push(fpt(t[r]));return e}function SP(t){var e;if(t.type===Ne.pki.oids.contentType)e=te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.value).getBytes());else if(t.type===Ne.pki.oids.messageDigest)e=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===Ne.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=t.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=te.utcTimeToDate(n):n=te.generalizedTimeToDate(n):n=new Date(s)}n>=r&&n<i?e=te.create(te.Class.UNIVERSAL,te.Type.UTCTIME,!1,te.dateToUtcTime(n)):e=te.create(te.Class.UNIVERSAL,te.Type.GENERALIZEDTIME,!1,te.dateToGeneralizedTime(n))}return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.type).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[e])])}function hpt(t){return[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Ne.pki.oids.data).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(t.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.parameter.getBytes())]),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,t.content.getBytes())])]}function xP(t,e,r){var i={},n=[];if(!te.validate(e,r,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=te.derToOid(i.contentType);if(o!==Ne.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(Ne.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;t.encryptedContent={algorithm:te.derToOid(i.encAlgorithm),parameter:Ne.util.createBuffer(i.encParameter.value),content:Ne.util.createBuffer(a)}}if(i.content){var a="";if(Ne.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;t.content=Ne.util.createBuffer(a)}return t.version=i.version.charCodeAt(0),t.rawCapture=i,i}function _be(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case Ne.pki.oids["aes128-CBC"]:case Ne.pki.oids["aes192-CBC"]:case Ne.pki.oids["aes256-CBC"]:e=Ne.aes.createDecryptionCipher(t.encryptedContent.key);break;case Ne.pki.oids.desCBC:case Ne.pki.oids["des-EDE3-CBC"]:e=Ne.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var Ibe=p((IMt,Abe)=>{f();"use strict";EP();var ppt=lt(),xbe=ppt.pki,ypt=(t,e)=>{let r=xbe.setRsaPublicKey(e.n,e.e),i=xbe.createCertificate();i.publicKey=r,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function gpt(t,e){let r=t.map(e),n=(await Promise.all(r)).findIndex(s=>s);return t[n]}Abe.exports={certificateForKey:ypt,findAsync:gpt}});var Cbe=p((TMt,Pbe)=>{f();"use strict";Sbe();o6();var _l=lt(),{certificateForKey:bpt,findAsync:mpt}=Ibe(),v0=ae(),Tbe=ct(),vpt=Je(),AP=new WeakMap,Rbe=class{constructor(e,r){if(!e)throw v0(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,AP.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw v0(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=AP.get(this).dek,o=_l.pki.decryptRsaPrivateKey(n,s),a=await bpt(i,o),c=_l.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=_l.util.createBuffer(r),c.encrypt();let u=_l.asn1.toDer(c.toAsn1()).getBytes();return Tbe(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw v0(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let r;try{let u=_l.util.createBuffer(vpt(e,"ascii")),l=_l.asn1.fromDer(u);r=_l.pkcs7.messageFromAsn1(l)}catch(u){throw v0(new Error("Invalid CMS: "+u.message),"ERR_INVALID_CMS")}let i=r.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),n=await mpt(i,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!n){let u=i.map(l=>l.keyId);throw v0(new Error("Decryption needs one of the key(s): "+u.join(", ")),"ERR_MISSING_KEYS",{missingKeys:u})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw v0(new Error("No key available to decrypto"),"ERR_NO_KEY");let o=await this.keychain._getPrivateKey(s.name),a=AP.get(this).dek,c=_l.pki.decryptRsaPrivateKey(o,a);return r.decrypt(n.recipient,c),Tbe(r.content.getBytes(),"ascii")}};Pbe.exports=Rbe});var Mbe=p((RMt,Bbe)=>{f();"use strict";var Obe=me(),kbe=Object.assign(Obe("libp2p:keychain"),{error:Obe("libp2p:keychain:err")}),wpt=obe(),_pt=hr(),gd=xa(),{Key:qbe}=Ft(),Ept=Cbe(),vr=ae(),bd=Je(),Xc=ct();Ev();var Spt="/pkcs8/",Nbe="/info/",El=new WeakMap,md={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},IP={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function Qc(t){return!t||typeof t!="string"?!1:t===wpt(t.trim())}async function Vt(t){let e=200,r=1e3,i=Math.random()*(r-e)+e;throw await new Promise(n=>setTimeout(n,i)),t}function Ya(t){return new qbe(Spt+t)}function Sl(t){return new qbe(Nbe+t)}var Dbe=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=_pt(IP,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<md.minKeyLength)throw new Error(`dek.keyLength must be least ${md.minKeyLength} bytes`);if(this.opts.dek.salt.length<md.minSaltLength)throw new Error(`dek.saltLength must be least ${md.minSaltLength} bytes`);if(this.opts.dek.iterationCount<md.minIterationCount)throw new Error(`dek.iterationCount must be least ${md.minIterationCount}`);let i=this.opts.pass?gd.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";El.set(this,{dek:i})}get cms(){return new Ept(this,El.get(this).dek)}static generateOptions(){let e=Object.assign({},IP),r=Math.ceil(md.minSaltLength/3)*3;return e.dek.salt=bd(gd.randomBytes(r),"base64"),e}static get options(){return IP}async createKey(e,r,i=2048){let n=this;if(!Qc(e)||e==="self")return Vt(vr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(typeof r!="string")return Vt(vr(new Error(`Invalid key type '${r}'`),"ERR_INVALID_KEY_TYPE"));let s=Ya(e);if(await n.store.has(s))return Vt(vr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return Vt(vr(new Error(`Invalid RSA key size ${i}`),"ERR_INVALID_KEY_SIZE"));break;default:break}let a;try{let c=await gd.keys.generateKeyPair(r,i),u=await c.id(),l=El.get(this).dek,d=await c.export(l);a={name:e,id:u};let h=n.store.batch();h.put(s,Xc(d)),h.put(Sl(e),Xc(JSON.stringify(a))),await h.commit()}catch(c){return Vt(c)}return a}async listKeys(){let e=this,r={prefix:Nbe},i=[];for await(let n of e.store.query(r))i.push(JSON.parse(bd(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(r){return Vt(r)}}async findKeyByName(e){if(!Qc(e))return Vt(vr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let r=Sl(e);try{let i=await this.store.get(r);return JSON.parse(bd(i))}catch(i){return Vt(vr(new Error(`Key '${e}' does not exist. ${i.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){let r=this;if(!Qc(e)||e==="self")return Vt(vr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let i=Ya(e),n=await r.findKeyByName(e),s=r.store.batch();return s.delete(i),s.delete(Sl(e)),await s.commit(),n}async renameKey(e,r){let i=this;if(!Qc(e)||e==="self")return Vt(vr(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!Qc(r)||r==="self")return Vt(vr(new Error(`Invalid new key name '${r}'`),"ERR_NEW_KEY_NAME_INVALID"));let n=Ya(e),s=Ya(r),o=Sl(e),a=Sl(r);if(await i.store.has(s))return Vt(vr(new Error(`Key '${r}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let u=await i.store.get(n),l=await i.store.get(o),d=JSON.parse(bd(l));d.name=r;let h=i.store.batch();return h.put(s,u),h.put(a,Xc(JSON.stringify(d))),h.delete(n),h.delete(o),await h.commit(),d}catch(u){return Vt(u)}}async exportKey(e,r){if(!Qc(e))return Vt(vr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return Vt(vr(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));let i=Ya(e);try{let n=await this.store.get(i),s=bd(n),o=El.get(this).dek;return(await gd.keys.import(s,o)).export(r)}catch(n){return Vt(n)}}async importKey(e,r,i){let n=this;if(!Qc(e)||e==="self")return Vt(vr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return Vt(vr(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));let s=Ya(e);if(await n.store.has(s))return Vt(vr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let a;try{a=await gd.keys.import(r,i)}catch(d){return Vt(vr(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let c;try{c=await a.id();let d=El.get(this).dek;r=await a.export(d)}catch(d){return Vt(d)}let u={name:e,id:c},l=n.store.batch();return l.put(s,Xc(r)),l.put(Sl(e),Xc(JSON.stringify(u))),await l.commit(),u}async importPeer(e,r){let i=this;if(!Qc(e))return Vt(vr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r||!r.privKey)return Vt(vr(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));let n=r.privKey,s=Ya(e);if(await i.store.has(s))return Vt(vr(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let a=await n.id(),c=El.get(this).dek,u=await n.export(c),l={name:e,id:a},d=i.store.batch();return d.put(s,Xc(u)),d.put(Sl(e),Xc(JSON.stringify(l))),await d.commit(),l}catch(a){return Vt(a)}}async _getPrivateKey(e){if(!Qc(e))return Vt(vr(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{let r=Ya(e),i=await this.store.get(r);return bd(i)}catch(r){return Vt(vr(new Error(`Key '${e}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,r){if(typeof e!="string")return Vt(vr(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if(typeof r!="string")return Vt(vr(new Error(`Invalid new pass type '${typeof r}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(r.length<20)return Vt(vr(new Error(`Invalid pass length ${r.length}`),"ERR_INVALID_PASS_LENGTH"));kbe("recreating keychain");let i=El.get(this).dek;this.opts.pass=r;let n=r?gd.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";El.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(Ya(o.name)),c=bd(a),u=await gd.keys.import(c,i),l=n.toString(),d=await u.export(l),h=this.store.batch(),y={name:o.name,id:o.id};h.put(Ya(o.name),Xc(d)),h.put(Sl(o.name),Xc(JSON.stringify(y))),await h.commit()}kbe("keychain reconstructed")}};Bbe.exports=Dbe});var Ube=p((PMt,Lbe)=>{f();"use strict";var xpt=Fg();Lbe.exports=t=>{let e=xpt(t);return e.delete=e.remove,e}});var Kbe=p((Fbe,nS)=>{f();(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function y(q){var N,z,G,Y=X.prototype={constructor:X,toString:null,valueOf:null},P=new X(1),b=20,w=4,S=-7,C=21,B=-1e7,W=1e7,j=!1,M=1,_=0,L={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},ce="0123456789abcdefghijklmnopqrstuvwxyz";function X(k,K){var $,Z,I,U,V,D,Q,ee,J=this;if(!(J instanceof X))return new X(k,K);if(K==null){if(k&&k._isBigNumber===!0){J.s=k.s,!k.c||k.e>W?J.c=J.e=null:k.e<B?J.c=[J.e=0]:(J.e=k.e,J.c=k.c.slice());return}if((D=typeof k=="number")&&k*0==0){if(J.s=1/k<0?(k=-k,-1):1,k===~~k){for(U=0,V=k;V>=10;V/=10,U++);U>W?J.c=J.e=null:(J.e=U,J.c=[k]);return}ee=String(k)}else{if(!r.test(ee=String(k)))return G(J,ee,D);J.s=ee.charCodeAt(0)==45?(ee=ee.slice(1),-1):1}(U=ee.indexOf("."))>-1&&(ee=ee.replace(".","")),(V=ee.search(/e/i))>0?(U<0&&(U=V),U+=+ee.slice(V+1),ee=ee.substring(0,V)):U<0&&(U=ee.length)}else{if(v(K,2,ce.length,"Base"),K==10)return J=new X(k),pe(J,b+J.e+1,w);if(ee=String(k),D=typeof k=="number"){if(k*0!=0)return G(J,ee,D,K);if(J.s=1/k<0?(ee=ee.slice(1),-1):1,X.DEBUG&&ee.replace(/^0\.0*|\./,"").length>15)throw Error(o+k)}else J.s=ee.charCodeAt(0)===45?(ee=ee.slice(1),-1):1;for($=ce.slice(0,K),U=V=0,Q=ee.length;V<Q;V++)if($.indexOf(Z=ee.charAt(V))<0){if(Z=="."){if(V>U){U=Q;continue}}else if(!I&&(ee==ee.toUpperCase()&&(ee=ee.toLowerCase())||ee==ee.toLowerCase()&&(ee=ee.toUpperCase()))){I=!0,V=-1,U=0;continue}return G(J,String(k),D,K)}D=!1,ee=z(ee,K,10,J.s),(U=ee.indexOf("."))>-1?ee=ee.replace(".",""):U=ee.length}for(V=0;ee.charCodeAt(V)===48;V++);for(Q=ee.length;ee.charCodeAt(--Q)===48;);if(ee=ee.slice(V,++Q)){if(Q-=V,D&&X.DEBUG&&Q>15&&(k>u||k!==n(k)))throw Error(o+J.s*k);if((U=U-V-1)>W)J.c=J.e=null;else if(U<B)J.c=[J.e=0];else{if(J.e=U,J.c=[],V=(U+1)%c,U<0&&(V+=c),V<Q){for(V&&J.c.push(+ee.slice(0,V)),Q-=c;V<Q;)J.c.push(+ee.slice(V,V+=c));V=c-(ee=ee.slice(V)).length}else V-=Q;for(;V--;ee+="0");J.c.push(+ee)}}else J.c=[J.e=0]}X.clone=y,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(k){var K,$;if(k!=null)if(typeof k=="object"){if(k.hasOwnProperty(K="DECIMAL_PLACES")&&($=k[K],v($,0,h,K),b=$),k.hasOwnProperty(K="ROUNDING_MODE")&&($=k[K],v($,0,8,K),w=$),k.hasOwnProperty(K="EXPONENTIAL_AT")&&($=k[K],$&&$.pop?(v($[0],-h,0,K),v($[1],0,h,K),S=$[0],C=$[1]):(v($,-h,h,K),S=-(C=$<0?-$:$))),k.hasOwnProperty(K="RANGE"))if($=k[K],$&&$.pop)v($[0],-h,-1,K),v($[1],1,h,K),B=$[0],W=$[1];else if(v($,-h,h,K),$)B=-(W=$<0?-$:$);else throw Error(s+K+" cannot be zero: "+$);if(k.hasOwnProperty(K="CRYPTO"))if($=k[K],$===!!$)if($)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))j=$;else throw j=!$,Error(s+"crypto unavailable");else j=$;else throw Error(s+K+" not true or false: "+$);if(k.hasOwnProperty(K="MODULO_MODE")&&($=k[K],v($,0,9,K),M=$),k.hasOwnProperty(K="POW_PRECISION")&&($=k[K],v($,0,h,K),_=$),k.hasOwnProperty(K="FORMAT"))if($=k[K],typeof $=="object")L=$;else throw Error(s+K+" not an object: "+$);if(k.hasOwnProperty(K="ALPHABET"))if($=k[K],typeof $=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test($))ce=$;else throw Error(s+K+" invalid: "+$)}else throw Error(s+"Object expected: "+k);return{DECIMAL_PLACES:b,ROUNDING_MODE:w,EXPONENTIAL_AT:[S,C],RANGE:[B,W],CRYPTO:j,MODULO_MODE:M,POW_PRECISION:_,FORMAT:L,ALPHABET:ce}},X.isBigNumber=function(k){if(!k||k._isBigNumber!==!0)return!1;if(!X.DEBUG)return!0;var K,$,Z=k.c,I=k.e,U=k.s;e:if({}.toString.call(Z)=="[object Array]"){if((U===1||U===-1)&&I>=-h&&I<=h&&I===n(I)){if(Z[0]===0){if(I===0&&Z.length===1)return!0;break e}if(K=(I+1)%c,K<1&&(K+=c),String(Z[0]).length==K){for(K=0;K<Z.length;K++)if($=Z[K],$<0||$>=a||$!==n($))break e;if($!==0)return!0}}}else if(Z===null&&I===null&&(U===null||U===1||U===-1))return!0;throw Error(s+"Invalid BigNumber: "+k)},X.maximum=X.max=function(){return oe(arguments,Y.lt)},X.minimum=X.min=function(){return oe(arguments,Y.gt)},X.random=function(){var k=9007199254740992,K=Math.random()*k&2097151?function(){return n(Math.random()*k)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function($){var Z,I,U,V,D,Q=0,ee=[],J=new X(P);if($==null?$=b:v($,0,h),V=i($/c),j)if(crypto.getRandomValues){for(Z=crypto.getRandomValues(new Uint32Array(V*=2));Q<V;)D=Z[Q]*131072+(Z[Q+1]>>>11),D>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),Z[Q]=I[0],Z[Q+1]=I[1]):(ee.push(D%1e14),Q+=2);Q=V/2}else if(crypto.randomBytes){for(Z=crypto.randomBytes(V*=7);Q<V;)D=(Z[Q]&31)*281474976710656+Z[Q+1]*1099511627776+Z[Q+2]*4294967296+Z[Q+3]*16777216+(Z[Q+4]<<16)+(Z[Q+5]<<8)+Z[Q+6],D>=9e15?crypto.randomBytes(7).copy(Z,Q):(ee.push(D%1e14),Q+=7);Q=V/7}else throw j=!1,Error(s+"crypto unavailable");if(!j)for(;Q<V;)D=K(),D<9e15&&(ee[Q++]=D%1e14);for(V=ee[--Q],$%=c,V&&$&&(D=l[c-$],ee[Q]=n(V/D)*D);ee[Q]===0;ee.pop(),Q--);if(Q<0)ee=[U=0];else{for(U=-1;ee[0]===0;ee.splice(0,1),U-=c);for(Q=1,D=ee[0];D>=10;D/=10,Q++);Q<c&&(U-=c-Q)}return J.e=U,J.c=ee,J}}(),X.sum=function(){for(var k=1,K=arguments,$=new X(K[0]);k<K.length;)$=$.plus(K[k++]);return $},z=function(){var k="0123456789";function K($,Z,I,U){for(var V,D=[0],Q,ee=0,J=$.length;ee<J;){for(Q=D.length;Q--;D[Q]*=Z);for(D[0]+=U.indexOf($.charAt(ee++)),V=0;V<D.length;V++)D[V]>I-1&&(D[V+1]==null&&(D[V+1]=0),D[V+1]+=D[V]/I|0,D[V]%=I)}return D.reverse()}return function($,Z,I,U,V){var D,Q,ee,J,ue,ge,be,Ke,Te=$.indexOf("."),je=b,Ze=w;for(Te>=0&&(J=_,_=0,$=$.replace(".",""),Ke=new X(Z),ge=Ke.pow($.length-Te),_=J,Ke.c=K(F(m(ge.c),ge.e,"0"),10,I,k),Ke.e=Ke.c.length),be=K($,Z,I,V?(D=ce,k):(D=k,ce)),ee=J=be.length;be[--J]==0;be.pop());if(!be[0])return D.charAt(0);if(Te<0?--ee:(ge.c=be,ge.e=ee,ge.s=U,ge=N(ge,Ke,je,Ze,I),be=ge.c,ue=ge.r,ee=ge.e),Q=ee+je+1,Te=be[Q],J=I/2,ue=ue||Q<0||be[Q+1]!=null,ue=Ze<4?(Te!=null||ue)&&(Ze==0||Ze==(ge.s<0?3:2)):Te>J||Te==J&&(Ze==4||ue||Ze==6&&be[Q-1]&1||Ze==(ge.s<0?8:7)),Q<1||!be[0])$=ue?F(D.charAt(1),-je,D.charAt(0)):D.charAt(0);else{if(be.length=Q,ue)for(--I;++be[--Q]>I;)be[Q]=0,Q||(++ee,be=[1].concat(be));for(J=be.length;!be[--J];);for(Te=0,$="";Te<=J;$+=D.charAt(be[Te++]));$=F($,ee,D.charAt(0))}return $}}(),N=function(){function k(Z,I,U){var V,D,Q,ee,J=0,ue=Z.length,ge=I%d,be=I/d|0;for(Z=Z.slice();ue--;)Q=Z[ue]%d,ee=Z[ue]/d|0,V=be*Q+ee*ge,D=ge*Q+V%d*d+J,J=(D/U|0)+(V/d|0)+be*ee,Z[ue]=D%U;return J&&(Z=[J].concat(Z)),Z}function K(Z,I,U,V){var D,Q;if(U!=V)Q=U>V?1:-1;else for(D=Q=0;D<U;D++)if(Z[D]!=I[D]){Q=Z[D]>I[D]?1:-1;break}return Q}function $(Z,I,U,V){for(var D=0;U--;)Z[U]-=D,D=Z[U]<I[U]?1:0,Z[U]=D*V+Z[U]-I[U];for(;!Z[0]&&Z.length>1;Z.splice(0,1));}return function(Z,I,U,V,D){var Q,ee,J,ue,ge,be,Ke,Te,je,Ze,ze,Ve,ht,Ht,er,gn,Kt,_t=Z.s==I.s?1:-1,Yr=Z.c,it=I.c;if(!Yr||!Yr[0]||!it||!it[0])return new X(!Z.s||!I.s||(Yr?it&&Yr[0]==it[0]:!it)?NaN:Yr&&Yr[0]==0||!it?_t*0:_t/0);for(Te=new X(_t),je=Te.c=[],ee=Z.e-I.e,_t=U+ee+1,D||(D=a,ee=g(Z.e/c)-g(I.e/c),_t=_t/c|0),J=0;it[J]==(Yr[J]||0);J++);if(it[J]>(Yr[J]||0)&&ee--,_t<0)je.push(1),ue=!0;else{for(Ht=Yr.length,gn=it.length,J=0,_t+=2,ge=n(D/(it[0]+1)),ge>1&&(it=k(it,ge,D),Yr=k(Yr,ge,D),gn=it.length,Ht=Yr.length),ht=gn,Ze=Yr.slice(0,gn),ze=Ze.length;ze<gn;Ze[ze++]=0);Kt=it.slice(),Kt=[0].concat(Kt),er=it[0],it[1]>=D/2&&er++;do{if(ge=0,Q=K(it,Ze,gn,ze),Q<0){if(Ve=Ze[0],gn!=ze&&(Ve=Ve*D+(Ze[1]||0)),ge=n(Ve/er),ge>1)for(ge>=D&&(ge=D-1),be=k(it,ge,D),Ke=be.length,ze=Ze.length;K(be,Ze,Ke,ze)==1;)ge--,$(be,gn<Ke?Kt:it,Ke,D),Ke=be.length,Q=1;else ge==0&&(Q=ge=1),be=it.slice(),Ke=be.length;if(Ke<ze&&(be=[0].concat(be)),$(Ze,be,ze,D),ze=Ze.length,Q==-1)for(;K(it,Ze,gn,ze)<1;)ge++,$(Ze,gn<ze?Kt:it,ze,D),ze=Ze.length}else Q===0&&(ge++,Ze=[0]);je[J++]=ge,Ze[0]?Ze[ze++]=Yr[ht]||0:(Ze=[Yr[ht]],ze=1)}while((ht++<Ht||Ze[0]!=null)&&_t--);ue=Ze[0]!=null,je[0]||je.splice(0,1)}if(D==a){for(J=1,_t=je[0];_t>=10;_t/=10,J++);pe(Te,U+(Te.e=J+ee*c-1)+1,V,ue)}else Te.e=ee,Te.r=+ue;return Te}}();function ne(k,K,$,Z){var I,U,V,D,Q;if($==null?$=w:v($,0,8),!k.c)return k.toString();if(I=k.c[0],V=k.e,K==null)Q=m(k.c),Q=Z==1||Z==2&&(V<=S||V>=C)?R(Q,V):F(Q,V,"0");else if(k=pe(new X(k),K,$),U=k.e,Q=m(k.c),D=Q.length,Z==1||Z==2&&(K<=U||U<=S)){for(;D<K;Q+="0",D++);Q=R(Q,U)}else if(K-=V,Q=F(Q,U,"0"),U+1>D){if(--K>0)for(Q+=".";K--;Q+="0");}else if(K+=U-D,K>0)for(U+1==D&&(Q+=".");K--;Q+="0");return k.s<0&&I?"-"+Q:Q}function oe(k,K){for(var $,Z=1,I=new X(k[0]);Z<k.length;Z++)if($=new X(k[Z]),$.s)K.call(I,$)&&(I=$);else{I=$;break}return I}function he(k,K,$){for(var Z=1,I=K.length;!K[--I];K.pop());for(I=K[0];I>=10;I/=10,Z++);return($=Z+$*c-1)>W?k.c=k.e=null:$<B?k.c=[k.e=0]:(k.e=$,k.c=K),k}G=function(){var k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,K=/^([^.]+)\.$/,$=/^\.([^.]+)$/,Z=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,V,D,Q){var ee,J=D?V:V.replace(I,"");if(Z.test(J))U.s=isNaN(J)?null:J<0?-1:1;else{if(!D&&(J=J.replace(k,function(ue,ge,be){return ee=(be=be.toLowerCase())=="x"?16:be=="b"?2:8,!Q||Q==ee?ge:ue}),Q&&(ee=Q,J=J.replace(K,"$1").replace($,"0.$1")),V!=J))return new X(J,ee);if(X.DEBUG)throw Error(s+"Not a"+(Q?" base "+Q:"")+" number: "+V);U.s=null}U.c=U.e=null}}();function pe(k,K,$,Z){var I,U,V,D,Q,ee,J,ue=k.c,ge=l;if(ue){e:{for(I=1,D=ue[0];D>=10;D/=10,I++);if(U=K-I,U<0)U+=c,V=K,Q=ue[ee=0],J=Q/ge[I-V-1]%10|0;else if(ee=i((U+1)/c),ee>=ue.length)if(Z){for(;ue.length<=ee;ue.push(0));Q=J=0,I=1,U%=c,V=U-c+1}else break e;else{for(Q=D=ue[ee],I=1;D>=10;D/=10,I++);U%=c,V=U-c+I,J=V<0?0:Q/ge[I-V-1]%10|0}if(Z=Z||K<0||ue[ee+1]!=null||(V<0?Q:Q%ge[I-V-1]),Z=$<4?(J||Z)&&($==0||$==(k.s<0?3:2)):J>5||J==5&&($==4||Z||$==6&&(U>0?V>0?Q/ge[I-V]:0:ue[ee-1])%10&1||$==(k.s<0?8:7)),K<1||!ue[0])return ue.length=0,Z?(K-=k.e+1,ue[0]=ge[(c-K%c)%c],k.e=-K||0):ue[0]=k.e=0,k;if(U==0?(ue.length=ee,D=1,ee--):(ue.length=ee+1,D=ge[c-U],ue[ee]=V>0?n(Q/ge[I-V]%ge[V])*D:0),Z)for(;;)if(ee==0){for(U=1,V=ue[0];V>=10;V/=10,U++);for(V=ue[0]+=D,D=1;V>=10;V/=10,D++);U!=D&&(k.e++,ue[0]==a&&(ue[0]=1));break}else{if(ue[ee]+=D,ue[ee]!=a)break;ue[ee--]=0,D=1}for(U=ue.length;ue[--U]===0;ue.pop());}k.e>W?k.c=k.e=null:k.e<B&&(k.c=[k.e=0])}return k}function _e(k){var K,$=k.e;return $===null?k.toString():(K=m(k.c),K=$<=S||$>=C?R(K,$):F(K,$,"0"),k.s<0?"-"+K:K)}return Y.absoluteValue=Y.abs=function(){var k=new X(this);return k.s<0&&(k.s=1),k},Y.comparedTo=function(k,K){return E(this,new X(k,K))},Y.decimalPlaces=Y.dp=function(k,K){var $,Z,I,U=this;if(k!=null)return v(k,0,h),K==null?K=w:v(K,0,8),pe(new X(U),k+U.e+1,K);if(!($=U.c))return null;if(Z=((I=$.length-1)-g(this.e/c))*c,I=$[I])for(;I%10==0;I/=10,Z--);return Z<0&&(Z=0),Z},Y.dividedBy=Y.div=function(k,K){return N(this,new X(k,K),b,w)},Y.dividedToIntegerBy=Y.idiv=function(k,K){return N(this,new X(k,K),0,1)},Y.exponentiatedBy=Y.pow=function(k,K){var $,Z,I,U,V,D,Q,ee,J,ue=this;if(k=new X(k),k.c&&!k.isInteger())throw Error(s+"Exponent not an integer: "+_e(k));if(K!=null&&(K=new X(K)),D=k.e>14,!ue.c||!ue.c[0]||ue.c[0]==1&&!ue.e&&ue.c.length==1||!k.c||!k.c[0])return J=new X(Math.pow(+_e(ue),D?2-A(k):+_e(k))),K?J.mod(K):J;if(Q=k.s<0,K){if(K.c?!K.c[0]:!K.s)return new X(NaN);Z=!Q&&ue.isInteger()&&K.isInteger(),Z&&(ue=ue.mod(K))}else{if(k.e>9&&(ue.e>0||ue.e<-1||(ue.e==0?ue.c[0]>1||D&&ue.c[1]>=24e7:ue.c[0]<8e13||D&&ue.c[0]<=9999975e7)))return U=ue.s<0&&A(k)?-0:0,ue.e>-1&&(U=1/U),new X(Q?1/U:U);_&&(U=i(_/c+2))}for(D?($=new X(.5),Q&&(k.s=1),ee=A(k)):(I=Math.abs(+_e(k)),ee=I%2),J=new X(P);;){if(ee){if(J=J.times(ue),!J.c)break;U?J.c.length>U&&(J.c.length=U):Z&&(J=J.mod(K))}if(I){if(I=n(I/2),I===0)break;ee=I%2}else if(k=k.times($),pe(k,k.e+1,1),k.e>14)ee=A(k);else{if(I=+_e(k),I===0)break;ee=I%2}ue=ue.times(ue),U?ue.c&&ue.c.length>U&&(ue.c.length=U):Z&&(ue=ue.mod(K))}return Z?J:(Q&&(J=P.div(J)),K?J.mod(K):U?pe(J,_,w,V):J)},Y.integerValue=function(k){var K=new X(this);return k==null?k=w:v(k,0,8),pe(K,K.e+1,k)},Y.isEqualTo=Y.eq=function(k,K){return E(this,new X(k,K))===0},Y.isFinite=function(){return!!this.c},Y.isGreaterThan=Y.gt=function(k,K){return E(this,new X(k,K))>0},Y.isGreaterThanOrEqualTo=Y.gte=function(k,K){return(K=E(this,new X(k,K)))===1||K===0},Y.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},Y.isLessThan=Y.lt=function(k,K){return E(this,new X(k,K))<0},Y.isLessThanOrEqualTo=Y.lte=function(k,K){return(K=E(this,new X(k,K)))===-1||K===0},Y.isNaN=function(){return!this.s},Y.isNegative=function(){return this.s<0},Y.isPositive=function(){return this.s>0},Y.isZero=function(){return!!this.c&&this.c[0]==0},Y.minus=function(k,K){var $,Z,I,U,V=this,D=V.s;if(k=new X(k,K),K=k.s,!D||!K)return new X(NaN);if(D!=K)return k.s=-K,V.plus(k);var Q=V.e/c,ee=k.e/c,J=V.c,ue=k.c;if(!Q||!ee){if(!J||!ue)return J?(k.s=-K,k):new X(ue?V:NaN);if(!J[0]||!ue[0])return ue[0]?(k.s=-K,k):new X(J[0]?V:w==3?-0:0)}if(Q=g(Q),ee=g(ee),J=J.slice(),D=Q-ee){for((U=D<0)?(D=-D,I=J):(ee=Q,I=ue),I.reverse(),K=D;K--;I.push(0));I.reverse()}else for(Z=(U=(D=J.length)<(K=ue.length))?D:K,D=K=0;K<Z;K++)if(J[K]!=ue[K]){U=J[K]<ue[K];break}if(U&&(I=J,J=ue,ue=I,k.s=-k.s),K=(Z=ue.length)-($=J.length),K>0)for(;K--;J[$++]=0);for(K=a-1;Z>D;){if(J[--Z]<ue[Z]){for($=Z;$&&!J[--$];J[$]=K);--J[$],J[Z]+=a}J[Z]-=ue[Z]}for(;J[0]==0;J.splice(0,1),--ee);return J[0]?he(k,J,ee):(k.s=w==3?-1:1,k.c=[k.e=0],k)},Y.modulo=Y.mod=function(k,K){var $,Z,I=this;return k=new X(k,K),!I.c||!k.s||k.c&&!k.c[0]?new X(NaN):!k.c||I.c&&!I.c[0]?new X(I):(M==9?(Z=k.s,k.s=1,$=N(I,k,0,3),k.s=Z,$.s*=Z):$=N(I,k,0,M),k=I.minus($.times(k)),!k.c[0]&&M==1&&(k.s=I.s),k)},Y.multipliedBy=Y.times=function(k,K){var $,Z,I,U,V,D,Q,ee,J,ue,ge,be,Ke,Te,je,Ze=this,ze=Ze.c,Ve=(k=new X(k,K)).c;if(!ze||!Ve||!ze[0]||!Ve[0])return!Ze.s||!k.s||ze&&!ze[0]&&!Ve||Ve&&!Ve[0]&&!ze?k.c=k.e=k.s=null:(k.s*=Ze.s,!ze||!Ve?k.c=k.e=null:(k.c=[0],k.e=0)),k;for(Z=g(Ze.e/c)+g(k.e/c),k.s*=Ze.s,Q=ze.length,ue=Ve.length,Q<ue&&(Ke=ze,ze=Ve,Ve=Ke,I=Q,Q=ue,ue=I),I=Q+ue,Ke=[];I--;Ke.push(0));for(Te=a,je=d,I=ue;--I>=0;){for($=0,ge=Ve[I]%je,be=Ve[I]/je|0,V=Q,U=I+V;U>I;)ee=ze[--V]%je,J=ze[V]/je|0,D=be*ee+J*ge,ee=ge*ee+D%je*je+Ke[U]+$,$=(ee/Te|0)+(D/je|0)+be*J,Ke[U--]=ee%Te;Ke[U]=$}return $?++Z:Ke.splice(0,1),he(k,Ke,Z)},Y.negated=function(){var k=new X(this);return k.s=-k.s||null,k},Y.plus=function(k,K){var $,Z=this,I=Z.s;if(k=new X(k,K),K=k.s,!I||!K)return new X(NaN);if(I!=K)return k.s=-K,Z.minus(k);var U=Z.e/c,V=k.e/c,D=Z.c,Q=k.c;if(!U||!V){if(!D||!Q)return new X(I/0);if(!D[0]||!Q[0])return Q[0]?k:new X(D[0]?Z:I*0)}if(U=g(U),V=g(V),D=D.slice(),I=U-V){for(I>0?(V=U,$=Q):(I=-I,$=D),$.reverse();I--;$.push(0));$.reverse()}for(I=D.length,K=Q.length,I-K<0&&($=Q,Q=D,D=$,K=I),I=0;K;)I=(D[--K]=D[K]+Q[K]+I)/a|0,D[K]=a===D[K]?0:D[K]%a;return I&&(D=[I].concat(D),++V),he(k,D,V)},Y.precision=Y.sd=function(k,K){var $,Z,I,U=this;if(k!=null&&k!==!!k)return v(k,1,h),K==null?K=w:v(K,0,8),pe(new X(U),k,K);if(!($=U.c))return null;if(I=$.length-1,Z=I*c+1,I=$[I]){for(;I%10==0;I/=10,Z--);for(I=$[0];I>=10;I/=10,Z++);}return k&&U.e+1>Z&&(Z=U.e+1),Z},Y.shiftedBy=function(k){return v(k,-u,u),this.times("1e"+k)},Y.squareRoot=Y.sqrt=function(){var k,K,$,Z,I,U=this,V=U.c,D=U.s,Q=U.e,ee=b+4,J=new X("0.5");if(D!==1||!V||!V[0])return new X(!D||D<0&&(!V||V[0])?NaN:V?U:1/0);if(D=Math.sqrt(+_e(U)),D==0||D==1/0?(K=m(V),(K.length+Q)%2==0&&(K+="0"),D=Math.sqrt(+K),Q=g((Q+1)/2)-(Q<0||Q%2),D==1/0?K="5e"+Q:(K=D.toExponential(),K=K.slice(0,K.indexOf("e")+1)+Q),$=new X(K)):$=new X(D+""),$.c[0]){for(Q=$.e,D=Q+ee,D<3&&(D=0);;)if(I=$,$=J.times(I.plus(N(U,I,ee,1))),m(I.c).slice(0,D)===(K=m($.c)).slice(0,D))if($.e<Q&&--D,K=K.slice(D-3,D+1),K=="9999"||!Z&&K=="4999"){if(!Z&&(pe(I,I.e+b+2,0),I.times(I).eq(U))){$=I;break}ee+=4,D+=4,Z=1}else{(!+K||!+K.slice(1)&&K.charAt(0)=="5")&&(pe($,$.e+b+2,1),k=!$.times($).eq(U));break}}return pe($,$.e+b+1,w,k)},Y.toExponential=function(k,K){return k!=null&&(v(k,0,h),k++),ne(this,k,K,1)},Y.toFixed=function(k,K){return k!=null&&(v(k,0,h),k=k+this.e+1),ne(this,k,K)},Y.toFormat=function(k,K,$){var Z,I=this;if($==null)k!=null&&K&&typeof K=="object"?($=K,K=null):k&&typeof k=="object"?($=k,k=K=null):$=L;else if(typeof $!="object")throw Error(s+"Argument not an object: "+$);if(Z=I.toFixed(k,K),I.c){var U,V=Z.split("."),D=+$.groupSize,Q=+$.secondaryGroupSize,ee=$.groupSeparator||"",J=V[0],ue=V[1],ge=I.s<0,be=ge?J.slice(1):J,Ke=be.length;if(Q&&(U=D,D=Q,Q=U,Ke-=U),D>0&&Ke>0){for(U=Ke%D||D,J=be.substr(0,U);U<Ke;U+=D)J+=ee+be.substr(U,D);Q>0&&(J+=ee+be.slice(U)),ge&&(J="-"+J)}Z=ue?J+($.decimalSeparator||"")+((Q=+$.fractionGroupSize)?ue.replace(new RegExp("\\d{"+Q+"}\\B","g"),"$&"+($.fractionGroupSeparator||"")):ue):J}return($.prefix||"")+Z+($.suffix||"")},Y.toFraction=function(k){var K,$,Z,I,U,V,D,Q,ee,J,ue,ge,be=this,Ke=be.c;if(k!=null&&(D=new X(k),!D.isInteger()&&(D.c||D.s!==1)||D.lt(P)))throw Error(s+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+_e(D));if(!Ke)return new X(be);for(K=new X(P),ee=$=new X(P),Z=Q=new X(P),ge=m(Ke),U=K.e=ge.length-be.e-1,K.c[0]=l[(V=U%c)<0?c+V:V],k=!k||D.comparedTo(K)>0?U>0?K:ee:D,V=W,W=1/0,D=new X(ge),Q.c[0]=0;J=N(D,K,0,1),I=$.plus(J.times(Z)),I.comparedTo(k)!=1;)$=Z,Z=I,ee=Q.plus(J.times(I=ee)),Q=I,K=D.minus(J.times(I=K)),D=I;return I=N(k.minus($),Z,0,1),Q=Q.plus(I.times(ee)),$=$.plus(I.times(Z)),Q.s=ee.s=be.s,U=U*2,ue=N(ee,Z,U,w).minus(be).abs().comparedTo(N(Q,$,U,w).minus(be).abs())<1?[ee,Z]:[Q,$],W=V,ue},Y.toNumber=function(){return+_e(this)},Y.toPrecision=function(k,K){return k!=null&&v(k,1,h),ne(this,k,K,2)},Y.toString=function(k){var K,$=this,Z=$.s,I=$.e;return I===null?Z?(K="Infinity",Z<0&&(K="-"+K)):K="NaN":(k==null?K=I<=S||I>=C?R(m($.c),I):F(m($.c),I,"0"):k===10?($=pe(new X($),b+I+1,w),K=F(m($.c),$.e,"0")):(v(k,2,ce.length,"Base"),K=z(F(m($.c),I,"0"),10,k,Z,!0)),Z<0&&$.c[0]&&(K="-"+K)),K},Y.valueOf=Y.toJSON=function(){return _e(this)},Y._isBigNumber=!0,q!=null&&X.set(q),X}function g(q){var N=q|0;return q>0||q===N?N:N-1}function m(q){for(var N,z,G=1,Y=q.length,P=q[0]+"";G<Y;){for(N=q[G++]+"",z=c-N.length;z--;N="0"+N);P+=N}for(Y=P.length;P.charCodeAt(--Y)===48;);return P.slice(0,Y+1||1)}function E(q,N){var z,G,Y=q.c,P=N.c,b=q.s,w=N.s,S=q.e,C=N.e;if(!b||!w)return null;if(z=Y&&!Y[0],G=P&&!P[0],z||G)return z?G?0:-w:b;if(b!=w)return b;if(z=b<0,G=S==C,!Y||!P)return G?0:!Y^z?1:-1;if(!G)return S>C^z?1:-1;for(w=(S=Y.length)<(C=P.length)?S:C,b=0;b<w;b++)if(Y[b]!=P[b])return Y[b]>P[b]^z?1:-1;return S==C?0:S>C^z?1:-1}function v(q,N,z,G){if(q<N||q>z||q!==n(q))throw Error(s+(G||"Argument")+(typeof q=="number"?q<N||q>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function A(q){var N=q.c.length-1;return g(q.e/c)==N&&q.c[N]%2!=0}function R(q,N){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+(N<0?"e":"e+")+N}function F(q,N,z){var G,Y;if(N<0){for(Y=z+".";++N;Y+=z);q=Y+q}else if(G=q.length,++N>G){for(Y=z,N-=G;--N;Y+=z);q+=Y}else N<G&&(q=q.slice(0,N)+"."+q.slice(N));return q}e=y(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof nS!="undefined"&&nS.exports?nS.exports=e:(t||(t=typeof self!="undefined"&&self?self:window),t.BigNumber=e)})(Fbe)});var TP=p((jbe,Vbe)=>{f();"use strict";var Apt=Math.exp;jbe=Vbe.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,i=0,n=0,s=0,o,a={};function c(u,l){return 1-Apt(-(u-l)/e)}return a.push=function(l,d){if(o){let h=c(l,o),y=d-r,g=h*y;r=h*d+(1-h)*r,i=(1-h)*(i+y*g),n=Math.sqrt(i),s=r+h*y}else r=d;o=l},a.movingAverage=function(){return r},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var Gbe=p((CMt,$be)=>{f();"use strict";var{EventEmitter:Ipt}=dr(),{BigNumber:sS}=Kbe(),zbe=TP(),Tpt=sP(),Hbe=class extends Ipt{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:sS(0),dataSent:sS(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=sS(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=zbe(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(r);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(r[s]))i.movingAverages[s][o]=r[s][o].movingAverage()}return i}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=Tpt(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(r||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],d=a[l];d||(d=a[l]=zbe(l)),d.push(i,o)}}_applyOp(e){let r=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,r)?n=this._stats[r]:n=this._stats[r]=sS(0),this._stats[r]=n.plus(i),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=i}};$be.exports=Hbe});var Xbe=p((OMt,Ybe)=>{f();"use strict";var Rpt=hr(),{pipe:Ppt}=Er(),{tap:Wbe}=gp(),Cpt=Ube(),{METRICS:Opt}=zE(),RP=Gbe(),PP=["dataReceived","dataSent"],kpt={in:"dataReceived",out:"dataSent"},oS=class{constructor(e){this._options=Rpt(Opt,e),this._globalStats=new RP(PP,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=Cpt(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",r=>{this.onPeerDisconnected(r.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),i=this._peerStats.get(r);i&&(i.stop(),this._peerStats.delete(r),this._oldPeers.set(r,i))}_onMessage({remotePeer:e,protocol:r,direction:i,dataLength:n}){if(!this._running)return;let s=kpt[i],o=this.forPeer(e);if(o||(o=new RP(PP,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),r){let a=this.forProtocol(r);a||(a=new RP(PP,this._options),this._protocolStats.set(r,a)),a.push(s,n)}}updatePlaceholder(e,r){if(!this._running)return;let i=this.forPeer(e),n=r.toB58String(),s=this.forPeer(r),o=i;s&&(o=oS.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:r,protocol:i}){let n=this,s=e.source;e.source=Wbe(a=>n._onMessage({remotePeer:r,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>Ppt(a,Wbe(c=>n._onMessage({remotePeer:r,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};Ybe.exports=oS});var aS=p(vd=>{f();"use strict";var Qbe=ln(),Zbe=Bo(),qpt=Er(),Npt=ae(),Dpt=ct(),Bpt=Jh(),Jbe=Dpt(`
`);vd.encode=t=>Zbe.encode.single(new Qbe([t,Jbe]));vd.write=(t,e)=>t.push(vd.encode(e));vd.writeAll=(t,e)=>{t.push(e.reduce((r,i)=>r.append(vd.encode(i)),new Qbe))};vd.read=async t=>{let e=1,r={[Symbol.asyncIterator](){return this},next:()=>t.next(e)},i=s=>{e=s},n=await qpt(r,Zbe.decode({onLength:i}),Bpt);if(n.get(n.length-1)!==Jbe[0])throw Npt(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.shallowSlice(0,-1)}});var t1e=p((qMt,e1e)=>{f();"use strict";var w0=me()("mss:select"),Mpt=ae(),_0=aS(),Lpt=p0();e1e.exports=async(t,e,r)=>{e=Array.isArray(e)?[...e]:[e];let{reader:i,writer:n,rest:s,stream:o}=Lpt(t),a=e.shift();r?(w0('select: write ["%s", "%s"]',r,a),_0.writeAll(n,[r,a])):(w0('select: write "%s"',a),_0.write(n,a));let c=(await _0.read(i)).toString();if(w0('select: read "%s"',c),c===r&&(c=(await _0.read(i)).toString(),w0('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let u of e){w0('select: write "%s"',u),_0.write(n,u);let l=(await _0.read(i)).toString();if(w0('select: read "%s" for "%s"',l,u),l===u)return s(),{stream:o,protocol:u}}throw s(),Mpt(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var CP=p(r1e=>{f();"use strict";r1e.PROTOCOL_ID="/multistream/1.0.0"});var n1e=p((DMt,i1e)=>{f();"use strict";var T1=me()("mss:handle"),Upt=ln(),E0=aS(),Fpt=p0(),{PROTOCOL_ID:OP}=CP();i1e.exports=async(t,e)=>{e=Array.isArray(e)?e:[e];let{writer:r,reader:i,rest:n,stream:s}=Fpt(t);for(;;){let o=(await E0.read(i)).toString();if(T1('read "%s"',o),o===OP){T1('respond with "%s" for "%s"',OP,o),E0.write(r,OP);continue}if(e.includes(o))return E0.write(r,o),T1('respond with "%s" for "%s"',o,o),n(),{stream:s,protocol:o};if(o==="ls"){E0.write(r,new Upt(e.map(a=>E0.encode(a)))),T1('respond with "%s" for %s',e,o);continue}E0.write(r,"na"),T1('respond with "na" for "%s"',o)}}});var a1e=p((BMt,o1e)=>{f();"use strict";var Kpt=O_(),jpt=me()("it-multistream-select:ls"),s1e=aS(),Vpt=p0(),zpt=Bo(),Hpt=Er();o1e.exports=async t=>{let{reader:e,writer:r,rest:i,stream:n}=Vpt(t);jpt('write "ls"'),s1e.write(r,"ls"),i();let s=await s1e.read(e),o=Kpt([s]),a=[];return await Hpt(o,zpt.decode(),async c=>{for await(let u of c)a.push(u.shallowSlice(0,-1).toString())}),{stream:n,protocols:a}}});var f1e=p(cS=>{f();"use strict";var c1e=t1e(),$pt=n1e(),Gpt=a1e(),{PROTOCOL_ID:kP}=CP();cS.PROTOCOL_ID=kP;var qP=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await c1e(this._stream,kP);this._stream=e,this._shaken=!0}},u1e=class extends qP{select(e){return c1e(this._stream,e,this._shaken?null:kP)}async ls(){await this._handshake();let{stream:e,protocols:r}=await Gpt(this._stream);return this._stream=e,r}};cS.Dialer=u1e;var l1e=class extends qP{handle(e){return $pt(this._stream,e)}};cS.Listener=l1e});var h1e=p((LMt,d1e)=>{f();"use strict";var Wpt={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};d1e.exports=Wpt});var v1e=p((UMt,m1e)=>{f();"use strict";var p1e=et(),{Multiaddr:Ypt}=tt(),fs=ae(),{OPEN:Xpt,CLOSING:y1e,CLOSED:NP}=h1e(),g1e=Symbol.for("@libp2p/interface-connection/connection"),b1e=class{constructor({localAddr:e,remoteAddr:r,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){Qpt(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:Xpt},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[g1e](){return!0}static isConnection(e){return Boolean(e&&e[g1e])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===y1e)throw fs(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===NP)throw fs(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:i}=await this._newStream(e);return this.addStream(r,{protocol:i}),{stream:r,protocol:i}}addStream(e,{protocol:r,metadata:i={}}){this.registry.set(e.id,{protocol:r,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==NP){if(this._closing)return this._closing;this.stat.status=y1e,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=NP}}};m1e.exports=b1e;function Qpt(t,e,r,i,n,s,o){if(t&&!Ypt.isMultiaddr(t))throw fs(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!p1e.isPeerId(e))throw fs(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!p1e.isPeerId(r))throw fs(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw fs(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw fs(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw fs(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw fs(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw fs(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw fs(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw fs(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw fs(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var _1e=p(w1e=>{f();"use strict";w1e.Connection=v1e()});var S1e=p((KMt,E1e)=>{f();"use strict";function Zpt(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}E1e.exports=function(e){var r=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),r=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,d=Array(l),h=0;h<l;h++)d[h]=arguments[h];return r[u].apply(null,[i].concat(Zpt(d.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return r},proxy:new Proxy(i,o)}}});var R1e=p((jMt,T1e)=>{f();"use strict";var x1e=me(),wi=Object.assign(x1e("libp2p:upgrader"),{error:x1e("libp2p:upgrader:err")}),wd=ae(),S0=f1e(),{Connection:Jpt}=_1e(),e0t=et(),{pipe:t0t}=Er(),A1e=S1e(),{codes:x0}=li(),I1e=class{constructor({localPeer:e,metrics:r,cryptos:i=new Map,muxers:n=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=r,this.cryptos=i,this.muxers=n,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let r,i,n,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=A1e());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}wi("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{({conn:r,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(r,this.muxers):n=r}catch(l){throw wi.error("Failed to upgrade inbound connection",l),await e.close(l),l}return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),wi("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw wd(new Error("outbound connection must have a peer id"),x0.ERR_INVALID_MULTIADDR);let i=e0t.createFromB58String(r),n,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=A1e());let h=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>h}),e=this.metrics.trackStream({stream:e,remotePeer:l})}wi("Starting the outbound connection upgrade");let d=e;this.protector&&(d=await this.protector.protect(e));try{({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,d,i,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(h){throw wi.error("Failed to upgrade outbound connection",h),await e.close(h),h}return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),wi("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async h=>{if(!u)return;let y=new S0.Listener(h);try{let{stream:g,protocol:m}=await y.handle(Array.from(this.protocols.keys()));wi("%s: incoming stream opened on %s",r,m),this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:m}),u.addStream(h,{protocol:m}),this._onStream({connection:u,stream:{...h,...g},protocol:m})}catch(g){wi.error(g)}},onStreamEnd:h=>{u.removeStream(h.id)}}),c=async h=>{wi("%s: starting new stream on %s",r,h);let y=a.newStream(),g=new S0.Dialer(y);try{let{stream:m,protocol:E}=await g.select(h);return this.metrics&&this.metrics.trackStream({stream:m,remotePeer:o,protocol:E}),{stream:{...y,...m},protocol:E}}catch(m){throw wi.error("could not create new stream",m),wd(m,x0.ERR_UNSUPPORTED_PROTOCOL)}},t0t(n,a,n).catch(wi.error));let l=i.timeline;i.timeline=new Proxy(l,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(y){wi.error(y)}finally{this.onConnectionEnd(u)}})(),Reflect.set(...h))}),i.timeline.upgraded=Date.now();let d=()=>{throw wd(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return u=new Jpt({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:r,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||d,getStreams:()=>a?a.streams:d(),close:async()=>{await i.close(),a&&a.streams.map(h=>h.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:r,protocol:i}){this.protocols.get(i)({connection:e,stream:r,protocol:i})}async _encryptInbound(e,r,i){let n=new S0.Listener(r),s=Array.from(i.keys());wi("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(wi("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw wd(o,x0.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,i,n){let s=new S0.Dialer(r),o=Array.from(n.keys());wi("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=n.get(c);if(wi("encrypting outbound connection to %j",i),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,i),protocol:c}}catch(a){throw wd(a,x0.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let i=new S0.Dialer(e),n=Array.from(r.keys());wi("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);wi("%s selected as muxer protocol",o);let a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw wd(s,x0.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let i=new S0.Listener(e),n=Array.from(r.keys());wi("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw wd(s,x0.ERR_MUXER_UNAVAILABLE)}}};T1e.exports=I1e});var R1=p((VMt,k1e)=>{f();"use strict";var DP=ae(),P1e=et(),{codes:{ERR_INVALID_PARAMETERS:C1e}}=li(),r0t=t=>t,O1e=class{constructor({peerStore:e,eventName:r,eventProperty:i,eventTransformer:n=r0t}){this._ps=e,this.eventName=r,this.eventProperty=i,this.eventTransformer=n,this.data=new Map}set(e,r){throw DP(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,r,{emit:i=!0}={}){let n=e.toB58String();this.data.set(n,r),i&&this._emit(e,r)}_emit(e,r){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(r)})}get(e){if(!P1e.isPeerId(e))throw DP(new Error("peerId must be an instance of peer-id"),C1e);let r=this.data.get(e.toB58String());return r?[...r]:void 0}delete(e){if(!P1e.isPeerId(e))throw DP(new Error("peerId must be an instance of peer-id"),C1e);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};k1e.exports=O1e});var B1e=p((zMt,D1e)=>{f();"use strict";var q1e=me(),jo=Object.assign(q1e("libp2p:peer-store:address-book"),{error:q1e("libp2p:peer-store:address-book:err")}),A0=ae(),{Multiaddr:i0t}=tt(),uS=et(),n0t=R1(),s0t=GE(),{codes:{ERR_INVALID_PARAMETERS:I0}}=li(),o0t=y1(),N1e=class extends n0t{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:r=>r.addresses?r.addresses.map(i=>i.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let r;try{r=s0t.createFromProtobuf(e.payload)}catch(c){return jo.error("invalid peer record received"),!1}if(!r.peerId.equals(e.peerId))return jo("signing key does not match PeerId in the PeerRecord"),!1;if(!r.multiaddrs||!r.multiaddrs.length)return!1;let i=r.peerId,n=i.toB58String(),o=(this.data.get(n)||{record:void 0}).record;if(o&&o.seqNumber>=r.seqNumber)return!1;let a=this._toAddresses(r.multiaddrs,!0);return this._setData(i,{addresses:a,record:{raw:e.marshal(),seqNumber:r.seqNumber}}),jo(`stored provided peer record for ${n}`),!0}getRawEnvelope(e){let r=this.data.get(e.toB58String());if(!(!r||!r.record||!r.record.raw))return r.record.raw}getPeerRecord(e){let r=this.getRawEnvelope(e);if(!!r)return o0t.createFromProtobuf(r)}set(e,r){if(!uS.isPeerId(e))throw jo.error("peerId must be an instance of peer-id to store data"),A0(new Error("peerId must be an instance of peer-id"),I0);let i=this._toAddresses(r);if(!i.length)return this;let n=e.toB58String(),s=this.data.get(n);return s&&s.addresses&&s.addresses.length===i.length&&s.addresses.filter(a=>i.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(jo(`the addresses provided to store are equal to the already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),jo(`stored provided multiaddrs for ${n}`),s||this._ps.emit("peer",e),this)}add(e,r){if(!uS.isPeerId(e))throw jo.error("peerId must be an instance of peer-id to store data"),A0(new Error("peerId must be an instance of peer-id"),I0);let i=this._toAddresses(r),n=e.toB58String();if(!i.length)return this;let s=this.data.get(n);return s&&s.addresses&&(s.addresses.forEach(o=>{i.find(a=>a.multiaddr.equals(o.multiaddr))||i.push(o)}),s.addresses.length===i.length)?(jo(`the addresses provided to store are already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),jo(`added provided multiaddrs for ${n}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!uS.isPeerId(e))throw A0(new Error("peerId must be an instance of peer-id"),I0);let r=this.data.get(e.toB58String());return r&&r.addresses?[...r.addresses]:void 0}_toAddresses(e,r=!1){if(!e)throw jo.error("multiaddrs must be provided to store data"),A0(new Error("multiaddrs must be provided"),I0);let i=[];return e.forEach(n=>{if(!i0t.isMultiaddr(n))throw jo.error(`multiaddr ${n} must be an instance of multiaddr`),A0(new Error(`multiaddr ${n} must be an instance of multiaddr`),I0);i.find(s=>s.multiaddr.equals(n))||i.push({multiaddr:n,isCertified:r})}),i}getMultiaddrsForPeer(e,r=i=>i){if(!uS.isPeerId(e))throw A0(new Error("peerId must be an instance of peer-id"),I0);let i=this.data.get(e.toB58String());if(!(!i||!i.addresses))return r(i.addresses||[]).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};D1e.exports=N1e});var z1e=p((HMt,V1e)=>{f();"use strict";var M1e=me(),L1e=Object.assign(M1e("libp2p:peer-store:key-book"),{error:M1e("libp2p:peer-store:key-book:err")}),U1e=ae(),F1e=et(),a0t=R1(),{codes:{ERR_INVALID_PARAMETERS:K1e}}=li(),j1e=class extends a0t{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:r=>r.pubKey});this.data=new Map}set(e,r){if(!F1e.isPeerId(e))throw L1e.error("peerId must be an instance of peer-id to store data"),U1e(new Error("peerId must be an instance of peer-id"),K1e);let i=e.toB58String();return!this.data.get(i)&&r&&(e.pubKey=r,this._setData(e,e),L1e(`stored provided public key for ${i}`)),this}get(e){if(!F1e.isPeerId(e))throw U1e(new Error("peerId must be an instance of peer-id"),K1e);let r=this.data.get(e.toB58String());return r?r.pubKey:void 0}};V1e.exports=j1e});var W1e=p(($Mt,G1e)=>{f();"use strict";var H1e=me(),BP=Object.assign(H1e("libp2p:peer-store:proto-book"),{error:H1e("libp2p:peer-store:proto-book:err")}),T0=ae(),c0t=ci(),P1=et(),u0t=R1(),{codes:{ERR_INVALID_PARAMETERS:R0}}=li(),$1e=class extends u0t{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,r,i){if(!P1.isPeerId(e))throw BP.error("peerId must be an instance of peer-id to store data"),T0(new Error("peerId must be an instance of peer-id"),R0);if(typeof r!="string"||!(i instanceof Uint8Array))throw BP.error("valid key and value must be provided to store data"),T0(new Error("valid key and value must be provided"),R0);return this._setValue(e,r,i),this}_setValue(e,r,i,{emit:n=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(r);if(a&&c0t(i,a)){BP(`the metadata provided to store is equal to the already stored for ${s} on ${r}`);return}o.set(r,i),this.data.set(s,o),n&&this._emit(e,r)}get(e){if(!P1.isPeerId(e))throw T0(new Error("peerId must be an instance of peer-id"),R0);return this.data.get(e.toB58String())}getValue(e,r){if(!P1.isPeerId(e))throw T0(new Error("peerId must be an instance of peer-id"),R0);let i=this.data.get(e.toB58String());return i&&i.get(r)}delete(e){if(!P1.isPeerId(e))throw T0(new Error("peerId must be an instance of peer-id"),R0);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,r){if(!P1.isPeerId(e))throw T0(new Error("peerId must be an instance of peer-id"),R0);let i=this.data.get(e.toB58String());return!i||!i.delete(r)?!1:(this._emit(e,r),!0)}};G1e.exports=$1e});var Z1e=p((GMt,Q1e)=>{f();"use strict";var Y1e=me(),Vo=Object.assign(Y1e("libp2p:peer-store:proto-book"),{error:Y1e("libp2p:peer-store:proto-book:err")}),P0=ae(),MP=et(),l0t=R1(),{codes:{ERR_INVALID_PARAMETERS:C0}}=li(),X1e=class extends l0t{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:r=>Array.from(r)});this.data=new Map}set(e,r){if(!MP.isPeerId(e))throw Vo.error("peerId must be an instance of peer-id to store data"),P0(new Error("peerId must be an instance of peer-id"),C0);if(!r)throw Vo.error("protocols must be provided to store data"),P0(new Error("protocols must be provided"),C0);let i=e.toB58String(),n=this.data.get(i),s=new Set(r);return n&&((a,c)=>a.size===c.size&&[...a].every(u=>c.has(u)))(n,s)?(Vo(`the protocols provided to store are equal to the already stored for ${i}`),this):(this._setData(e,s),Vo(`stored provided protocols for ${i}`),this)}add(e,r){if(!MP.isPeerId(e))throw Vo.error("peerId must be an instance of peer-id to store data"),P0(new Error("peerId must be an instance of peer-id"),C0);if(!r)throw Vo.error("protocols must be provided to store data"),P0(new Error("protocols must be provided"),C0);let i=e.toB58String(),n=this.data.get(i)||new Set,s=new Set([...n,...r]);return n.size===s.size?(Vo(`the protocols provided to store are already stored for ${i}`),this):(this._setData(e,s),Vo(`added provided protocols for ${i}`),this)}remove(e,r){if(!MP.isPeerId(e))throw Vo.error("peerId must be an instance of peer-id to store data"),P0(new Error("peerId must be an instance of peer-id"),C0);if(!r)throw Vo.error("protocols must be provided to store data"),P0(new Error("protocols must be provided"),C0);let i=e.toB58String(),n=this.data.get(i);if(n){let s=new Set([...n].filter(o=>!r.includes(o)));if(n.size===s.size)return this;this._setData(e,s),Vo(`removed provided protocols for ${i}`)}return this}};Q1e.exports=X1e});var LP=p((WMt,tme)=>{f();"use strict";var f0t=ae(),{EventEmitter:d0t}=dr(),J1e=et(),h0t=B1e(),p0t=z1e(),y0t=W1e(),g0t=Z1e(),{codes:{ERR_INVALID_PARAMETERS:b0t}}=li(),eme=class extends d0t{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new h0t(this),this.keyBook=new p0t(this),this.metadataBook=new y0t(this),this.protoBook=new g0t(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let r=new Map;return e.forEach(i=>{r.set(i,this.get(J1e.createFromB58String(i)))}),r}delete(e){let r=this.addressBook.delete(e),i=this.keyBook.delete(e),n=this.protoBook.delete(e),s=this.metadataBook.delete(e);return r||i||n||s}get(e){if(!J1e.isPeerId(e))throw f0t(new Error("peerId must be an instance of peer-id"),b0t);let r=this.keyBook.data.get(e.toB58String()),i=this.addressBook.get(e),n=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!r&&!i&&!n&&!s))return{id:r||e,addresses:i||[],protocols:s||[],metadata:n}}};tme.exports=eme});var ime=p((YMt,rme)=>{f();"use strict";function m0t(t,e,r){let i=new t(e,r);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}rme.exports=m0t});var nme=p((XMt,O0)=>{f();"use strict";O0.exports.NAMESPACE_COMMON="/peers/";O0.exports.NAMESPACE_ADDRESS="/peers/addrs/";O0.exports.NAMESPACE_KEYS="/peers/keys/";O0.exports.NAMESPACE_METADATA="/peers/metadata/";O0.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var ome=p((QMt,sme)=>{f();"use strict";var xl=Ti(),k0=xl.Reader,UP=xl.Writer,$r=xl.util,_i=xl.roots["libp2p-address-book"]||(xl.roots["libp2p-address-book"]={});_i.Addresses=function(){function t(e){if(this.addrs=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.addrs=$r.emptyArray,t.prototype.certifiedRecord=null,t.encode=function(r,i){if(i||(i=UP.create()),r.addrs!=null&&r.addrs.length)for(var n=0;n<r.addrs.length;++n)_i.Addresses.Address.encode(r.addrs[n],i.uint32(10).fork()).ldelim();return r.certifiedRecord!=null&&Object.hasOwnProperty.call(r,"certifiedRecord")&&_i.Addresses.CertifiedRecord.encode(r.certifiedRecord,i.uint32(18).fork()).ldelim(),i},t.decode=function(r,i){r instanceof k0||(r=k0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new _i.Addresses;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(_i.Addresses.Address.decode(r,r.uint32()));break;case 2:s.certifiedRecord=_i.Addresses.CertifiedRecord.decode(r,r.uint32());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof _i.Addresses)return r;var i=new _i.Addresses;if(r.addrs){if(!Array.isArray(r.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<r.addrs.length;++n){if(typeof r.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=_i.Addresses.Address.fromObject(r.addrs[n])}}if(r.certifiedRecord!=null){if(typeof r.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=_i.Addresses.CertifiedRecord.fromObject(r.certifiedRecord)}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),r.addrs&&r.addrs.length){n.addrs=[];for(var s=0;s<r.addrs.length;++s)n.addrs[s]=_i.Addresses.Address.toObject(r.addrs[s],i)}return r.certifiedRecord!=null&&r.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=_i.Addresses.CertifiedRecord.toObject(r.certifiedRecord,i)),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,xl.util.toJSONOptions)},t.Address=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.multiaddr=$r.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(i,n){return n||(n=UP.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},e.decode=function(i,n){i instanceof k0||(i=k0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new _i.Addresses.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof _i.Addresses.Address)return i;var n=new _i.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?$r.base64.decode(i.multiaddr,n.multiaddr=$r.newBuffer($r.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=$r.newBuffer(s.multiaddr))),s.isCertified=!1),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?$r.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,xl.util.toJSONOptions)},e}(),t.CertifiedRecord=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.seq=$r.Long?$r.Long.fromBits(0,0,!0):0,e.prototype.raw=$r.newBuffer([]),e.encode=function(i,n){return n||(n=UP.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof k0||(i=k0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new _i.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof _i.Addresses.CertifiedRecord)return i;var n=new _i.Addresses.CertifiedRecord;return i.seq!=null&&($r.Long?(n.seq=$r.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new $r.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?$r.base64.decode(i.raw,n.raw=$r.newBuffer($r.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if($r.Long){var o=new $r.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=$r.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?$r.Long.prototype.toString.call(i.seq):n.longs===Number?new $r.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?$r.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,xl.util.toJSONOptions)},e}(),t}();sme.exports=_i});var ume=p((ZMt,cme)=>{f();"use strict";var q0=Ti(),ame=q0.Reader,v0t=q0.Writer,w0t=q0.util,C1=q0.roots["libp2p-proto-book"]||(q0.roots["libp2p-proto-book"]={});C1.Protocols=function(){function t(e){if(this.protocols=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.protocols=w0t.emptyArray,t.encode=function(r,i){if(i||(i=v0t.create()),r.protocols!=null&&r.protocols.length)for(var n=0;n<r.protocols.length;++n)i.uint32(10).string(r.protocols[n]);return i},t.decode=function(r,i){r instanceof ame||(r=ame.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new C1.Protocols;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof C1.Protocols)return r;var i=new C1.Protocols;if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<r.protocols.length;++n)i.protocols[n]=String(r.protocols[n])}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),r.protocols&&r.protocols.length){n.protocols=[];for(var s=0;s<r.protocols.length;++s)n.protocols[s]=r.protocols[s]}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,q0.util.toJSONOptions)},t}();cme.exports=C1});var yme=p((JMt,pme)=>{f();"use strict";var lme=me(),Fi=Object.assign(lme("libp2p:persistent-peer-store"),{error:lme("libp2p:persistent-peer-store:err")}),{Key:lS}=Ft(),{Multiaddr:_0t}=tt(),FP=et(),{base32:E0t}=(Ji(),Zi),S0t=LP(),{NAMESPACE_ADDRESS:x0t,NAMESPACE_COMMON:A0t,NAMESPACE_KEYS:I0t,NAMESPACE_METADATA:T0t,NAMESPACE_PROTOCOL:R0t}=nme(),{Addresses:fme}=ome(),{Protocols:dme}=ume(),hme=class extends S0t{constructor({peerId:e,datastore:r,threshold:i=5}){super({peerId:e});this._datastore=r,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=i,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){Fi("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:A0t}))await this._processDatastoreEntry(e);Fi("PeerStore started")}async stop(){Fi("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),Fi("PeerStore stopped")}_addDirtyPeer({peerId:e}){let r=e.toB58String();Fi("add dirty peer",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{Fi.error("error committing data",i)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let r=e.toB58String();Fi("add dirty peer key",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{Fi.error("error committing data",i)})}_addDirtyPeerMetadata({peerId:e,metadata:r}){let i=e.toB58String();Fi("add dirty metadata peer",i),this._dirtyPeers.add(i);let n=this._dirtyMetadata.get(i)||new Set;n.add(r),this._dirtyMetadata.set(i,n),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{Fi.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),Fi("create batch commit");let r=this._datastore.batch();for(let i of e){let n=this.keyBook.data.get(i)||FP.createFromB58String(i);this._batchAddressBook(n,r),!n.hasInlinePublicKey()&&this._batchKeyBook(n,r),this._batchMetadataBook(n,r),this._batchProtoBook(n,r)}await r.commit(),Fi("batch committed")}_batchAddressBook(e,r){let i=e.toString(),n=new lS(`${x0t}${i}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){r.delete(n);return}let o=fme.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();r.put(n,o)}catch(o){Fi.error(o)}}_batchKeyBook(e,r){let i=e.toString(),n=new lS(`${I0t}${i}`);try{if(!e.pubKey){r.delete(n);return}let s=e.marshalPubKey();r.put(n,s)}catch(s){Fi.error(s)}}_batchMetadataBook(e,r){let i=e.toString(),n=this._dirtyMetadata.get(e.toB58String())||[];try{n.forEach(s=>{let o=new lS(`${T0t}${i}/${s}`),a=this.metadataBook.getValue(e,s);a?r.put(o,a):r.delete(o)})}catch(s){Fi.error(s)}}_batchProtoBook(e,r){let i=e.toString(),n=new lS(`${R0t}${i}`),s=this.protoBook.get(e);try{if(!s){r.delete(n);return}let o=dme.encode({protocols:s}).finish();r.put(n,o)}catch(o){Fi.error(o)}}async _processDatastoreEntry({key:e,value:r}){try{let i=e.toString().split("/"),n=FP.createFromBytes(E0t.decode(i[3])),s;switch(i[2]){case"addrs":s=fme.decode(r),this.addressBook._setData(n,{addresses:s.addrs.map(o=>({multiaddr:new _0t(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await FP.createFromPubKey(r),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(n,i[4],r,{emit:!1});break;case"protos":s=dme.decode(r),this.protoBook._setData(n,new Set(s.protocols),{emit:!1});break;default:Fi("invalid data persisted for: ",e.toString())}}catch(i){Fi.error(i)}}};pme.exports=hme});var vme=p((e7t,mme)=>{f();"use strict";var gme=me(),P0t=Object.assign(gme("libp2p:registrar"),{error:gme("libp2p:registrar:err")}),C0t=ae(),{codes:{ERR_INVALID_PARAMETERS:O0t}}=li(),k0t=HR(),bme=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!k0t.isTopology(e))throw P0t.error("topology must be an instance of interfaces/topology"),C0t(new Error("topology must be an instance of interfaces/topology"),O0t);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),e.registrar=this,r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};mme.exports=bme});var hS=p((t7t,O1)=>{f();"use strict";var{Buffer:fS}=Ut(),dS=ln();O1.exports=async function*(t){for await(let e of t)fS.isBuffer(e)?yield e:dS.isBufferList(e)?yield e.slice():yield fS.from(e)};O1.exports.toBuffer=O1.exports;O1.exports.toList=async function*(t){for await(let e of t)fS.isBuffer(e)?yield new dS().append(e):dS.isBufferList(e)?yield e:yield new dS().append(fS.from(e))}});var _me=p((r7t,wme)=>{f();"use strict";wme.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var Ame=p((pS,xme)=>{f();"use strict";var Eme=me(),q0t=Object.assign(Eme("libp2p:ping"),{error:Eme("libp2p:ping:err")}),N0t=ae(),D0t=xa(),{pipe:Sme}=Er(),{toBuffer:B0t}=hS(),{collect:M0t,take:L0t}=gp(),U0t=ci(),{PROTOCOL_NAME:KP,PING_LENGTH:F0t,PROTOCOL_VERSION:jP}=_me();async function K0t(t,e){let r=`/${t._config.protocolPrefix}/${KP}/${jP}`;q0t("dialing %s to %s",r,e.toB58String?e.toB58String():e);let i=await t.dial(e),{stream:n}=await i.newStream(r),s=Date.now(),o=D0t.randomBytes(F0t),[a]=await Sme([o],n,u=>L0t(1,u),B0t,M0t),c=Date.now();if(!U0t(o,a))throw N0t(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return c-s}function j0t(t){t.handle(`/${t._config.protocolPrefix}/${KP}/${jP}`,({stream:e})=>Sme(e,e))}function V0t(t){t.unhandle(`/${t._config.protocolPrefix}/${KP}/${jP}`)}pS=xme.exports=K0t;pS.mount=j0t;pS.unmount=V0t});var Rme=p((i7t,Tme)=>{f();"use strict";var N0=Ti(),Ime=N0.Reader,z0t=N0.Writer,wr=N0.util,k1=N0.roots["libp2p-identify"]||(N0.roots["libp2p-identify"]={});k1.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=wr.newBuffer([]),t.prototype.listenAddrs=wr.emptyArray,t.prototype.observedAddr=wr.newBuffer([]),t.prototype.protocols=wr.emptyArray,t.prototype.signedPeerRecord=wr.newBuffer([]),t.encode=function(r,i){if(i||(i=z0t.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var n=0;n<r.listenAddrs.length;++n)i.uint32(18).bytes(r.listenAddrs[n]);if(r.protocols!=null&&r.protocols.length)for(var n=0;n<r.protocols.length;++n)i.uint32(26).string(r.protocols[n]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&i.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&i.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&i.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&i.uint32(66).bytes(r.signedPeerRecord),i},t.decode=function(r,i){r instanceof Ime||(r=Ime.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new k1.Identify;r.pos<n;){var o=r.uint32();switch(o>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof k1.Identify)return r;var i=new k1.Identify;if(r.protocolVersion!=null&&(i.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(i.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?wr.base64.decode(r.publicKey,i.publicKey=wr.newBuffer(wr.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<r.listenAddrs.length;++n)typeof r.listenAddrs[n]=="string"?wr.base64.decode(r.listenAddrs[n],i.listenAddrs[n]=wr.newBuffer(wr.base64.length(r.listenAddrs[n])),0):r.listenAddrs[n].length&&(i.listenAddrs[n]=r.listenAddrs[n])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?wr.base64.decode(r.observedAddr,i.observedAddr=wr.newBuffer(wr.base64.length(r.observedAddr)),0):r.observedAddr.length&&(i.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<r.protocols.length;++n)i.protocols[n]=String(r.protocols[n])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?wr.base64.decode(r.signedPeerRecord,i.signedPeerRecord=wr.newBuffer(wr.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(i.signedPeerRecord=r.signedPeerRecord)),i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=wr.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=wr.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=wr.newBuffer(n.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?wr.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?wr.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){n.protocols=[];for(var s=0;s<r.protocols.length;++s)n.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?wr.base64.encode(r.observedAddr,0,r.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(n.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(n.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?wr.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,N0.util.toJSONOptions)},t}();Tme.exports=k1});var Mme=p((n7t,Bme)=>{f();"use strict";var Pme=me(),Xa=Object.assign(Pme("libp2p:identify"),{error:Pme("libp2p:identify:err")}),VP=ae(),yS=Bo(),{pipe:gS}=Er(),{collect:Cme,take:Ome,consume:kme}=gp(),D0=ct(),H0t=et(),{Multiaddr:zP}=tt(),{toBuffer:qme}=hS(),q1=Rme(),Nme=y1(),Dme=GE(),{MULTICODEC_IDENTIFY:$0t,MULTICODEC_IDENTIFY_PUSH:G0t,IDENTIFY_PROTOCOL_VERSION:W0t,MULTICODEC_IDENTIFY_PROTOCOL_NAME:Y0t,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:X0t,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:Q0t,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:Z0t}=G8(),{codes:HP}=li(),_d=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${Y0t}/${Q0t}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${X0t}/${Z0t}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let r=_d.getProtocolStr(e);this.identifyProtocolStr=r.identifyProtocolStr,this.identifyPushProtocolStr=r.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${W0t}`,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",D0(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",D0(this._host.protocolVersion)),this.connectionManager.on("peer:connect",i=>{this.identify(i).catch(Xa.error)}),this.peerStore.on("change:multiaddrs",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await gS([q1.Identify.encode({listenAddrs:i,signedPeerRecord:r,protocols:n}).finish()],yS.encode(),a,kme)}catch(a){Xa.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for(let i of this.peerStore.peers.values())i.protocols.includes(this.identifyPushProtocolStr)&&(r=this.connectionManager.get(i.id))&&e.push(r);this.push(e)}async identify(e){let{stream:r}=await e.newStream(this.identifyProtocolStr),[i]=await gS([],r,yS.decode(),Ome(1),qme,Cme);if(!i)throw VP(new Error("No data could be retrieved"),HP.ERR_CONNECTION_ENDED);let n;try{n=q1.Identify.decode(i)}catch(h){throw VP(h,HP.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=n,l=await H0t.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw VP(new Error("identified peer does not match the expected peer"),HP.ERR_INVALID_PEER);let d=_d.getCleanMultiaddr(c);try{let h=await Nme.openAndCertify(u,Dme.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(h)){this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",D0(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",D0(n.protocolVersion));return}}catch(h){Xa("received invalid envelope, discard it and fallback to listenAddrs is available",h)}try{this.peerStore.addressBook.set(l,o.map(h=>new zP(h)))}catch(h){Xa.error("received invalid addrs",h)}this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",D0(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",D0(n.protocolVersion)),Xa("received observed address of %s",d)}handleMessage({connection:e,stream:r,protocol:i}){switch(i){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:r});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:r});default:Xa.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:r}){let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=q1.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await gS([o],yS.encode(),r,kme)}catch(a){Xa.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:r}){let i;try{let[s]=await gS([],r,yS.decode(),Ome(1),qme,Cme);i=q1.Identify.decode(s)}catch(s){return Xa.error("received invalid message",s)}let n=e.remotePeer;try{let s=await Nme.openAndCertify(i.signedPeerRecord,Dme.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){Xa("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new zP(s)))}catch(s){Xa.error("received invalid addrs",s)}this.peerStore.protoBook.set(n,i.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new zP(e)}catch(r){return null}return null}},J0t={IDENTIFY:$0t,IDENTIFY_PUSH:G0t};_d.multicodecs=J0t;_d.Messsage=q1;Bme.exports=_d});var Lme=p(()=>{f()});var Fme=p($P=>{f();"use strict";Object.defineProperty($P,"__esModule",{value:!0});$P.promisify=bS;var Ume="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function bS(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[Ume],r=bS.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return new r(function(a,c){s.push(function(l){if(l)return c(l);for(var d=arguments.length,h=new Array(d>1?d-1:0),y=1;y<d;y++)h[y-1]=arguments[y];if(h.length===1||!e)return a(h[0]);var g={};h.forEach(function(m,E){var v=e[E];v&&(g[v]=m)}),a(g)}),t.apply(i,s)})}}bS.argumentNames=Ume;bS.Promise=void 0});var jme=p((c7t,Kme)=>{f();"use strict";var eyt=cx(),mS=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,N1=eyt(),tyt=mS&&!N1,ryt=N1&&!mS,iyt=N1&&mS,nyt=typeof Wo=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!N1,syt=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,oyt=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;Kme.exports={isTest:oyt,isElectron:N1,isElectronMain:ryt,isElectronRenderer:iyt,isNode:nyt,isBrowser:tyt,isWebWorker:syt,isEnvWithDom:mS}});var zme=p((u7t,Vme)=>{f();function Ys(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}Vme.exports=Ys;Ys.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Ys.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Ys.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},r),this._options.unref&&this._timer.unref(),!0};Ys.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Ys.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};Ys.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};Ys.prototype.start=Ys.prototype.try;Ys.prototype.errors=function(){return this._errors};Ys.prototype.attempts=function(){return this._attempts};Ys.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(t[s]||0)+1;t[s]=o,o>=r&&(e=n,r=o)}return e}});var Hme=p(Ed=>{f();var ayt=zme();Ed.operation=function(t){var e=Ed.timeouts(t);return new ayt(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};Ed.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return t&&t.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};Ed.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,i=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return i=Math.min(i,e.maxTimeout),i};Ed.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var i in t)typeof t[i]=="function"&&r.push(i)}for(var n=0;n<r.length;n++){var s=r[n],o=t[s];t[s]=function(c){var u=Ed.operation(e),l=Array.prototype.slice.call(arguments,1),d=l.pop();l.push(function(h){u.retry(h)||(h&&(arguments[0]=u.mainError()),d.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,o),t[s].options=e}}});var Gme=p((f7t,$me)=>{f();$me.exports=Hme()});var Yme=p((d7t,vS)=>{f();"use strict";var cyt=Gme(),uyt=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],GP=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},lyt=(t,e,r)=>{let i=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=i,t},fyt=t=>uyt.includes(t),Wme=(t,e)=>new Promise((r,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=cyt.operation(e);n.attempt(async s=>{try{r(await t(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof GP)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!fyt(o.message))n.stop(),i(o);else{lyt(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});vS.exports=Wme;vS.exports.default=Wme;vS.exports.AbortError=GP});var Qme=p((h7t,Xme)=>{f();"use strict";function dyt(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}Xme.exports=dyt});var Jme=p((p7t,Zme)=>{f();"use strict";var hyt=Qme();function pyt(t){let{address:e}=t.nodeAddress();return hyt(e)}Zme.exports=pyt});var sve=p((y7t,nve)=>{f();"use strict";var yyt=Lme(),eve=me(),{promisify:WP}=Fme(),{Multiaddr:gyt}=tt(),B0=Object.assign(eve("libp2p:nat"),{error:eve("libp2p:nat:err")}),{isBrowser:tve}=jme(),YP=Yme(),byt=W8(),rve=$8(),myt=ae(),{codes:{ERR_INVALID_PARAMETERS:vyt}}=li(),wyt=Jme(),XP=7200;function _yt(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var ive=class{constructor({peerId:e,addressManager:r,transportManager:i,...n}){if(this._peerId=e,this._addressManager=r,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${rve.name}@${rve.version} ${this._peerId}`,ttl:n.ttl||XP,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<XP)throw myt(new Error(`NatManager ttl should be at least ${XP} seconds`),vyt)}start(){tve||!this._enabled||this._start().catch(e=>{B0.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:i,host:n,port:s,transport:o}=r.toOptions();if(!r.isThinWaistAddress()||o!=="tcp"||wyt(r)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(byt(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=_yt();B0(`opening uPnP connection from ${c}:${u} to ${n}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(gyt.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new yyt(this._options),r=WP(e.map.bind(e)),i=WP(e.destroy.bind(e)),n=WP(e.externalIp.bind(e));return this._client={map:(...s)=>YP(()=>r(...s),{onFailedAttempt:B0.error,unref:!0}),destroy:(...s)=>YP(()=>i(...s),{onFailedAttempt:B0.error,unref:!0}),externalIp:(...s)=>YP(()=>n(...s),{onFailedAttempt:B0.error,unref:!0})},this._client}async stop(){if(!(tve||!this._client))try{await this._client.destroy(),this._client=null}catch(e){B0.error(e)}}};nve.exports=ive});var fve=p((g7t,lve)=>{f();"use strict";var ove=me(),ds=Object.assign(ove("libp2p"),{error:ove("libp2p:err")}),{EventEmitter:Eyt}=dr(),QP=ae(),Syt=et(),{Multiaddr:xyt}=tt(),Ayt=h0e(),Iyt=g0e(),ZP=H8(),{validate:Tyt}=bye(),{codes:wS,messages:Ryt}=li(),Pyt=wye(),Cyt=Bye(),ave=dge(),Oyt=Age(),kyt=Qge(),cve=Mbe(),qyt=Xbe(),Nyt=rP(),Dyt=R1e(),Byt=LP(),Myt=ime(),Lyt=yme(),Uyt=vme(),_S=Ame(),uve=Mme(),Fyt=sve(),{updateSelfPeerRecord:Kyt}=eP(),D1=class extends Eyt{static async create(e){if(e.peerId)return new D1(e);let r=await Syt.create();return e.peerId=r,new D1(e)}constructor(e){super();if(this._options=Tyt(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new Lyt({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new Byt({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new Pyt(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{Kyt(this).catch(i=>{ds.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new Cyt(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new qyt({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){ds("creating keychain");let i=cve.generateOptions();this.keychain=new cve(this._options.keychain.datastore,{...i,...this._options.keychain}),ds("keychain constructed")}if(this.upgrader=new Dyt({localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new Nyt({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new Fyt({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new Uyt({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw QP(new Error(Ryt.CONN_ENCRYPTION_REQUIRED),wS.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new kyt({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(ave.prototype[Symbol.toStringTag],ave),this.relay=new Oyt(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new uve({libp2p:this}),this.handle(Object.values(uve.getProtocolStr(this)),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=new i({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=Myt(i,this,this._config.pubsub)}this.peerRouting=new Ayt(this),this.contentRouting=new Iyt(this),_S.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...r){return e==="error"&&!this._events.error?(ds.error(r),!1):super.emit(e,...r)}async start(){ds("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),ds("libp2p has started")}catch(e){throw this.emit("error",e),ds.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){ds("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop();for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),_S.unmount(this),this.dialer.destroy()}catch(e){e&&(ds.error(e),this.emit("error",e))}ds("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,i){if(!r||!r.length)throw QP(new Error("no protocols were provided to open a stream"),wS.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(r)}async _dial(e,r){let{id:i,multiaddrs:n}=ZP(e);if(i.equals(this.peerId))throw QP(new Error("Cannot dial self"),wS.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let r=this._options.addresses.announceFilter,i=new Set(e);return r(Array.from(i).map(n=>new xyt(n)))}async hangUp(e){let{id:r}=ZP(e),i=this.connectionManager.connections.get(r.toB58String());!i||await Promise.all(i.map(n=>n.close()))}ping(e){let{id:r,multiaddrs:i}=ZP(e);return i?_S(this,i[0]):_S(this,r)}handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,r)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){ds.error(new Error(wS.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){ds("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){ds.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=r=>{let i={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(i={...i,...this._config.peerDiscovery[r.tag]}),i.enabled&&!this._discovery.has(r.tag)){let n;typeof r=="function"?n=new r(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=r,n.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,n)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};lve.exports=D1});var dve=p(()=>{f()});var pve=p((v7t,hve)=>{f();hve.exports=typeof WebSocket=="undefined"?dve():WebSocket});var gve=p(ES=>{f();"use strict";Object.defineProperty(ES,"__esModule",{value:!0});var yve=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let r={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(r)}else this.pushQueue.push(Promise.resolve(r)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let r of this.pullQueue)r.reject(e);this.pullQueue.length=0}else{let r=Promise.reject(e);r.catch(()=>{}),this.pushQueue.push(r)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let r=this.pushQueue.shift();return r?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),r):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},JP=class{constructor(e,{highWaterMark:r=100,lowWaterMark:i=1}={}){let n=new yve;n.highWaterMark=r,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};ES.EventIterator=JP;ES.default=JP});var bve=p(B1=>{f();"use strict";Object.defineProperty(B1,"__esModule",{value:!0});var eC=gve();B1.EventIterator=eC.EventIterator;function jyt(t,e,r){return new eC.EventIterator(({push:i})=>(this.addEventListener(t,i,e),()=>this.removeEventListener(t,i,e)),r)}B1.subscribe=jyt;B1.default=eC.EventIterator});var vve=p((E7t,mve)=>{f();var{Buffer:Vyt}=Ut(),{EventIterator:zyt}=bve();function Hyt(t){return t instanceof ArrayBuffer||t!=null&&t.constructor!=null&&t.constructor.name==="ArrayBuffer"&&typeof t.byteLength=="number"}mve.exports=t=>{let e=t.removeEventListener||t.removeListener,r=async function*(){let s=new zyt(({push:o,stop:a,fail:c})=>(t.addEventListener("message",o),t.addEventListener("error",c),t.addEventListener("close",a),()=>{e.call(t,"message",o),e.call(t,"error",c),e.call(t,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield Hyt(o)?Vyt.from(o):o}(),i=t.readyState===1,n;return t.addEventListener("open",()=>{i=!0,n=null}),t.addEventListener("close",()=>{i=!1,n=null}),t.addEventListener("error",s=>{i||(n=s)}),r.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=l=>{e.call(t,"open",c),e.call(t,"error",u),l()},c=()=>a(s),u=l=>a(()=>o(l));t.addEventListener("open",c),t.addEventListener("error",u)}),r}});var _ve=p((S7t,wve)=>{f();wve.exports=async t=>{if(t.readyState>=2)throw new Error("socket closed");if(t.readyState!==1)return new Promise((e,r)=>{let i=t&&(t.removeEventListener||t.removeListener);function n(){typeof i=="function"&&(i.call(t,"open",s),i.call(t,"error",o))}function s(){n(),e()}function o(a){n(),r(a)}t.addEventListener("open",s),t.addEventListener("error",o)})}});var Sve=p((x7t,Eve)=>{f();var $yt=_ve();Eve.exports=(t,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async r=>{for await(let i of r){try{await $yt(t)}catch(n){if(n.message==="socket closed")break;throw n}t.send(i)}if(e.closeOnEnd&&t.readyState<=1)return new Promise((i,n)=>{t.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>t.close())})})});var Ave=p((A7t,xve)=>{f();var Gyt=vve(),Wyt=Sve();xve.exports=(t,e)=>{e=e||{},e.binaryType?t.binaryType=e.binaryType:e.binary&&(t.binaryType="arraybuffer");let r={sink:Wyt(t,e),source:Gyt(t,e),connected:()=>r.source.connected()};return r}});var Tve=p((I7t,Ive)=>{f();var{relative:Yyt}=Um(),Xyt={http:"ws",https:"wss"},Qyt="ws";Ive.exports=(t,e)=>Yyt(t,e,Xyt,Qyt)});var Rve=p((T7t,SS)=>{f();"use strict";var Zyt=pve(),Jyt=Ave(),egt=Tve();SS.exports=function(t,e={}){let r=typeof window=="undefined"?{}:window.location,i=egt(t,r),n=new Zyt(i,e.websocket),s=Jyt(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};SS.exports.connect=SS.exports});var Cve=p((R7t,Pve)=>{f();"use strict";Pve.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var tC=p(Sd=>{f();"use strict";Sd.CODE_P2P=421;Sd.CODE_CIRCUIT=290;Sd.CODE_TCP=6;Sd.CODE_WS=477;Sd.CODE_WSS=478;Sd.CLOSE_TIMEOUT=2e3});var rC=p(M0=>{f();"use strict";Object.defineProperty(M0,"__esModule",{value:!0});M0.isCorrect=M0.isInSubnet=void 0;function tgt(t){return this.subnetMask<t.subnetMask?!1:this.mask(t.subnetMask)===t.mask()}M0.isInSubnet=tgt;function rgt(t){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===t&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}M0.isCorrect=rgt});var iC=p(Qa=>{f();"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.RE_SUBNET_STRING=Qa.RE_ADDRESS=Qa.GROUPS=Qa.BITS=void 0;Qa.BITS=32;Qa.GROUPS=4;Qa.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;Qa.RE_SUBNET_STRING=/\/\d{1,2}$/});var xS=p(L0=>{f();"use strict";var igt=L0&&L0.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(L0,"__esModule",{value:!0});L0.AddressError=void 0;var ngt=function(t){igt(e,t);function e(r,i){var n=t.call(this,r)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);L0.AddressError=ngt});var nC=p((AS,Ove)=>{f();(function(){var t,e=244837814094590,r=(e&16777215)==15715070;function i(x,T,H){x!=null&&(typeof x=="number"?this.fromNumber(x,T,H):T==null&&typeof x!="string"?this.fromString(x,256):this.fromString(x,T))}function n(){return new i(null)}function s(x,T,H,ie,ye,Ee){for(;--Ee>=0;){var De=T*this[x++]+H[ie]+ye;ye=Math.floor(De/67108864),H[ie++]=De&67108863}return ye}function o(x,T,H,ie,ye,Ee){for(var De=T&32767,Fe=T>>15;--Ee>=0;){var lr=this[x]&32767,xi=this[x++]>>15,gs=Fe*lr+xi*De;lr=De*lr+((gs&32767)<<15)+H[ie]+(ye&1073741823),ye=(lr>>>30)+(gs>>>15)+Fe*xi+(ye>>>30),H[ie++]=lr&1073741823}return ye}function a(x,T,H,ie,ye,Ee){for(var De=T&16383,Fe=T>>14;--Ee>=0;){var lr=this[x]&16383,xi=this[x++]>>14,gs=Fe*lr+xi*De;lr=De*lr+((gs&16383)<<14)+H[ie]+ye,ye=(lr>>28)+(gs>>14)+Fe*xi,H[ie++]=lr&268435455}return ye}var c=typeof navigator!="undefined";c&&r&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,t=30):c&&r&&navigator.appName!="Netscape"?(i.prototype.am=s,t=26):(i.prototype.am=a,t=28),i.prototype.DB=t,i.prototype.DM=(1<<t)-1,i.prototype.DV=1<<t;var u=52;i.prototype.FV=Math.pow(2,u),i.prototype.F1=u-t,i.prototype.F2=2*t-u;var l="0123456789abcdefghijklmnopqrstuvwxyz",d=new Array,h,y;for(h="0".charCodeAt(0),y=0;y<=9;++y)d[h++]=y;for(h="a".charCodeAt(0),y=10;y<36;++y)d[h++]=y;for(h="A".charCodeAt(0),y=10;y<36;++y)d[h++]=y;function g(x){return l.charAt(x)}function m(x,T){var H=d[x.charCodeAt(T)];return H??-1}function E(x){for(var T=this.t-1;T>=0;--T)x[T]=this[T];x.t=this.t,x.s=this.s}function v(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0}function A(x){var T=n();return T.fromInt(x),T}function R(x,T){var H;if(T==16)H=4;else if(T==8)H=3;else if(T==256)H=8;else if(T==2)H=1;else if(T==32)H=5;else if(T==4)H=2;else{this.fromRadix(x,T);return}this.t=0,this.s=0;for(var ie=x.length,ye=!1,Ee=0;--ie>=0;){var De=H==8?x[ie]&255:m(x,ie);if(De<0){x.charAt(ie)=="-"&&(ye=!0);continue}ye=!1,Ee==0?this[this.t++]=De:Ee+H>this.DB?(this[this.t-1]|=(De&(1<<this.DB-Ee)-1)<<Ee,this[this.t++]=De>>this.DB-Ee):this[this.t-1]|=De<<Ee,Ee+=H,Ee>=this.DB&&(Ee-=this.DB)}H==8&&(x[0]&128)!=0&&(this.s=-1,Ee>0&&(this[this.t-1]|=(1<<this.DB-Ee)-1<<Ee)),this.clamp(),ye&&i.ZERO.subTo(this,this)}function F(){for(var x=this.s&this.DM;this.t>0&&this[this.t-1]==x;)--this.t}function q(x){if(this.s<0)return"-"+this.negate().toString(x);var T;if(x==16)T=4;else if(x==8)T=3;else if(x==2)T=1;else if(x==32)T=5;else if(x==4)T=2;else return this.toRadix(x);var H=(1<<T)-1,ie,ye=!1,Ee="",De=this.t,Fe=this.DB-De*this.DB%T;if(De-- >0)for(Fe<this.DB&&(ie=this[De]>>Fe)>0&&(ye=!0,Ee=g(ie));De>=0;)Fe<T?(ie=(this[De]&(1<<Fe)-1)<<T-Fe,ie|=this[--De]>>(Fe+=this.DB-T)):(ie=this[De]>>(Fe-=T)&H,Fe<=0&&(Fe+=this.DB,--De)),ie>0&&(ye=!0),ye&&(Ee+=g(ie));return ye?Ee:"0"}function N(){var x=n();return i.ZERO.subTo(this,x),x}function z(){return this.s<0?this.negate():this}function G(x){var T=this.s-x.s;if(T!=0)return T;var H=this.t;if(T=H-x.t,T!=0)return this.s<0?-T:T;for(;--H>=0;)if((T=this[H]-x[H])!=0)return T;return 0}function Y(x){var T=1,H;return(H=x>>>16)!=0&&(x=H,T+=16),(H=x>>8)!=0&&(x=H,T+=8),(H=x>>4)!=0&&(x=H,T+=4),(H=x>>2)!=0&&(x=H,T+=2),(H=x>>1)!=0&&(x=H,T+=1),T}function P(){return this.t<=0?0:this.DB*(this.t-1)+Y(this[this.t-1]^this.s&this.DM)}function b(x,T){var H;for(H=this.t-1;H>=0;--H)T[H+x]=this[H];for(H=x-1;H>=0;--H)T[H]=0;T.t=this.t+x,T.s=this.s}function w(x,T){for(var H=x;H<this.t;++H)T[H-x]=this[H];T.t=Math.max(this.t-x,0),T.s=this.s}function S(x,T){var H=x%this.DB,ie=this.DB-H,ye=(1<<ie)-1,Ee=Math.floor(x/this.DB),De=this.s<<H&this.DM,Fe;for(Fe=this.t-1;Fe>=0;--Fe)T[Fe+Ee+1]=this[Fe]>>ie|De,De=(this[Fe]&ye)<<H;for(Fe=Ee-1;Fe>=0;--Fe)T[Fe]=0;T[Ee]=De,T.t=this.t+Ee+1,T.s=this.s,T.clamp()}function C(x,T){T.s=this.s;var H=Math.floor(x/this.DB);if(H>=this.t){T.t=0;return}var ie=x%this.DB,ye=this.DB-ie,Ee=(1<<ie)-1;T[0]=this[H]>>ie;for(var De=H+1;De<this.t;++De)T[De-H-1]|=(this[De]&Ee)<<ye,T[De-H]=this[De]>>ie;ie>0&&(T[this.t-H-1]|=(this.s&Ee)<<ye),T.t=this.t-H,T.clamp()}function B(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]-x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie-=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie-=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie-=x.s}T.s=ie<0?-1:0,ie<-1?T[H++]=this.DV+ie:ie>0&&(T[H++]=ie),T.t=H,T.clamp()}function W(x,T){var H=this.abs(),ie=x.abs(),ye=H.t;for(T.t=ye+ie.t;--ye>=0;)T[ye]=0;for(ye=0;ye<ie.t;++ye)T[ye+H.t]=H.am(0,ie[ye],T,ye,0,H.t);T.s=0,T.clamp(),this.s!=x.s&&i.ZERO.subTo(T,T)}function j(x){for(var T=this.abs(),H=x.t=2*T.t;--H>=0;)x[H]=0;for(H=0;H<T.t-1;++H){var ie=T.am(H,T[H],x,2*H,0,1);(x[H+T.t]+=T.am(H+1,2*T[H],x,2*H+1,ie,T.t-H-1))>=T.DV&&(x[H+T.t]-=T.DV,x[H+T.t+1]=1)}x.t>0&&(x[x.t-1]+=T.am(H,T[H],x,2*H,0,1)),x.s=0,x.clamp()}function M(x,T,H){var ie=x.abs();if(!(ie.t<=0)){var ye=this.abs();if(ye.t<ie.t){T!=null&&T.fromInt(0),H!=null&&this.copyTo(H);return}H==null&&(H=n());var Ee=n(),De=this.s,Fe=x.s,lr=this.DB-Y(ie[ie.t-1]);lr>0?(ie.lShiftTo(lr,Ee),ye.lShiftTo(lr,H)):(ie.copyTo(Ee),ye.copyTo(H));var xi=Ee.t,gs=Ee[xi-1];if(gs!=0){var Qn=gs*(1<<this.F1)+(xi>1?Ee[xi-2]>>this.F2:0),cc=this.FV/Qn,Rm=(1<<this.F1)/Qn,so=1<<this.F2,oo=H.t,Pm=oo-xi,cu=T??n();for(Ee.dlShiftTo(Pm,cu),H.compareTo(cu)>=0&&(H[H.t++]=1,H.subTo(cu,H)),i.ONE.dlShiftTo(xi,cu),cu.subTo(Ee,Ee);Ee.t<xi;)Ee[Ee.t++]=0;for(;--Pm>=0;){var G3=H[--oo]==gs?this.DM:Math.floor(H[oo]*cc+(H[oo-1]+so)*Rm);if((H[oo]+=Ee.am(0,G3,H,Pm,0,xi))<G3)for(Ee.dlShiftTo(Pm,cu),H.subTo(cu,H);H[oo]<--G3;)H.subTo(cu,H)}T!=null&&(H.drShiftTo(xi,T),De!=Fe&&i.ZERO.subTo(T,T)),H.t=xi,H.clamp(),lr>0&&H.rShiftTo(lr,H),De<0&&i.ZERO.subTo(H,H)}}}function _(x){var T=n();return this.abs().divRemTo(x,null,T),this.s<0&&T.compareTo(i.ZERO)>0&&x.subTo(T,T),T}function L(x){this.m=x}function ce(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x}function X(x){return x}function ne(x){x.divRemTo(this.m,null,x)}function oe(x,T,H){x.multiplyTo(T,H),this.reduce(H)}function he(x,T){x.squareTo(T),this.reduce(T)}L.prototype.convert=ce,L.prototype.revert=X,L.prototype.reduce=ne,L.prototype.mulTo=oe,L.prototype.sqrTo=he;function pe(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var T=x&3;return T=T*(2-(x&15)*T)&15,T=T*(2-(x&255)*T)&255,T=T*(2-((x&65535)*T&65535))&65535,T=T*(2-x*T%this.DV)%this.DV,T>0?this.DV-T:-T}function _e(x){this.m=x,this.mp=x.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<x.DB-15)-1,this.mt2=2*x.t}function k(x){var T=n();return x.abs().dlShiftTo(this.m.t,T),T.divRemTo(this.m,null,T),x.s<0&&T.compareTo(i.ZERO)>0&&this.m.subTo(T,T),T}function K(x){var T=n();return x.copyTo(T),this.reduce(T),T}function $(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var T=0;T<this.m.t;++T){var H=x[T]&32767,ie=H*this.mpl+((H*this.mph+(x[T]>>15)*this.mpl&this.um)<<15)&x.DM;for(H=T+this.m.t,x[H]+=this.m.am(0,ie,x,T,0,this.m.t);x[H]>=x.DV;)x[H]-=x.DV,x[++H]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)}function Z(x,T){x.squareTo(T),this.reduce(T)}function I(x,T,H){x.multiplyTo(T,H),this.reduce(H)}_e.prototype.convert=k,_e.prototype.revert=K,_e.prototype.reduce=$,_e.prototype.mulTo=I,_e.prototype.sqrTo=Z;function U(){return(this.t>0?this[0]&1:this.s)==0}function V(x,T){if(x>4294967295||x<1)return i.ONE;var H=n(),ie=n(),ye=T.convert(this),Ee=Y(x)-1;for(ye.copyTo(H);--Ee>=0;)if(T.sqrTo(H,ie),(x&1<<Ee)>0)T.mulTo(ie,ye,H);else{var De=H;H=ie,ie=De}return T.revert(H)}function D(x,T){var H;return x<256||T.isEven()?H=new L(T):H=new _e(T),this.exp(x,H)}i.prototype.copyTo=E,i.prototype.fromInt=v,i.prototype.fromString=R,i.prototype.clamp=F,i.prototype.dlShiftTo=b,i.prototype.drShiftTo=w,i.prototype.lShiftTo=S,i.prototype.rShiftTo=C,i.prototype.subTo=B,i.prototype.multiplyTo=W,i.prototype.squareTo=j,i.prototype.divRemTo=M,i.prototype.invDigit=pe,i.prototype.isEven=U,i.prototype.exp=V,i.prototype.toString=q,i.prototype.negate=N,i.prototype.abs=z,i.prototype.compareTo=G,i.prototype.bitLength=P,i.prototype.mod=_,i.prototype.modPowInt=D,i.ZERO=A(0),i.ONE=A(1);function Q(){var x=n();return this.copyTo(x),x}function ee(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function J(){return this.t==0?this.s:this[0]<<24>>24}function ue(){return this.t==0?this.s:this[0]<<16>>16}function ge(x){return Math.floor(Math.LN2*this.DB/Math.log(x))}function be(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Ke(x){if(x==null&&(x=10),this.signum()==0||x<2||x>36)return"0";var T=this.chunkSize(x),H=Math.pow(x,T),ie=A(H),ye=n(),Ee=n(),De="";for(this.divRemTo(ie,ye,Ee);ye.signum()>0;)De=(H+Ee.intValue()).toString(x).substr(1)+De,ye.divRemTo(ie,ye,Ee);return Ee.intValue().toString(x)+De}function Te(x,T){this.fromInt(0),T==null&&(T=10);for(var H=this.chunkSize(T),ie=Math.pow(T,H),ye=!1,Ee=0,De=0,Fe=0;Fe<x.length;++Fe){var lr=m(x,Fe);if(lr<0){x.charAt(Fe)=="-"&&this.signum()==0&&(ye=!0);continue}De=T*De+lr,++Ee>=H&&(this.dMultiply(ie),this.dAddOffset(De,0),Ee=0,De=0)}Ee>0&&(this.dMultiply(Math.pow(T,Ee)),this.dAddOffset(De,0)),ye&&i.ZERO.subTo(this,this)}function je(x,T,H){if(typeof T=="number")if(x<2)this.fromInt(1);else for(this.fromNumber(x,H),this.testBit(x-1)||this.bitwiseTo(i.ONE.shiftLeft(x-1),Kt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(T);)this.dAddOffset(2,0),this.bitLength()>x&&this.subTo(i.ONE.shiftLeft(x-1),this);else{var ie=new Array,ye=x&7;ie.length=(x>>3)+1,T.nextBytes(ie),ye>0?ie[0]&=(1<<ye)-1:ie[0]=0,this.fromString(ie,256)}}function Ze(){var x=this.t,T=new Array;T[0]=this.s;var H=this.DB-x*this.DB%8,ie,ye=0;if(x-- >0)for(H<this.DB&&(ie=this[x]>>H)!=(this.s&this.DM)>>H&&(T[ye++]=ie|this.s<<this.DB-H);x>=0;)H<8?(ie=(this[x]&(1<<H)-1)<<8-H,ie|=this[--x]>>(H+=this.DB-8)):(ie=this[x]>>(H-=8)&255,H<=0&&(H+=this.DB,--x)),(ie&128)!=0&&(ie|=-256),ye==0&&(this.s&128)!=(ie&128)&&++ye,(ye>0||ie!=this.s)&&(T[ye++]=ie);return T}function ze(x){return this.compareTo(x)==0}function Ve(x){return this.compareTo(x)<0?this:x}function ht(x){return this.compareTo(x)>0?this:x}function Ht(x,T,H){var ie,ye,Ee=Math.min(x.t,this.t);for(ie=0;ie<Ee;++ie)H[ie]=T(this[ie],x[ie]);if(x.t<this.t){for(ye=x.s&this.DM,ie=Ee;ie<this.t;++ie)H[ie]=T(this[ie],ye);H.t=this.t}else{for(ye=this.s&this.DM,ie=Ee;ie<x.t;++ie)H[ie]=T(ye,x[ie]);H.t=x.t}H.s=T(this.s,x.s),H.clamp()}function er(x,T){return x&T}function gn(x){var T=n();return this.bitwiseTo(x,er,T),T}function Kt(x,T){return x|T}function _t(x){var T=n();return this.bitwiseTo(x,Kt,T),T}function Yr(x,T){return x^T}function it(x){var T=n();return this.bitwiseTo(x,Yr,T),T}function _r(x,T){return x&~T}function vm(x){var T=n();return this.bitwiseTo(x,_r,T),T}function Sr(){for(var x=n(),T=0;T<this.t;++T)x[T]=this.DM&~this[T];return x.t=this.t,x.s=~this.s,x}function xr(x){var T=n();return x<0?this.rShiftTo(-x,T):this.lShiftTo(x,T),T}function wm(x){var T=n();return x<0?this.lShiftTo(-x,T):this.rShiftTo(x,T),T}function Ar(x){if(x==0)return-1;var T=0;return(x&65535)==0&&(x>>=16,T+=16),(x&255)==0&&(x>>=8,T+=8),(x&15)==0&&(x>>=4,T+=4),(x&3)==0&&(x>>=2,T+=2),(x&1)==0&&++T,T}function Ir(){for(var x=0;x<this.t;++x)if(this[x]!=0)return x*this.DB+Ar(this[x]);return this.s<0?this.t*this.DB:-1}function _m(x){for(var T=0;x!=0;)x&=x-1,++T;return T}function Tr(){for(var x=0,T=this.s&this.DM,H=0;H<this.t;++H)x+=_m(this[H]^T);return x}function Rr(x){var T=Math.floor(x/this.DB);return T>=this.t?this.s!=0:(this[T]&1<<x%this.DB)!=0}function Em(x,T){var H=i.ONE.shiftLeft(x);return this.bitwiseTo(H,T,H),H}function Pr(x){return this.changeBit(x,Kt)}function Cr(x){return this.changeBit(x,_r)}function Sm(x){return this.changeBit(x,Yr)}function Or(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]+x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie+=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie+=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=x.s}T.s=ie<0?-1:0,ie>0?T[H++]=ie:ie<-1&&(T[H++]=this.DV+ie),T.t=H,T.clamp()}function kr(x){var T=n();return this.addTo(x,T),T}function xm(x){var T=n();return this.subTo(x,T),T}function qr(x){var T=n();return this.multiplyTo(x,T),T}function Nr(){var x=n();return this.squareTo(x),x}function Am(x){var T=n();return this.divRemTo(x,T,null),T}function Dr(x){var T=n();return this.divRemTo(x,null,T),T}function Br(x){var T=n(),H=n();return this.divRemTo(x,T,H),new Array(T,H)}function Im(x){this[this.t]=this.am(0,x-1,this,0,0,this.t),++this.t,this.clamp()}function Mr(x,T){if(x!=0){for(;this.t<=T;)this[this.t++]=0;for(this[T]+=x;this[T]>=this.DV;)this[T]-=this.DV,++T>=this.t&&(this[this.t++]=0),++this[T]}}function tr(){}function qd(x){return x}function fy(x,T,H){x.multiplyTo(T,H)}function dy(x,T){x.squareTo(T)}tr.prototype.convert=qd,tr.prototype.revert=qd,tr.prototype.mulTo=fy,tr.prototype.sqrTo=dy;function hy(x){return this.exp(x,new tr)}function py(x,T,H){var ie=Math.min(this.t+x.t,T);for(H.s=0,H.t=ie;ie>0;)H[--ie]=0;var ye;for(ye=H.t-this.t;ie<ye;++ie)H[ie+this.t]=this.am(0,x[ie],H,ie,0,this.t);for(ye=Math.min(x.t,T);ie<ye;++ie)this.am(0,x[ie],H,ie,0,T-ie);H.clamp()}function yy(x,T,H){--T;var ie=H.t=this.t+x.t-T;for(H.s=0;--ie>=0;)H[ie]=0;for(ie=Math.max(T-this.t,0);ie<x.t;++ie)H[this.t+ie-T]=this.am(T-ie,x[ie],H,0,0,this.t+ie-T);H.clamp(),H.drShiftTo(1,H)}function io(x){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*x.t,this.r2),this.mu=this.r2.divide(x),this.m=x}function gy(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var T=n();return x.copyTo(T),this.reduce(T),T}function by(x){return x}function my(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)}function vy(x,T){x.squareTo(T),this.reduce(T)}function wy(x,T,H){x.multiplyTo(T,H),this.reduce(H)}io.prototype.convert=gy,io.prototype.revert=by,io.prototype.reduce=my,io.prototype.mulTo=wy,io.prototype.sqrTo=vy;function _y(x,T){var H=x.bitLength(),ie,ye=A(1),Ee;if(H<=0)return ye;H<18?ie=1:H<48?ie=3:H<144?ie=4:H<768?ie=5:ie=6,H<8?Ee=new L(T):T.isEven()?Ee=new io(T):Ee=new _e(T);var De=new Array,Fe=3,lr=ie-1,xi=(1<<ie)-1;if(De[1]=Ee.convert(this),ie>1){var gs=n();for(Ee.sqrTo(De[1],gs);Fe<=xi;)De[Fe]=n(),Ee.mulTo(gs,De[Fe-2],De[Fe]),Fe+=2}var Qn=x.t-1,cc,Rm=!0,so=n(),oo;for(H=Y(x[Qn])-1;Qn>=0;){for(H>=lr?cc=x[Qn]>>H-lr&xi:(cc=(x[Qn]&(1<<H+1)-1)<<lr-H,Qn>0&&(cc|=x[Qn-1]>>this.DB+H-lr)),Fe=ie;(cc&1)==0;)cc>>=1,--Fe;if((H-=Fe)<0&&(H+=this.DB,--Qn),Rm)De[cc].copyTo(ye),Rm=!1;else{for(;Fe>1;)Ee.sqrTo(ye,so),Ee.sqrTo(so,ye),Fe-=2;Fe>0?Ee.sqrTo(ye,so):(oo=ye,ye=so,so=oo),Ee.mulTo(so,De[cc],ye)}for(;Qn>=0&&(x[Qn]&1<<H)==0;)Ee.sqrTo(ye,so),oo=ye,ye=so,so=oo,--H<0&&(H=this.DB-1,--Qn)}return Ee.revert(ye)}function Ey(x){var T=this.s<0?this.negate():this.clone(),H=x.s<0?x.negate():x.clone();if(T.compareTo(H)<0){var ie=T;T=H,H=ie}var ye=T.getLowestSetBit(),Ee=H.getLowestSetBit();if(Ee<0)return T;for(ye<Ee&&(Ee=ye),Ee>0&&(T.rShiftTo(Ee,T),H.rShiftTo(Ee,H));T.signum()>0;)(ye=T.getLowestSetBit())>0&&T.rShiftTo(ye,T),(ye=H.getLowestSetBit())>0&&H.rShiftTo(ye,H),T.compareTo(H)>=0?(T.subTo(H,T),T.rShiftTo(1,T)):(H.subTo(T,H),H.rShiftTo(1,H));return Ee>0&&H.lShiftTo(Ee,H),H}function Sy(x){if(x<=0)return 0;var T=this.DV%x,H=this.s<0?x-1:0;if(this.t>0)if(T==0)H=this[0]%x;else for(var ie=this.t-1;ie>=0;--ie)H=(T*H+this[ie])%x;return H}function xy(x){var T=x.isEven();if(this.isEven()&&T||x.signum()==0)return i.ZERO;for(var H=x.clone(),ie=this.clone(),ye=A(1),Ee=A(0),De=A(0),Fe=A(1);H.signum()!=0;){for(;H.isEven();)H.rShiftTo(1,H),T?((!ye.isEven()||!Ee.isEven())&&(ye.addTo(this,ye),Ee.subTo(x,Ee)),ye.rShiftTo(1,ye)):Ee.isEven()||Ee.subTo(x,Ee),Ee.rShiftTo(1,Ee);for(;ie.isEven();)ie.rShiftTo(1,ie),T?((!De.isEven()||!Fe.isEven())&&(De.addTo(this,De),Fe.subTo(x,Fe)),De.rShiftTo(1,De)):Fe.isEven()||Fe.subTo(x,Fe),Fe.rShiftTo(1,Fe);H.compareTo(ie)>=0?(H.subTo(ie,H),T&&ye.subTo(De,ye),Ee.subTo(Fe,Ee)):(ie.subTo(H,ie),T&&De.subTo(ye,De),Fe.subTo(Ee,Fe))}if(ie.compareTo(i.ONE)!=0)return i.ZERO;if(Fe.compareTo(x)>=0)return Fe.subtract(x);if(Fe.signum()<0)Fe.addTo(x,Fe);else return Fe;return Fe.signum()<0?Fe.add(x):Fe}var hi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ay=(1<<26)/hi[hi.length-1];function Iy(x){var T,H=this.abs();if(H.t==1&&H[0]<=hi[hi.length-1]){for(T=0;T<hi.length;++T)if(H[0]==hi[T])return!0;return!1}if(H.isEven())return!1;for(T=1;T<hi.length;){for(var ie=hi[T],ye=T+1;ye<hi.length&&ie<Ay;)ie*=hi[ye++];for(ie=H.modInt(ie);T<ye;)if(ie%hi[T++]==0)return!1}return H.millerRabin(x)}function eAe(x){var T=this.subtract(i.ONE),H=T.getLowestSetBit();if(H<=0)return!1;var ie=T.shiftRight(H);x=x+1>>1,x>hi.length&&(x=hi.length);for(var ye=n(),Ee=0;Ee<x;++Ee){ye.fromInt(hi[Math.floor(Math.random()*hi.length)]);var De=ye.modPow(ie,this);if(De.compareTo(i.ONE)!=0&&De.compareTo(T)!=0){for(var Fe=1;Fe++<H&&De.compareTo(T)!=0;)if(De=De.modPowInt(2,this),De.compareTo(i.ONE)==0)return!1;if(De.compareTo(T)!=0)return!1}}return!0}i.prototype.chunkSize=ge,i.prototype.toRadix=Ke,i.prototype.fromRadix=Te,i.prototype.fromNumber=je,i.prototype.bitwiseTo=Ht,i.prototype.changeBit=Em,i.prototype.addTo=Or,i.prototype.dMultiply=Im,i.prototype.dAddOffset=Mr,i.prototype.multiplyLowerTo=py,i.prototype.multiplyUpperTo=yy,i.prototype.modInt=Sy,i.prototype.millerRabin=eAe,i.prototype.clone=Q,i.prototype.intValue=ee,i.prototype.byteValue=J,i.prototype.shortValue=ue,i.prototype.signum=be,i.prototype.toByteArray=Ze,i.prototype.equals=ze,i.prototype.min=Ve,i.prototype.max=ht,i.prototype.and=gn,i.prototype.or=_t,i.prototype.xor=it,i.prototype.andNot=vm,i.prototype.not=Sr,i.prototype.shiftLeft=xr,i.prototype.shiftRight=wm,i.prototype.getLowestSetBit=Ir,i.prototype.bitCount=Tr,i.prototype.testBit=Rr,i.prototype.setBit=Pr,i.prototype.clearBit=Cr,i.prototype.flipBit=Sm,i.prototype.add=kr,i.prototype.subtract=xm,i.prototype.multiply=qr,i.prototype.divide=Am,i.prototype.remainder=Dr,i.prototype.divideAndRemainder=Br,i.prototype.modPow=_y,i.prototype.modInverse=xy,i.prototype.pow=hy,i.prototype.gcd=Ey,i.prototype.isProbablePrime=Iy,i.prototype.square=Nr,i.prototype.Barrett=io;var Tm,Xn,Si;function tAe(x){Xn[Si++]^=x&255,Xn[Si++]^=x>>8&255,Xn[Si++]^=x>>16&255,Xn[Si++]^=x>>24&255,Si>=$3&&(Si-=$3)}function dk(){tAe(new Date().getTime())}if(Xn==null){Xn=new Array,Si=0;var no;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var hk=new Uint8Array(32);for(window.crypto.getRandomValues(hk),no=0;no<32;++no)Xn[Si++]=hk[no]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var pk=window.crypto.random(32);for(no=0;no<pk.length;++no)Xn[Si++]=pk.charCodeAt(no)&255}}for(;Si<$3;)no=Math.floor(65536*Math.random()),Xn[Si++]=no>>>8,Xn[Si++]=no&255;Si=0,dk()}function rAe(){if(Tm==null){for(dk(),Tm=oAe(),Tm.init(Xn),Si=0;Si<Xn.length;++Si)Xn[Si]=0;Si=0}return Tm.next()}function iAe(x){var T;for(T=0;T<x.length;++T)x[T]=rAe()}function z3(){}z3.prototype.nextBytes=iAe;function H3(){this.i=0,this.j=0,this.S=new Array}function nAe(x){var T,H,ie;for(T=0;T<256;++T)this.S[T]=T;for(H=0,T=0;T<256;++T)H=H+this.S[T]+x[T%x.length]&255,ie=this.S[T],this.S[T]=this.S[H],this.S[H]=ie;this.i=0,this.j=0}function sAe(){var x;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,x=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=x,this.S[x+this.S[this.i]&255]}H3.prototype.init=nAe,H3.prototype.next=sAe;function oAe(){return new H3}var $3=256;typeof AS!="undefined"?AS=Ove.exports={default:i,BigInteger:i,SecureRandom:z3}:this.jsbn={BigInteger:i,SecureRandom:z3}}).call(AS)});var M1=p(IS=>{f();(function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function r(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,u=o.length,l,d="",h,y,g,m,E,v,A,R;for(h=0;h<u;h++)if(typeof o[h]=="string")d+=o[h];else if(typeof o[h]=="object"){if(g=o[h],g.keys)for(l=a[c],y=0;y<g.keys.length;y++){if(l==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',g.keys[y],g.keys[y-1]));l=l[g.keys[y]]}else g.param_no?l=a[g.param_no]:l=a[c++];if(t.not_type.test(g.type)&&t.not_primitive.test(g.type)&&l instanceof Function&&(l=l()),t.numeric_arg.test(g.type)&&typeof l!="number"&&isNaN(l))throw new TypeError(e("[sprintf] expecting number but found %T",l));switch(t.number.test(g.type)&&(A=l>=0),g.type){case"b":l=parseInt(l,10).toString(2);break;case"c":l=String.fromCharCode(parseInt(l,10));break;case"d":case"i":l=parseInt(l,10);break;case"j":l=JSON.stringify(l,null,g.width?parseInt(g.width):0);break;case"e":l=g.precision?parseFloat(l).toExponential(g.precision):parseFloat(l).toExponential();break;case"f":l=g.precision?parseFloat(l).toFixed(g.precision):parseFloat(l);break;case"g":l=g.precision?String(Number(l.toPrecision(g.precision))):parseFloat(l);break;case"o":l=(parseInt(l,10)>>>0).toString(8);break;case"s":l=String(l),l=g.precision?l.substring(0,g.precision):l;break;case"t":l=String(!!l),l=g.precision?l.substring(0,g.precision):l;break;case"T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase(),l=g.precision?l.substring(0,g.precision):l;break;case"u":l=parseInt(l,10)>>>0;break;case"v":l=l.valueOf(),l=g.precision?l.substring(0,g.precision):l;break;case"x":l=(parseInt(l,10)>>>0).toString(16);break;case"X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase();break}t.json.test(g.type)?d+=l:(t.number.test(g.type)&&(!A||g.sign)?(R=A?"+":"-",l=l.toString().replace(t.sign,"")):R="",E=g.pad_char?g.pad_char==="0"?"0":g.pad_char.charAt(1):" ",v=g.width-(R+l).length,m=g.width&&v>0?E.repeat(v):"",d+=g.align?R+l+m:E==="0"?R+m+l:m+R+l)}return d}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,u=[],l=0;a;){if((c=t.text.exec(a))!==null)u.push(c[0]);else if((c=t.modulo.exec(a))!==null)u.push("%");else if((c=t.placeholder.exec(a))!==null){if(c[2]){l|=1;var d=[],h=c[2],y=[];if((y=t.key.exec(h))!==null)for(d.push(y[1]);(h=h.substring(y[0].length))!=="";)if((y=t.key_access.exec(h))!==null)d.push(y[1]);else if((y=t.index_access.exec(h))!==null)d.push(y[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=d}else l|=2;if(l===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=u}typeof IS!="undefined"&&(IS.sprintf=e,IS.vsprintf=r),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=r,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:r}}))})()});var sC=p(Za=>{f();"use strict";var sgt=Za&&Za.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),ogt=Za&&Za.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kve=Za&&Za.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&sgt(e,t,r);return ogt(e,t),e};Object.defineProperty(Za,"__esModule",{value:!0});Za.Address4=void 0;var qve=kve(rC()),zo=kve(iC()),Nve=xS(),L1=nC(),U0=M1(),agt=function(){function t(e){this.groups=zo.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=qve.isCorrect(zo.BITS),this.isInSubnet=qve.isInSubnet,this.address=e;var r=zo.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>zo.BITS)throw new Nve.AddressError("Invalid subnet mask.");e=e.replace(zo.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return t.isValid=function(e){try{return new t(e),!0}catch(r){return!1}},t.prototype.parse=function(e){var r=e.split(".");if(!e.match(zo.RE_ADDRESS))throw new Nve.AddressError("Invalid IPv4 address.");return r},t.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},t.fromHex=function(e){var r=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=r.slice(n,n+2);i.push(parseInt(s,16))}return new t(i.join("."))},t.fromInteger=function(e){return t.fromHex(e.toString(16))},t.fromArpa=function(e){var r=e.replace(/(\.in-addr\.arpa)?\.$/,""),i=r.split(".").reverse().join(".");return new t(i)},t.prototype.toHex=function(){return this.parsedAddress.map(function(e){return U0.sprintf("%02x",parseInt(e,10))}).join(":")},t.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},t.prototype.toGroup6=function(){var e=[],r;for(r=0;r<zo.GROUPS;r+=2){var i=U0.sprintf("%02x%02x",parseInt(this.parsedAddress[r],10),parseInt(this.parsedAddress[r+1],10));e.push(U0.sprintf("%x",parseInt(i,16)))}return e.join(":")},t.prototype.bigInteger=function(){return new L1.BigInteger(this.parsedAddress.map(function(e){return U0.sprintf("%02x",parseInt(e,10))}).join(""),16)},t.prototype._startAddress=function(){return new L1.BigInteger(this.mask()+"0".repeat(zo.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new L1.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new L1.BigInteger(this.mask()+"1".repeat(zo.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new L1.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.fromBigInteger=function(e){return t.fromInteger(parseInt(e.toString(),10))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.reverseForm=function(e){e||(e={});var r=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?r:U0.sprintf("%s.in-addr.arpa.",r)},t.prototype.isMulticast=function(){return this.isInSubnet(new t("224.0.0.0/4"))},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(zo.BITS,"0")},t.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(zo.RE_ADDRESS,U0.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},t}();Za.Address4=agt});var oC=p(Gr=>{f();"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.RE_URL_WITH_PORT=Gr.RE_URL=Gr.RE_ZONE_STRING=Gr.RE_SUBNET_STRING=Gr.RE_BAD_ADDRESS=Gr.RE_BAD_CHARACTERS=Gr.TYPES=Gr.SCOPES=Gr.GROUPS=Gr.BITS=void 0;Gr.BITS=128;Gr.GROUPS=8;Gr.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};Gr.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};Gr.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;Gr.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;Gr.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;Gr.RE_ZONE_STRING=/%.*$/;Gr.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);Gr.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var aC=p(Ja=>{f();"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.simpleGroup=Ja.spanLeadingZeroes=Ja.spanAll=Ja.spanAllZeroes=void 0;var Dve=M1();function Bve(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}Ja.spanAllZeroes=Bve;function cgt(t,e){e===void 0&&(e=0);var r=t.split("");return r.map(function(i,n){return Dve.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,Bve(i))}).join("")}Ja.spanAll=cgt;function Mve(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}function ugt(t){var e=t.split(":");return e.map(function(r){return Mve(r)}).join(":")}Ja.spanLeadingZeroes=ugt;function lgt(t,e){e===void 0&&(e=0);var r=t.split(":");return r.map(function(i,n){return/group-v4/.test(i)?i:Dve.sprintf('<span class="hover-group group-%d">%s</span>',n+e,Mve(i))})}Ja.simpleGroup=lgt});var Lve=p(Ki=>{f();"use strict";var fgt=Ki&&Ki.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),dgt=Ki&&Ki.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hgt=Ki&&Ki.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fgt(e,t,r);return dgt(e,t),e};Object.defineProperty(Ki,"__esModule",{value:!0});Ki.possibleElisions=Ki.simpleRegularExpression=Ki.ADDRESS_BOUNDARY=Ki.padGroup=Ki.groupPossibilities=void 0;var pgt=hgt(oC()),F0=M1();function TS(t){return F0.sprintf("(%s)",t.join("|"))}Ki.groupPossibilities=TS;function RS(t){return t.length<4?F0.sprintf("0{0,%d}%s",4-t.length,t):t}Ki.padGroup=RS;Ki.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function ygt(t){var e=[];t.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var r=e.map(function(i){return t.map(function(n,s){if(s===i){var o=s===0||s===pgt.GROUPS-1?":":"";return TS([RS(n),o])}return RS(n)}).join(":")});return r.push(t.map(RS).join(":")),TS(r)}Ki.simpleRegularExpression=ygt;function ggt(t,e,r){var i=e?"":":",n=r?"":":",s=[];!e&&!r&&s.push("::"),e&&r&&s.push(""),(r&&!e||!r&&e)&&s.push(":"),s.push(F0.sprintf("%s(:0{1,4}){1,%d}",i,t-1)),s.push(F0.sprintf("(0{1,4}:){1,%d}%s",t-1,n)),s.push(F0.sprintf("(0{1,4}:){%d}0{1,4}",t-1));for(var o=1;o<t-1;o++)for(var a=1;a<t-o;a++)s.push(F0.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,t-a-o-1));return TS(s)}Ki.possibleElisions=ggt});var Vve=p(Xs=>{f();"use strict";var bgt=Xs&&Xs.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),mgt=Xs&&Xs.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),PS=Xs&&Xs.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bgt(e,t,r);return mgt(e,t),e},Uve=Xs&&Xs.__spreadArray||function(t,e){for(var r=0,i=e.length,n=t.length;r<i;r++,n++)t[n]=e[r];return t};Object.defineProperty(Xs,"__esModule",{value:!0});Xs.Address6=void 0;var Fve=PS(rC()),cC=PS(iC()),cr=PS(oC()),uC=PS(aC()),xd=sC(),Ad=Lve(),Zc=xS(),Pn=nC(),Cn=M1();function CS(t){if(!t)throw new Error("Assertion failed.")}function vgt(t){for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}function wgt(t){return t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),t=t.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),t}function _gt(t,e){var r=[],i=[],n;for(n=0;n<t.length;n++)n<e[0]?r.push(t[n]):n>e[1]&&i.push(t[n]);return r.concat(["compact"]).concat(i)}function Kve(t){return Cn.sprintf("%04x",parseInt(t,16))}function jve(t){return t&255}var Egt=function(){function t(e,r){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=Fve.isInSubnet,this.isCorrect=Fve.isCorrect(cr.BITS),r===void 0?this.groups=cr.GROUPS:this.groups=r,this.address=e;var i=cr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>cr.BITS)throw new Zc.AddressError("Invalid subnet mask.");e=e.replace(cr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new Zc.AddressError("Invalid subnet mask.");var n=cr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(cr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return t.isValid=function(e){try{return new t(e),!0}catch(r){return!1}},t.fromBigInteger=function(e){var r=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<cr.GROUPS;n++)i.push(r.slice(n*4,(n+1)*4));return new t(i.join(":"))},t.fromURL=function(e){var r,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=cr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};r=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=cr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};r=n[1]}else r=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new t(r),port:i}},t.fromAddress4=function(e){var r=new xd.Address4(e),i=cr.BITS-(cC.BITS-r.subnetMask);return new t("::ffff:"+r.correctForm()+"/"+i)},t.fromArpa=function(e){var r=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(r.length!==63)throw new Zc.AddressError("Invalid 'ip6.arpa' form.");for(var n=r.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return r=n.join(""),new t(r)},t.prototype.microsoftTranscription=function(){return Cn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},t.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},t.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var r=cr.BITS-this.subnetMask,i=Math.abs(e-cr.BITS),n=r-i;return n<0?"0":vgt(new Pn.BigInteger("2",10).pow(n).toString(10))},t.prototype._startAddress=function(){return new Pn.BigInteger(this.mask()+"0".repeat(cr.BITS-this.subnetMask),2)},t.prototype.startAddress=function(){return t.fromBigInteger(this._startAddress())},t.prototype.startAddressExclusive=function(){var e=new Pn.BigInteger("1");return t.fromBigInteger(this._startAddress().add(e))},t.prototype._endAddress=function(){return new Pn.BigInteger(this.mask()+"1".repeat(cr.BITS-this.subnetMask),2)},t.prototype.endAddress=function(){return t.fromBigInteger(this._endAddress())},t.prototype.endAddressExclusive=function(){var e=new Pn.BigInteger("1");return t.fromBigInteger(this._endAddress().subtract(e))},t.prototype.getScope=function(){var e=cr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},t.prototype.getType=function(){for(var e=0,r=Object.keys(cr.TYPES);e<r.length;e++){var i=r[e];if(this.isInSubnet(new t(i)))return cr.TYPES[i]}return"Global unicast"},t.prototype.getBits=function(e,r){return new Pn.BigInteger(this.getBitsBase2(e,r),2)},t.prototype.getBitsBase2=function(e,r){return this.binaryZeroPad().slice(e,r)},t.prototype.getBitsBase16=function(e,r){var i=r-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,r).toString(16).padStart(i/4,"0")},t.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,cr.BITS)},t.prototype.reverseForm=function(e){e||(e={});var r=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,r).reverse().join(".");return r>0?e.omitSuffix?i:Cn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},t.prototype.correctForm=function(){var e,r=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(u){return u[1]-u[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));r=_gt(this.parsedAddress,n[a])}else r=this.parsedAddress;for(e=0;e<r.length;e++)r[e]!=="compact"&&(r[e]=parseInt(r[e],16).toString(16));var c=r.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},t.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(cr.BITS,"0")},t.prototype.parse4in6=function(e){var r=e.split(":"),i=r.slice(-1)[0],n=i.match(cC.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new xd.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new Zc.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(cC.RE_ADDRESS,this.address4.parsedAddress.map(wgt).join(".")));this.v4=!0,r[r.length-1]=this.address4.toGroup6(),e=r.join(":")}return e},t.prototype.parse=function(e){e=this.parse4in6(e);var r=e.match(cr.RE_BAD_CHARACTERS);if(r)throw new Zc.AddressError(Cn.sprintf("Bad character%s detected in address: %s",r.length>1?"s":"",r.join("")),e.replace(cr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(cr.RE_BAD_ADDRESS);if(i)throw new Zc.AddressError(Cn.sprintf("Address failed regex: %s",i.join("")),e.replace(cr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new Zc.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var u=0;u<c;u++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new Zc.AddressError("Too many :: groups found");if(n=n.map(function(l){return Cn.sprintf("%x",parseInt(l,16))}),n.length!==this.groups)throw new Zc.AddressError("Incorrect number of groups found");return n},t.prototype.canonicalForm=function(){return this.parsedAddress.map(Kve).join(":")},t.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Cn.sprintf("%05d",parseInt(e,16))}).join(":")},t.prototype.bigInteger=function(){return new Pn.BigInteger(this.parsedAddress.map(Kve).join(""),16)},t.prototype.to4=function(){var e=this.binaryZeroPad().split("");return xd.Address4.fromHex(new Pn.BigInteger(e.slice(96,128).join(""),2).toString(16))},t.prototype.to4in6=function(){var e=this.to4(),r=new t(this.parsedAddress.slice(0,6).join(":"),6),i=r.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},t.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),r=this.getBits(80,96).xor(new Pn.BigInteger("ffff",16)).toString(),i=xd.Address4.fromHex(this.getBitsBase16(32,64)),n=xd.Address4.fromHex(this.getBits(96,128).xor(new Pn.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),u=s.testBit(8),l=s.testBit(9),d=new Pn.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Cn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:l,groupIndividual:u,nonce:d},udpPort:r}},t.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),r=xd.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Cn.sprintf("%s",e.slice(0,4)),gateway:r.address}},t.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new t(e)},t.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},t.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(jve)},t.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(jve))},t.fromUnsignedByteArray=function(e){for(var r=new Pn.BigInteger("256",10),i=new Pn.BigInteger("0",10),n=new Pn.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new Pn.BigInteger(e[s].toString(10),10))),n=n.multiply(r);return t.fromBigInteger(i)},t.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},t.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},t.prototype.isMulticast=function(){return this.getType()==="Multicast"},t.prototype.is4=function(){return this.v4},t.prototype.isTeredo=function(){return this.isInSubnet(new t("2001::/32"))},t.prototype.is6to4=function(){return this.isInSubnet(new t("2002::/16"))},t.prototype.isLoopback=function(){return this.getType()==="Loopback"},t.prototype.href=function(e){return e===void 0?e="":e=Cn.sprintf(":%s",e),Cn.sprintf("http://[%s]%s/",this.correctForm(),e)},t.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var r=this.correctForm;return e.v4&&(r=this.to4in6),e.className?Cn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,r.call(this),e.className):Cn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,r.call(this))},t.prototype.group=function(){if(this.elidedGroups===0)return uC.simpleGroup(this.address).join(":");CS(typeof this.elidedGroups=="number"),CS(typeof this.elisionBegin=="number");var e=[],r=this.address.split("::"),i=r[0],n=r[1];i.length?e.push.apply(e,uC.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Cn.sprintf("group-%d",o));return e.push(Cn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,uC.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(CS(this.address4 instanceof xd.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},t.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var r=[],i=new t(this.correctForm());if(i.elidedGroups===0)r.push(Ad.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===cr.GROUPS)r.push(Ad.possibleElisions(cr.GROUPS));else{var n=i.address.split("::");n[0].length&&r.push(Ad.simpleRegularExpression(n[0].split(":"))),CS(typeof i.elidedGroups=="number"),r.push(Ad.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&r.push(Ad.simpleRegularExpression(n[1].split(":"))),r=[r.join(":")]}return e||(r=Uve(Uve(["(?=^|",Ad.ADDRESS_BOUNDARY,"|[^\\w\\:])("],r),[")(?=[^\\w\\:]|",Ad.ADDRESS_BOUNDARY,"|$)"])),r.join("")},t.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},t}();Xs.Address6=Egt});var zve=p(hn=>{f();"use strict";var Sgt=hn&&hn.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),xgt=hn&&hn.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Agt=hn&&hn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Sgt(e,t,r);return xgt(e,t),e};Object.defineProperty(hn,"__esModule",{value:!0});hn.v6=hn.AddressError=hn.Address6=hn.Address4=void 0;var Igt=sC();Object.defineProperty(hn,"Address4",{enumerable:!0,get:function(){return Igt.Address4}});var Tgt=Vve();Object.defineProperty(hn,"Address6",{enumerable:!0,get:function(){return Tgt.Address6}});var Rgt=xS();Object.defineProperty(hn,"AddressError",{enumerable:!0,get:function(){return Rgt.AddressError}});var Pgt=Agt(aC());hn.v6={helpers:Pgt}});var hC=p((F7t,dC)=>{f();"use strict";var Hve=me(),Cgt=Object.assign(Hve("libp2p:ip-port-to-multiaddr"),{error:Hve("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:lC}=tt(),fC=ae(),{Address4:Ogt,Address6:kgt}=zve(),OS={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function qgt(t,e){if(typeof t!="string")throw fC(new Error(`invalid ip provided: ${t}`),OS.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw fC(new Error(`invalid port provided: ${e}`),OS.ERR_INVALID_PORT_PARAMETER);try{return new Ogt(t),new lC(`/ip4/${t}/tcp/${e}`)}catch{}try{let r=new kgt(t);return r.is4()?new lC(`/ip4/${r.to4().correctForm()}/tcp/${e}`):new lC(`/ip6/${t}/tcp/${e}`)}catch(r){let i=`invalid ip:port for creating a multiaddr: ${t}:${e}`;throw Cgt.error(i),fC(new Error(i),OS.ERR_INVALID_IP)}}dC.exports=qgt;dC.exports.Errors=OS});var Id=p((K7t,kS)=>{f();"use strict";var pC=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},$ve=(t,e,r,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(t);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{o(r())}catch(l){a(l)}return}let c=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,u=r instanceof Error?r:new pC(c);typeof t.cancel=="function"&&t.cancel(),a(u)},e),(async()=>{try{o(await t)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};kS.exports=$ve;kS.exports.default=$ve;kS.exports.TimeoutError=pC});var Qve=p((j7t,Xve)=>{f();"use strict";var Gve=Ha(),{CLOSE_TIMEOUT:Ngt}=tC(),Wve=hC(),Dgt=Id(),Yve=me(),yC=Yve("libp2p:websockets:socket");yC.error=Yve("libp2p:websockets:socket:error");Xve.exports=(t,e={})=>{let r={async sink(i){e.signal&&(i=Gve(i,e.signal));try{await t.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&yC.error(n)}},source:e.signal?Gve(t.source,e.signal):t.source,conn:t,localAddr:e.localAddr||(t.localAddress&&t.localPort?Wve(t.localAddress,t.localPort):void 0),remoteAddr:e.remoteAddr||Wve(t.remoteAddress,t.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await Dgt(t.close(),Ngt)}catch(n){let{host:s,port:o}=r.remoteAddr.toOptions();yC("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),t.destroy()}finally{r.timeline.close=Date.now()}}};return t.socket.once&&t.socket.once("close",()=>{r.timeline.close||(r.timeline.close=Date.now())}),r}});var ewe=p((V7t,Jve)=>{f();"use strict";var Al=lf(),{CODE_CIRCUIT:gC,CODE_P2P:bC,CODE_TCP:mC,CODE_WS:Bgt,CODE_WSS:Zve}=tC();Jve.exports={all:t=>t.filter(e=>{if(e.protoCodes().includes(gC))return!1;let r=e.decapsulateCode(bC);return Al.WebSockets.matches(r)||Al.WebSocketsSecure.matches(r)}),dnsWss:t=>t.filter(e=>{if(e.protoCodes().includes(gC))return!1;let r=e.decapsulateCode(bC);return Al.WebSocketsSecure.matches(r)&&Al.DNS.matches(r.decapsulateCode(mC).decapsulateCode(Zve))}),dnsWsOrWss:t=>t.filter(e=>{if(e.protoCodes().includes(gC))return!1;let r=e.decapsulateCode(bC);return Al.WebSockets.matches(r)?Al.DNS.matches(r.decapsulateCode(mC).decapsulateCode(Bgt)):Al.WebSocketsSecure.matches(r)&&Al.DNS.matches(r.decapsulateCode(mC).decapsulateCode(Zve))})}});var awe=p((z7t,owe)=>{f();"use strict";var Mgt=Rve(),Lgt=Qv(),Ugt=n2(),{AbortError:twe}=Ha(),Fgt=Hu(),rwe=me(),Il=rwe("libp2p:websockets");Il.error=rwe("libp2p:websockets:error");var iwe=Py(),Kgt=Cve(),jgt=Qve(),nwe=ewe(),swe=class{constructor({upgrader:e,filter:r}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=r}async dial(e,r={}){Il("dialing %s",e);let i=await this._connect(e,r),n=jgt(i,{remoteAddr:e,signal:r.signal});Il("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Il("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,r={}){if(r.signal&&r.signal.aborted)throw new twe;let i=e.toOptions();Il("dialing %s:%s",i.host,i.port);let n=Fgt(),s=u=>{let l=`connection error: ${u.message}`;Il.error(l),n.reject(u)},o=Mgt(Ugt(e),Object.assign({binary:!0},r));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!r.signal)return await Promise.race([o.connected(),n.promise]),Il("connected %s",e),o;let a,c=new Promise((u,l)=>{if(a=()=>{l(new twe),setTimeout(()=>{o.close()})},r.signal.aborted)return a();r.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{r.signal.removeEventListener("abort",a)}return Il("connected %s",e),o}createListener(e={},r){return typeof e=="function"&&(r=e,e={}),Kgt({handler:r,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):iwe.isBrowser||iwe.isWebWorker?nwe.dnsWss(e):nwe.all(e)}};owe.exports=Lgt(swe,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var uwe=p((H7t,cwe)=>{f();cwe.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var _C=p(($7t,wC)=>{f();"use strict";var vC=65536,Vgt=4294967295;function zgt(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Hgt=lR().Buffer,qS=globalThis.crypto||globalThis.msCrypto;qS&&qS.getRandomValues?wC.exports=$gt:wC.exports=zgt;function $gt(t,e){if(t>Vgt)throw new RangeError("requested too many random bytes");var r=Hgt.allocUnsafe(t);if(t>0)if(t>vC)for(var i=0;i<t;i+=vC)qS.getRandomValues(r.slice(i,i+vC));else qS.getRandomValues(r);return typeof e=="function"?process.nextTick(function(){e(null,r)}):r}});var dwe=p((G7t,fwe)=>{f();"use strict";function lwe(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Ggt(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=void 0),e!=null&&(r.code=e);try{return lwe(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),lwe(new n,r)}}fwe.exports=Ggt});var xC=p((W7t,gwe)=>{f();var Wgt=me()("simple-peer"),hwe=uwe(),pwe=_C(),Ygt=IR(),EC=K2(),ur=dwe(),SC=64*1024,Xgt=5*1e3,Qgt=5*1e3;function ywe(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function Zgt(t){console.warn(t)}var Tl=class extends Ygt.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);if(this._id=pwe(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||pwe(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Tl.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},Tl.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(r=>r),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||Xgt,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:hwe(),!this._wrtc)throw typeof window=="undefined"?ur(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):ur(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(r){EC(()=>this.destroy(ur(r,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=r=>{this._onIceCandidate(r)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=r=>{this._setupData(r)},this.streams&&this.streams.forEach(r=>{this.addStream(r)}),this._pc.ontrack=r=>{this._onTrack(r)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw ur(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(r){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(r=>{this._addIceCandidate(r)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(r=>{this.destroy(ur(r,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(ur(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var r=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(r).catch(i=>{!r.address||r.address.endsWith(".local")?Zgt("Ignoring unsupported ICE candidate."):this.destroy(ur(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,r){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,r),this._needsNegotiation()}catch(i){this.destroy(ur(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:r}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(r=>{this.addTrack(r,e)})}addTrack(e,r){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(r);if(!n)n=this._pc.addTrack(e,r),i.set(r,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?ur(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):ur(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,r,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw ur(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");r&&this._senderMap.set(r,n),s.replaceTrack!=null?s.replaceTrack(r):this.destroy(ur(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,r){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(r):null;if(!n)throw ur(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(ur(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(r=>{this.removeTrack(r,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,EC(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,r){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,r(e)}_setupData(e){if(!e.channel)return this.destroy(ur(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=SC),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(ur(i,"ERR_DATA_CHANNEL"))};var r=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(r&&this._onChannelClose(),r=!0):r=!1},Qgt)}_read(){}_write(e,r,i){if(this.destroyed)return i(ur(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(ur(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>SC?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=ywe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(ur(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(ur(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=ywe(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let r=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},n=s=>{this.destroy(ur(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(ur(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(ur(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,r=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,r),this.emit("iceStateChange",e,r),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(ur(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(ur(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let r=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(r(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(r(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((r,i)=>{if(this.destroyed)return;r&&(i=[]);var n={},s={},o={},a=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(n[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(o[l.id]=l)});let c=l=>{a=!0;var d=s[l.localCandidateId];d&&(d.ip||d.address)?(this.localAddress=d.ip||d.address,this.localPort=Number(d.port)):d&&d.ipAddress?(this.localAddress=d.ipAddress,this.localPort=Number(d.portNumber)):typeof l.googLocalAddress=="string"&&(d=l.googLocalAddress.split(":"),this.localAddress=d[0],this.localPort=Number(d[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var h=n[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(o[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(l){return this.destroy(ur(l,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>SC||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var r=e.data;r instanceof ArrayBuffer&&(r=new Uint8Array(r)),this.push(r)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(r=>{this._debug("on track"),this.emit("track",e.track,r),this._remoteTracks.push({track:e.track,stream:r}),!this._remoteStreams.some(i=>i.id===r.id)&&(this._remoteStreams.push(r),EC(()=>{this.emit("stream",r)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],Wgt.apply(null,e)}};Tl.WEBRTC_SUPPORT=!!hwe();Tl.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};Tl.channelConfig={};gwe.exports=Tl});var mwe=p((Y7t,bwe)=>{f();"use strict";bwe.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var DS=p(NS=>{f();"use strict";NS.CODE_P2P=421;NS.CODE_CIRCUIT=290;NS.CLOSE_TIMEOUT=2e3});var AC=p((Q7t,vwe)=>{f();var Jgt=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ebt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];vwe.exports=function(e){var r=e,i=e.indexOf("["),n=e.indexOf("]");i!=-1&&n!=-1&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var s=Jgt.exec(e||""),o={},a=14;a--;)o[ebt[a]]=s[a]||"";return i!=-1&&n!=-1&&(o.source=r,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=tbt(o,o.path),o.queryKey=rbt(o,o.query),o};function tbt(t,e){var r=/\/{2,9}/g,i=e.replace(r,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function rbt(t,e){var r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(r[n]=s)}),r}});var _we=p(BS=>{f();"use strict";Object.defineProperty(BS,"__esModule",{value:!0});BS.url=void 0;var ibt=AC(),wwe=me()("socket.io-client:url");function nbt(t,e="",r){let i=t;r=r||typeof location!="undefined"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(wwe("protocol-less url %s",t),typeof r!="undefined"?t=r.protocol+"//"+t:t="https://"+t),wwe("parse %s",t),i=ibt(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(r&&r.port===i.port?"":":"+i.port),i}BS.url=nbt});var Ewe=p((J7t,IC)=>{f();try{IC.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){IC.exports=!1}});var U1=p((eLt,Swe)=>{f();Swe.exports=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var TC=p((tLt,xwe)=>{f();var sbt=Ewe(),obt=U1();xwe.exports=function(t){let e=t.xdomain,r=t.xscheme,i=t.enablesXDR;try{if(typeof XMLHttpRequest!="undefined"&&(!e||sbt))return new XMLHttpRequest}catch(n){}try{if(typeof XDomainRequest!="undefined"&&!r&&i)return new XDomainRequest}catch(n){}if(!e)try{return new obt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(n){}}});var RC=p((rLt,Iwe)=>{f();var ec=Object.create(null);ec.open="0";ec.close="1";ec.ping="2";ec.pong="3";ec.message="4";ec.upgrade="5";ec.noop="6";var Awe=Object.create(null);Object.keys(ec).forEach(t=>{Awe[ec[t]]=t});var abt={type:"error",data:"parser error"};Iwe.exports={PACKET_TYPES:ec,PACKET_TYPES_REVERSE:Awe,ERROR_PACKET:abt}});var Pwe=p((iLt,Rwe)=>{f();var{PACKET_TYPES:cbt}=RC(),ubt=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",lbt=typeof ArrayBuffer=="function",fbt=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,dbt=({type:t,data:e},r,i)=>ubt&&e instanceof Blob?r?i(e):Twe(e,i):lbt&&(e instanceof ArrayBuffer||fbt(e))?r?i(e instanceof ArrayBuffer?e:e.buffer):Twe(new Blob([e]),i):i(cbt[t]+(e||"")),Twe=(t,e)=>{let r=new FileReader;return r.onload=function(){let i=r.result.split(",")[1];e("b"+i)},r.readAsDataURL(t)};Rwe.exports=dbt});var Cwe=p(PC=>{f();(function(t){"use strict";PC.encode=function(e){var r=new Uint8Array(e),i,n=r.length,s="";for(i=0;i<n;i+=3)s+=t[r[i]>>2],s+=t[(r[i]&3)<<4|r[i+1]>>4],s+=t[(r[i+1]&15)<<2|r[i+2]>>6],s+=t[r[i+2]&63];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},PC.decode=function(e){var r=e.length*.75,i=e.length,n,s=0,o,a,c,u;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);var l=new ArrayBuffer(r),d=new Uint8Array(l);for(n=0;n<i;n+=4)o=t.indexOf(e[n]),a=t.indexOf(e[n+1]),c=t.indexOf(e[n+2]),u=t.indexOf(e[n+3]),d[s++]=o<<2|a>>4,d[s++]=(a&15)<<4|c>>2,d[s++]=(c&3)<<6|u&63;return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")});var qwe=p((sLt,kwe)=>{f();var{PACKET_TYPES_REVERSE:CC,ERROR_PACKET:hbt}=RC(),pbt=typeof ArrayBuffer=="function",OC;pbt&&(OC=Cwe());var ybt=(t,e)=>{if(typeof t!="string")return{type:"message",data:Owe(t,e)};let r=t.charAt(0);return r==="b"?{type:"message",data:gbt(t.substring(1),e)}:CC[r]?t.length>1?{type:CC[r],data:t.substring(1)}:{type:CC[r]}:hbt},gbt=(t,e)=>{if(OC){let r=OC.decode(t);return Owe(r,e)}else return{base64:!0,data:t}},Owe=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};kwe.exports=ybt});var K0=p((oLt,Mwe)=>{f();var Nwe=Pwe(),Dwe=qwe(),Bwe=String.fromCharCode(30),bbt=(t,e)=>{let r=t.length,i=new Array(r),n=0;t.forEach((s,o)=>{Nwe(s,!1,a=>{i[o]=a,++n===r&&e(i.join(Bwe))})})},mbt=(t,e)=>{let r=t.split(Bwe),i=[];for(let n=0;n<r.length;n++){let s=Dwe(r[n],e);if(i.push(s),s.type==="error")break}return i};Mwe.exports={protocol:4,encodePacket:Nwe,encodePayload:bbt,decodePacket:Dwe,decodePayload:mbt}});var j0=p((aLt,kC)=>{f();typeof kC!="undefined"&&(kC.exports=hs);function hs(t){if(t)return vbt(t)}function vbt(t){for(var e in hs.prototype)t[e]=hs.prototype[e];return t}hs.prototype.on=hs.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};hs.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};hs.prototype.off=hs.prototype.removeListener=hs.prototype.removeAllListeners=hs.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,n=0;n<r.length;n++)if(i=r[n],i===e||i.fn===e){r.splice(n,1);break}return r.length===0&&delete this._callbacks["$"+t],this};hs.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(r){r=r.slice(0);for(var i=0,n=r.length;i<n;++i)r[i].apply(this,e)}return this};hs.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};hs.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var MS=p((cLt,Uwe)=>{f();var wbt=K0(),_bt=j0(),Ebt=me()("engine.io-client:transport"),Lwe=class extends _bt{constructor(e){super();this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,r){let i=new Error(e);return i.type="TransportError",i.description=r,this.emit("error",i),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):Ebt("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){let r=wbt.decodePacket(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}};Uwe.exports=Lwe});var LS=p(qC=>{f();qC.encode=function(t){var e="";for(var r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e};qC.decode=function(t){for(var e={},r=t.split("&"),i=0,n=r.length;i<n;i++){var s=r[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}});var BC=p((lLt,zwe)=>{f();"use strict";var Fwe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),US=64,Kwe={},jwe=0,Rl=0,Vwe;function NC(t){var e="";do e=Fwe[t%US]+e,t=Math.floor(t/US);while(t>0);return e}function Sbt(t){var e=0;for(Rl=0;Rl<t.length;Rl++)e=e*US+Kwe[t.charAt(Rl)];return e}function DC(){var t=NC(+new Date);return t!==Vwe?(jwe=0,Vwe=t):t+"."+NC(jwe++)}for(;Rl<US;Rl++)Kwe[Fwe[Rl]]=Rl;DC.encode=NC;DC.decode=Sbt;zwe.exports=DC});var MC=p((fLt,Gwe)=>{f();var xbt=MS(),Abt=LS(),Hwe=K0(),Ibt=BC(),Ho=me()("engine.io-client:polling"),$we=class extends xbt{get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let r=()=>{Ho("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(Ho("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){Ho("pre-pause polling complete"),--i||r()})),this.writable||(Ho("we are currently writing - waiting to pause"),i++,this.once("drain",function(){Ho("pre-pause writing complete"),--i||r()}))}else r()}poll(){Ho("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){Ho("polling got data %s",e);let r=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose(),!1;this.onPacket(i)};Hwe.decodePayload(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():Ho('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{Ho("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(Ho("transport open - closing"),e()):(Ho("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,Hwe.encodePayload(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{},r=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Ibt()),!this.supportsBinary&&!e.sid&&(e.b64=1),e=Abt.encode(e),this.opts.port&&(r==="https"&&Number(this.opts.port)!==443||r==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}};Gwe.exports=$we});var LC=p((dLt,Wwe)=>{f();Wwe.exports.pick=(t,...e)=>e.reduce((r,i)=>(t.hasOwnProperty(i)&&(r[i]=t[i]),r),{})});var Jwe=p((hLt,FC)=>{f();var Ywe=TC(),Tbt=MC(),Rbt=j0(),{pick:Pbt}=LC(),Cbt=U1(),UC=me()("engine.io-client:polling-xhr");function Xwe(){}var Obt=function(){return new Ywe({xdomain:!1}).responseType!=null}(),Qwe=class extends Tbt{constructor(e){super(e);if(typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?443:80),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let r=e&&e.forceBase64;this.supportsBinary=Obt&&!r}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new Qs(this.uri(),e)}doWrite(e,r){let i=this.request({method:"POST",data:e});i.on("success",r),i.on("error",n=>{this.onError("xhr post error",n)})}doPoll(){UC("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",r=>{this.onError("xhr poll error",r)}),this.pollXhr=e}},Qs=class extends Rbt{constructor(e,r){super();this.opts=r,this.method=r.method||"GET",this.uri=e,this.async=r.async!==!1,this.data=r.data!==void 0?r.data:null,this.create()}create(){let e=Pbt(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let r=this.xhr=new Ywe(e);try{UC("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{r.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),this.hasXDR()?(r.onload=()=>{this.onLoad()},r.onerror=()=>{this.onError(r.responseText)}):r.onreadystatechange=()=>{r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():setTimeout(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},UC("xhr data %s",this.data),r.send(this.data)}catch(i){setTimeout(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=Qs.requestsCount++,Qs.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=Xwe:this.xhr.onreadystatechange=Xwe,e)try{this.xhr.abort()}catch(r){}typeof document!="undefined"&&delete Qs.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&this.onData(e)}hasXDR(){return typeof XDomainRequest!="undefined"&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}};Qs.requestsCount=0;Qs.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",Zwe);else if(typeof addEventListener=="function"){let t="onpagehide"in Cbt?"pagehide":"unload";addEventListener(t,Zwe,!1)}}function Zwe(){for(let t in Qs.requests)Qs.requests.hasOwnProperty(t)&&Qs.requests[t].abort()}FC.exports=Qwe;FC.exports.Request=Qs});var i_e=p((pLt,r_e)=>{f();var kbt=MC(),e_e=U1(),qbt=/\n/g,Nbt=/\\n/g,FS,t_e=class extends kbt{constructor(e){super(e);this.query=this.query||{},FS||(FS=e_e.___eio=e_e.___eio||[]),this.index=FS.length,FS.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){let e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=n=>{this.onError("jsonp poll error",n)};let r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e,typeof navigator!="undefined"&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){let n=document.createElement("iframe");document.body.appendChild(n),document.body.removeChild(n)},100)}doWrite(e,r){let i;if(!this.form){let o=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri();function n(){s(),r()}let s=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(o){this.onError("jsonp polling iframe removal error",o)}try{let o='<iframe src="javascript:0" name="'+this.iframeId+'">';i=document.createElement(o)}catch(o){i=document.createElement("iframe"),i.name=this.iframeId,i.src="javascript:0"}i.id=this.iframeId,this.form.appendChild(i),this.iframe=i};s(),e=e.replace(Nbt,`\\
`),this.area.value=e.replace(qbt,"\\n");try{this.form.submit()}catch(o){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{this.iframe.readyState==="complete"&&n()}:this.iframe.onload=n}};r_e.exports=t_e});var o_e=p((yLt,s_e)=>{f();var n_e=U1(),Dbt=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):e=>setTimeout(e,0))();s_e.exports={WebSocket:n_e.WebSocket||n_e.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:Dbt}});var l_e=p((gLt,u_e)=>{f();var a_e=MS(),Bbt=K0(),Mbt=LS(),Lbt=BC(),{pick:Ubt}=LC(),{WebSocket:F1,usingBrowserWebSocket:KC,defaultBinaryType:Fbt,nextTick:Kbt}=o_e(),jbt=me()("engine.io-client:websocket"),c_e=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",KS=class extends a_e{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),r=this.opts.protocols,i=c_e?{}:Ubt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=KC&&!c_e?r?new F1(e,r):new F1(e):new F1(e,r,i)}catch(n){return this.emit("error",n)}this.ws.binaryType=this.socket.binaryType||Fbt,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let i=e[r],n=r===e.length-1;Bbt.encodePacket(i,this.supportsBinary,s=>{let o={};KC||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{KC?this.ws.send(s):this.ws.send(s,o)}catch(a){jbt("websocket closed before onclose event")}n&&Kbt(()=>{this.writable=!0,this.emit("drain")})})}}onClose(){a_e.prototype.onClose.call(this)}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},r=this.opts.secure?"wss":"ws",i="";this.opts.port&&(r==="wss"&&Number(this.opts.port)!==443||r==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=Lbt()),this.supportsBinary||(e.b64=1),e=Mbt.encode(e),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}check(){return!!F1&&!("__initialize"in F1&&this.name===KS.prototype.name)}};u_e.exports=KS});var VC=p(jC=>{f();var Vbt=TC(),zbt=Jwe(),Hbt=i_e(),$bt=l_e();jC.polling=Gbt;jC.websocket=$bt;function Gbt(t){let e,r=!1,i=!1,n=t.jsonp!==!1;if(typeof location!="undefined"){let s=location.protocol==="https:",o=location.port;o||(o=s?443:80),r=t.hostname!==location.hostname||o!==t.port,i=t.secure!==s}if(t.xdomain=r,t.xscheme=i,e=new Vbt(t),"open"in e&&!t.forceJSONP)return new zbt(t);if(!n)throw new Error("JSONP disabled");return new Hbt(t)}});var p_e=p((mLt,h_e)=>{f();var Wbt=VC(),Ybt=j0(),ni=me()("engine.io-client:socket"),f_e=K0(),d_e=AC(),Xbt=LS(),tc=class extends Ybt{constructor(e,r={}){super();e&&typeof e=="object"&&(r=e,e=null),e?(e=d_e(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=d_e(r.host).host),this.secure=r.secure!=null?r.secure:typeof location!="undefined"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=r.port||(typeof location!="undefined"&&location.port?location.port:this.secure?443:80),this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=Xbt.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){ni('creating transport "%s"',e);let r=Qbt(this.opts.query);r.EIO=f_e.protocol,r.transport=e,this.id&&(r.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return ni("options: %j",i),new Wbt[e](i)}open(){let e;if(this.opts.rememberUpgrade&&tc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){setTimeout(()=>{this.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(r){ni("error while creating transport: %s",r),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){ni("setting transport %s",e.name),this.transport&&(ni("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){ni('probing transport "%s"',e);let r=this.createTransport(e,{probe:1}),i=!1;tc.priorWebsocketSuccess=!1;let n=()=>{i||(ni('probe transport "%s" opened',e),r.send([{type:"ping",data:"probe"}]),r.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(ni('probe transport "%s" pong',e),this.upgrading=!0,this.emit("upgrading",r),!r)return;tc.priorWebsocketSuccess=r.name==="websocket",ni('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(ni("changing transport and sending upgrade packet"),l(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emit("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{ni('probe transport "%s" failed',e);let h=new Error("probe error");h.transport=r.name,this.emit("upgradeError",h)}}))};function s(){i||(i=!0,l(),r.close(),r=null)}let o=d=>{let h=new Error("probe error: "+d);h.transport=r.name,s(),ni('probe transport "%s" failed because of error: %s',e,d),this.emit("upgradeError",h)};function a(){o("transport closed")}function c(){o("socket closed")}function u(d){r&&d.name!==r.name&&(ni('"%s" works - aborting "%s"',d.name,r.name),s())}let l=()=>{r.removeListener("open",n),r.removeListener("error",o),r.removeListener("close",a),this.removeListener("close",c),this.removeListener("upgrading",u)};r.once("open",n),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",u),r.open()}onOpen(){if(ni("socket open"),this.readyState="open",tc.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){ni("starting upgrade probes");let e=0,r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(ni('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":let r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emit("data",e.data),this.emit("message",e.data);break}else ni('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(ni("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,r,i){return this.sendPacket("message",e,r,i),this}send(e,r,i){return this.sendPacket("message",e,r,i),this}sendPacket(e,r,i,n){if(typeof r=="function"&&(n=r,r=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:r,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),ni("socket closing - telling transport to close"),this.transport.close()},r=()=>{this.removeListener("upgrade",r),this.removeListener("upgradeError",r),e()},i=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){ni("socket error %j",e),tc.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(ni('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let r=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&r.push(e[i]);return r}};tc.priorWebsocketSuccess=!1;tc.protocol=f_e.protocol;function Qbt(t){let e={};for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}h_e.exports=tc});var y_e=p((vLt,Td)=>{f();var zC=p_e();Td.exports=(t,e)=>new zC(t,e);Td.exports.Socket=zC;Td.exports.protocol=zC.protocol;Td.exports.Transport=MS();Td.exports.transports=VC();Td.exports.parser=K0()});var HC=p(V0=>{f();"use strict";Object.defineProperty(V0,"__esModule",{value:!0});V0.hasBinary=V0.isBinary=void 0;var Zbt=typeof ArrayBuffer=="function",Jbt=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,g_e=Object.prototype.toString,e1t=typeof Blob=="function"||typeof Blob!="undefined"&&g_e.call(Blob)==="[object BlobConstructor]",t1t=typeof File=="function"||typeof File!="undefined"&&g_e.call(File)==="[object FileConstructor]";function b_e(t){return Zbt&&(t instanceof ArrayBuffer||Jbt(t))||e1t&&t instanceof Blob||t1t&&t instanceof File}V0.isBinary=b_e;function jS(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,i=t.length;r<i;r++)if(jS(t[r]))return!0;return!1}if(b_e(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return jS(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&jS(t[r]))return!0;return!1}V0.hasBinary=jS});var m_e=p(z0=>{f();"use strict";Object.defineProperty(z0,"__esModule",{value:!0});z0.reconstructPacket=z0.deconstructPacket=void 0;var r1t=HC();function i1t(t){let e=[],r=t.data,i=t;return i.data=$C(r,e),i.attachments=e.length,{packet:i,buffers:e}}z0.deconstructPacket=i1t;function $C(t,e){if(!t)return t;if(r1t.isBinary(t)){let r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){let r=new Array(t.length);for(let i=0;i<t.length;i++)r[i]=$C(t[i],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){let r={};for(let i in t)t.hasOwnProperty(i)&&(r[i]=$C(t[i],e));return r}return t}function n1t(t,e){return t.data=GC(t.data,e),t.attachments=void 0,t}z0.reconstructPacket=n1t;function GC(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=GC(t[r],e);else if(typeof t=="object")for(let r in t)t.hasOwnProperty(r)&&(t[r]=GC(t[r],e));return t}});var zS=p($o=>{f();"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.Decoder=$o.Encoder=$o.PacketType=$o.protocol=void 0;var s1t=j0(),v_e=m_e(),w_e=HC(),WC=me()("socket.io-parser");$o.protocol=5;var fi;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(fi=$o.PacketType||($o.PacketType={}));var __e=class{encode(e){return WC("encoding packet %j",e),(e.type===fi.EVENT||e.type===fi.ACK)&&w_e.hasBinary(e)?(e.type=e.type===fi.EVENT?fi.BINARY_EVENT:fi.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===fi.BINARY_EVENT||e.type===fi.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data)),WC("encoded %j as %s",e,r),r}encodeAsBinary(e){let r=v_e.deconstructPacket(e),i=this.encodeAsString(r.packet),n=r.buffers;return n.unshift(i),n}};$o.Encoder=__e;var VS=class extends s1t{constructor(){super()}add(e){let r;if(typeof e=="string")r=this.decodeString(e),r.type===fi.BINARY_EVENT||r.type===fi.BINARY_ACK?(this.reconstructor=new E_e(r),r.attachments===0&&super.emit("decoded",r)):super.emit("decoded",r);else if(w_e.isBinary(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emit("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0,i={type:Number(e.charAt(0))};if(fi[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===fi.BINARY_EVENT||i.type===fi.BINARY_ACK){let s=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);let o=e.substring(s,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(r+1)==="/"){let s=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););i.nsp=e.substring(s,r)}else i.nsp="/";let n=e.charAt(r+1);if(n!==""&&Number(n)==n){let s=r+1;for(;++r;){let o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}i.id=Number(e.substring(s,r+1))}if(e.charAt(++r)){let s=o1t(e.substr(r));if(VS.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return WC("decoded %s as %j",e,i),i}static isPayloadValid(e,r){switch(e){case fi.CONNECT:return typeof r=="object";case fi.DISCONNECT:return r===void 0;case fi.CONNECT_ERROR:return typeof r=="string"||typeof r=="object";case fi.EVENT:case fi.BINARY_EVENT:return Array.isArray(r)&&r.length>0;case fi.ACK:case fi.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};$o.Decoder=VS;function o1t(t){try{return JSON.parse(t)}catch(e){return!1}}var E_e=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let r=v_e.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var YC=p(HS=>{f();"use strict";Object.defineProperty(HS,"__esModule",{value:!0});HS.on=void 0;function a1t(t,e,r){return t.on(e,r),function(){t.off(e,r)}}HS.on=a1t});var XC=p($S=>{f();"use strict";Object.defineProperty($S,"__esModule",{value:!0});$S.StrictEventEmitter=void 0;var c1t=j0(),S_e=class extends c1t{on(e,r){return super.on(e,r),this}once(e,r){return super.once(e,r),this}emit(e,...r){return super.emit(e,...r),this}emitReserved(e,...r){return super.emit(e,...r),this}listeners(e){return super.listeners(e)}};$S.StrictEventEmitter=S_e});var QC=p(WS=>{f();"use strict";Object.defineProperty(WS,"__esModule",{value:!0});WS.Socket=void 0;var Zs=zS(),GS=YC(),u1t=XC(),Js=me()("socket.io-client:socket"),l1t=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),x_e=class extends u1t.StrictEventEmitter{constructor(e,r,i){super();this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;let e=this.io;this.subs=[GS.on(e,"open",this.onopen.bind(this)),GS.on(e,"packet",this.onpacket.bind(this)),GS.on(e,"error",this.onerror.bind(this)),GS.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(l1t.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');r.unshift(e);let i={type:Zs.PacketType.EVENT,data:r};i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"&&(Js("emitting packet with ack id %d",this.ids),this.acks[this.ids]=r.pop(),i.id=this.ids++);let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?Js("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){Js("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:Zs.PacketType.CONNECT,data:e})}):this.packet({type:Zs.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){Js("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Zs.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Zs.PacketType.EVENT:this.onevent(e);break;case Zs.PacketType.BINARY_EVENT:this.onevent(e);break;case Zs.PacketType.ACK:this.onack(e);break;case Zs.PacketType.BINARY_ACK:this.onack(e);break;case Zs.PacketType.DISCONNECT:this.ondisconnect();break;case Zs.PacketType.CONNECT_ERROR:let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let r=e.data||[];Js("emitting event %j",r),e.id!=null&&(Js("attaching ack callback to event"),r.push(this.ack(e.id))),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let i of r)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let r=this,i=!1;return function(...n){i||(i=!0,Js("sending ack %j",n),r.packet({type:Zs.PacketType.ACK,id:e,data:n}))}}onack(e){let r=this.acks[e.id];typeof r=="function"?(Js("calling ack %s with %j",e.id,e.data),r.apply(this,e.data),delete this.acks[e.id]):Js("bad ack %s",e.id)}onconnect(e){Js("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){Js("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(Js("performing disconnect (%s)",this.nsp),this.packet({type:Zs.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let r=this._anyListeners;for(let i=0;i<r.length;i++)if(e===r[i])return r.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}};WS.Socket=x_e});var I_e=p((ILt,A_e)=>{f();A_e.exports=H0;function H0(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}H0.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};H0.prototype.reset=function(){this.attempts=0};H0.prototype.setMin=function(t){this.ms=t};H0.prototype.setMax=function(t){this.max=t};H0.prototype.setJitter=function(t){this.jitter=t}});var ZC=p(YS=>{f();"use strict";Object.defineProperty(YS,"__esModule",{value:!0});YS.Manager=void 0;var f1t=y_e(),d1t=QC(),h1t=zS(),Rd=YC(),p1t=I_e(),y1t=XC(),Wi=me()("socket.io-client:manager"),T_e=class extends y1t.StrictEventEmitter{constructor(e,r){super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor(r.randomizationFactor||.5),this.backoff=new p1t({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;let i=r.parser||h1t;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(Wi("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;Wi("opening %s",this.uri),this.engine=f1t(this.uri,this.opts);let r=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=Rd.on(r,"open",function(){i.onopen(),e&&e()}),s=Rd.on(r,"error",o=>{Wi("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;Wi("connect attempt will timeout after %d",o),o===0&&n();let a=setTimeout(()=>{Wi("connect attempt timed out after %d",o),n(),r.close(),r.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){Wi("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Rd.on(e,"ping",this.onping.bind(this)),Rd.on(e,"data",this.ondata.bind(this)),Rd.on(e,"error",this.onerror.bind(this)),Rd.on(e,"close",this.onclose.bind(this)),Rd.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){Wi("error",e),this.emitReserved("error",e)}socket(e,r){let i=this.nsps[e];return i||(i=new d1t.Socket(this,e,r),this.nsps[e]=i),i}_destroy(e){let r=Object.keys(this.nsps);for(let i of r)if(this.nsps[i].active){Wi("socket %s is still active, skipping close",i);return}this._close()}_packet(e){Wi("writing packet %j",e);let r=this.encoder.encode(e);for(let i=0;i<r.length;i++)this.engine.write(r[i],e.options)}cleanup(){Wi("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){Wi("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this._readyState==="opening"&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){Wi("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)Wi("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();Wi("will wait %dms before reconnect attempt",r),this._reconnecting=!0;let i=setTimeout(()=>{e.skipReconnect||(Wi("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(Wi("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(Wi("reconnect success"),e.onreconnect())}))},r);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};YS.Manager=T_e});var O_e=p((Gn,C_e)=>{f();"use strict";Object.defineProperty(Gn,"__esModule",{value:!0});Gn.io=Gn.Socket=Gn.Manager=Gn.protocol=void 0;var g1t=_we(),R_e=ZC(),P_e=me()("socket.io-client");C_e.exports=Gn=XS;var K1=Gn.managers={};function XS(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};let r=g1t.url(t,e.path||"/socket.io"),i=r.source,n=r.id,s=r.path,o=K1[n]&&s in K1[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(P_e("ignoring socket cache for %s",i),c=new R_e.Manager(i,e)):(K1[n]||(P_e("new io instance for %s",i),K1[n]=new R_e.Manager(i,e)),c=K1[n]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Gn.io=XS;var b1t=zS();Object.defineProperty(Gn,"protocol",{enumerable:!0,get:function(){return b1t.protocol}});Gn.connect=XS;var m1t=ZC();Object.defineProperty(Gn,"Manager",{enumerable:!0,get:function(){return m1t.Manager}});var v1t=QC();Object.defineProperty(Gn,"Socket",{enumerable:!0,get:function(){return v1t.Socket}});Gn.default=XS});var JC=p((RLt,k_e)=>{f();var w1t=wE();k_e.exports=t=>async e=>{e=w1t(e);let r=v=>{typeof v.return=="function"&&v.return()},i=null,n=null,s=v=>{i=v,n&&n(v),r(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},u=null,l=!1,d=()=>{l=!0,u&&u()},h=null,y=()=>{h&&h()},g=()=>new Promise((v,A)=>{o=h=v,n=A,t.once("drain",y)}),m=()=>(r(e),new Promise((v,A)=>{if(a||l||i)return v();u=o=v,n=A})),E=()=>{t.removeListener("error",s),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("drain",y)};t.once("error",s),t.once("close",c),t.once("finish",d);try{for await(let v of e){if(!t.writable||t.destroyed||i)break;t.write(v)===!1&&await g()}}catch(v){i||t.destroy(),i=v}try{if(t.writable&&t.end(),await m(),i)throw i}finally{E()}}});var eO=p((PLt,q_e)=>{f();var _1t=JC(),E1t=g1();q_e.exports=t=>({sink:_1t(t),source:E1t(t)})});var D_e=p((CLt,N_e)=>{f();var S1t=eO();N_e.exports=t=>async function*(e){let r=S1t(t),i;if(r.sink(e).catch(n=>{i=n}),yield*r.source,i)throw i}});var B_e=p((OLt,$0)=>{f();$0.exports=g1();$0.exports.source=g1();$0.exports.sink=JC();$0.exports.transform=D_e();$0.exports.duplex=eO()});var tO=p((kLt,K_e)=>{f();"use strict";var M_e=Ha(),x1t=B_e(),{CLOSE_TIMEOUT:A1t}=DS(),L_e=hC(),U_e=me(),QS=U_e("libp2p:webrtc-star:socket");QS.error=U_e("libp2p:webrtc-star:socket:error");var F_e=(t,e)=>{if(!(!t||!e))try{return L_e(t,e)}catch(r){return QS.error(r),L_e("0.0.0.0",e)}};K_e.exports=(t,e={})=>{let{sink:r,source:i}=x1t.duplex(t),n=e.remoteAddr||F_e(t.remoteAddress,t.remotePort),s=F_e(t.localAddress,t.localPort),o={async sink(a){e.signal&&(a=M_e(a,e.signal));try{await r(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&QS.error(c)}},source:e.signal?M_e(i,e.signal):i,conn:t,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!t.destroyed)return new Promise((a,c)=>{let u=Date.now(),l=setTimeout(()=>{if(o.remoteAddr){let{host:d,port:h}=o.remoteAddr.toOptions();QS("timeout closing socket to %s:%s after %dms, destroying it manually",d,h,Date.now()-u)}t.destroyed||t.destroy()},A1t);t.once("close",()=>{a()}),t.end(d=>{if(clearTimeout(l),o.timeline.close=Date.now(),d)return c(d)})})}};return t.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var rO=p((qLt,V_e)=>{f();"use strict";var{Multiaddr:j_e}=tt();function I1t(t){let e=t.toString().split("/"),r=t.protos()[1].name,i=t.protos()[2].name,n=t.stringTuples()[1][1];if(r!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+t.toString());if(!j_e.isName(t))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function T1t(t){let e="/libp2p-webrtc-star";if(t.indexOf(e)!==-1){t=t.substring(e.length,t.length);let r=new j_e(t),i=r.stringTuples().filter(n=>n[0]===421)[0];r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${i[1]}`),t=r.toString()}return t}V_e.exports={cleanUrlSIO:I1t,cleanMultiaddr:T1t}});var G_e=p((NLt,$_e)=>{f();"use strict";var R1t=dr(),z_e=me(),Pd=z_e("libp2p:webrtc-star:listener");Pd.error=z_e("libp2p:webrtc-star:listener:error");var P1t=ae(),C1t=O_e(),O1t=xC(),k1t=Hu(),q1t=tO(),{cleanUrlSIO:N1t}=rO(),{CODE_P2P:H_e}=DS(),D1t={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};$_e.exports=({handler:t,upgrader:e},r,i={})=>{let n=new R1t,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw P1t(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=k1t();s=a;let u;!a.protoCodes().includes(H_e)&&e.localPeer?u=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):u=a,n.on("error",()=>c.reject()),o=N1t(a),Pd("Dialing to Signalling Server on: "+o),n.io=C1t.connect(o,D1t);let l=d=>{if(d.answer||d.err||!d.intentId)return;let h=d.intentId,y=n.__pendingIntents.get(h);y||(y=[],n.__pendingIntents.set(h,y));let g=n.__spChannels.get(h);if(g){g.signal(d.signal);return}else if(d.signal.type!=="offer"){y.push(d);return}let m={trickle:!1,...i};r.wrtc&&(m.wrtc=r.wrtc),g=new O1t(m);let E=v=>{Pd.error("incoming connection errored",v)};g.on("error",E),g.once("close",(...v)=>{g.removeListener("error",E)}),g.on("signal",v=>{d.signal=v,d.answer=!0,n.io.emit("ss-handshake",d)}),g.signal(d.signal);for(let v of y)g.signal(v.signal);n.__pendingIntents.set(h,[]),g.once("connect",async()=>{let v=q1t(g);Pd("new inbound connection %s",v.remoteAddr);let A;try{A=await e.upgradeInbound(v)}catch(R){return Pd.error("inbound connection failed to upgrade",R),v.close()}if(!A.remoteAddr)try{A.remoteAddr=a.decapsulateCode(H_e).encapsulate(`/p2p/${A.remotePeer.toB58String()}`)}catch(R){Pd.error("could not determine remote address",R)}Pd("inbound connection %s upgraded",v.remoteAddr),B1t(n,v,h),n.emit("connection",A),t(A)}),n.__spChannels.set(h,g)};return n.io.once("connect_error",d=>c.reject(d)),n.io.once("error",d=>{n.emit("error",d),n.emit("close")}),n.io.on("ws-handshake",l),n.io.on("ws-peer",r._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",u.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),r.sigReferences.set(o,{listener:n,signallingAddr:u}),c.promise},n.close=async()=>{let a=r.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,r.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function B1t(t,e,r){t.__connections.push(e);let i=()=>{t.__connections=t.__connections.filter(n=>n!==e),t.__spChannels.delete(r),t.__pendingIntents.delete(r)};e.conn.once("close",i)}});var Z_e=p((DLt,Q_e)=>{f();"use strict";var W_e=me(),Jc=W_e("libp2p:webrtc-star");Jc.error=W_e("libp2p:webrtc-star:error");var{EventEmitter:M1t}=dr(),ZS=ae(),L1t=Qv(),{AbortError:Y_e}=Ha(),U1t=xC(),{supportsWebRTCDataChannels:F1t}=mwe(),{Multiaddr:K1t}=tt(),j1t=lf(),V1t=et(),{CODE_CIRCUIT:z1t}=DS(),H1t=G_e(),$1t=tO(),{cleanMultiaddr:G1t,cleanUrlSIO:W1t}=rO();function Y1t(){}var X_e=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new M1t,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,r={}){let i=await this._connect(e,r),n=$1t(i,{remoteAddr:e,signal:r.signal});Jc("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Jc("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,r={}){if(r.signal&&r.signal.aborted)throw new Y_e;let i={initiator:!0,trickle:!1,...r.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(W1t(e));if(!c||!c.listener)return a(ZS(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=c.listener.io,l=Date.now(),d;Jc("dialing %s:%s",n.host,n.port);let h=new U1t(i),y=A=>{if(!d){let R=`connection error ${n.host}:${n.port}: ${A.message}`;Jc.error(R),v(A)}},g=()=>{Jc("connnection timeout %s:%s",n.host,n.port);let A=ZS(new Error(`connection timeout after ${Date.now()-l}ms`),"ERR_CONNECT_TIMEOUT");h.emit("error",A)},m=()=>{d=!0,Jc("connection opened %s:%s",n.host,n.port),v(null)},E=()=>{Jc.error("connection aborted %s:%s",n.host,n.port),h.destroy(),v(new Y_e)},v=A=>{h.removeListener("timeout",g),h.removeListener("connect",m),r.signal&&r.signal.removeEventListener("abort",E),A?a(A):o(h)};h.on("error",y),h.once("timeout",g),h.once("connect",m),h.on("close",()=>{h.removeListener("error",y)}),r.signal&&r.signal.addEventListener("abort",E),h.on("signal",A=>{u.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:A})}),u.on("ws-handshake",A=>{A.intentId===s&&A.err&&(h.destroy(),a(ZS(A.err instanceof Error?A.err:new Error(A.err),"ERR_SIGNALLING_FAILED"))),!(A.intentId!==s||!A.answer||h.destroyed)&&h.signal(A.signal)})})}createListener(e={},r){if(!F1t&&!this.wrtc)throw ZS(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(r=e,e={}),r=r||Y1t,H1t({handler:r,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>r.protoCodes().includes(z1t)?!1:j1t.WebRTCStar.matches(r))}_peerDiscovered(e){if(!this.discovery._isStarted)return;Jc("Peer Discovered:",e),e=G1t(e);let r=new K1t(e),i=V1t.createFromB58String(r.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[r]})}};Q_e.exports=L1t(X_e,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var i2e=p((BLt,r2e)=>{f();"use strict";var JS=es(),J_e=ln(),iO=10*1024,e2e=class{constructor(){this._pool=new Uint8Array(iO),this._poolOffset=0}write(e){let r=this._pool,i=this._poolOffset;JS.encode(e.id<<3|e.type,r,i),i+=JS.encode.bytes,JS.encode(e.data?e.data.length:0,r,i),i+=JS.encode.bytes;let n=r.subarray(this._poolOffset,i);return iO-i<100?(this._pool=new Uint8Array(iO),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},t2e=new e2e;r2e.exports=t=>async function*(){for await(let r of t)Array.isArray(r)?yield new J_e(r.map(i=>t2e.write(i))):yield new J_e(t2e.write(r))}()});var o2e=p((MLt,s2e)=>{f();"use strict";var e3=es(),X1t=ln();s2e.exports=t=>async function*(){let r=new n2e;for await(let i of t){let n=r.write(i);n.length&&(yield n)}}();var n2e=class{constructor(){this._buffer=new X1t,this._bufferProxy=new Proxy({},{get:(e,r)=>r[0]==="l"?this._buffer[r]:this._buffer.get(parseInt(r))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let r=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;r.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return r}_decodeHeader(e){let r=e3.decode(e),i=e3.decode.bytes,n=e3.decode(e,i);return i+=e3.decode.bytes,{id:r>>3,type:r&7,offset:i,length:n}}}});var a2e=p(nO=>{f();"use strict";nO.encode=i2e();nO.decode=o2e()});var oO=p((ULt,sO)=>{f();"use strict";var c2e=1<<20;sO.exports=t=>{t=t||c2e;let e=r=>{if(r.data&&r.data.length>t)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return r=>async function*(){for await(let n of r)Array.isArray(n)?n.forEach(e):e(n),yield n}()};sO.exports.MAX_MSG_SIZE=c2e});var aO=p(j1=>{f();"use strict";var eu=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});j1.MessageTypes=eu;j1.InitiatorMessageTypes=Object.freeze({NEW_STREAM:eu.NEW_STREAM,MESSAGE:eu.MESSAGE_INITIATOR,CLOSE:eu.CLOSE_INITIATOR,RESET:eu.RESET_INITIATOR});j1.ReceiverMessageTypes=Object.freeze({MESSAGE:eu.MESSAGE_RECEIVER,CLOSE:eu.CLOSE_RECEIVER,RESET:eu.RESET_RECEIVER});j1.MessageTypeNames=Object.freeze(Object.entries(eu).reduce((t,e)=>(t[e[1]]=e[0],t),{}))});var d2e=p((KLt,f2e)=>{f();"use strict";var Q1t=Ha(),u2e=Ll(),V1=me()("libp2p:mplex:stream"),Z1t=Oa(),l2e=ln(),J1t=ae(),{MAX_MSG_SIZE:emt}=oO(),{InitiatorMessageTypes:tmt,ReceiverMessageTypes:rmt}=aO(),cO="ERR_MPLEX_STREAM_RESET",imt="ERR_MPLEX_STREAM_ABORT";f2e.exports=({id:t,name:e,send:r,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=emt})=>{let o=new u2e,a=new u2e,c=n==="initiator"?tmt:rmt,u=n==="initiator"?`i${t}`:`r${t}`;e=String(e??t);let l=!1,d=!1,h,y=E=>{l||(l=!0,V1("%s stream %s source end",n,e,E),E&&!h&&(h=E),d&&(m.timeline.close=Date.now(),i(h)))},g=E=>{d||(d=!0,V1("%s stream %s sink end",n,e,E),E&&!h&&(h=E),l&&(m.timeline.close=Date.now(),i(h)))},m={close:()=>m.source.end(),abort:E=>{V1("%s stream %s abort",n,e,E),m.source.end(E),o.abort(),g(E)},reset:()=>{let E=J1t(new Error("stream reset"),cO);a.abort(),m.source.end(E),g(E)},sink:async E=>{E=Q1t(E,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:imt}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:cO}}]),n==="initiator"&&r({id:t,type:c.NEW_STREAM,data:e});try{for await(let v of E)for(;v.length;){if(v.length<=s){r({id:t,type:c.MESSAGE,data:v});break}v=l2e.isBufferList(v)?v:new l2e(v),r({id:t,type:c.MESSAGE,data:v.shallowSlice(0,s)}),v.consume(s)}}catch(v){return v.code===cO?V1("%s stream %s reset",n,e):(V1("%s stream %s error",n,e,v),r({id:t,type:c.RESET})),m.source.end(v),g(v)}r({id:t,type:c.CLOSE}),g()},source:Z1t(y),timeline:{open:Date.now(),close:null},id:u};return m}});var g2e=p((jLt,y2e)=>{f();"use strict";var nmt=Er(),smt=Oa(),tu=me()("libp2p:mplex"),omt=Ha(),h2e=a2e(),amt=oO(),{MessageTypes:Cd,MessageTypeNames:p2e}=aO(),cmt=d2e(),uO=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(r=>{e.push(r)}),this._streams.receivers.forEach(r=>{e.push(r)}),e}newStream(e){let r=this._streamId++;e=e==null?r.toString():String(e);let i=this._streams.initiators;return this._newStream({id:r,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:r}){let i=this._streams.receivers;return this._newStream({id:e,name:r,type:"receiver",registry:i})}_newStream({id:e,name:r,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);tu("new %s stream %s %s",i,e,r);let a=cmt({id:e,name:r,send:c=>(tu.enabled&&tu("%s stream %s %s send",i,e,r,{...c,type:p2e[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{tu("%s stream %s %s ended",i,e,r),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=omt(e,this._options.signal));try{await nmt(e,h2e.decode,amt(this._options.maxMsgSize),async r=>{for await(let i of r)for(let n of i)this._handleIncoming(n)})}catch(r){return tu("error in sink",r),this.source.end(r)}this.source.end()}}_createSource(){let r=smt({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(h2e.encode(r),{push:r.push,end:r.end,return:r.return})}_handleIncoming({id:e,type:r,data:i}){if(tu.enabled&&tu("incoming message",{id:e,type:p2e[r],data:i.slice()}),r===Cd.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(r&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return tu("missing stream %s",e);switch(r){case Cd.MESSAGE_INITIATOR:case Cd.MESSAGE_RECEIVER:s.source.push(i);break;case Cd.CLOSE_INITIATOR:case Cd.CLOSE_RECEIVER:s.close();break;case Cd.RESET_INITIATOR:case Cd.RESET_RECEIVER:s.reset();break;default:tu("unknown message type %s",r)}}};uO.multicodec="/mplex/6.7.0";y2e.exports=uO});var m2e=p((VLt,b2e)=>{f();"use strict";b2e.exports=g2e()});var w2e=p(lO=>{f();"use strict";Object.defineProperty(lO,"__esModule",{value:!0});var v2e=65536,umt=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),i=0;i<r.length;i+=v2e)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,v2e)));return r},t}();lO.BrowserRandomSource=umt});var rc=p(fO=>{f();"use strict";Object.defineProperty(fO,"__esModule",{value:!0});function lmt(t){for(var e=0;e<t.length;e++)t[e]=0;return t}fO.wipe=lmt});var _2e=p(dO=>{f();"use strict";Object.defineProperty(dO,"__esModule",{value:!0});var fmt=rc(),dmt=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Wo!="undefined"){var e=Zd();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=r[n];return fmt.wipe(r),i},t}();dO.NodeRandomSource=dmt});var E2e=p(hO=>{f();"use strict";Object.defineProperty(hO,"__esModule",{value:!0});var hmt=w2e(),pmt=_2e(),ymt=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new hmt.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new pmt.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();hO.SystemRandomSource=ymt});var S2e=p(ps=>{f();"use strict";Object.defineProperty(ps,"__esModule",{value:!0});function gmt(t,e){var r=t>>>16&65535,i=t&65535,n=e>>>16&65535,s=e&65535;return i*s+(r*s+i*n<<16>>>0)|0}ps.mul=Math.imul||gmt;function bmt(t,e){return t+e|0}ps.add=bmt;function mmt(t,e){return t-e|0}ps.sub=mmt;function vmt(t,e){return t<<e|t>>>32-e}ps.rotl=vmt;function wmt(t,e){return t<<32-e|t>>>e}ps.rotr=wmt;function _mt(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}ps.isInteger=Number.isInteger||_mt;ps.MAX_SAFE_INTEGER=9007199254740991;ps.isSafeInteger=function(t){return ps.isInteger(t)&&t>=-ps.MAX_SAFE_INTEGER&&t<=ps.MAX_SAFE_INTEGER}});var z1=p(yt=>{f();"use strict";Object.defineProperty(yt,"__esModule",{value:!0});var x2e=S2e();function Emt(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}yt.readInt16BE=Emt;function Smt(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}yt.readUint16BE=Smt;function xmt(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}yt.readInt16LE=xmt;function Amt(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}yt.readUint16LE=Amt;function A2e(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}yt.writeUint16BE=A2e;yt.writeInt16BE=A2e;function I2e(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}yt.writeUint16LE=I2e;yt.writeInt16LE=I2e;function pO(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}yt.readInt32BE=pO;function yO(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}yt.readUint32BE=yO;function gO(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}yt.readInt32LE=gO;function bO(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}yt.readUint32LE=bO;function t3(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}yt.writeUint32BE=t3;yt.writeInt32BE=t3;function r3(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}yt.writeUint32LE=r3;yt.writeInt32LE=r3;function Imt(t,e){e===void 0&&(e=0);var r=pO(t,e),i=pO(t,e+4);return r*4294967296+i-(i>>31)*4294967296}yt.readInt64BE=Imt;function Tmt(t,e){e===void 0&&(e=0);var r=yO(t,e),i=yO(t,e+4);return r*4294967296+i}yt.readUint64BE=Tmt;function Rmt(t,e){e===void 0&&(e=0);var r=gO(t,e),i=gO(t,e+4);return i*4294967296+r-(r>>31)*4294967296}yt.readInt64LE=Rmt;function Pmt(t,e){e===void 0&&(e=0);var r=bO(t,e),i=bO(t,e+4);return i*4294967296+r}yt.readUint64LE=Pmt;function T2e(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),t3(t/4294967296>>>0,e,r),t3(t>>>0,e,r+4),e}yt.writeUint64BE=T2e;yt.writeInt64BE=T2e;function R2e(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),r3(t>>>0,e,r),r3(t/4294967296>>>0,e,r+4),e}yt.writeUint64LE=R2e;yt.writeInt64LE=R2e;function Cmt(t,e,r){if(r===void 0&&(r=0),t%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}yt.readUintBE=Cmt;function Omt(t,e,r){if(r===void 0&&(r=0),t%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}yt.readUintLE=Omt;function kmt(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!x2e.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}yt.writeUintBE=kmt;function qmt(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!x2e.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}yt.writeUintLE=qmt;function Nmt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}yt.readFloat32BE=Nmt;function Dmt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}yt.readFloat32LE=Dmt;function Bmt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}yt.readFloat64BE=Bmt;function Mmt(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}yt.readFloat64LE=Mmt;function Lmt(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}yt.writeFloat32BE=Lmt;function Umt(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}yt.writeFloat32LE=Umt;function Fmt(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}yt.writeFloat64BE=Fmt;function Kmt(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}yt.writeFloat64LE=Kmt});var k2e=p(Go=>{f();"use strict";Object.defineProperty(Go,"__esModule",{value:!0});var jmt=E2e(),Vmt=z1(),P2e=rc();Go.defaultRandomSource=new jmt.SystemRandomSource;function mO(t,e){return e===void 0&&(e=Go.defaultRandomSource),e.randomBytes(t)}Go.randomBytes=mO;function zmt(t){t===void 0&&(t=Go.defaultRandomSource);var e=mO(4,t),r=Vmt.readUint32LE(e);return P2e.wipe(e),r}Go.randomUint32=zmt;var C2e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function O2e(t,e,r){if(e===void 0&&(e=C2e),r===void 0&&(r=Go.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;t>0;){for(var o=mO(Math.ceil(t*256/s),r),a=0;a<o.length&&t>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),t--)}P2e.wipe(o)}return i}Go.randomString=O2e;function Hmt(t,e,r){e===void 0&&(e=C2e),r===void 0&&(r=Go.defaultRandomSource);var i=Math.ceil(t/(Math.log(e.length)/Math.LN2));return O2e(i,e,r)}Go.randomStringForEntropy=Hmt});var s3=p(Wn=>{f();"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});var $mt=k2e(),Gmt=rc();Wn.PUBLIC_KEY_LENGTH=32;Wn.SECRET_KEY_LENGTH=32;Wn.SHARED_KEY_LENGTH=32;function ic(t){var e=new Float64Array(16);if(t)for(var r=0;r<t.length;r++)e[r]=t[r];return e}var q2e=new Uint8Array(32);q2e[0]=9;var Wmt=ic([56129,1]);function vO(t){for(var e=1,r=0;r<16;r++){var i=t[r]+e+65535;e=Math.floor(i/65536),t[r]=i-e*65536}t[0]+=e-1+37*(e-1)}function H1(t,e,r){for(var i=~(r-1),n=0;n<16;n++){var s=i&(t[n]^e[n]);t[n]^=s,e[n]^=s}}function Ymt(t,e){for(var r=ic(),i=ic(),n=0;n<16;n++)i[n]=e[n];vO(i),vO(i),vO(i);for(var s=0;s<2;s++){r[0]=i[0]-65517;for(var n=1;n<15;n++)r[n]=i[n]-65535-(r[n-1]>>16&1),r[n-1]&=65535;r[15]=i[15]-32767-(r[14]>>16&1);var o=r[15]>>16&1;r[14]&=65535,H1(i,r,1-o)}for(var n=0;n<16;n++)t[2*n]=i[n]&255,t[2*n+1]=i[n]>>8}function Xmt(t,e){for(var r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function i3(t,e,r){for(var i=0;i<16;i++)t[i]=e[i]+r[i]}function n3(t,e,r){for(var i=0;i<16;i++)t[i]=e[i]-r[i]}function ru(t,e,r){var i,n,s=0,o=0,a=0,c=0,u=0,l=0,d=0,h=0,y=0,g=0,m=0,E=0,v=0,A=0,R=0,F=0,q=0,N=0,z=0,G=0,Y=0,P=0,b=0,w=0,S=0,C=0,B=0,W=0,j=0,M=0,_=0,L=r[0],ce=r[1],X=r[2],ne=r[3],oe=r[4],he=r[5],pe=r[6],_e=r[7],k=r[8],K=r[9],$=r[10],Z=r[11],I=r[12],U=r[13],V=r[14],D=r[15];i=e[0],s+=i*L,o+=i*ce,a+=i*X,c+=i*ne,u+=i*oe,l+=i*he,d+=i*pe,h+=i*_e,y+=i*k,g+=i*K,m+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*D,i=e[1],o+=i*L,a+=i*ce,c+=i*X,u+=i*ne,l+=i*oe,d+=i*he,h+=i*pe,y+=i*_e,g+=i*k,m+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*D,i=e[2],a+=i*L,c+=i*ce,u+=i*X,l+=i*ne,d+=i*oe,h+=i*he,y+=i*pe,g+=i*_e,m+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,N+=i*D,i=e[3],c+=i*L,u+=i*ce,l+=i*X,d+=i*ne,h+=i*oe,y+=i*he,g+=i*pe,m+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,N+=i*V,z+=i*D,i=e[4],u+=i*L,l+=i*ce,d+=i*X,h+=i*ne,y+=i*oe,g+=i*he,m+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,N+=i*U,z+=i*V,G+=i*D,i=e[5],l+=i*L,d+=i*ce,h+=i*X,y+=i*ne,g+=i*oe,m+=i*he,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,N+=i*I,z+=i*U,G+=i*V,Y+=i*D,i=e[6],d+=i*L,h+=i*ce,y+=i*X,g+=i*ne,m+=i*oe,E+=i*he,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,N+=i*Z,z+=i*I,G+=i*U,Y+=i*V,P+=i*D,i=e[7],h+=i*L,y+=i*ce,g+=i*X,m+=i*ne,E+=i*oe,v+=i*he,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,N+=i*$,z+=i*Z,G+=i*I,Y+=i*U,P+=i*V,b+=i*D,i=e[8],y+=i*L,g+=i*ce,m+=i*X,E+=i*ne,v+=i*oe,A+=i*he,R+=i*pe,F+=i*_e,q+=i*k,N+=i*K,z+=i*$,G+=i*Z,Y+=i*I,P+=i*U,b+=i*V,w+=i*D,i=e[9],g+=i*L,m+=i*ce,E+=i*X,v+=i*ne,A+=i*oe,R+=i*he,F+=i*pe,q+=i*_e,N+=i*k,z+=i*K,G+=i*$,Y+=i*Z,P+=i*I,b+=i*U,w+=i*V,S+=i*D,i=e[10],m+=i*L,E+=i*ce,v+=i*X,A+=i*ne,R+=i*oe,F+=i*he,q+=i*pe,N+=i*_e,z+=i*k,G+=i*K,Y+=i*$,P+=i*Z,b+=i*I,w+=i*U,S+=i*V,C+=i*D,i=e[11],E+=i*L,v+=i*ce,A+=i*X,R+=i*ne,F+=i*oe,q+=i*he,N+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,P+=i*$,b+=i*Z,w+=i*I,S+=i*U,C+=i*V,B+=i*D,i=e[12],v+=i*L,A+=i*ce,R+=i*X,F+=i*ne,q+=i*oe,N+=i*he,z+=i*pe,G+=i*_e,Y+=i*k,P+=i*K,b+=i*$,w+=i*Z,S+=i*I,C+=i*U,B+=i*V,W+=i*D,i=e[13],A+=i*L,R+=i*ce,F+=i*X,q+=i*ne,N+=i*oe,z+=i*he,G+=i*pe,Y+=i*_e,P+=i*k,b+=i*K,w+=i*$,S+=i*Z,C+=i*I,B+=i*U,W+=i*V,j+=i*D,i=e[14],R+=i*L,F+=i*ce,q+=i*X,N+=i*ne,z+=i*oe,G+=i*he,Y+=i*pe,P+=i*_e,b+=i*k,w+=i*K,S+=i*$,C+=i*Z,B+=i*I,W+=i*U,j+=i*V,M+=i*D,i=e[15],F+=i*L,q+=i*ce,N+=i*X,z+=i*ne,G+=i*oe,Y+=i*he,P+=i*pe,b+=i*_e,w+=i*k,S+=i*K,C+=i*$,B+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*D,s+=38*q,o+=38*N,a+=38*z,c+=38*G,u+=38*Y,l+=38*P,d+=38*b,h+=38*w,y+=38*S,g+=38*C,m+=38*B,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=u,t[5]=l,t[6]=d,t[7]=h,t[8]=y,t[9]=g,t[10]=m,t[11]=E,t[12]=v,t[13]=A,t[14]=R,t[15]=F}function $1(t,e){ru(t,e,e)}function Qmt(t,e){for(var r=ic(),i=0;i<16;i++)r[i]=e[i];for(var i=253;i>=0;i--)$1(r,r),i!==2&&i!==4&&ru(r,r,e);for(var i=0;i<16;i++)t[i]=r[i]}function wO(t,e){for(var r=new Uint8Array(32),i=new Float64Array(80),n=ic(),s=ic(),o=ic(),a=ic(),c=ic(),u=ic(),l=0;l<31;l++)r[l]=t[l];r[31]=t[31]&127|64,r[0]&=248,Xmt(i,e);for(var l=0;l<16;l++)s[l]=i[l];n[0]=a[0]=1;for(var l=254;l>=0;--l){var d=r[l>>>3]>>>(l&7)&1;H1(n,s,d),H1(o,a,d),i3(c,n,o),n3(n,n,o),i3(o,s,a),n3(s,s,a),$1(a,c),$1(u,n),ru(n,o,n),ru(o,s,c),i3(c,n,o),n3(n,n,o),$1(s,n),n3(o,a,u),ru(n,o,Wmt),i3(n,n,a),ru(o,o,n),ru(n,a,u),ru(a,s,i),$1(s,c),H1(n,s,d),H1(o,a,d)}for(var l=0;l<16;l++)i[l+16]=n[l],i[l+32]=o[l],i[l+48]=s[l],i[l+64]=a[l];var h=i.subarray(32),y=i.subarray(16);Qmt(h,h),ru(y,y,h);var g=new Uint8Array(32);return Ymt(g,y),g}Wn.scalarMult=wO;function N2e(t){return wO(t,q2e)}Wn.scalarMultBase=N2e;function D2e(t){if(t.length!==Wn.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+Wn.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(t),r=N2e(e);return{publicKey:r,secretKey:e}}Wn.generateKeyPairFromSeed=D2e;function Zmt(t){var e=$mt.randomBytes(32,t),r=D2e(e);return Gmt.wipe(e),r}Wn.generateKeyPair=Zmt;function Jmt(t,e,r){if(r===void 0&&(r=!1),t.length!==Wn.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==Wn.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=wO(t,e);if(r){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}Wn.sharedKey=Jmt});var M2e=p((ZLt,B2e)=>{f();B2e.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var F2e=p((JLt,U2e)=>{f();"use strict";var evt=M2e(),tvt=p0(),L2e=Bo();U2e.exports=(t,e={})=>{let r=tvt(t),i=L2e.decode.fromReader(r.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await r.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=evt(a)?a:a.slice();return o.decode(c)},write:o=>{r.writer.push(o)},writeLP:o=>{s.write(L2e.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(r.rest(),r.stream)};return s}});var j2e=p((e9t,K2e)=>{f();"use strict";var rvt=wE();K2e.exports=function(){let e,r,i=async s=>{if(e)throw new Error("already piped");e=rvt(s),r&&r(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{r=o=>{r=null,s(o.next())}})}};return{sink:i,source:n}}});var H2e=p((t9t,z2e)=>{f();var V2e=j2e();z2e.exports=function(){var t=V2e(),e=V2e();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}});var $2e=p(_O=>{f();"use strict";Object.defineProperty(_O,"__esModule",{value:!0});function ivt(t){return typeof t.saveState!="undefined"&&typeof t.restoreState!="undefined"&&typeof t.cleanSavedState!="undefined"}_O.isSerializableHash=ivt});var o3=p(G0=>{f();"use strict";Object.defineProperty(G0,"__esModule",{value:!0});function nvt(t,e,r){return~(t-1)&e|t-1&r}G0.select=nvt;function svt(t,e){return(t|0)-(e|0)-1>>>31&1}G0.lessOrEqual=svt;function G2e(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}G0.compare=G2e;function ovt(t,e){return t.length===0||e.length===0?!1:G2e(t,e)!==0}G0.equal=ovt});var Y2e=p(G1=>{f();"use strict";Object.defineProperty(G1,"__esModule",{value:!0});var nc=$2e(),avt=o3(),cvt=rc(),W2e=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),nc.isSerializableHash(this._inner)&&nc.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),cvt.wipe(i)}return t.prototype.reset=function(){if(!nc.isSerializableHash(this._inner)||!nc.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){nc.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),nc.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!nc.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!nc.isSerializableHash(this._inner)||!nc.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!nc.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();G1.HMAC=W2e;function uvt(t,e,r){var i=new W2e(t,e);i.update(r);var n=i.digest();return i.clean(),n}G1.hmac=uvt;G1.equal=avt.equal});var Z2e=p(EO=>{f();"use strict";Object.defineProperty(EO,"__esModule",{value:!0});var X2e=Y2e(),Q2e=rc(),lvt=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=X2e.hmac(this._hash,i,r);this._hmac=new X2e.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Q2e.wipe(this._buffer),Q2e.wipe(this._counter),this._bufpos=0},t}();EO.HKDF=lvt});var xO=p(Pl=>{f();"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});var a3=z1(),c3=rc();Pl.DIGEST_LENGTH=32;Pl.BLOCK_SIZE=64;var J2e=function(){function t(){this.digestLength=Pl.DIGEST_LENGTH,this.blockSize=Pl.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return t.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},t.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},t.prototype.clean=function(){c3.wipe(this._buffer),c3.wipe(this._temp),this.reset()},t.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=e[i++],r--;this._bufferLength===this.blockSize&&(SO(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(i=SO(this._temp,this._state,e,i,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[i++],r--;return this},t.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,i=this._bufferLength,n=r/536870912|0,s=r<<3,o=r%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;a3.writeUint32BE(n,this._buffer,o-8),a3.writeUint32BE(s,this._buffer,o-4),SO(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)a3.writeUint32BE(this._state[a],e,a*4);return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},t.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},t.prototype.cleanSavedState=function(e){c3.wipe(e.state),e.buffer&&c3.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},t}();Pl.SHA256=J2e;var fvt=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function SO(t,e,r,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],l=e[5],d=e[6],h=e[7],y=0;y<16;y++){var g=i+y*4;t[y]=a3.readUint32BE(r,g)}for(var y=16;y<64;y++){var m=t[y-2],E=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=t[y-15];var v=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;t[y]=(E+t[y-7]|0)+(v+t[y-16]|0)}for(var y=0;y<64;y++){var E=(((u>>>6|u<<32-6)^(u>>>11|u<<32-11)^(u>>>25|u<<32-25))+(u&l^~u&d)|0)+(h+(fvt[y]+t[y]|0)|0)|0,v=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;h=d,d=l,l=u,u=c+E|0,c=a,a=o,o=s,s=E+v|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=l,e[6]+=d,e[7]+=h,i+=64,n-=64}return i}function dvt(t){var e=new J2e;e.update(t);var r=e.digest();return e.clean(),r}Pl.hash=dvt});var tEe=p((eEe,W1)=>{f();"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Wo=="function"&&typeof W1=="object"&&W1&&W1.exports&&(W1.exports=e(Ti()))})(eEe,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots["libp2p-noise"]||(t.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,u){return u||(u=r.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&u.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&u.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&u.uint32(26).bytes(c.data),u},o.encodeDelimited=function(c,u){return this.encode(c,u).ldelim()},o.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.pb.NoiseHandshakePayload;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.identityKey=c.bytes();break;case 2:d.identitySig=c.bytes();break;case 3:d.data=c.bytes();break;default:c.skipType(h&7);break}}return d},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var u=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,u.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(u.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,u.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(u.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,u.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(u.data=c.data)),u},o.toObject=function(c,u){u||(u={});var l={};return u.defaults&&(u.bytes===String?l.identityKey="":(l.identityKey=[],u.bytes!==Array&&(l.identityKey=i.newBuffer(l.identityKey))),u.bytes===String?l.identitySig="":(l.identitySig=[],u.bytes!==Array&&(l.identitySig=i.newBuffer(l.identitySig))),u.bytes===String?l.data="":(l.data=[],u.bytes!==Array&&(l.data=i.newBuffer(l.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(l.identityKey=u.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):u.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(l.identitySig=u.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):u.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(l.data=u.bytes===String?i.base64.encode(c.data,0,c.data.length):u.bytes===Array?Array.prototype.slice.call(c.data):c.data),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s}(),n})});var Cl=p(zt=>{f();"use strict";var hvt=zt&&zt.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),pvt=zt&&zt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),yvt=zt&&zt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&hvt(e,t,r);return pvt(e,t),e},rEe=zt&&zt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(zt,"__esModule",{value:!0});zt.isValidPublicKey=zt.getHkdf=zt.verifySignedPayload=zt.getHandshakePayload=zt.decodePayload=zt.getPeerIdFromPayload=zt.signPayload=zt.createHandshakePayload=zt.getPayload=zt.generateKeypair=void 0;var gvt=Z2e(),bvt=xO(),mvt=yvt(s3()),Yn=Ut(),AO=rEe(et()),vvt=xa(),wvt=tEe(),_vt=rEe(ci()),u3=wvt.pb.NoiseHandshakePayload;function Evt(){let t=mvt.generateKeyPair();return{publicKey:Yn.Buffer.from(t.publicKey.buffer,t.publicKey.byteOffset,t.publicKey.length),privateKey:Yn.Buffer.from(t.secretKey.buffer,t.secretKey.byteOffset,t.secretKey.length)}}zt.generateKeypair=Evt;async function Svt(t,e,r){let i=await nEe(t,IO(e)),n=r??Yn.Buffer.alloc(0);return iEe(t.marshalPubKey(),i,n)}zt.getPayload=Svt;function iEe(t,e,r){let i=u3.create({identityKey:Yn.Buffer.from(t),identitySig:e,data:r??null});return Yn.Buffer.from(u3.encode(i).finish())}zt.createHandshakePayload=iEe;async function nEe(t,e){return Yn.Buffer.from(await t.privKey.sign(e))}zt.signPayload=nEe;async function xvt(t){return await AO.default.createFromPubKey(Yn.Buffer.from(t.identityKey))}zt.getPeerIdFromPayload=xvt;function Avt(t){return u3.toObject(u3.decode(Yn.Buffer.from(t)))}zt.decodePayload=Avt;function IO(t){return Yn.Buffer.concat([Yn.Buffer.from("noise-libp2p-static-key:"),t])}zt.getHandshakePayload=IO;async function Ivt(t,e){let r=await AO.default.createFromPubKey(e);return _vt.default(r.id,t)}async function Tvt(t,e,r){let i=Yn.Buffer.from(e.identityKey);if(!await Ivt(r.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=IO(t),s=vvt.keys.unmarshalPublicKey(i);if(!e.identitySig||!s.verify(n,Yn.Buffer.from(e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return await AO.default.createFromPubKey(i)}zt.verifySignedPayload=Tvt;function Rvt(t,e){let i=new gvt.HKDF(bvt.SHA256,e,t).expand(96),n=Yn.Buffer.from(i.buffer,i.byteOffset,i.length),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}zt.getHkdf=Rvt;function Pvt(t){return!(!Yn.Buffer.isBuffer(t)||t.length!==32)}zt.isValidPublicKey=Pvt});var oEe=p(l3=>{f();"use strict";Object.defineProperty(l3,"__esModule",{value:!0});var pn=z1(),TO=rc(),Cvt=20;function Ovt(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],u=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],d=r[19]<<24|r[18]<<16|r[17]<<8|r[16],h=r[23]<<24|r[22]<<16|r[21]<<8|r[20],y=r[27]<<24|r[26]<<16|r[25]<<8|r[24],g=r[31]<<24|r[30]<<16|r[29]<<8|r[28],m=e[3]<<24|e[2]<<16|e[1]<<8|e[0],E=e[7]<<24|e[6]<<16|e[5]<<8|e[4],v=e[11]<<24|e[10]<<16|e[9]<<8|e[8],A=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=i,F=n,q=s,N=o,z=a,G=c,Y=u,P=l,b=d,w=h,S=y,C=g,B=m,W=E,j=v,M=A,_=0;_<Cvt;_+=2)R=R+z|0,B^=R,B=B>>>32-16|B<<16,b=b+B|0,z^=b,z=z>>>32-12|z<<12,F=F+G|0,W^=F,W=W>>>32-16|W<<16,w=w+W|0,G^=w,G=G>>>32-12|G<<12,q=q+Y|0,j^=q,j=j>>>32-16|j<<16,S=S+j|0,Y^=S,Y=Y>>>32-12|Y<<12,N=N+P|0,M^=N,M=M>>>32-16|M<<16,C=C+M|0,P^=C,P=P>>>32-12|P<<12,q=q+Y|0,j^=q,j=j>>>32-8|j<<8,S=S+j|0,Y^=S,Y=Y>>>32-7|Y<<7,N=N+P|0,M^=N,M=M>>>32-8|M<<8,C=C+M|0,P^=C,P=P>>>32-7|P<<7,F=F+G|0,W^=F,W=W>>>32-8|W<<8,w=w+W|0,G^=w,G=G>>>32-7|G<<7,R=R+z|0,B^=R,B=B>>>32-8|B<<8,b=b+B|0,z^=b,z=z>>>32-7|z<<7,R=R+G|0,M^=R,M=M>>>32-16|M<<16,S=S+M|0,G^=S,G=G>>>32-12|G<<12,F=F+Y|0,B^=F,B=B>>>32-16|B<<16,C=C+B|0,Y^=C,Y=Y>>>32-12|Y<<12,q=q+P|0,W^=q,W=W>>>32-16|W<<16,b=b+W|0,P^=b,P=P>>>32-12|P<<12,N=N+z|0,j^=N,j=j>>>32-16|j<<16,w=w+j|0,z^=w,z=z>>>32-12|z<<12,q=q+P|0,W^=q,W=W>>>32-8|W<<8,b=b+W|0,P^=b,P=P>>>32-7|P<<7,N=N+z|0,j^=N,j=j>>>32-8|j<<8,w=w+j|0,z^=w,z=z>>>32-7|z<<7,F=F+Y|0,B^=F,B=B>>>32-8|B<<8,C=C+B|0,Y^=C,Y=Y>>>32-7|Y<<7,R=R+G|0,M^=R,M=M>>>32-8|M<<8,S=S+M|0,G^=S,G=G>>>32-7|G<<7;pn.writeUint32LE(R+i|0,t,0),pn.writeUint32LE(F+n|0,t,4),pn.writeUint32LE(q+s|0,t,8),pn.writeUint32LE(N+o|0,t,12),pn.writeUint32LE(z+a|0,t,16),pn.writeUint32LE(G+c|0,t,20),pn.writeUint32LE(Y+u|0,t,24),pn.writeUint32LE(P+l|0,t,28),pn.writeUint32LE(b+d|0,t,32),pn.writeUint32LE(w+h|0,t,36),pn.writeUint32LE(S+y|0,t,40),pn.writeUint32LE(C+g|0,t,44),pn.writeUint32LE(B+m|0,t,48),pn.writeUint32LE(W+E|0,t,52),pn.writeUint32LE(j+v|0,t,56),pn.writeUint32LE(M+A|0,t,60)}function sEe(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<r.length;c+=64){Ovt(a,s,t);for(var u=c;u<c+64&&u<r.length;u++)i[u]=r[u]^a[u-c];qvt(s,0,o)}return TO.wipe(a),n===0&&TO.wipe(s),i}l3.streamXOR=sEe;function kvt(t,e,r,i){return i===void 0&&(i=0),TO.wipe(r),sEe(t,e,r,r,i)}l3.stream=kvt;function qvt(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var cEe=p(iu=>{f();"use strict";Object.defineProperty(iu,"__esModule",{value:!0});var Nvt=o3(),f3=rc();iu.DIGEST_LENGTH=16;var aEe=function(){function t(e){this.digestLength=iu.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var i=e[2]|e[3]<<8;this._r[1]=(r>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return t.prototype._blocks=function(e,r,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],l=this._h[5],d=this._h[6],h=this._h[7],y=this._h[8],g=this._h[9],m=this._r[0],E=this._r[1],v=this._r[2],A=this._r[3],R=this._r[4],F=this._r[5],q=this._r[6],N=this._r[7],z=this._r[8],G=this._r[9];i>=16;){var Y=e[r+0]|e[r+1]<<8;s+=Y&8191;var P=e[r+2]|e[r+3]<<8;o+=(Y>>>13|P<<3)&8191;var b=e[r+4]|e[r+5]<<8;a+=(P>>>10|b<<6)&8191;var w=e[r+6]|e[r+7]<<8;c+=(b>>>7|w<<9)&8191;var S=e[r+8]|e[r+9]<<8;u+=(w>>>4|S<<12)&8191,l+=S>>>1&8191;var C=e[r+10]|e[r+11]<<8;d+=(S>>>14|C<<2)&8191;var B=e[r+12]|e[r+13]<<8;h+=(C>>>11|B<<5)&8191;var W=e[r+14]|e[r+15]<<8;y+=(B>>>8|W<<8)&8191,g+=W>>>5|n;var j=0,M=j;M+=s*m,M+=o*(5*G),M+=a*(5*z),M+=c*(5*N),M+=u*(5*q),j=M>>>13,M&=8191,M+=l*(5*F),M+=d*(5*R),M+=h*(5*A),M+=y*(5*v),M+=g*(5*E),j+=M>>>13,M&=8191;var _=j;_+=s*E,_+=o*m,_+=a*(5*G),_+=c*(5*z),_+=u*(5*N),j=_>>>13,_&=8191,_+=l*(5*q),_+=d*(5*F),_+=h*(5*R),_+=y*(5*A),_+=g*(5*v),j+=_>>>13,_&=8191;var L=j;L+=s*v,L+=o*E,L+=a*m,L+=c*(5*G),L+=u*(5*z),j=L>>>13,L&=8191,L+=l*(5*N),L+=d*(5*q),L+=h*(5*F),L+=y*(5*R),L+=g*(5*A),j+=L>>>13,L&=8191;var ce=j;ce+=s*A,ce+=o*v,ce+=a*E,ce+=c*m,ce+=u*(5*G),j=ce>>>13,ce&=8191,ce+=l*(5*z),ce+=d*(5*N),ce+=h*(5*q),ce+=y*(5*F),ce+=g*(5*R),j+=ce>>>13,ce&=8191;var X=j;X+=s*R,X+=o*A,X+=a*v,X+=c*E,X+=u*m,j=X>>>13,X&=8191,X+=l*(5*G),X+=d*(5*z),X+=h*(5*N),X+=y*(5*q),X+=g*(5*F),j+=X>>>13,X&=8191;var ne=j;ne+=s*F,ne+=o*R,ne+=a*A,ne+=c*v,ne+=u*E,j=ne>>>13,ne&=8191,ne+=l*m,ne+=d*(5*G),ne+=h*(5*z),ne+=y*(5*N),ne+=g*(5*q),j+=ne>>>13,ne&=8191;var oe=j;oe+=s*q,oe+=o*F,oe+=a*R,oe+=c*A,oe+=u*v,j=oe>>>13,oe&=8191,oe+=l*E,oe+=d*m,oe+=h*(5*G),oe+=y*(5*z),oe+=g*(5*N),j+=oe>>>13,oe&=8191;var he=j;he+=s*N,he+=o*q,he+=a*F,he+=c*R,he+=u*A,j=he>>>13,he&=8191,he+=l*v,he+=d*E,he+=h*m,he+=y*(5*G),he+=g*(5*z),j+=he>>>13,he&=8191;var pe=j;pe+=s*z,pe+=o*N,pe+=a*q,pe+=c*F,pe+=u*R,j=pe>>>13,pe&=8191,pe+=l*A,pe+=d*v,pe+=h*E,pe+=y*m,pe+=g*(5*G),j+=pe>>>13,pe&=8191;var _e=j;_e+=s*G,_e+=o*z,_e+=a*N,_e+=c*q,_e+=u*F,j=_e>>>13,_e&=8191,_e+=l*R,_e+=d*A,_e+=h*v,_e+=y*E,_e+=g*m,j+=_e>>>13,_e&=8191,j=(j<<2)+j|0,j=j+M|0,M=j&8191,j=j>>>13,_+=j,s=M,o=_,a=L,c=ce,u=X,l=ne,d=oe,h=he,y=pe,g=_e,r+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=l,this._h[6]=d,this._h[7]=h,this._h[8]=y,this._h[9]=g},t.prototype.finish=function(e,r){r===void 0&&(r=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(e){var r=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[r+s];if(i-=n,r+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,r,n),r+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=i}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},t.prototype.clean=function(){return f3.wipe(this._buffer),f3.wipe(this._r),f3.wipe(this._h),f3.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();iu.Poly1305=aEe;function Dvt(t,e){var r=new aEe(t);r.update(e);var i=r.digest();return r.clean(),i}iu.oneTimeAuth=Dvt;function Bvt(t,e){return t.length!==iu.DIGEST_LENGTH||e.length!==iu.DIGEST_LENGTH?!1:Nvt.equal(t,e)}iu.equal=Bvt});var fEe=p(nu=>{f();"use strict";Object.defineProperty(nu,"__esModule",{value:!0});var d3=oEe(),Mvt=cEe(),Y1=rc(),uEe=z1(),Lvt=o3();nu.KEY_LENGTH=32;nu.NONCE_LENGTH=12;nu.TAG_LENGTH=16;var lEe=new Uint8Array(16),Uvt=function(){function t(e){if(this.nonceLength=nu.NONCE_LENGTH,this.tagLength=nu.TAG_LENGTH,e.length!==nu.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return t.prototype.seal=function(e,r,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);d3.stream(this._key,s,o,4);var a=r.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return d3.streamXOR(this._key,s,r,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),Y1.wipe(s),c},t.prototype.open=function(e,r,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);d3.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,r.subarray(0,r.length-this.tagLength),i),!Lvt.equal(a,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,u;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=n}else u=new Uint8Array(c);return d3.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),u,4),Y1.wipe(s),u},t.prototype.clean=function(){return Y1.wipe(this._key),this},t.prototype._authenticate=function(e,r,i,n){var s=new Mvt.Poly1305(r);n&&(s.update(n),n.length%16>0&&s.update(lEe.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(lEe.subarray(i.length%16));var o=new Uint8Array(8);n&&uEe.writeUint64LE(n.length,o),s.update(o),uEe.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),Y1.wipe(a),Y1.wipe(o)},t}();nu.ChaCha20Poly1305=Uvt});var h3=p(su=>{f();"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.DUMP_SESSION_KEYS=su.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=su.NOISE_MSG_MAX_LENGTH_BYTES=void 0;su.NOISE_MSG_MAX_LENGTH_BYTES=65535;su.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=su.NOISE_MSG_MAX_LENGTH_BYTES-16;su.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var W0=p(Yi=>{f();"use strict";var Fvt=Yi&&Yi.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.logCipherState=Yi.logRemoteEphemeralKey=Yi.logRemoteStaticKey=Yi.logLocalEphemeralKeys=Yi.logLocalStaticKeys=Yi.logger=void 0;var Kvt=Fvt(me()),jvt=h3();Yi.logger=Kvt.default("libp2p:noise");var eo;jvt.DUMP_SESSION_KEYS?eo=Yi.logger:eo=()=>{};function Vvt(t){eo(`LOCAL_STATIC_PUBLIC_KEY ${t.publicKey.toString("hex")}`),eo(`LOCAL_STATIC_PRIVATE_KEY ${t.privateKey.toString("hex")}`)}Yi.logLocalStaticKeys=Vvt;function zvt(t){t?(eo(`LOCAL_PUBLIC_EPHEMERAL_KEY ${t.publicKey.toString("hex")}`),eo(`LOCAL_PRIVATE_EPHEMERAL_KEY ${t.privateKey.toString("hex")}`)):eo("Missing local ephemeral keys.")}Yi.logLocalEphemeralKeys=zvt;function Hvt(t){eo(`REMOTE_STATIC_PUBLIC_KEY ${t.toString("hex")}`)}Yi.logRemoteStaticKey=Hvt;function $vt(t){eo(`REMOTE_EPHEMERAL_PUBLIC_KEY ${t.toString("hex")}`)}Yi.logRemoteEphemeralKey=$vt;function Gvt(t){t.cs1&&t.cs2?(eo(`CIPHER_STATE_1 ${t.cs1.n} ${t.cs1.k.toString("hex")}`),eo(`CIPHER_STATE_2 ${t.cs2.n} ${t.cs2.k.toString("hex")}`)):eo("Missing cipher state.")}Yi.logCipherState=Gvt});var RO=p(ys=>{f();"use strict";var Wvt=ys&&ys.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Yvt=ys&&ys.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),dEe=ys&&ys.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Wvt(e,t,r);return Yvt(e,t),e};Object.defineProperty(ys,"__esModule",{value:!0});ys.AbstractHandshake=ys.MIN_NONCE=void 0;var Xi=Ut(),Xvt=dEe(s3()),Qvt=dEe(xO()),hEe=fEe(),pEe=Cl(),Zvt=W0();ys.MIN_NONCE=0;var yEe=class{encryptWithAd(e,r,i){let n=this.encrypt(e.k,e.n,r,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,r,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,r,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,r){e.n=r}createEmptyKey(){return Xi.Buffer.alloc(32)}isEmptyKey(e){return this.createEmptyKey().equals(e)}incrementNonce(e){return e+1}nonceToBytes(e){let r=Xi.Buffer.alloc(12);return r.writeUInt32LE(e,4),r}encrypt(e,r,i,n){let s=this.nonceToBytes(r),a=new hEe.ChaCha20Poly1305(e).seal(s,n,i);return Xi.Buffer.from(a.buffer,a.byteOffset,a.length)}encryptAndHash(e,r){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,r):i=r,this.mixHash(e,i),i}decrypt(e,r,i,n){let s=this.nonceToBytes(r),a=new hEe.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:Xi.Buffer.from(a.buffer,a.byteOffset,a.length),valid:!0}:{plaintext:Xi.Buffer.from(""),valid:!1}}decryptAndHash(e,r){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,r):i=r,this.mixHash(e,r),{plaintext:i,valid:n}}dh(e,r){try{let i=Xvt.sharedKey(e,r),n=Xi.Buffer.from(i.buffer,i.byteOffset,i.length),s=Xi.Buffer.alloc(32);return n.copy(s),s}catch(i){return Zvt.logger(i.message),Xi.Buffer.alloc(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){let i=Qvt.hash(Xi.Buffer.from([...e,...r]));return Xi.Buffer.from(i.buffer,i.byteOffset,i.length)}mixKey(e,r){let[i,n]=pEe.getHkdf(e.ck,r);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let r=ys.MIN_NONCE;return{k:e,n:r}}initializeSymmetric(e){let r=Xi.Buffer.from(e,"utf-8"),i=this.hashProtocolName(r),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let r=Xi.Buffer.alloc(32);return e.copy(r),r}else return this.getHash(e,Xi.Buffer.alloc(0))}split(e){let[r,i]=pEe.getHkdf(e.ck,Xi.Buffer.alloc(0)),n=this.initializeKey(r),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,r){let i=this.encryptWithAd(e,Xi.Buffer.alloc(0),r),n=this.createEmptyKey(),s=Xi.Buffer.alloc(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,r){return this.decryptWithAd(e,Xi.Buffer.alloc(0),r.ciphertext)}};ys.AbstractHandshake=yEe});var bEe=p(p3=>{f();"use strict";Object.defineProperty(p3,"__esModule",{value:!0});p3.XX=void 0;var Od=Ut(),Y0=Cl(),Jvt=RO(),gEe=class extends Jvt.AbstractHandshake{initializeInitiator(e,r,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=Od.Buffer.alloc(32);return{ss:o,s:r,rs:i,psk:n,re:a}}initializeResponder(e,r,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=Od.Buffer.alloc(32);return{ss:o,s:r,rs:i,psk:n,re:a}}writeMessageA(e,r,i){let n=Od.Buffer.alloc(0);i!==void 0?e.e=i:e.e=Y0.generateKeypair();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,r);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,r){e.e=Y0.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=Od.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,r){let i=Od.Buffer.from(e.s.publicKey),n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,r){return Y0.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(Y0.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);n&&i.length===32&&Y0.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,r){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);if(n&&i.length===32&&Y0.isValidPublicKey(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,r,i){let n=this.createEmptyKey(),s=Od.Buffer.alloc(32),o;return e?o=this.initializeInitiator(r,i,s,n):o=this.initializeResponder(r,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,r,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,r,i);else if(e.mc===1)n=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,r){let i=Od.Buffer.alloc(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,r);i=o,n=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}};p3.XX=gEe});var X1=p(di=>{f();"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.decode2=di.decode1=di.decode0=di.encode2=di.encode1=di.encode0=di.uint16BEDecode=di.uint16BEEncode=void 0;var X0=Ut(),ewt=(t,e,r)=>(e=e||X0.Buffer.allocUnsafe(2),e.writeUInt16BE(t,r),e);di.uint16BEEncode=ewt;di.uint16BEEncode.bytes=2;var twt=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t.readUInt16BE(0)};di.uint16BEDecode=twt;di.uint16BEDecode.bytes=2;function rwt(t){return X0.Buffer.concat([t.ne,t.ciphertext])}di.encode0=rwt;function iwt(t){return X0.Buffer.concat([t.ne,t.ns,t.ciphertext])}di.encode1=iwt;function nwt(t){return X0.Buffer.concat([t.ns,t.ciphertext])}di.encode2=nwt;function swt(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.slice(0,32),ciphertext:t.slice(32,t.length),ns:X0.Buffer.alloc(0)}}di.decode0=swt;function owt(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.slice(0,32),ns:t.slice(32,80),ciphertext:t.slice(80,t.length)}}di.decode1=owt;function awt(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:X0.Buffer.alloc(0),ns:t.slice(0,48),ciphertext:t.slice(48,t.length)}}di.decode2=awt});var PO=p(y3=>{f();"use strict";Object.defineProperty(y3,"__esModule",{value:!0});y3.XXHandshake=void 0;var Q1=Ut(),cwt=bEe(),Q0=Cl(),si=W0(),Z0=X1(),mEe=class{constructor(e,r,i,n,s,o,a){this.isInitiator=e,this.payload=r,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new cwt.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=Q1.Buffer.alloc(0)}async propose(){if(si.logLocalStaticKeys(this.session.hs.s),this.isInitiator){si.logger("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,Q1.Buffer.alloc(0));this.connection.writeLP(Z0.encode0(e)),si.logger("Stage 0 - Initiator finished sending first message."),si.logLocalEphemeralKeys(this.session.hs.e)}else{si.logger("Stage 0 - Responder waiting to receive first message...");let e=Z0.decode0((await this.connection.readLP()).slice()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Error("xx handshake stage 0 validation fail");si.logger("Stage 0 - Responder received first message."),si.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){si.logger("Stage 1 - Initiator waiting to receive first message from responder...");let e=Z0.decode1((await this.connection.readLP()).slice()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");si.logger("Stage 1 - Initiator received the message."),si.logRemoteEphemeralKey(this.session.hs.re),si.logRemoteStaticKey(this.session.hs.rs),si.logger("Initiator going to check remote's signature...");try{let n=await Q0.decodePayload(r);this.remotePeer=this.remotePeer||await Q0.getPeerIdFromPayload(n),this.remotePeer=await Q0.verifySignedPayload(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}si.logger("All good with the signature!")}else{si.logger("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(Z0.encode1(e)),si.logger("Stage 1 - Responder sent the second handshake message with signed payload."),si.logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){si.logger("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(Z0.encode2(e)),si.logger("Stage 2 - Initiator sent message with signed payload.")}else{si.logger("Stage 2 - Responder waiting for third handshake message...");let e=Z0.decode2((await this.connection.readLP()).slice()),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");si.logger("Stage 2 - Responder received the message, finished handshake.");try{let n=await Q0.decodePayload(r);this.remotePeer=this.remotePeer||await Q0.getPeerIdFromPayload(n),await Q0.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}si.logCipherState(this.session)}encrypt(e,r){let i=this.getCS(r);return this.xx.encryptWithAd(i,Q1.Buffer.alloc(0),e)}decrypt(e,r){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,Q1.Buffer.alloc(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=Q1.Buffer.from(e.buffer,e.byteOffset,e.length))}};y3.XXHandshake=mEe});var wEe=p(b3=>{f();"use strict";Object.defineProperty(b3,"__esModule",{value:!0});b3.IK=void 0;var g3=Ut(),Z1=Cl(),uwt=RO(),vEe=class extends uwt.AbstractHandshake{initSession(e,r,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(r,i,n,s):o=this.initializeResponder(r,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,r){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,r);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let i=g3.Buffer.alloc(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,r)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:u}=this.readMessageB(e.hs,r);i=s,n=o,e.h=a,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,r){e.e=Z1.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=g3.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,r);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,r){e.e=Z1.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,r),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,r){Z1.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ns);n&&i.length===32&&Z1.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,r){if(Z1.isValidPublicKey(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,r,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=g3.Buffer.alloc(32);return{ss:o,s:r,rs:i,re:a,psk:n}}initializeResponder(e,r,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,r.publicKey);let a=g3.Buffer.alloc(32);return{ss:o,s:r,rs:i,re:a,psk:n}}};b3.IK=vEe});var EEe=p(m3=>{f();"use strict";Object.defineProperty(m3,"__esModule",{value:!0});m3.FailedIKError=void 0;var _Ee=class extends Error{constructor(e,r){super(r);this.initialMsg=e,this.name="FailedIKhandshake"}};m3.FailedIKError=_Ee});var AEe=p(w3=>{f();"use strict";Object.defineProperty(w3,"__esModule",{value:!0});w3.IKHandshake=void 0;var lwt=wEe(),J0=Ut(),v3=X1(),ey=Cl(),SEe=EEe(),Ei=W0(),xEe=class{constructor(e,r,i,n,s,o,a,c){this.isInitiator=e,this.payload=J0.Buffer.from(r),this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new lwt.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=J0.Buffer.alloc(0)}async stage0(){if(Ei.logLocalStaticKeys(this.session.hs.s),Ei.logRemoteStaticKey(this.session.hs.rs),this.isInitiator){Ei.logger("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(v3.encode1(e)),Ei.logger("IK Stage 0 - Initiator sent message."),Ei.logLocalEphemeralKeys(this.session.hs.e)}else{Ei.logger("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let r=v3.decode1(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,r);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");Ei.logger("IK Stage 0 - Responder got message, going to verify payload.");let s=await ey.decodePayload(i);this.remotePeer=this.remotePeer||await ey.getPeerIdFromPayload(s),await ey.verifySignedPayload(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),Ei.logger("IK Stage 0 - Responder successfully verified payload!"),Ei.logRemoteEphemeralKey(this.session.hs.re)}catch(r){let i=r;throw Ei.logger("Responder breaking up with IK handshake in stage 0."),new SEe.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){Ei.logger("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),r=v3.decode0(J0.Buffer.from(e)),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,r);Ei.logger("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await ey.decodePayload(i);this.remotePeer=this.remotePeer||await ey.getPeerIdFromPayload(s),await ey.verifySignedPayload(r.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),Ei.logger("IK Stage 1 - Initiator successfully verified payload!"),Ei.logRemoteEphemeralKey(this.session.hs.re)}catch(s){let o=s;throw Ei.logger("Initiator breaking up with IK handshake in stage 1."),new SEe.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{Ei.logger("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(v3.encode0(e)),Ei.logger("IK Stage 1 - Responder sent message..."),Ei.logLocalEphemeralKeys(this.session.hs.e)}Ei.logCipherState(this.session)}decrypt(e,r){let i=this.getCS(r,!1);return this.ik.decryptWithAd(i,J0.Buffer.alloc(0),e)}encrypt(e,r){let i=this.getCS(r);return this.ik.encryptWithAd(i,J0.Buffer.alloc(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=J0.Buffer.from(e.buffer,e.byteOffset,e.length))}};w3.IKHandshake=xEe});var REe=p(_3=>{f();"use strict";Object.defineProperty(_3,"__esModule",{value:!0});_3.XXFallbackHandshake=void 0;var CO=Ut(),fwt=PO(),OO=Cl(),to=W0(),IEe=X1(),TEe=class extends fwt.XXHandshake{constructor(e,r,i,n,s,o,a,c,u){super(e,r,i,n,s,a,u);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,CO.Buffer.alloc(0),this.ephemeralKeys),to.logger("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),to.logLocalEphemeralKeys(this.session.hs.e);else{to.logger("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=IEe.decode0(this.initialMsg),{valid:r}=this.xx.recvMessage(this.session,{ne:e.ne,ns:CO.Buffer.alloc(0),ciphertext:CO.Buffer.alloc(0)});if(!r)throw new Error("xx fallback stage 0 decryption validation fail");to.logger("XX Fallback Stage 0 - Responder used received message from IK."),to.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=IEe.decode1(this.initialMsg),{plaintext:r,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");to.logger("XX Fallback Stage 1 - Initiator used received message from IK."),to.logRemoteEphemeralKey(this.session.hs.re),to.logRemoteStaticKey(this.session.hs.rs),to.logger("Initiator going to check remote's signature...");try{let n=await OO.decodePayload(r);this.remotePeer=this.remotePeer||await OO.getPeerIdFromPayload(n),await OO.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}to.logger("All good with the signature!")}else to.logger("XX Fallback Stage 1 - Responder start"),await super.exchange(),to.logger("XX Fallback Stage 1 - Responder end")}};_3.XXFallbackHandshake=TEe});var CEe=p(ty=>{f();"use strict";Object.defineProperty(ty,"__esModule",{value:!0});ty.decryptStream=ty.encryptStream=void 0;var PEe=Ut(),E3=h3();function dwt(t){return async function*(e){for await(let r of e){let i=PEe.Buffer.from(r.buffer,r.byteOffset,r.length);for(let n=0;n<i.length;n+=E3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let s=n+E3.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;s>i.length&&(s=i.length),yield t.encrypt(i.slice(n,s),t.session)}}}}ty.encryptStream=dwt;function hwt(t){return async function*(e){for await(let r of e){let i=PEe.Buffer.from(r.buffer,r.byteOffset,r.length);for(let n=0;n<i.length;n+=E3.NOISE_MSG_MAX_LENGTH_BYTES){let s=n+E3.NOISE_MSG_MAX_LENGTH_BYTES;s>i.length&&(s=i.length);let o=i.slice(n,s),{plaintext:a,valid:c}=await t.decrypt(o,t.session);if(!c)throw new Error("Failed to validate decrypted chunk");yield a}}}}ty.decryptStream=hwt});var kEe=p(S3=>{f();"use strict";Object.defineProperty(S3,"__esModule",{value:!0});S3.KeyCache=void 0;var OEe=class{constructor(){this.storage=new Map}store(e,r){this.storage.set(e.id,r)}load(e){var r;return e&&(r=this.storage.get(e.id))!==null&&r!==void 0?r:null}resetStorage(){this.storage.clear()}},pwt=new OEe;S3.KeyCache=pwt});var qO=p(ro=>{f();"use strict";var ywt=ro&&ro.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),gwt=ro&&ro.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bwt=ro&&ro.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ywt(e,t,r);return gwt(e,t),e},x3=ro&&ro.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ro,"__esModule",{value:!0});ro.Noise=void 0;var mwt=bwt(s3()),J1=Ut(),qEe=x3(F2e()),vwt=x3(H2e()),NEe=x3(hS()),wwt=x3(Er()),DEe=Bo(),_wt=PO(),Ewt=AEe(),Swt=REe(),BEe=Cl(),ry=X1(),MEe=CEe(),kO=kEe(),xwt=W0(),LEe=h3(),UEe=class{constructor(e,r){if(this.protocol="/noise",this.prologue=J1.Buffer.alloc(0),this.earlyData=r??J1.Buffer.alloc(0),this.useNoisePipes=!1,e){let i=mwt.generateKeyPairFromSeed(e);this.staticKeys={privateKey:J1.Buffer.from(i.secretKey.buffer,i.secretKey.byteOffset,i.secretKey.length),publicKey:J1.Buffer.from(i.publicKey.buffer,i.publicKey.byteOffset,i.publicKey.length)}}else this.staticKeys=BEe.generateKeypair()}async secureOutbound(e,r,i){let n=qEe.default(r,{lengthEncoder:ry.uint16BEEncode,lengthDecoder:ry.uint16BEDecode,maxDataLength:LEe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,r,i){let n=qEe.default(r,{lengthEncoder:ry.uint16BEEncode,lengthDecoder:ry.uint16BEDecode,maxDataLength:LEe.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var r;let i=await BEe.getPayload(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&kO.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new Ewt.IKHandshake(a,i,this.prologue,this.staticKeys,o,(r=kO.KeyCache.load(e.remotePeer))!==null&&r!==void 0?r:J1.Buffer.alloc(32),s);try{return await this.performIKHandshake(c)}catch(u){let l;return e.isInitiator&&(l=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,u.initialMsg,l)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,r,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new Swt.XXFallbackHandshake(s,r,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(u){xwt.logger(u);let l=u;throw new Error(`Error occurred during XX Fallback handshake: ${l.message}`)}return c}async performXXHandshake(e,r){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new _wt.XXHandshake(i,r,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&kO.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,r){let[i,n]=vwt.default(),s=e.unwrap();return await wwt.default(i,NEe.default,MEe.encryptStream(r),DEe.encode({lengthEncoder:ry.uint16BEEncode}),s,DEe.decode({lengthDecoder:ry.uint16BEDecode}),NEe.default,MEe.decryptStream(r),i),n}};ro.Noise=UEe});var FEe=p(ou=>{f();"use strict";var Awt=ou&&ou.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Iwt=ou&&ou.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Awt(e,t,r)};Object.defineProperty(ou,"__esModule",{value:!0});ou.NOISE=void 0;var Twt=qO();Iwt(qO(),ou);ou.NOISE=new Twt.Noise});var VEe=p((A9t,jEe)=>{f();"use strict";var Rwt=_C(),{EventEmitter:Pwt}=dr();function KEe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0,i=t.length;r<i;++r)if(t[r]!==e[r])return!1;return!0}function NO(){return{contacts:[],dontSplit:!1,left:null,right:null}}function em(t,e){if(!(e instanceof Uint8Array))throw new TypeError(t+" is not a Uint8Array")}var tm=class extends Pwt{constructor(e={}){super();this.localNodeId=e.localNodeId||Rwt(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||tm.distance,this.arbiter=e.arbiter||tm.arbiter,this.metadata=Object.assign({},e.metadata),em("option.localNodeId as parameter 1",this.localNodeId),this.root=NO()}static arbiter(e,r){return e.vectorClock>r.vectorClock?e:r}static distance(e,r){let i=0,n=0,s=Math.min(e.length,r.length),o=Math.max(e.length,r.length);for(;n<s;++n)i=i*256+(e[n]^r[n]);for(;n<o;++n)i=i*256+255;return i}add(e){em("contact.id",(e||{}).id);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,r++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,r),this.add(e))}closest(e,r=1/0){if(em("id",e),!Number.isInteger(r)&&r!==1/0||r<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<r;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,r).map(n=>n[1])}count(){let e=0;for(let r=[this.root];r.length>0;){let i=r.pop();i.contacts===null?r.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,r,i){let n=i>>3,s=i%8;return r.length<=n&&s!==0?e.left:r[n]&1<<7-s?e.right:e.left}get(e){em("id",e);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,r++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,r){for(let i=0;i<e.contacts.length;++i)if(KEe(e.contacts[i].id,r))return i;return-1}remove(e){em("the id as parameter 1",e);let r=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,r++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,r){e.left=NO(),e.right=NO();for(let s of e.contacts)this._determineNode(e,s.id,r).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,r),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let r=[this.root];r.length>0;){let i=r.pop();i.contacts===null?r.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let r=e.pop();r.contacts===null?e.push(r.right,r.left):yield*r.contacts}}_update(e,r,i){if(!KEe(e.contacts[r].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[r],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(r,1),e.contacts.push(s),this.emit("updated",n,s))}};jEe.exports=tm});var A3=p((I9t,zEe)=>{f();zEe.exports=Ol;function Ol(t,e){if(t.length!==e.length)throw new Error("Inputs should have the same length");for(var r=Buffer.allocUnsafe(t.length),i=0;i<t.length;i++)r[i]=t[i]^e[i];return r}Ol.compare=function(e,r){if(e.length!==r.length)throw new Error("Inputs should have the same length");for(var i=0;i<e.length;i++)if(e[i]!==r[i])return e[i]<r[i]?-1:1;return 0};Ol.gt=function(e,r){return Ol.compare(e,r)===1};Ol.lt=function(e,r){return Ol.compare(e,r)===-1};Ol.eq=function(e,r){return Ol.compare(e,r)===0}});var I3=p((T9t,HEe)=>{f();"use strict";var Cwt=dP();HEe.exports=async(t,e,{concurrency:r=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(r)||r===1/0)&&r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);let o=[],a=[],c=t[Symbol.iterator](),u=!1,l=!1,d=0,h=0,y=()=>{if(u)return;let g=c.next(),m=h;if(h++,g.done){l=!0,d===0&&(!i&&a.length!==0?s(new Cwt(a)):n(o));return}d++,(async()=>{try{let E=await g.value;o[m]=await e(E,m),d--,y()}catch(E){i?(u=!0,s(E)):(a.push(E),d--,y())}})()};for(let g=0;g<r&&(y(),!l);g++);})});var ai=p(oi=>{f();"use strict";var DO=me(),{sha256:$Ee}=(ei(),Ur),{base58btc:Owt}=(Zr(),Qr),{Key:kwt}=Ft(),GEe=A3(),qwt=I3(),{Record:Nwt}=xf(),Dwt=et(),Bwt=ae(),Mwt=tn(),WEe=ct(),YEe=Je(),XEe=Id();oi.convertBuffer=async t=>(await $Ee.digest(t)).digest;oi.convertPeerId=async t=>(await $Ee.digest(t.id)).digest;oi.bufferToKey=t=>new kwt("/"+oi.encodeBase32(t),!1);oi.keyForPublicKey=t=>Mwt([WEe("/pk/"),t.id]);oi.isPublicKeyKey=t=>YEe(t.slice(0,4))==="/pk/";oi.fromPublicKeyKey=t=>new Dwt(t.slice(4));oi.now=()=>Date.now();oi.encodeBase32=t=>YEe(t,"base32");oi.decodeBase32=t=>WEe(t,"base32");oi.sortClosestPeers=async(t,e)=>(await qwt(t,async i=>{let n=await oi.convertPeerId(i);return{peer:i,distance:GEe(n,e)}})).sort(oi.xorCompare).map(i=>i.peer);oi.xorCompare=(t,e)=>GEe.compare(t.distance,e.distance);oi.pathSize=(t,e)=>Math.ceil(t/e);oi.createPutRecord=(t,e)=>{let r=new Date;return new Nwt(t,e,r).serialize()};oi.logger=(t,e)=>{let r=["libp2p","dht"];return e&&r.push(e),t&&r.push(`${t.toB58String().slice(0,8)}`),DO.formatters.b=n=>Owt.baseEncode(n),Object.assign(DO(r.join(":")),{error:DO(r.concat(["error"]).join(":"))})};oi.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}};oi.withTimeout=(t,e)=>{async function r(...i){if(!e)return t(...i);let n;try{n=await XEe(t(...i),e)}catch(s){throw s instanceof XEe.TimeoutError?Bwt(s,"ETIMEDOUT"):s}return n}return r};oi.mapParallel=async function(t,e){let r=[];for await(let i of t)r.push(e(i));return Promise.all(r)}});var JEe=p((C9t,ZEe)=>{f();"use strict";var Lwt=VEe(),T3=ai(),QEe=class{constructor(e,r){this.self=e,this._onPing=this._onPing.bind(this),this._onInit(r)}async _onInit(e){let r=await T3.convertPeerId(this.self);this.kb=new Lwt({localNodeId:r,numberOfNodesPerKBucket:e,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}_onPing(e,r){let i=e[0];i&&this.kb.remove(i.id),this.kb.add(r)}get size(){return this.kb.count()}async find(e){let r=await T3.convertPeerId(e),i=this.closestPeer(r);if(i&&e.equals(i))return i}closestPeer(e){let r=this.closestPeers(e,1);if(r.length>0)return r[0]}closestPeers(e,r){return this.kb.closest(e,r).map(n=>n.peer)}async add(e){let r=await T3.convertPeerId(e);this.kb.add({id:r,peer:e})}async remove(e){let r=await T3.convertPeerId(e);this.kb.remove(r)}};ZEe.exports=QEe});var kl=p(On=>{f();"use strict";var R3=On.second=1e3,eSe=On.minute=60*R3,BO=On.hour=60*eSe;On.MAX_RECORD_AGE=36*BO;On.PROTOCOL_DHT="/kad/1.0.0";On.PROVIDERS_KEY_PREFIX="/providers/";On.PROVIDERS_LRU_CACHE_SIZE=256;On.PROVIDERS_VALIDITY=24*BO;On.PROVIDERS_CLEANUP_INTERVAL=BO;On.READ_MESSAGE_TIMEOUT=10*R3;On.GET_MANY_RECORD_COUNT=16;On.K=20;On.ALPHA=3;On.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*eSe,timeout:10*R3,delay:10*R3}});var rSe=p((k9t,tSe)=>{f();"use strict";var ql=Ti(),iy=ql.Reader,MO=ql.Writer,$e=ql.util,Wr=ql.roots["libp2p-dht-message"]||(ql.roots["libp2p-dht-message"]={});Wr.Record=function(){function t(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.key=null,t.prototype.value=null,t.prototype.author=null,t.prototype.signature=null,t.prototype.timeReceived=null;var e;return Object.defineProperty(t.prototype,"_key",{get:$e.oneOfGetter(e=["key"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_value",{get:$e.oneOfGetter(e=["value"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_author",{get:$e.oneOfGetter(e=["author"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_signature",{get:$e.oneOfGetter(e=["signature"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_timeReceived",{get:$e.oneOfGetter(e=["timeReceived"]),set:$e.oneOfSetter(e)}),t.encode=function(i,n){return n||(n=MO.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(10).bytes(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&n.uint32(18).bytes(i.value),i.author!=null&&Object.hasOwnProperty.call(i,"author")&&n.uint32(26).bytes(i.author),i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(34).bytes(i.signature),i.timeReceived!=null&&Object.hasOwnProperty.call(i,"timeReceived")&&n.uint32(42).string(i.timeReceived),n},t.decode=function(i,n){i instanceof iy||(i=iy.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Wr.Record;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.key=i.bytes();break;case 2:o.value=i.bytes();break;case 3:o.author=i.bytes();break;case 4:o.signature=i.bytes();break;case 5:o.timeReceived=i.string();break;default:i.skipType(a&7);break}}return o},t.fromObject=function(i){if(i instanceof Wr.Record)return i;var n=new Wr.Record;return i.key!=null&&(typeof i.key=="string"?$e.base64.decode(i.key,n.key=$e.newBuffer($e.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.value!=null&&(typeof i.value=="string"?$e.base64.decode(i.value,n.value=$e.newBuffer($e.base64.length(i.value)),0):i.value.length&&(n.value=i.value)),i.author!=null&&(typeof i.author=="string"?$e.base64.decode(i.author,n.author=$e.newBuffer($e.base64.length(i.author)),0):i.author.length&&(n.author=i.author)),i.signature!=null&&(typeof i.signature=="string"?$e.base64.decode(i.signature,n.signature=$e.newBuffer($e.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.timeReceived!=null&&(n.timeReceived=String(i.timeReceived)),n},t.toObject=function(i,n){n||(n={});var s={};return i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?$e.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.value!=null&&i.hasOwnProperty("value")&&(s.value=n.bytes===String?$e.base64.encode(i.value,0,i.value.length):n.bytes===Array?Array.prototype.slice.call(i.value):i.value,n.oneofs&&(s._value="value")),i.author!=null&&i.hasOwnProperty("author")&&(s.author=n.bytes===String?$e.base64.encode(i.author,0,i.author.length):n.bytes===Array?Array.prototype.slice.call(i.author):i.author,n.oneofs&&(s._author="author")),i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?$e.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,n.oneofs&&(s._signature="signature")),i.timeReceived!=null&&i.hasOwnProperty("timeReceived")&&(s.timeReceived=i.timeReceived,n.oneofs&&(s._timeReceived="timeReceived")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,ql.util.toJSONOptions)},t}();Wr.Message=function(){function t(r){if(this.closerPeers=[],this.providerPeers=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.type=null,t.prototype.clusterLevelRaw=null,t.prototype.key=null,t.prototype.record=null,t.prototype.closerPeers=$e.emptyArray,t.prototype.providerPeers=$e.emptyArray;var e;return Object.defineProperty(t.prototype,"_type",{get:$e.oneOfGetter(e=["type"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_clusterLevelRaw",{get:$e.oneOfGetter(e=["clusterLevelRaw"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_key",{get:$e.oneOfGetter(e=["key"]),set:$e.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_record",{get:$e.oneOfGetter(e=["record"]),set:$e.oneOfSetter(e)}),t.encode=function(i,n){if(n||(n=MO.create()),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(8).int32(i.type),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(18).bytes(i.key),i.record!=null&&Object.hasOwnProperty.call(i,"record")&&n.uint32(26).bytes(i.record),i.closerPeers!=null&&i.closerPeers.length)for(var s=0;s<i.closerPeers.length;++s)Wr.Message.Peer.encode(i.closerPeers[s],n.uint32(66).fork()).ldelim();if(i.providerPeers!=null&&i.providerPeers.length)for(var s=0;s<i.providerPeers.length;++s)Wr.Message.Peer.encode(i.providerPeers[s],n.uint32(74).fork()).ldelim();return i.clusterLevelRaw!=null&&Object.hasOwnProperty.call(i,"clusterLevelRaw")&&n.uint32(80).int32(i.clusterLevelRaw),n},t.decode=function(i,n){i instanceof iy||(i=iy.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Wr.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.type=i.int32();break;case 10:o.clusterLevelRaw=i.int32();break;case 2:o.key=i.bytes();break;case 3:o.record=i.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(Wr.Message.Peer.decode(i,i.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(Wr.Message.Peer.decode(i,i.uint32()));break;default:i.skipType(a&7);break}}return o},t.fromObject=function(i){if(i instanceof Wr.Message)return i;var n=new Wr.Message;switch(i.type){case"PUT_VALUE":case 0:n.type=0;break;case"GET_VALUE":case 1:n.type=1;break;case"ADD_PROVIDER":case 2:n.type=2;break;case"GET_PROVIDERS":case 3:n.type=3;break;case"FIND_NODE":case 4:n.type=4;break;case"PING":case 5:n.type=5;break}if(i.clusterLevelRaw!=null&&(n.clusterLevelRaw=i.clusterLevelRaw|0),i.key!=null&&(typeof i.key=="string"?$e.base64.decode(i.key,n.key=$e.newBuffer($e.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.record!=null&&(typeof i.record=="string"?$e.base64.decode(i.record,n.record=$e.newBuffer($e.base64.length(i.record)),0):i.record.length&&(n.record=i.record)),i.closerPeers){if(!Array.isArray(i.closerPeers))throw TypeError(".Message.closerPeers: array expected");n.closerPeers=[];for(var s=0;s<i.closerPeers.length;++s){if(typeof i.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");n.closerPeers[s]=Wr.Message.Peer.fromObject(i.closerPeers[s])}}if(i.providerPeers){if(!Array.isArray(i.providerPeers))throw TypeError(".Message.providerPeers: array expected");n.providerPeers=[];for(var s=0;s<i.providerPeers.length;++s){if(typeof i.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");n.providerPeers[s]=Wr.Message.Peer.fromObject(i.providerPeers[s])}}return n},t.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.closerPeers=[],s.providerPeers=[]),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Wr.Message.MessageType[i.type]:i.type,n.oneofs&&(s._type="type")),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?$e.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.record!=null&&i.hasOwnProperty("record")&&(s.record=n.bytes===String?$e.base64.encode(i.record,0,i.record.length):n.bytes===Array?Array.prototype.slice.call(i.record):i.record,n.oneofs&&(s._record="record")),i.closerPeers&&i.closerPeers.length){s.closerPeers=[];for(var o=0;o<i.closerPeers.length;++o)s.closerPeers[o]=Wr.Message.Peer.toObject(i.closerPeers[o],n)}if(i.providerPeers&&i.providerPeers.length){s.providerPeers=[];for(var o=0;o<i.providerPeers.length;++o)s.providerPeers[o]=Wr.Message.Peer.toObject(i.providerPeers[o],n)}return i.clusterLevelRaw!=null&&i.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=i.clusterLevelRaw,n.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,ql.util.toJSONOptions)},t.MessageType=function(){var r={},i=Object.create(r);return i[r[0]="PUT_VALUE"]=0,i[r[1]="GET_VALUE"]=1,i[r[2]="ADD_PROVIDER"]=2,i[r[3]="GET_PROVIDERS"]=3,i[r[4]="FIND_NODE"]=4,i[r[5]="PING"]=5,i}(),t.ConnectionType=function(){var r={},i=Object.create(r);return i[r[0]="NOT_CONNECTED"]=0,i[r[1]="CONNECTED"]=1,i[r[2]="CAN_CONNECT"]=2,i[r[3]="CANNOT_CONNECT"]=3,i}(),t.Peer=function(){function r(n){if(this.addrs=[],n)for(var s=Object.keys(n),o=0;o<s.length;++o)n[s[o]]!=null&&(this[s[o]]=n[s[o]])}r.prototype.id=null,r.prototype.addrs=$e.emptyArray,r.prototype.connection=null;var i;return Object.defineProperty(r.prototype,"_id",{get:$e.oneOfGetter(i=["id"]),set:$e.oneOfSetter(i)}),Object.defineProperty(r.prototype,"_connection",{get:$e.oneOfGetter(i=["connection"]),set:$e.oneOfSetter(i)}),r.encode=function(s,o){if(o||(o=MO.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},r.decode=function(s,o){s instanceof iy||(s=iy.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new Wr.Message.Peer;s.pos<a;){var u=s.uint32();switch(u>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(u&7);break}}return c},r.fromObject=function(s){if(s instanceof Wr.Message.Peer)return s;var o=new Wr.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?$e.base64.decode(s.id,o.id=$e.newBuffer($e.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?$e.base64.decode(s.addrs[a],o.addrs[a]=$e.newBuffer($e.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},r.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?$e.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?$e.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?Wr.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},r.prototype.toJSON=function(){return this.constructor.toObject(this,ql.util.toJSONOptions)},r}(),t}();tSe.exports=Wr});var sc=p((q9t,oSe)=>{f();"use strict";var Uwt=et(),{Multiaddr:Fwt}=tt(),{Record:Kwt}=xf(),P3=rSe(),jwt=P3.Message.MessageType,iSe=P3.Message.ConnectionType,ny=class{constructor(e,r,i){if(r&&!(r instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=r,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(nSe),providerPeers:this.providerPeers.map(nSe),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),P3.Message.encode(e).finish()}static deserialize(e){let r=P3.Message.decode(e),i=new ny(r.type||0,r.key||Uint8Array.from([]),r.clusterLevelRaw||0);return i.closerPeers=r.closerPeers.map(sSe),i.providerPeers=r.providerPeers.map(sSe),r.record&&r.record.length&&(i.record=Kwt.deserialize(r.record)),i}};ny.TYPES=jwt;ny.CONNECTION_TYPES=iSe;function nSe(t){return{id:t.id.id,addrs:(t.multiaddrs||[]).map(r=>r.bytes),connection:iSe.CONNECTED}}function sSe(t){return{id:new Uwt(t.id),multiaddrs:(t.addrs||[]).map(e=>new Fwt(e))}}oSe.exports=ny});var uSe=p((N9t,cSe)=>{f();"use strict";var{Record:Vwt}=xf(),zwt=ae(),aSe=sc(),LO=ai();cSe.exports=t=>{let e=LO.logger(t.peerId,"rpc:get-value");async function r(i,n){let s=n.key;if(e("key: %b",s),!s||s.length===0)throw zwt(new Error("Invalid key"),"ERR_INVALID_KEY");let o=new aSe(aSe.TYPES.GET_VALUE,s,n.clusterLevel);if(LO.isPublicKeyKey(s)){e("is public key");let u=LO.fromPublicKeyKey(s),l;if(t._isSelf(u))l=t.peerId;else{let d=t.peerStore.get(u);l=d&&d.id}if(l&&l.pubKey)return e("returning found public key"),o.record=new Vwt(s,l.pubKey.bytes),o}let[a,c]=await Promise.all([t._checkLocalDatastore(s),t._betterPeersToQuery(n,i)]);return a&&(e("got record"),o.record=a),c.length>0&&(e("got closer %s",c.length),o.closerPeers=c),o}return r}});var dSe=p((D9t,fSe)=>{f();"use strict";var lSe=ai(),Hwt=ae();fSe.exports=t=>{let e=lSe.logger(t.peerId,"rpc:put-value");async function r(i,n){let s=n.key;e("key: %b",s);let o=n.record;if(!o){let c=`Empty record from: ${i.toB58String()}`;throw e.error(c),Hwt(new Error(c),"ERR_EMPTY_RECORD")}await t._verifyRecordLocally(o),o.timeReceived=new Date;let a=lSe.bufferToKey(o.key);return await t.datastore.put(a,o.serialize()),t.onPut(o,i),n}return r}});var pSe=p((B9t,hSe)=>{f();"use strict";var $wt=ci(),Gwt=sc(),Wwt=ai();hSe.exports=t=>{let e=Wwt.logger(t.peerId,"rpc:find-node");async function r(i,n){e("start");let s;$wt(n.key,t.peerId.id)?s=[{id:t.peerId,multiaddrs:t.libp2p.multiaddrs}]:s=await t._betterPeersToQuery(n,i);let o=new Gwt(n.type,new Uint8Array(0),n.clusterLevel);return s.length>0?o.closerPeers=s:e("handle FindNode %s: could not find anything",i.toB58String()),o}return r}});var bSe=p((M9t,gSe)=>{f();"use strict";var{CID:Ywt}=(Ae(),ke),ySe=ae(),Xwt=ai();gSe.exports=t=>{let e=Xwt.logger(t.peerId,"rpc:add-provider");async function r(i,n){if(e("start"),!n.key||n.key.length===0)throw ySe(new Error("Missing key"),"ERR_MISSING_KEY");let s;try{s=Ywt.decode(n.key)}catch(o){let a=`Invalid CID: ${o.message}`;throw ySe(new Error(a),"ERR_INVALID_CID")}return n.providerPeers.forEach(o=>{if(!o.id.isEqual(i)){e("invalid provider peer %s from %s",o.id.toB58String(),i.toB58String());return}if(o.multiaddrs.length<1){e("no valid addresses for provider %s. Ignore",i.toB58String());return}if(e("received provider %s for %s (addrs %s)",i.toB58String(),s.toString(),o.multiaddrs.map(a=>a.toString())),!t._isSelf(o.id))return t.peerStore.addressBook.add(o.id,o.multiaddrs),t.providers.addProvider(s,o.id)}),t.providers.addProvider(s,i)}return r}});var wSe=p((L9t,vSe)=>{f();"use strict";var{CID:Qwt}=(Ae(),ke),Zwt=ae(),Jwt=sc(),mSe=ai();vSe.exports=t=>{let e=mSe.logger(t.peerId,"rpc:get-providers");async function r(i,n){let s;try{s=Qwt.decode(n.key)}catch(y){throw Zwt(new Error(`Invalid CID: ${y.message}`),"ERR_INVALID_CID")}e("%s",s.toString());let o=mSe.bufferToKey(s.bytes),[a,c,u]=await Promise.all([t.datastore.has(o),t.providers.getProviders(s),t._betterPeersToQuery(n,i)]),l=c.map(y=>({id:y,multiaddrs:[]})),d=u.map(y=>({id:y.id,multiaddrs:[]}));a&&l.push({id:t.peerId,multiaddrs:[]});let h=new Jwt(n.type,n.key,n.clusterLevel);return l.length>0&&(h.providerPeers=l),d.length>0&&(h.closerPeers=d),e("got %s providers %s closerPeers",l.length,d.length),h}return r}});var ESe=p((U9t,_Se)=>{f();"use strict";var e_t=ai();_Se.exports=t=>{let e=e_t.logger(t.peerId,"rpc:ping");function r(i,n){return e("from %s",i.toB58String()),n}return r}});var xSe=p((F9t,SSe)=>{f();"use strict";var sy=sc().TYPES;SSe.exports=t=>{let e={[sy.GET_VALUE]:uSe()(t),[sy.PUT_VALUE]:dSe()(t),[sy.FIND_NODE]:pSe()(t),[sy.ADD_PROVIDER]:bSe()(t),[sy.GET_PROVIDERS]:wSe()(t),[sy.PING]:ESe()(t)};function r(i){return e[i]}return r}});var TSe=p((K9t,ISe)=>{f();"use strict";var{pipe:t_t}=Er(),ASe=Bo(),r_t=sc(),i_t=xSe(),n_t=ai();ISe.exports=t=>{let e=n_t.logger(t.peerId,"rpc"),r=i_t(t);async function i(s,o){let a=r(o.type);try{await t._add(s)}catch(c){e.error("Failed to update the kbucket store",c)}if(!a){e.error(`no handler found for message type: ${o.type}`);return}return a(s,o)}async function n({stream:s,connection:o}){let a=o.remotePeer;try{await t._add(a)}catch(u){e.error(u)}let c=a.toB58String();e("from: %s",c),await t_t(s.source,ASe.decode(),u=>async function*(){for await(let l of u){let d=r_t.deserialize(l.slice()),h=await i(a,d);h&&(yield h.serialize())}}(),ASe.encode(),s.sink)}return n}});var OSe=p((j9t,CSe)=>{f();"use strict";var C3=ae(),{pipe:RSe}=Er(),UO=Bo(),s_t=Id(),{consume:o_t}=gp(),a_t=Jh(),c_t=gE(),u_t=TSe(),l_t=kl(),f_t=sc(),d_t=ai(),PSe=class{constructor(e){this.dht=e,this.readMessageTimeout=l_t.READ_MESSAGE_TIMEOUT,this._log=d_t.logger(this.dht.peerId,"net"),this._rpc=u_t(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}start(){if(this._running)return;if(!this.dht.isStarted)throw C3(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK");this._running=!0,this.dht._clientMode===!1&&this.dht.registrar.handle(this.dht.protocol,this._rpc);let e=new c_t({multicodecs:[this.dht.protocol],handlers:{onConnect:this._onPeerConnected,onDisconnect:()=>{}}});this._registrarId=this.dht.registrar.register(e)}stop(){!this.dht.isStarted&&!this.isStarted||(this._running=!1,this._registrarId&&this.dht.registrar.unregister(this._registrarId))}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}async _onPeerConnected(e){await this.dht._add(e),this._log("added to the routing table: %s",e.toB58String())}async sendRequest(e,r){if(!this.isConnected)throw C3(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeReadMessage(s,r.serialize())}async sendMessage(e,r){if(!this.isConnected)throw C3(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeMessage(s,r.serialize())}async _writeReadMessage(e,r){return s_t(h_t(e,r),this.readMessageTimeout)}_writeMessage(e,r){return RSe([r],UO.encode(),e,o_t)}};async function h_t(t,e){let r=await RSe([e],UO.encode(),t,UO.decode(),async i=>{let n=await a_t(i);if(n)return n.slice()});if(r.length===0)throw C3(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");return f_t.deserialize(r)}CSe.exports=PSe});var DSe=p((V9t,NSe)=>{f();"use strict";var O3=A3(),kSe=ai(),p_t=I3(),y_t=ci(),qSe=class{constructor(e,r){this.originDhtKey=e,this.capacity=r,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>y_t(n.peerId.id,e.id)))return;let r=await kSe.convertPeerId(e),i={peerId:e,distance:O3(this.originDhtKey,r)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>O3.compare(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let r=await p_t(e,n=>kSe.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of r){let s=O3(this.originDhtKey,n);if(O3.compare(s,i)<0)return!0}return!1}};NSe.exports=qSe});var MSe=p((FO,BSe)=>{f();(function(){var t,e,r,i,n,s,o,a,c,u,l,d,h,y,g;r=Math.floor,u=Math.min,e=function(m,E){return m<E?-1:m>E?1:0},c=function(m,E,v,A,R){var F;if(v==null&&(v=0),R==null&&(R=e),v<0)throw new Error("lo must be non-negative");for(A==null&&(A=m.length);v<A;)F=r((v+A)/2),R(E,m[F])<0?A=F:v=F+1;return[].splice.apply(m,[v,v-v].concat(E)),E},s=function(m,E,v){return v==null&&(v=e),m.push(E),y(m,0,m.length-1,v)},n=function(m,E){var v,A;return E==null&&(E=e),v=m.pop(),m.length?(A=m[0],m[0]=v,g(m,0,E)):A=v,A},a=function(m,E,v){var A;return v==null&&(v=e),A=m[0],m[0]=E,g(m,0,v),A},o=function(m,E,v){var A;return v==null&&(v=e),m.length&&v(m[0],E)<0&&(A=[m[0],E],E=A[0],m[0]=A[1],g(m,0,v)),E},i=function(m,E){var v,A,R,F,q,N,z,G;for(E==null&&(E=e),N=function(){G=[];for(var Y=0,P=r(m.length/2);0<=P?Y<P:Y>P;0<=P?Y++:Y--)G.push(Y);return G}.apply(this).reverse(),z=[],A=0,F=N.length;A<F;A++)v=N[A],z.push(g(m,v,E));return z},h=function(m,E,v){var A;if(v==null&&(v=e),A=m.indexOf(E),A!==-1)return y(m,0,A,v),g(m,A,v)},l=function(m,E,v){var A,R,F,q,N;if(v==null&&(v=e),R=m.slice(0,E),!R.length)return R;for(i(R,v),N=m.slice(E),F=0,q=N.length;F<q;F++)A=N[F],o(R,A,v);return R.sort(v).reverse()},d=function(m,E,v){var A,R,F,q,N,z,G,Y,P,b;if(v==null&&(v=e),E*10<=m.length){if(q=m.slice(0,E).sort(v),!q.length)return q;for(F=q[q.length-1],Y=m.slice(E),N=0,G=Y.length;N<G;N++)A=Y[N],v(A,F)<0&&(c(q,A,0,null,v),q.pop(),F=q[q.length-1]);return q}for(i(m,v),b=[],R=z=0,P=u(E,m.length);0<=P?z<P:z>P;R=0<=P?++z:--z)b.push(n(m,v));return b},y=function(m,E,v,A){var R,F,q;for(A==null&&(A=e),R=m[v];v>E;){if(q=v-1>>1,F=m[q],A(R,F)<0){m[v]=F,v=q;continue}break}return m[v]=R},g=function(m,E,v){var A,R,F,q,N;for(v==null&&(v=e),R=m.length,N=E,F=m[E],A=2*E+1;A<R;)q=A+1,q<R&&!(v(m[A],m[q])<0)&&(A=q),m[E]=m[A],E=A,A=2*E+1;return m[E]=F,y(m,N,E,v)},t=function(){m.push=s,m.pop=n,m.replace=a,m.pushpop=o,m.heapify=i,m.updateItem=h,m.nlargest=l,m.nsmallest=d;function m(E){this.cmp=E??e,this.nodes=[]}return m.prototype.push=function(E){return s(this.nodes,E,this.cmp)},m.prototype.pop=function(){return n(this.nodes,this.cmp)},m.prototype.peek=function(){return this.nodes[0]},m.prototype.contains=function(E){return this.nodes.indexOf(E)!==-1},m.prototype.replace=function(E){return a(this.nodes,E,this.cmp)},m.prototype.pushpop=function(E){return o(this.nodes,E,this.cmp)},m.prototype.heapify=function(){return i(this.nodes,this.cmp)},m.prototype.updateItem=function(E){return h(this.nodes,E,this.cmp)},m.prototype.clear=function(){return this.nodes=[]},m.prototype.empty=function(){return this.nodes.length===0},m.prototype.size=function(){return this.nodes.length},m.prototype.clone=function(){var E;return E=new m,E.nodes=this.nodes.slice(0),E},m.prototype.toArray=function(){return this.nodes.slice(0)},m.prototype.insert=m.prototype.push,m.prototype.top=m.prototype.peek,m.prototype.front=m.prototype.peek,m.prototype.has=m.prototype.contains,m.prototype.copy=m.prototype.clone,m}(),function(m,E){return typeof define=="function"&&define.amd?define([],E):typeof FO=="object"?BSe.exports=E():m.Heap=E()}(this,function(){return t})}).call(FO)});var USe=p((z9t,LSe)=>{f();LSe.exports=MSe()});var KSe=p((H9t,FSe)=>{f();"use strict";var g_t=USe(),b_t=A3(),m_t=me(),k3=ai(),KO=m_t("libp2p:dht:peer-queue"),rm=class{static async fromPeerId(e){let r=await k3.convertPeerId(e);return new rm(r)}static async fromKey(e){let r=await k3.convertBuffer(e);return new rm(r)}constructor(e){KO("create: %b",e),this.from=e,this.heap=new g_t(k3.xorCompare)}async enqueue(e){KO("enqueue %s",e.toB58String());let r=await k3.convertPeerId(e),i={id:e,distance:b_t(this.from,r)};this.heap.push(i)}dequeue(){let e=this.heap.pop();return KO("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}};FSe.exports=rm});var zSe=p(($9t,VSe)=>{f();"use strict";var v_t=KSe(),w_t=ai(),__t=3e4,jSe=class{constructor(e,r){if(this.run=e,this.queryFunc=w_t.withTimeout(r,__t),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if(typeof this.queryFunc!="function")throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null,this.res=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){let e=await v_t.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map(r=>this.addPeerToQuery(r))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e.toB58String())||this.peersToQuery&&await this.peersToQuery.enqueue(e)}};VSe.exports=jSe});var GSe=p((G9t,$Se)=>{f();"use strict";var{default:E_t}=Pc(),HSe=class{constructor(e,r,i,n){this.dht=e,this.run=r,this.path=i,this.log=n,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null,this.queuedPeerIds=new Set}setupQueue(){let e=new E_t({concurrency:this.concurrency});return e.on("idle",()=>{this.path.peersToQuery&&!this.path.peersToQuery.length&&(this.log("queue:drain"),this.stop())}),e.on("next",()=>{!this.running||e.pending<this.concurrency&&this.fill()}),e}stop(e){!this.running||(this.running=!1,this.queue.clear(),this.log("worker:stop, %d workers still running",this.run.workers.filter(r=>r.running).length),this.execution&&(e?this.execution.reject(e):this.execution.resolve()))}async execute(){this.running=!0,this.execution=null;let e=new Promise((r,i)=>{this.execution={resolve:r,reject:i}});this.fill(),await e}fill(){if(!!this.path.peersToQuery)for(;this.queue.pending+this.queue.size<this.concurrency&&this.path.peersToQuery.length>0;){let e=this.path.peersToQuery.dequeue();this.queuedPeerIds.add(e),this.queue.add(()=>this.processNext(e).catch(r=>{this.log.error("queue",r),this.stop(r)}).finally(()=>{this.queuedPeerIds.delete(e)}))}}async processNext(e){if(!this.running||this.run.peersSeen.has(e.toB58String()))return;let r,i;try{r=await this.run.continueQuerying(this)}catch(o){i=o}if(!this.running)return;if(i)throw i;if(!r){this.stop();return}if(this.run.peersSeen.has(e.toB58String()))return;this.run.peersSeen.add(e.toB58String()),this.log("queue:work");let n,s;try{n=await this.execQuery(e)}catch(o){s=o}if(!!this.running){if(this.log("queue:work:done",s,n),s)throw s;if(n&&n.queryComplete){this.log("query:complete"),this.run.stop();return}n&&n.pathComplete&&this.stop()}}async execQuery(e){let r,i;try{r=await this.path.queryFunc(e)}catch(n){i=n}if(!!this.running){if(i){this.run.errors.push(i);return}if(this.run.peersQueried&&await this.run.peersQueried.add(e),!!r){if(r.pathComplete||r.queryComplete)return this.path.res=r,{pathComplete:r.pathComplete,queryComplete:r.queryComplete};if(r.closerPeers&&r.closerPeers.length>0){let n=async s=>{this.dht._isSelf(s.id)||(this.dht._peerDiscovered(s.id,s.multiaddrs),await this.path.addPeerToQuery(s.id))};await Promise.all(r.closerPeers.map(n))}}}}};$Se.exports=HSe});var XSe=p((W9t,YSe)=>{f();"use strict";var S_t=DSe(),x_t=dr(),A_t=zSe(),I_t=GSe(),T_t=ai(),WSe=class extends x_t{constructor(e){super();this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(!!this.running){this.running=!1;for(let e of this.workers)e.stop()}}async execute(e){let r=[],i=Math.min(this.query.dht.disjointPaths,e.length);for(let s=0;s<i;s++)r.push(new A_t(this,this.query.makePath(s,i)));e.forEach((s,o)=>{r[o%i].addInitialPeer(s)}),await this.executePaths(r);let n={finalSet:new Set(this.peersQueried&&this.peersQueried.peers),paths:[]};for(let s of r)s.res&&(s.res.pathComplete||s.res.queryComplete)&&(s.res.success=!0,n.paths.push(s.res));return n}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map(r=>r.execute()))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){let r=new I_t(this.query.dht,this,e,this.query._log);this.workers.push(r),await r.execute()}async init(){if(!this.peersQueried){if(this.peersQueriedPromise){await this.peersQueriedPromise;return}this.peersQueriedPromise=(async()=>{let e=await T_t.convertBuffer(this.query.key);this.peersQueried=new S_t(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise}}async continueQuerying(e){if(this.peersQueried&&this.peersQueried.length<this.peersQueried.capacity)return!0;let r=Array.from(e.queuedPeerIds);return!!(this.peersQueried&&await this.peersQueried.anyCloser(r))}};YSe.exports=WSe});var q3=p((Y9t,ZSe)=>{f();"use strict";var{base58btc:R_t}=(Zr(),Qr),P_t=ai(),C_t=XSe(),QSe=class{constructor(e,r,i){this.dht=e,this.key=r,this.makePath=i,this._log=P_t.logger(this.dht.peerId,"query:"+R_t.baseEncode(r)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?e.length===0?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new C_t(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-(this._startTime||0)}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),!!this.running&&(this.running=!1,this._run&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this._run.stop()),this.dht._queryManager.queryCompleted(this))}};ZSe.exports=QSe});var r3e=p((X9t,t3e)=>{f();"use strict";var jO=ae(),O_t=Id(),k_t=ci(),JSe=Je(),e3e=xf(),VO=kl(),q_t=q3(),kd=ai(),N_t=e3e.Record;t3e.exports=t=>{let e=async(n,s)=>t.datastore.put(kd.bufferToKey(n),s),r=async n=>{t._log(`getLocal ${JSe(n,"base32")}`);let s=await t.datastore.get(kd.bufferToKey(n));t._log(`found ${JSe(n,"base32")} in local datastore`);let o=N_t.deserialize(s);return await t._verifyRecordLocally(o),o},i=async(n,s,o)=>{let a=await kd.createPutRecord(n,o);return Promise.all(s.map(async c=>{if(!k_t(c.val,o)){if(t._isSelf(c.from)){try{await t._putLocal(n,a)}catch(u){t._log.error("Failed error correcting self",u)}return}try{await t._putValueToPeer(n,a,c.from)}catch(u){t._log.error("Failed error correcting entry",u)}}}))};return{async _putLocal(n,s){return e(n,s)},async put(n,s,o={}){t._log("PutValue %b",n);let a=await kd.createPutRecord(n,s);await e(n,a);let c=0,u=0;await kd.mapParallel(t.getClosestPeers(n,{shallow:!0}),async d=>{try{c+=1,await t._putValueToPeer(n,a,d),u+=1}catch(h){t._log.error("Failed to put to peer (%b): %s",d.id,h)}});let l=o.minPeers||c;if(l>u){let d=jO(new Error(`Failed to put value to enough peers: ${u}/${l}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw t._log.error(d),d}},async get(n,s={}){s.timeout=s.timeout||VO.minute,t._log("_get %b",n);let o=await t.getMany(n,VO.GET_MANY_RECORD_COUNT,s),a=o.map(l=>l.val),c=0;try{c=e3e.selection.bestRecord(t.selectors,n,a)}catch(l){if(l.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw l}let u=a[c];if(t._log("GetValue %b %s",n,u),!u)throw jO(new Error("best value was not found"),"ERR_NOT_FOUND");return await i(n,o,u),u},async getMany(n,s,o={}){o.timeout=o.timeout||VO.minute,t._log("getMany %b (%s)",n,s);let a=[],c;try{c=await r(n)}catch(g){if(s===0)throw g}if(c&&a.push({val:c.value,from:t.peerId}),a.length>=s)return a;let u=await kd.convertBuffer(n),l=t.routingTable.closestPeers(u,t.kBucketSize);if(t._log("peers in rt: %d",l.length),l.length===0){let g="Failed to lookup key! No peers from routing table!";if(t._log.error(g),a.length===0)throw jO(new Error(g),"ERR_NO_PEERS_IN_ROUTING_TABLE");return a}let d=a.length;function h(g,m){let E=kd.pathSize(s-d,m),v=0;async function A(R){let F,q,N;try{let G=await t._getValueOrPeers(R,n);F=G.record,q=G.peers}catch(G){if(G.code!=="ERR_INVALID_RECORD")throw G;N=G}let z={closerPeers:q};return F&&F.value?(a.push({val:F.value,from:R}),v++):N&&(a.push({err:N,from:R}),v++),v>=E&&(z.pathComplete=!0),z}return A}let y=new q_t(t,n,h);try{await O_t(y.run(l),o.timeout)}catch(g){if(a.length===0)throw g}finally{y.stop()}return a}}}});var s3e=p((Q9t,n3e)=>{f();"use strict";var i3e=class{constructor(){this.list=[]}push(e){return this.has(e.id)?!1:(this.list.push(e),!0)}has(e){let r=this.list.find(i=>i.id.equals(e));return Boolean(r)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}};n3e.exports=i3e});var c3e=p((Z9t,a3e)=>{f();"use strict";var D_t=s3e(),o3e=class extends D_t{constructor(e){super();this.limit=e}push(e){return this.length<this.limit?super.push(e):!1}};a3e.exports=o3e});var p3e=p((J9t,h3e)=>{f();"use strict";var B_t=ae(),u3e=Id(),l3e=kl(),f3e=c3e(),N3=sc(),M_t=q3(),d3e=ai();h3e.exports=t=>{let e=async(r,i)=>{let n=new N3(N3.TYPES.GET_PROVIDERS,i.bytes,0);return t.network.sendRequest(r,n)};return{async provide(r){t._log(`provide: ${r}`);let i=[];await t.providers.addProvider(r,t.peerId);let n=t.libp2p?t.libp2p.multiaddrs:[],s=new N3(N3.TYPES.ADD_PROVIDER,r.bytes,0);s.providerPeers=[{id:t.peerId,multiaddrs:n}];async function o(a){t._log(`putProvider ${r} to ${a.toB58String()}`);try{await t.network.sendMessage(a,s)}catch(c){i.push(c)}}if(await d3e.mapParallel(t.getClosestPeers(r.bytes),o),i.length)throw B_t(new Error(`Failed to provide to ${i.length} of ${t.kBucketSize} peers`),"ERR_SOME_PROVIDES_FAILED",{errors:i})},async*findProviders(r,i={timeout:6e4,maxNumProviders:5}){let n=i.timeout||l3e.minute,s=i.maxNumProviders||l3e.K;t._log(`findProviders ${r}`);let o=new f3e(s);if((await t.providers.getProviders(r)).forEach(h=>{let y=t.peerStore.get(h);y?o.push({id:y.id,multiaddrs:y.addresses.map(g=>g.multiaddr)}):o.push({id:h,multiaddrs:[]})}),o.length>=s){for(let h of o.toArray())yield h;return}let c=[];function u(h,y){let g=d3e.pathSize(s-o.length,y),m=new f3e(g);c.push(m);async function E(v){let A=await e(v,r),R=A.providerPeers;return t._log(`Found ${R.length} provider entries for ${r}`),R.forEach(F=>{m.push({...F})}),m.length>=g?{pathComplete:!0}:{closerPeers:A.closerPeers}}return E}let l=new M_t(t,r.bytes,u),d=t.routingTable.closestPeers(r.bytes,t.kBucketSize);try{await u3e(l.run(d),n)}catch(h){if(h.name!==u3e.TimeoutError.name)throw h}finally{l.stop()}c.forEach(h=>{h.toArray().forEach(y=>{o.push(y)})});for(let h of o.toArray())yield h}}}});var b3e=p((eUt,g3e)=>{f();"use strict";var im=ae(),L_t=Id(),zO=et(),U_t=xa(),F_t=Je(),K_t=kl(),D3=sc(),y3e=q3(),nm=ai();g3e.exports=t=>{let e=async s=>{t._log(`findPeerLocal ${s.toB58String()}`);let o=await t.routingTable.find(s),a=o&&t.peerStore.get(o);if(a)return{id:a.id,multiaddrs:a.addresses.map(c=>c.multiaddr)}},r=async(s,o)=>{let a=new D3(D3.TYPES.GET_VALUE,o,0);return t.network.sendRequest(s,a)},i=async(s,o)=>(t._log(`closerPeersSingle ${F_t(s,"base32")} from ${o.toB58String()}`),(await t.peerRouting._findPeerSingle(o,new zO(s))).closerPeers.filter(c=>!t._isSelf(c.id)).map(c=>(t.peerStore.addressBook.add(c.id,c.multiaddrs),c))),n=async s=>{let o=nm.keyForPublicKey(s),a=await r(s,o);if(!a.record||!a.record.value)throw im(new Error(`Node not responding with its public key: ${s.toB58String()}`),"ERR_INVALID_RECORD");let c=await zO.createFromPubKey(a.record.value);if(!c.equals(s))throw im(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return c.pubKey};return{async _findPeerSingle(s,o){t._log("findPeerSingle %s",s.toB58String());let a=new D3(D3.TYPES.FIND_NODE,o.id,0);return t.network.sendRequest(s,a)},async findPeer(s,o={timeout:6e4}){o.timeout=o.timeout||K_t.minute,t._log("findPeer %s",s.toB58String());let a=await e(s);if(a!=null)return t._log("found local"),a;let c=await nm.convertPeerId(s),u=t.routingTable.closestPeers(c,t.kBucketSize);if(u.length===0)throw im(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED");if(u.find(m=>m.isEqual(s))){let m=t.peerStore.get(s);if(m)return t._log("found in peerStore"),{id:m.id,multiaddrs:m.addresses.map(E=>E.multiaddr)}}let d=new y3e(t,s.id,()=>async E=>{let v=await this._findPeerSingle(E,s),A=v.closerPeers.find(R=>R.id.isEqual(s));return A?{peer:A,queryComplete:!0}:{closerPeers:v.closerPeers}}),h;try{h=await L_t(d.run(u),o.timeout)}finally{d.stop()}let y=!1;if(h.paths.forEach(m=>{m.success&&m.peer&&(y=!0,t.peerStore.addressBook.add(m.peer.id,m.peer.multiaddrs))}),t._log("findPeer %s: %s",s.toB58String(),y),!y)throw im(new Error("No peer found"),"ERR_NOT_FOUND");let g=t.peerStore.get(s);if(!g)throw im(new Error("No peer found in peer store"),"ERR_NOT_FOUND");return{id:g.id,multiaddrs:g.addresses.map(m=>m.multiaddr)}},async*getClosestPeers(s,o={shallow:!1}){t._log("getClosestPeers to %b",s);let a=await nm.convertBuffer(s),c=t.routingTable.closestPeers(a,t.kBucketSize),l=await new y3e(t,s,()=>async h=>({closerPeers:await i(s,h),pathComplete:o.shallow?!0:void 0})).run(c);if(!l||!l.finalSet)return[];let d=await nm.sortClosestPeers(Array.from(l.finalSet),a);for(let h of d.slice(0,t.kBucketSize))yield h},async getPublicKey(s){t._log("getPublicKey %s",s.toB58String());let o=t.peerStore.get(s);if(o&&o.id.pubKey)return t._log("getPublicKey: found local copy"),o.id.pubKey;let a;try{a=await n(s)}catch(l){let d=nm.keyForPublicKey(s),h=await t.get(d);a=U_t.keys.unmarshalPublicKey(h)}let c=new zO(s.id,void 0,a),u=(o&&o.addresses||[]).map(l=>l.multiaddr);return t.peerStore.addressBook.add(c,u),t.peerStore.keyBook.set(c,a),a}}}});var S3e=p((tUt,E3e)=>{f();"use strict";var j_t=Fg(),m3e=es(),V_t=et(),{Key:z_t}=Ft(),{default:H_t}=Pc(),sm=kl(),om=ai(),v3e=class{constructor(e,r,i){this.datastore=e,this._log=om.logger(r,"providers"),this.cleanupInterval=sm.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=sm.PROVIDERS_VALIDITY,this.lruCacheSize=i||sm.PROVIDERS_LRU_CACHE_SIZE,this.providers=j_t(this.lruCacheSize),this.syncQueue=new H_t({concurrency:1})}start(){this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval)}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{this._log("start cleanup");let e=Date.now(),r=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:sm.PROVIDERS_KEY_PREFIX});for await(let a of o)try{let{cid:c,peerId:u}=w3e(a.key),l=_3e(a.value),d=Date.now(),h=d-l,y=h>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",d,l,h,this.provideValidity,y?"(expired)":""),y){i++,s.delete(a.key);let g=n.get(c)||new Set;g.add(u),n.set(c,g)}r++}catch(c){this._log.error(c.message)}this._log("deleting %d / %d entries",i,r),n.size&&await s.commit();for(let[a,c]of n){let u=am(a),l=this.providers.get(u);if(l){for(let d of c)l.delete(d);l.size===0?this.providers.remove(u):this.providers.set(u,l)}}this._log("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let r=am(e),i=this.providers.get(r);return i||(i=await G_t(this.datastore,e),this.providers.set(r,i)),i}async addProvider(e,r){return this.syncQueue.add(async()=>{this._log("addProvider %s",e.toString());let i=await this._getProvidersMap(e);this._log("loaded %s provs",i.size);let n=new Date;i.set(om.encodeBase32(r.id),n);let s=am(e);return this.providers.set(s,i),$_t(this.datastore,e,r,n)})}async getProviders(e){return this.syncQueue.add(async()=>(this._log("getProviders %s",e.toString()),[...(await this._getProvidersMap(e)).keys()].map(i=>new V_t(om.decodeBase32(i)))))}};function am(t){return t=typeof t=="string"?t:om.encodeBase32(t.bytes),sm.PROVIDERS_KEY_PREFIX+t}async function $_t(t,e,r,i){let n=[am(e),"/",om.encodeBase32(r.id)].join(""),s=new z_t(n),o=Uint8Array.from(m3e.encode(i.getTime()));return t.put(s,o)}function w3e(t){let e=t.toString().split("/");if(e.length!==4)throw new Error("incorrectly formatted provider entry key in datastore: "+t);return{cid:e[2],peerId:e[3]}}async function G_t(t,e){let r=new Map,i=t.query({prefix:am(e)});for await(let n of i){let{peerId:s}=w3e(n.key);r.set(s,_3e(n.value))}return r}function _3e(t){return m3e.decode(t)}E3e.exports=v3e});var A3e=p((rUt,HO)=>{f();"use strict";var W_t=I3(),x3e=async(t,e,r)=>W_t(new Array(t).fill(),(i,n)=>e(n),r);HO.exports=x3e;HO.exports.default=x3e});var R3e=p((iUt,T3e)=>{f();"use strict";var Y_t=xa(),{sha256:X_t}=(ei(),Ur),Q_t=et(),{AbortController:Z_t}=Ll(),J_t=ae(),e2t=A3e(),t2t=kl(),{logger:r2t}=ai(),I3e=class{constructor(e,r){if(!e)throw new Error("Random Walk needs an instance of the Kademlia DHT");this._kadDHT=e,this._options={...t2t.defaultRandomWalk,...r},this.log=r2t(e.peerId,"random-walk"),this._timeoutId=void 0}start(){this._running||(this._running=!0,!(this._timeoutId||!this._options.enabled)&&(this._timeoutId=setTimeout(()=>{this._runPeriodically()},this._options.delay)))}stop(){this._running=!1,this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._controller&&this._controller.abort()}async _runPeriodically(){for(;this._timeoutId;){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}if(!this._running)return;await new Promise(e=>{this._timeoutId=setTimeout(e,this._options.interval)})}}async _walk(e,r){this.log("start"),this._controller=new Z_t;try{await e2t(e,async i=>{this.log("running query %d",i);try{let n=await this._randomPeerId();if(!this._controller)return;await this._query(n,{timeout:r,signal:this._controller.signal})}catch(n){if(n&&n.code!=="ETIMEDOUT")throw this.log.error("query %d finished with error",i,n),n}this.log("finished query %d",i)})}finally{this._controller=null,this.log("finished queries")}}async _query(e,r){this.log("query:%s",e.toB58String());let i;try{i=await this._kadDHT.findPeer(e,r)}catch(n){if(n&&n.code==="ERR_NOT_FOUND")return;throw n}throw this.log("query:found",i),J_t(new Error(`random-walk: ACTUALLY FOUND PEER: ${i}, ${e.toB58String()}`),"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){let e=await X_t.digest(Y_t.randomBytes(16));return new Q_t(e.bytes)}};T3e.exports=I3e});var O3e=p((nUt,C3e)=>{f();"use strict";var P3e=class{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(let e of this.queries)e.stop();this.queries.clear()}};C3e.exports=P3e});var N3e=p((sUt,WO)=>{f();"use strict";var{EventEmitter:i2t}=dr(),B3=ae(),cm=xf(),{MemoryDatastore:n2t}=Ft(),k3e=ci(),$O=Je(),s2t=JEe(),oy=ai(),um=kl(),o2t=OSe(),a2t=r3e(),c2t=p3e(),u2t=b3e(),M3=sc(),l2t=S3e(),f2t=R3e(),d2t=O3e(),GO=cm.Record,q3e=class extends i2t{constructor({libp2p:e,dialer:r,peerId:i,peerStore:n,registrar:s,protocolPrefix:o="/ipfs",forceProtocolLegacy:a=!1,datastore:c=new n2t,kBucketSize:u=um.K,clientMode:l=!1,concurrency:d=um.ALPHA,validators:h={},selectors:y={},randomWalk:g={enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:3e4,delay:1e4},onPut:m=()=>{},onRemove:E=()=>{}}){super();if(!r)throw new Error("libp2p-kad-dht requires an instance of Dialer");this.libp2p=e,this.dialer=r,this.peerId=i,this.peerStore=n,this.registrar=s,this.protocol=o+(a?"":um.PROTOCOL_DHT),this.kBucketSize=u,this._clientMode=l,this.concurrency=d,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new s2t(this.peerId,this.kBucketSize),this.datastore=c,this.providers=new l2t(this.datastore,this.peerId),this.validators={pk:cm.validator.validators.pk,...h},this.selectors={pk:cm.selection.selectors.pk,...y},this.network=new o2t(this),this._log=oy.logger(this.peerId),this.randomWalk=new f2t(this,g),this._queryManager=new d2t,this._running=!1,this.contentFetching=a2t(this),this.contentRouting=c2t(this),this.peerRouting=u2t(this),this.onPut=m,this.onRemove=E}get isStarted(){return this._running}start(){this._running||(this._running=!0,this.providers.start(),this._queryManager.start(),this.network.start(),this.randomWalk.start())}stop(){this._running=!1,this.randomWalk.stop(),this.network.stop(),this._queryManager.stop(),this.providers.stop()}async put(e,r,i={}){return this.contentFetching.put(e,r,i)}async get(e,r={}){return this.contentFetching.get(e,r)}async getMany(e,r,i={}){return this.contentFetching.getMany(e,r,i)}async removeLocal(e){this._log(`removeLocal: ${$O(e,"base32")}`);let r=oy.bufferToKey(e);try{await this.datastore.delete(r)}catch(i){if(i.code==="ERR_NOT_FOUND")return;throw i}}async _putLocal(e,r){this._log(`_putLocal: ${$O(e,"base32")}`);let i=oy.bufferToKey(e);await this.datastore.put(i,r)}async provide(e){return this.contentRouting.provide(e)}async*findProviders(e,r={timeout:6e3,maxNumProviders:5}){for await(let i of this.contentRouting.findProviders(e,r))yield i}async findPeer(e,r={timeout:6e4}){return this.peerRouting.findPeer(e,r)}async*getClosestPeers(e,r={shallow:!1}){yield*this.peerRouting.getClosestPeers(e,r)}getPublicKey(e){return this.peerRouting.getPublicKey(e)}_peerDiscovered(e,r){this.emit("peer",{id:e,multiaddrs:r})}async _nearestPeersToQuery(e){let r=await oy.convertBuffer(e.key);return this.routingTable.closestPeers(r,this.kBucketSize).map(n=>{let s=this.peerStore.get(n);return{id:n,multiaddrs:s?s.addresses.map(o=>o.multiaddr):[]}})}async _betterPeersToQuery(e,r){return this._log("betterPeersToQuery"),(await this._nearestPeersToQuery(e)).filter(n=>this._isSelf(n.id)?(this._log.error("trying to return self as closer"),!1):!n.id.isEqual(r))}async _checkLocalDatastore(e){this._log(`checkLocalDatastore: ${$O(e)} %b`,e);let r=oy.bufferToKey(e),i;try{i=await this.datastore.get(r)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=GO.deserialize(i);if(!n)throw B3(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||oy.now()-n.timeReceived.getTime()>um.MAX_RECORD_AGE){await this.datastore.delete(r),this.onRemove(n);return}return n}async _add(e){await this.routingTable.add(e)}async _verifyRecordLocally(e){this._log("verifyRecordLocally"),await cm.validator.verifyRecord(this.validators,e)}_isSelf(e){return e&&k3e(this.peerId.id,e.id)}async _putValueToPeer(e,r,i){let n=new M3(M3.TYPES.PUT_VALUE,e,0);n.record=GO.deserialize(r);let s=await this.network.sendRequest(i,n);if(s.record&&!k3e(s.record.value,GO.deserialize(r).value))throw B3(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")}async _getValueOrPeers(e,r){let i=await this._getValueSingle(e,r),n=i.closerPeers,s=i.record;if(s){try{await this._verifyRecordOnline(s)}catch(o){let a="invalid record received, discarded";throw this._log(a),B3(new Error(a),"ERR_INVALID_RECORD")}return{record:s,peers:n}}if(n.length>0)return{peers:n};throw B3(new Error("Not found"),"ERR_NOT_FOUND")}async _getValueSingle(e,r){let i=new M3(M3.TYPES.GET_VALUE,r,0);return this.network.sendRequest(e,i)}async _verifyRecordOnline(e){await cm.validator.verifyRecord(this.validators,e)}};WO.exports=q3e;WO.exports.multicodec="/ipfs"+um.PROTOCOL_DHT});var M3e=p((oUt,B3e)=>{f();"use strict";var h2t=awe(),p2t=Z_e(),y2t=m2e(),{NOISE:g2t}=FEe(),b2t=N3e(),m2t=v8(),D3e=B4();B3e.exports=()=>({dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[h2t,p2t],streamMuxer:[y2t],connEncryption:[g2t],peerDiscovery:[],dht:b2t,pubsub:m2t},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!1,clientMode:!0,randomWalk:{enabled:!1},validators:{ipns:D3e.validator},selectors:{ipns:D3e.selector}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0,threshold:1}})});var K3e=p((YO,F3e)=>{f();"use strict";var v2t=et(),{Multiaddr:w2t}=tt(),_2t=lf(),{EventEmitter:E2t}=dr(),L3e=me(),L3=Object.assign(L3e("libp2p:bootstrap"),{error:L3e("libp2p:bootstrap:error")}),U3e=class extends E2t{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),L3("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!_2t.P2P.matches(e))return L3.error("Invalid multiaddr");let r=new w2t(e),i=r.getPeerId();if(!i){L3.error("Invalid bootstrap multiaddr without peer id");return}let n=v2t.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[r]})}catch(s){L3.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};YO=F3e.exports=U3e;YO.tag="bootstrap"});var XO=p((aUt,V3e)=>{f();"use strict";var Mt=sb(),S2t=hr().bind({ignoreUndefined:!0}),x2t=ae(),j3e=lue(),A2t=gue(),I2t=Eue(),{create:T2t}=n0e(),{Multiaddr:R2t}=tt(),P2t=Y_().version;V3e.exports=({options:t={},peerId:e,multiaddrs:r=[],repo:i,keychainConfig:n={},config:s={}})=>{let{datastore:o,keys:a}=i,c=C2t({options:t,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:r});return typeof t.libp2p=="function"?t.libp2p({libp2pOptions:c,options:t,config:s,datastore:o,peerId:e}):fve().create(c)};function C2t({options:t,config:e,datastore:r,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let m=Mt(e,"Pubsub.Router")||"gossipsub";if(!j3e[m])throw x2t(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${m} router.`),"ERR_NOT_SUPPORTED");return j3e[m]},c={datastore:r,peerId:s,modules:{}},u={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:Mt(t,"config.Discovery.MDNS.Enabled",Mt(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:Mt(t,"config.Discovery.webRTCStar.Enabled",Mt(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:Mt(t,"config.Bootstrap",Mt(e,"Bootstrap",[]))}},relay:{enabled:Mt(t,"relay.enabled",Mt(e,"relay.enabled",!0)),hop:{enabled:Mt(t,"relay.hop.enabled",Mt(e,"relay.hop.enabled",!1)),active:Mt(t,"relay.hop.active",Mt(e,"relay.hop.active",!1))}},dht:{enabled:Mt(e,"Routing.Type","none")!=="none",clientMode:Mt(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:Mt(t,"dht.kBucketSize",20)},pubsub:{enabled:Mt(t,"config.Pubsub.Enabled",Mt(e,"Pubsub.Enabled",!0))},nat:{enabled:!Mt(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(m=>m.toString()),announce:Mt(t,"addresses.announce",Mt(e,"Addresses.Announce",[])),noAnnounce:Mt(t,"addresses.noAnnounce",Mt(e,"Addresses.NoAnnounce",[]))},connectionManager:Mt(t,"connectionManager",{maxConnections:Mt(t,"config.Swarm.ConnMgr.HighWater",Mt(e,"Swarm.ConnMgr.HighWater")),minConnections:Mt(t,"config.Swarm.ConnMgr.LowWater",Mt(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${P2t}`}},l=M3e(),d=Mt(t,"libp2p",void 0);typeof d=="function"&&(d=void 0);let h=S2t(c,l(),u,d);Mt(h,"config.peerDiscovery.bootstrap.list",[]).length>0&&h.modules.peerDiscovery.push(K3e());let g=Mt(t,"config.Addresses.Delegates",Mt(e,"Addresses.Delegates",[]));if(g.length>0){let m=g[Math.floor(Math.random()*g.length)],E=new R2t(m).toOptions(),v={host:E.host,protocol:parseInt(E.port)===443?"https":"http",port:E.port},A=T2t(v);u.modules.contentRouting=u.modules.contentRouting||[],u.modules.contentRouting.push(new I2t(s,A)),u.modules.peerRouting=u.modules.peerRouting||[],u.modules.peerRouting.push(new A2t(A))}return h}});var Y3e=p((cUt,W3e)=>{f();"use strict";var lm=me()("ipfs:components:peer:storage"),O2t=gae(),k2t=p_(),{ERR_REPO_NOT_INITIALIZED:q2t}=mf().errors,N2t=ct(),D2t=Je(),QO=et(),z3e=hr().bind({ignoreUndefined:!0}),B2t=sT(),{NotEnabledError:M2t,NotInitializedError:L2t}=Lu(),H3e=XO(),U3=class{constructor(e,r,i,n,s){this.print=n,this.peerId=e,this.keychain=r,this.repo=i,this.print=n,this.isNew=s}static async start(e,r,i){let{repoAutoMigrate:n,repo:s,onMigrationProgress:o}=i,a=typeof s=="string"||s==null?O2t(e,r,{path:s,autoMigrate:n,onMigrationProgress:o}):s,{peerId:c,keychain:u,isNew:l}=await U2t(e,a,i);return new U3(c,u,a,e,l)}};W3e.exports=U3;var U2t=async(t,e,r)=>{if(!e.closed)return{...await $3e(e,r),isNew:!1};try{return await e.open(),{...await $3e(e,r),isNew:!1}}catch(i){if(i.code!==q2t)throw i;if(r.init&&r.init.allowNew===!1)throw new M2t("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await F2t(t,e,r),isNew:!0}}},F2t=async(t,e,r)=>{let i=r.init||{},n=await e.exists();if(lm("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await K2t(i.privateKey):await j2t(t,i),o=V2t(s);lm("peer identity: %s",o.PeerID);let a={...z3e(G3e(k2t(),i.profiles),r.config),Identity:o};await e.init(a),await e.open(),lm("repo opened");let c={pass:r.pass};try{c.dek=await e.config.get("Keychain.DEK")}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let u=await H3e({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:c});return u.keychain&&u.keychain.opts&&(await u.loadKeychain(),await e.config.set("Keychain",{DEK:u.keychain.opts.dek})),{peerId:s,keychain:u.keychain}},K2t=t=>(lm("using user-supplied private-key"),typeof t=="object"?t:QO.createFromPrivKey(N2t(t,"base64pad"))),j2t=(t,{algorithm:e="Ed25519",bits:r=2048})=>(t("generating %s keypair...",e),QO.create({keyType:e,bits:r})),V2t=t=>({PeerID:t.toB58String(),PrivKey:D2t(t.privKey.bytes,"base64pad")}),$3e=async(t,e)=>{let r=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await t.config.getAll(),o=z2t(G3e(s,i),r);if(s!==o&&await t.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new L2t("No private key was found in the config, please intialize the repo");let a=await QO.createFromPrivKey(o.Identity.PrivKey),c=await H3e({options:void 0,multiaddrs:void 0,peerId:a,repo:t,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},z2t=(t,e)=>e?z3e(t,e):t,G3e=(t,e)=>(e||[]).reduce((r,i)=>{let n=B2t.profiles[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return lm("applying profile %s",i),n.transform(r)},t)});var J3e=p((uUt,Z3e)=>{f();Z3e.exports=Q3e;var X3e=128,H2t=127,$2t=~H2t,G2t=Math.pow(2,31);function Q3e(t,e,r){e=e||[],r=r||0;for(var i=r;t>=G2t;)e[r++]=t&255|X3e,t/=128;for(;t&$2t;)e[r++]=t&255|X3e,t>>>=7;return e[r]=t|0,Q3e.bytes=r-i+1,e}});var rxe=p((lUt,txe)=>{f();txe.exports=ZO;var W2t=128,exe=127;function ZO(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw ZO.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&exe)<<i:(s&exe)*Math.pow(2,i),i+=7}while(s>=W2t);return ZO.bytes=n-e,r}});var nxe=p((fUt,ixe)=>{f();var Y2t=Math.pow(2,7),X2t=Math.pow(2,14),Q2t=Math.pow(2,21),Z2t=Math.pow(2,28),J2t=Math.pow(2,35),eEt=Math.pow(2,42),tEt=Math.pow(2,49),rEt=Math.pow(2,56),iEt=Math.pow(2,63);ixe.exports=function(t){return t<Y2t?1:t<X2t?2:t<Q2t?3:t<Z2t?4:t<J2t?5:t<eEt?6:t<tEt?7:t<rEt?8:t<iEt?9:10}});var oxe=p((dUt,sxe)=>{f();sxe.exports={encode:J3e(),decode:rxe(),encodingLength:nxe()}});var uxe=p((hUt,cxe)=>{f();"use strict";var axe=oxe();cxe.exports=t=>{if(!(t instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;t.length>0;){let r=axe.decode(t);e.push(r),t=t.slice(axe.decode.bytes)}return e}});var dxe=p((pUt,fxe)=>{f();"use strict";var{base58btc:nEt}=(Zr(),Qr),lxe=class{constructor(e,r,i){this._refCounter=1,this.cid=e,this.priority=r||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(nEt)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};fxe.exports=lxe});var fm=p((yUt,pxe)=>{f();"use strict";var hxe=dxe(),{base58btc:F3}=(Zr(),Qr),sEt=(t,e)=>Array.prototype.slice.call(e,0).sort((r,i)=>{let n=t(r),s=t(i);return n<s?-1:n>s?1:0}),JO=class{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,r,i){let n=ay(),s=e.toString(F3),o=this.set.get(s);o?(o.inc(),o.priority=r,o.wantType===n.WantType.Have&&i===n.WantType.Block&&(o.wantType=i)):(this.set.set(s,new hxe(e,r,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let r=e.toString(F3),i=this.set.get(r);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(r),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(sEt(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let r=e.toString(F3);return this.set.has(r)}get(e){let r=e.toString(F3);return this.set.get(r)}};JO.Entry=hxe;pxe.exports=JO});var ek=p((bUt,yxe)=>{f();"use strict";var oEt=fm().Entry,{base58btc:aEt}=(Zr(),Qr);yxe.exports=class{constructor(e,r,i,n,s){this.entry=new oEt(e,r,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(aEt)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}});var Nl=p((mUt,mxe)=>{f();"use strict";var gxe=me(),cEt=ci(),bxe=ek(),uEt=(t,e)=>{let r=["bitswap"];return e&&r.push(e),t&&r.push(`${t.toB58String().slice(0,8)}`),Object.assign(gxe(r.join(":")),{error:gxe(r.concat(["error"]).join(":"))})},tk=(t,e,r)=>{let i=0,n=r.length;for(;i<n;){if(t(e,r[i]))return!0;i+=1}return!1},lEt=(t,e)=>{let r=0,i=e.length,n=[],s;for(;r<i;)s=e[r],tk(t,s,n)||(n[n.length]=s),r+=1;return n},fEt=(t,e)=>e.reduce((r,i)=>{let n=t(i);return r[n]?r[n].push(i):r[n]=[i],r},{}),dEt=(t,e,r)=>e.filter(i=>!tk(t,i,r)),hEt=(t,e)=>Array.prototype.slice.call(e,0).sort((r,i)=>{let n=t(r),s=t(i);return n<s?-1:n>s?1:0}),pEt=(t,e)=>{if(t.size!==e.size)return!1;for(let[r,i]of t){let n=e.get(r);if(n===void 0||i instanceof Uint8Array&&n instanceof Uint8Array&&!cEt(i,n)||i instanceof bxe&&n instanceof bxe&&!i.equals(n))return!1}return!0};mxe.exports={logger:uEt,includesWith:tk,uniqWith:lEt,groupBy:fEt,pullAllWith:dEt,sortBy:hEt,isMapEqual:pEt}});var wxe=p((vUt,vxe)=>{f();"use strict";var oc=Ti(),ac=oc.Reader,dm=oc.Writer,Lt=oc.util,It=oc.roots["ipfs-bitswap"]||(oc.roots["ipfs-bitswap"]={});It.Message=function(){function t(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.wantlist=null,t.prototype.blocks=Lt.emptyArray,t.prototype.payload=Lt.emptyArray,t.prototype.blockPresences=Lt.emptyArray,t.prototype.pendingBytes=0,t.encode=function(r,i){if(i||(i=dm.create()),r.wantlist!=null&&Object.hasOwnProperty.call(r,"wantlist")&&It.Message.Wantlist.encode(r.wantlist,i.uint32(10).fork()).ldelim(),r.blocks!=null&&r.blocks.length)for(var n=0;n<r.blocks.length;++n)i.uint32(18).bytes(r.blocks[n]);if(r.payload!=null&&r.payload.length)for(var n=0;n<r.payload.length;++n)It.Message.Block.encode(r.payload[n],i.uint32(26).fork()).ldelim();if(r.blockPresences!=null&&r.blockPresences.length)for(var n=0;n<r.blockPresences.length;++n)It.Message.BlockPresence.encode(r.blockPresences[n],i.uint32(34).fork()).ldelim();return r.pendingBytes!=null&&Object.hasOwnProperty.call(r,"pendingBytes")&&i.uint32(40).int32(r.pendingBytes),i},t.decode=function(r,i){r instanceof ac||(r=ac.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new It.Message;r.pos<n;){var o=r.uint32();switch(o>>>3){case 1:s.wantlist=It.Message.Wantlist.decode(r,r.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(r.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(It.Message.Block.decode(r,r.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(It.Message.BlockPresence.decode(r,r.uint32()));break;case 5:s.pendingBytes=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof It.Message)return r;var i=new It.Message;if(r.wantlist!=null){if(typeof r.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=It.Message.Wantlist.fromObject(r.wantlist)}if(r.blocks){if(!Array.isArray(r.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<r.blocks.length;++n)typeof r.blocks[n]=="string"?Lt.base64.decode(r.blocks[n],i.blocks[n]=Lt.newBuffer(Lt.base64.length(r.blocks[n])),0):r.blocks[n].length&&(i.blocks[n]=r.blocks[n])}if(r.payload){if(!Array.isArray(r.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<r.payload.length;++n){if(typeof r.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=It.Message.Block.fromObject(r.payload[n])}}if(r.blockPresences){if(!Array.isArray(r.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<r.blockPresences.length;++n){if(typeof r.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=It.Message.BlockPresence.fromObject(r.blockPresences[n])}}return r.pendingBytes!=null&&(i.pendingBytes=r.pendingBytes|0),i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),r.wantlist!=null&&r.hasOwnProperty("wantlist")&&(n.wantlist=It.Message.Wantlist.toObject(r.wantlist,i)),r.blocks&&r.blocks.length){n.blocks=[];for(var s=0;s<r.blocks.length;++s)n.blocks[s]=i.bytes===String?Lt.base64.encode(r.blocks[s],0,r.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(r.blocks[s]):r.blocks[s]}if(r.payload&&r.payload.length){n.payload=[];for(var s=0;s<r.payload.length;++s)n.payload[s]=It.Message.Block.toObject(r.payload[s],i)}if(r.blockPresences&&r.blockPresences.length){n.blockPresences=[];for(var s=0;s<r.blockPresences.length;++s)n.blockPresences[s]=It.Message.BlockPresence.toObject(r.blockPresences[s],i)}return r.pendingBytes!=null&&r.hasOwnProperty("pendingBytes")&&(n.pendingBytes=r.pendingBytes),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,oc.util.toJSONOptions)},t.Wantlist=function(){function e(r){if(this.entries=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.entries=Lt.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=dm.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)It.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof ac||(i=ac.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new It.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(It.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof It.Message.Wantlist)return i;var n=new It.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=It.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=It.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,oc.util.toJSONOptions)},e.WantType=function(){var r={},i=Object.create(r);return i[r[0]="Block"]=0,i[r[1]="Have"]=1,i}(),e.Entry=function(){function r(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return r.prototype.block=Lt.newBuffer([]),r.prototype.priority=0,r.prototype.cancel=!1,r.prototype.wantType=0,r.prototype.sendDontHave=!1,r.encode=function(n,s){return s||(s=dm.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},r.decode=function(n,s){n instanceof ac||(n=ac.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new It.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},r.fromObject=function(n){if(n instanceof It.Message.Wantlist.Entry)return n;var s=new It.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?Lt.base64.decode(n.block,s.block=Lt.newBuffer(Lt.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},r.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=Lt.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?Lt.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?It.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,oc.util.toJSONOptions)},r}(),e}(),t.Block=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.prefix=Lt.newBuffer([]),e.prototype.data=Lt.newBuffer([]),e.encode=function(i,n){return n||(n=dm.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof ac||(i=ac.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new It.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof It.Message.Block)return i;var n=new It.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?Lt.base64.decode(i.prefix,n.prefix=Lt.newBuffer(Lt.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?Lt.base64.decode(i.data,n.data=Lt.newBuffer(Lt.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=Lt.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=Lt.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?Lt.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?Lt.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,oc.util.toJSONOptions)},e}(),t.BlockPresenceType=function(){var e={},r=Object.create(e);return r[e[0]="Have"]=0,r[e[1]="DontHave"]=1,r}(),t.BlockPresence=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.cid=Lt.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=dm.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof ac||(i=ac.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new It.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof It.Message.BlockPresence)return i;var n=new It.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?Lt.base64.decode(i.cid,n.cid=Lt.newBuffer(Lt.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=Lt.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?Lt.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?It.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,oc.util.toJSONOptions)},e}(),t}();vxe.exports=It});var ay=p((wUt,Exe)=>{f();"use strict";var{CID:cy}=(_u(),rh),{sha256:rk}=(ei(),Ur),{base58btc:hm}=(Zr(),Qr),yEt=uxe(),{isMapEqual:ik}=Nl(),{Message:au}=wxe(),_xe=ek(),gEt=tn(),bEt=ae(),yn=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,r,i,n,s){i==null&&(i=yn.WantType.Block);let o=e.toString(hm),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=r),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===yn.WantType.Block&&a.wantType===yn.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new _xe(e,r,i,n,s))}addBlock(e,r){let i=e.toString(hm);this.blocks.set(i,r)}addHave(e){let r=e.toString(hm);this.blockPresences.has(r)||this.blockPresences.set(r,yn.BlockPresenceType.Have)}addDontHave(e){let r=e.toString(hm);this.blockPresences.has(r)||this.blockPresences.set(r,yn.BlockPresenceType.DontHave)}cancel(e){let r=e.toString(hm);this.wantlist.delete(r),this.addEntry(e,0,yn.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),cancel:Boolean(r.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return au.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),wantType:r.wantType,cancel:Boolean(r.cancel),sendDontHave:Boolean(r.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[r,i]of this.blocks.entries()){let n=cy.parse(r),s=Uint8Array.from([n.code]),o=n.multihash.bytes.subarray(0,2),a=gEt([[n.version],s,o],1+s.byteLength+o.byteLength);e.payload.push(new au.Block({prefix:a,data:i}))}for(let[r,i]of this.blockPresences)e.blockPresences.push(new au.BlockPresence({cid:cy.parse(r).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),au.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!ik(this.wantlist,e.wantlist)||!ik(this.blocks,e.blocks)||!ik(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),r=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${r}>`}};yn.deserialize=async(t,e={})=>{let r=au.decode(t),i=r.wantlist&&r.wantlist.full||!1,n=new yn(i);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach(s=>{if(!s.block)return;let o=cy.decode(s.block);n.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),r.blockPresences&&r.blockPresences.forEach(s=>{if(!s.cid)return;let o=cy.decode(s.cid);s.type===yn.BlockPresenceType.Have?n.addHave(o):n.addDontHave(o)}),r.blocks.length>0?(await Promise.all(r.blocks.map(async s=>{let o=await rk.digest(s),a=cy.createV0(o);n.addBlock(a,s)})),n):(r.payload.length>0&&(await Promise.all(r.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=yEt(s.prefix),a=o[0],c=o[1],u=o[2],l=u===rk.code?rk:e[u];if(!l)throw bEt(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let d=await l.digest(s.data),h=cy.create(a,c,d);n.addBlock(h,s.data)})),n.setPendingBytes(r.pendingBytes)),n)};yn.blockPresenceSize=t=>t.bytes.length+1;yn.Entry=_xe;yn.WantType={Block:au.Wantlist.WantType.Block,Have:au.Wantlist.WantType.Have};yn.BlockPresenceType={Have:au.BlockPresenceType.Have,DontHave:au.BlockPresenceType.DontHave};Exe.exports=yn});var pm=p((_Ut,Sxe)=>{f();"use strict";var nk=1e3;Sxe.exports={maxProvidersPerRequest:3,providerRequestTimeout:10*nk,hasBlockTimeout:15*nk,provideTimeout:15*nk,kMaxPriority:Math.pow(2,31)-1,maxListeners:1e3,wantlistSendDebounceMs:1}});var Axe=p((EUt,xxe)=>{f();xxe.exports=mEt;function mEt(t,e,r){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return t.apply(this,arguments);var c=this,u=arguments,l=r&&!i;if(s(),n=function(){t.apply(c,u)},i=setTimeout(function(){if(i=null,!l){var d=n;return n=null,d()}},e),l)return n()};return a.cancel=s,a.flush=o,a}});var Txe=p((xUt,Ixe)=>{f();"use strict";var vEt=Axe(),wEt=ay(),_Et=Nl().logger,{wantlistSendDebounceMs:EEt}=pm();Ixe.exports=class{constructor(e,r,i){this.peerId=r,this.network=i,this.refcnt=1,this._entries=[],this._log=_Et(e,"msgqueue"),this.sendEntries=vEt(this._sendEntries.bind(this),EEt)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new wEt(!1);this._entries.forEach(r=>{r.cancel?e.cancel(r.cid):e.addEntry(r.cid,r.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(r){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),r.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(r=>{this._log.error("send error: %s",r.message)})}}});var Pxe=p((IUt,Rxe)=>{f();"use strict";var sk=ay(),SEt=fm(),xEt=pm(),AEt=Txe(),IEt=Nl().logger,{base58btc:TEt}=(Zr(),Qr);Rxe.exports=class{constructor(e,r,i){this.peers=new Map,this.wantlist=new SEt(i),this.network=r,this._stats=i,this._peerId=e,this._log=IEt(e,"want")}_addEntries(e,r,i){let n=e.map((s,o)=>new sk.Entry(s,xEt.kMaxPriority-o,sk.WantType.Block,r));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString(TEt)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let r=this.peers.get(e.toB58String());if(r){r.refcnt++;return}r=new AEt(this._peerId,e,this.network);let i=new sk(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return r.addMessage(i),this.peers.set(e.toB58String(),r),r}_stopPeerHandler(e){let r=this.peers.get(e.toB58String());!r||(r.refcnt--,!(r.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,r={}){this._addEntries(e,!1),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}});var Dxe=p((TUt,Nxe)=>{f();"use strict";var Cxe=Bo(),{pipe:Oxe}=Er(),REt=gE(),PEt=ay(),kxe=pm(),CEt=Nl().logger,ok="/ipfs/bitswap/1.0.0",ak="/ipfs/bitswap/1.1.0",ck="/ipfs/bitswap/1.2.0",qxe=class{constructor(e,r,i,n={}){this._log=CEt(e.peerId,"network"),this._libp2p=e,this._bitswap=r,this._protocols=[ok],n.b100Only||(this._protocols.unshift(ak),this._protocols.unshift(ck)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashers=n.hashers||{}}start(){this._running=!0,this._libp2p.handle(this._protocols,this._onConnection);let e=new REt({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=this._libp2p.registrar.register(e);for(let r of this._libp2p.peerStore.peers.values()){let i=this._libp2p.connectionManager.get(r.id);i&&this._onPeerConnect(i.remotePeer)}}stop(){this._running=!1,this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:r,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await Oxe(r,Cxe.decode(),async n=>{for await(let s of n)try{let o=await PEt.deserialize(s.slice(),this._hashers);await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,r,i={}){return this._libp2p.contentRouting.findProviders(e,{timeout:kxe.providerRequestTimeout,maxNumProviders:r})}async findAndConnect(e,r){let i=[];for await(let n of this.findProviders(e,kxe.maxProvidersPerRequest,r))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,r).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,r){await this._libp2p.contentRouting.provide(e,r)}async sendMessage(e,r){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,r);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([ck,ak,ok]),a;switch(o){case ok:a=r.serializeToBitswap100();break;case ak:case ck:a=r.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}OEt(s,a,this._log),this._updateSentStats(e,r.blocks)}async connectTo(e,r){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,r)}_updateSentStats(e,r){let i=e.toB58String();if(this._stats){for(let n of r.values())this._stats.push(i,"dataSent",n.length);this._stats.push(i,"blocksSent",r.size)}}};async function OEt(t,e,r){try{await Oxe([e],Cxe.encode(),t)}catch(i){r(i)}}Nxe.exports=qxe});var Lxe=p((RUt,Mxe)=>{f();"use strict";var kEt=fm(),Bxe=class{constructor(e){this.partner=e,this.wantlist=new kEt,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,r,i){this.wantlist.add(e,r,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};Mxe.exports=Bxe});var Kxe=p((PUt,Fxe)=>{f();"use strict";var Uxe=class extends Map{constructor(e,r){super();this._cmp=r||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let r=this._keys[e];this._keys.splice(e,1);let i=this._find(r);this._keys.splice(i,0,r)}set(e,r){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,r);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let r=this.indexOf(e);return this._keys.splice(r,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let r=this._find(e);if(this._keys[r]===e)return r;for(let i=1;i<this._keys.length;i++){if(this._keys[r+i]===e)return r+i;if(this._keys[r-i]===e)return r-i}return-1}_find(e){let r=0,i=this._keys.length;for(;r<i;){let n=r+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)r=n+1;else if(s>0)i=n;else return n}return r}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,r){if(!!e)for(let i of this._keys)e.apply(r,[[i,this.get(i)]])}_defaultSort(e,r){return e[0]<r[0]?-1:r[0]<e[0]?1:0}_kCmp(e,r){return this._cmp([e,this.get(e)],[r,this.get(r)])}};Fxe.exports=Uxe});var $xe=p((CUt,Hxe)=>{f();"use strict";var jxe=Kxe(),qEt={hasNewInfo(){return!1},merge(){}},Vxe=class{constructor(e=qEt){this._taskMerger=e,this._byPeer=new jxe([],uk.compare)}pushTasks(e,r){let i=this._byPeer.get(e.toB58String());i||(i=new uk(e,this._taskMerger)),i.pushTasks(r),this._byPeer.set(e.toB58String(),i)}popTasks(e){let r=this._head();if(r===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=r.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=r.peerId;return r.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,r){let i=this._byPeer.get(r.toB58String());i&&i.remove(e)}tasksDone(e,r){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of r)i.taskDone(s);this._byPeer.update(n)}},uk=class{constructor(e,r){this.peerId=e,this._taskMerger=r,this._activeTotalSize=0,this._pending=new zxe,this._active=new Set}pushTasks(e){for(let r of e)this._pushTask(r)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let r=this._pending.get(e.topic);if(r){e.priority>r.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,r);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let r=[];for(let i of this._active)i.topic===e.topic&&r.push(i);return r.length===0?!0:this._taskMerger.hasNewInfo(e,r)}popTasks(e){let r=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&r<e;s++){let o=n[s];i.push(o),r+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,r){return e[1]._pending.length===0?1:r[1]._pending.length===0?-1:e[1]._activeTotalSize===r[1]._activeTotalSize?r[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-r[1]._activeTotalSize}},zxe=class{constructor(){this._tasks=new jxe([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,r)=>e+r.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,r){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=r,this._tasks.update(n)}_compare(e,r){return e[1].task.priority===r[1].task.priority?e[1].created-r[1].created:r[1].task.priority-e[1].task.priority}};Hxe.exports=Vxe});var Wxe=p((OUt,Gxe)=>{f();"use strict";var NEt={hasNewInfo(t,e){let r=!1,i=!1;for(let n of e)n.data.haveBlock&&(r=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&t.data.isWantBlock||!r&&t.data.haveBlock)},merge(t,e){let r=t.data,i=e.data;!i.haveBlock&&r.haveBlock&&(i.haveBlock=r.haveBlock,i.blockSize=r.blockSize),!i.isWantBlock&&r.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||r.haveBlock)&&(i.haveBlock=r.haveBlock,e.size=t.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};Gxe.exports=NEt});var Zxe=p((kUt,Qxe)=>{f();"use strict";var{CID:lk}=(_u(),rh),{base58btc:K3}=(Zr(),Qr),ym=ay(),Yxe=ym.WantType,DEt=fm(),BEt=Lxe(),MEt=$xe(),LEt=Wxe(),{logger:UEt}=Nl(),FEt=16*1024,KEt=1024,Xxe=class{constructor(e,r,i,n,s={}){this._log=UEt(e,"engine"),this.blockstore=r,this.network=i,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=new Map,this._running=!1,this._requestQueue=new MEt(LEt)}_processOpts(e){return{maxSizeReplaceHasWithBlock:KEt,targetMessageSize:FEt,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:r,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(r.length===0)return;let n=new ym(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of r){let u=lk.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(u),o.set(c.topic,c.data)):n.addHave(u):n.addDontHave(u)}let a=await this._getBlocks(s);for(let[c,u]of o){let l=lk.parse(c),d=a.get(c);d?n.addBlock(l,d):u.sendDontHave&&n.addDontHave(l)}if(n.empty){e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[c,u]of a.entries())e&&this.messageSent(e,lk.parse(c),u)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks()}wantlistForPeer(e){let r=e.toB58String(),i=this.ledgerMap.get(r);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let r=e.toB58String(),i=this.ledgerMap.get(r);return i?{peer:i.partner,value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let r of this.ledgerMap.values())for(let i of e){let n=r.wantlistContains(i.cid);if(!n)continue;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=ym.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(r.partner,[{topic:n.cid.toString(K3),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,r){let i=this._findOrCreate(e);if(r.empty)return;if(r.full&&(i.wantlist=new DEt),this._updateBlockAccounting(r.blocks,i),r.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];r.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,r){for(let i of r)this._requestQueue.remove(i.toString(K3),e)}async _addWants(e,r){let i=await this._getBlockSizes(r.map(s=>s.cid)),n=[];for(let s of r){let o=s.cid.toString(K3),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:ym.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===Yxe.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),u=a;c||(u=ym.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,r){return e===Yxe.Block||r<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let r=await this._getBlocks(e);return new Map([...r].map(([i,n])=>[i,n.length]))}async _getBlocks(e){let r=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);r.set(i.toString(K3),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),r}_updateBlockAccounting(e,r){for(let i of e.values())this._log("got block (%s bytes)",i.length),r.receivedBytes(i.length)}messageSent(e,r,i){let n=this._findOrCreate(e);n.sentBytes(i.length),n.wantlist.remove(r)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){let r=e.toB58String(),i=this.ledgerMap.get(r);if(i)return i;let n=new BEt(e);return this.ledgerMap.set(r,n),this._stats&&this._stats.push(r,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};Qxe.exports=Xxe});var n6e=p((qUt,i6e)=>{f();"use strict";var{EventEmitter:jEt}=dr(),Jxe=Je(),VEt=pm(),zEt=Nl().logger,e6e=t=>`unwant:${Jxe(t.multihash.bytes,"base64")}`,t6e=t=>`block:${Jxe(t.multihash.bytes,"base64")}`,r6e=class extends jEt{constructor(e){super();this.setMaxListeners(VEt.maxListeners),this._log=zEt(e,"notif")}hasBlock(e,r){let i=t6e(e);this._log(i),this.emit(i,r)}wantBlock(e,r={}){if(!e)throw new Error("Not a valid cid");let i=t6e(e),n=e6e(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(n,a),s(u)};this.once(n,a),this.once(i,c),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let r=e6e(e);this._log(r),this.emit(r)}};i6e.exports=r6e});var c6e=p((NUt,a6e)=>{f();"use strict";var{EventEmitter:HEt}=dr(),s6e=TP(),o6e=class extends HEt{constructor(e,r){super();this._options=r,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=s6e(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,r){this._enabled&&(this._queue.push([e,r,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let r=e=this._queue.shift();r&&this._applyOp(r)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;r&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/r*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=s6e(a)),c.push(i,s)})}_applyOp(e){let r=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,r)||(this._stats[r]=BigInt(0)),this._stats[r]=BigInt(this._stats[r])+BigInt(i),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=i}};a6e.exports=o6e});var h6e=p((DUt,d6e)=>{f();"use strict";var{EventEmitter:$Et}=dr(),u6e=c6e(),l6e={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},f6e=class extends $Et{constructor(e=[],r=l6e){super();let i=Object.assign({},l6e,r);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=i,this._enabled=this._options.enabled,this._global=new u6e(e,i),this._global.on("update",n=>this.emit("update",n)),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let r=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(r)}push(e,r,i){if(this._enabled&&(this._global.push(r,i),e)){let n=this._peers.get(e);n||(n=new u6e(this._initialCounters,this._options),this._peers.set(e,n)),n.push(r,i)}}disconnected(e){let r=e.toB58String(),i=this._peers.get(r);i&&(i.stop(),this._peers.delete(r))}};d6e.exports=f6e});var g6e=p((BUt,y6e)=>{f();"use strict";var GEt=Pxe(),WEt=Dxe(),YEt=Zxe(),XEt=n6e(),QEt=Nl().logger,ZEt=h6e(),{AbortController:JEt}=Qi(),{anySignal:eSt}=Ul(),{BlockstoreAdapter:tSt}=yE(),{CID:rSt}=(_u(),rh),iSt={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},nSt=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],p6e=class extends tSt{constructor(e,r,i={}){super();this._libp2p=e,this._log=QEt(this.peerId),this._options=Object.assign({},iSt,i),this._stats=new ZEt(nSt,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new WEt(e,this,this._stats,{hashers:i.hashers}),this.blockstore=r,this.engine=new YEt(this.peerId,r,this.network,this._stats),this.wm=new GEt(this.peerId,this.network,this._stats),this.notifications=new XEt(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,r){try{await this.engine.messageReceived(e,r)}catch(n){this._log("failed to receive message",r)}if(r.blocks.size===0)return;let i=[];for(let[n,s]of r.blocks.entries()){let o=rSt.parse(n);i.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(i.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(i.map(({cid:n,wasWanted:s,data:o})=>this._handleReceivedBlock(e,n,o,s)))}async _handleReceivedBlock(e,r,i,n){this._log("received block");let s=await this.blockstore.has(r);this._updateReceiveCounters(e.toB58String(),r,i,s),!!n&&await this.put(r,i)}_updateReceiveCounters(e,r,i,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",i.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",i.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,r){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,r={}){let i=(u,l)=>(this.wm.wantBlocks([u],l),this.notifications.wantBlock(u,l)),n=!1,s=async(u,l)=>{try{return await this.blockstore.get(u,l)}catch(d){if(d.code!=="ERR_NOT_FOUND")throw d;return n||(n=!0,this.network.findAndConnect(u).catch(h=>this._log.error(h))),i(u,l)}},o=new JEt,a=r.signal?eSt([r.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}unwant(e){let r=Array.isArray(e)?e:[e];this.wm.unwantBlocks(r),r.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,r,i){await this.blockstore.put(e,r),this._sendHaveBlockNotifications(e,r)}async*putMany(e,r){for await(let{key:i,value:n}of this.blockstore.putMany(e,r))this._sendHaveBlockNotifications(i,n),yield{key:i,value:n}}_sendHaveBlockNotifications(e,r){this.notifications.hasBlock(e,r),this.engine.receivedBlocks([{cid:e,data:r}]),this.network.provide(e).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){this.wm.start(),this.network.start(),this.engine.start(),this.started=!0}stop(){this._stats.stop(),this.wm.stop(),this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};y6e.exports=p6e});var m6e=p((MUt,b6e)=>{f();"use strict";var sSt=g6e(),oSt=(t,e,r={})=>new sSt(t,e,r);b6e.exports={createBitswap:oSt}});var E6e=p((LUt,_6e)=>{f();"use strict";var{BlockstoreAdapter:aSt}=yE(),cSt=ip(),v6e=Oa(),uSt=Pa(),w6e=class extends aSt{constructor(e,r){super();this.child=e,this.bitswap=r}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,r,i={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,r,i):await this.child.put(e,r,i))}async*putMany(e,r={}){let i=uSt(e,async({key:n})=>!await this.has(n));this.bitswap.isStarted()?yield*this.bitswap.putMany(i,r):yield*this.child.putMany(i,r)}async get(e,r={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,r):this.child.get(e,r)}async*getMany(e,r={}){let i=v6e(),n=v6e();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?i.push(s):n.push(s);i.end(),n.end()}),yield*cSt(this.bitswap.getMany(i,r),this.child.getMany(n,r))}async delete(e,r){await this.child.delete(e,r)}async*deleteMany(e,r){yield*this.child.deleteMany(e,r)}async has(e,r={}){return this.child.has(e,r)}async*query(e,r={}){yield*this.child.query(e,r)}async*queryKeys(e,r={}){yield*this.child.queryKeys(e,r)}};_6e.exports=w6e});var x6e=p((UUt,S6e)=>{f();"use strict";var{createBitswap:lSt}=m6e(),fSt=XO(),{Multiaddr:dSt}=tt(),hSt=ae(),pSt=E6e(),j3=class{constructor(e,r,i,n,s){this.peerId=e,this.libp2p=r,this.bitswap=i,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:r,print:i,options:n}){r.closed&&await r.open();let s=await r.config.getAll(),o=await fSt({options:n,repo:r,peerId:e,multiaddrs:ySt(e,s),config:s,keychainConfig:void 0});o.keychain&&await o.loadKeychain(),await o.start();for(let u of o.multiaddrs)i(`Swarm listening on ${u}/p2p/${e.toB58String()}`);let a=lSt(o,r.blocks,{statsEnabled:!0});await a.start();let c=new pSt(r.blocks,a);return r.blocks=c,r.pins.blockstore=c,new j3(e,o,a,r,c)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await Promise.all([e.bitswap.stop(),e.libp2p.stop()])}};S6e.exports=j3;var ySt=(t,e)=>{let r=t.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new dSt(s);if(o.protoCodes().includes(gSt))throw hSt(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==r&&(o=o.encapsulate(`/p2p/${r}`)),i.push(o)}return i},gSt=479});var I6e=p((FUt,A6e)=>{f();"use strict";var bSt=Ce();A6e.exports=({network:t})=>{async function e(r={}){let i=[],{libp2p:n}=await t.use(r);for(let[s,o]of n.peerStore.peers.entries())i.push({id:s,addrs:o.addresses.map(a=>a.multiaddr)});return i}return bSt(e)}});var R6e=p((KUt,T6e)=>{f();"use strict";var mSt=Ce();T6e.exports=({network:t})=>{async function e(r,i={}){let{libp2p:n}=await t.use(i);await n.dial(r,i)}return mSt(e)}});var C6e=p((jUt,P6e)=>{f();"use strict";var vSt=Ce();P6e.exports=({network:t})=>{async function e(r,i={}){let{libp2p:n}=await t.use(i);await n.hangUp(r)}return vSt(e)}});var k6e=p((VUt,O6e)=>{f();"use strict";var wSt=Ce();O6e.exports=({network:t})=>{async function e(r={}){let{libp2p:i}=await t.use(r);return i.multiaddrs}return wSt(e)}});var N6e=p((zUt,q6e)=>{f();"use strict";var _St=Ce();q6e.exports=({network:t})=>{async function e(r={}){let{libp2p:i}=await t.use(r),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(r.verbose||r.direction)&&(c.direction=a.stat.direction),r.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return _St(e)}});var M6e=p((HUt,B6e)=>{f();"use strict";var ESt=I6e(),SSt=R6e(),xSt=C6e(),ASt=k6e(),ISt=N6e(),D6e=class{constructor({network:e}){this.addrs=ESt({network:e}),this.connect=SSt({network:e}),this.disconnect=xSt({network:e}),this.localAddrs=ASt({network:e}),this.peers=ISt({network:e})}};B6e.exports=D6e});var U6e=p(($Ut,L6e)=>{f();"use strict";var TSt=et(),gm={success:!0,time:0,text:""},RSt=Ce();L6e.exports=({network:t})=>{async function*e(r,i={}){let{libp2p:n}=await t.use();i.count=i.count||10;let s=TSt.createFromB58String(r),o=n.peerStore.get(s),a=o&&o.id;if(!a){yield{...gm,text:`Looking up peer ${r}`};let l=await n.peerRouting.findPeer(s);a=l&&l.id}if(!a)throw new Error("Peer was not found");yield{...gm,text:`PING ${a.toB58String()}`};let c=0,u=0;for(let l=0;l<i.count;l++)try{let d=await n.ping(a);u+=d,c++,yield{...gm,time:d}}catch(d){yield{...gm,success:!1,text:d.toString()}}if(c){let l=u/c;yield{...gm,text:`Average latency: ${l}ms`}}}return RSt(e)}});var V6e=p((GUt,j6e)=>{f();"use strict";var F6e=et(),K6e=ae(),{NotEnabledError:PSt}=Lu(),CSt=sb(),uy=Ce();j6e.exports=({network:t,repo:e})=>{let{get:r,put:i,findProvs:n,findPeer:s,provide:o,query:a}={async get(c,u={}){let{libp2p:l}=await ly(t,u);return l._dht.get(c,u)},async*put(c,u,l){let{libp2p:d}=await ly(t,l);yield*d._dht.put(c,u)},async*findProvs(c,u={numProviders:20}){let{libp2p:l}=await ly(t,u);for await(let d of l._dht.findProviders(c,{maxNumProviders:u.numProviders,signal:u.signal}))yield{id:d.id.toB58String(),addrs:d.addrs}},async findPeer(c,u){let{libp2p:l}=await ly(t,u),d=await l._dht.findPeer(F6e.parse(c));return{id:d.id.toB58String(),addrs:d.multiaddrs}},async*provide(c,u={recursive:!1}){let{libp2p:l}=await ly(t,u),d=Array.isArray(c)?c:[c];if(!(await Promise.all(d.map(g=>e.blocks.has(g)))).every(g=>g))throw K6e(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(u.recursive)throw K6e(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");for(let g of d)yield l._dht.provide(g)},async*query(c,u){let{libp2p:l}=await ly(t,u);for await(let d of l._dht.getClosestPeers(F6e.parse(c).toBytes()))yield{id:d.toB58String(),addrs:[]}}};return{get:uy(r),put:uy(i),findProvs:uy(n),findPeer:uy(s),provide:uy(o),query:uy(a)}};var ly=async(t,e)=>{let r=await t.use(e);if(CSt(r.libp2p,"_config.dht.enabled",!1))return r;throw new PSt("dht not enabled")}});var H6e=p((WUt,z6e)=>{f();"use strict";var bm=Ce(),OSt=ae(),{NotEnabledError:kSt}=Lu(),qSt=sb();z6e.exports=({network:t,config:e})=>{let r=qSt(e||{},"Pubsub.Enabled",!0);return{subscribe:r?bm(i):mm,unsubscribe:r?bm(n):mm,publish:r?bm(s):mm,ls:r?bm(o):mm,peers:r?bm(a):mm};async function i(c,u,l={}){let{libp2p:d}=await t.use(l);return d.pubsub.subscribe(c,u,l)}async function n(c,u,l={}){let{libp2p:d}=await t.use(l);d.pubsub.unsubscribe(c,u,l)}async function s(c,u,l={}){let{libp2p:d}=await t.use(l);if(!u)throw OSt(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await d.pubsub.publish(c,u)}async function o(c={}){let{libp2p:u}=await t.use(c);return u.pubsub.getTopics()}async function a(c,u={}){let{libp2p:l}=await t.use(u);return l.pubsub.getSubscribers(c)}};var mm=async()=>{throw new kSt("pubsub not enabled")}});var X6e=p((YUt,Y6e)=>{f();"use strict";var NSt=hr().bind({ignoreUndefined:!0}),{isTest:DSt}=Py(),fk=me()("ipfs"),$6e=ae(),{UnixFS:BSt}=yi(),G6e=(xt(),St),MSt=(Tc(),df),{identity:W6e}=(bc(),ua),{bases:LSt,hashes:USt,codecs:FSt}=(_v(),wv),KSt=TF(),{AlreadyInitializedError:jSt}=Lu(),VSt=ct(),zSt=pK(),HSt=gK(),$St=DK(),GSt=MK(),WSt=FK(),YSt=Wz(),XSt=EG(),QSt=YG(),ZSt=ZG(),JSt=eW(),e3t=lW(),t3t=IW(),r3t=UW(),i3t=$J(),n3t=WJ(),s3t=XJ(),o3t=sT(),a3t=Ree(),c3t=Mee(),u3t=Fee(),l3t=cre(),f3t=Tre(),d3t=Zre(),h3t=oie(),p3t=die(),y3t=Y3e(),g3t=x6e(),b3t=Rw(),m3t=M6e(),v3t=U6e(),w3t=V6e(),_3t=H6e(),E3t=_8(),S3t=E8(),x3t=S8(),V3=class{constructor({print:e,storage:r,codecs:i,options:n}){let{peerId:s,repo:o,keychain:a}=r,c=b3t.create(g3t),u=c3t(n.preload),l=$St(),d=GSt({network:c}),h=new XSt(n),y=Object.values(USt);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(C=>y.push(C)),this.hashers=new S3t({hashers:y,loadHasher:n.ipld&&n.ipld.loadHasher});let g=Object.values(LSt);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach(C=>g.push(C)),this.bases=new x3t({bases:g,loadBase:n.ipld&&n.ipld.loadBase});let m=new YSt({repo:o,codecs:i}),E=new r3t({codecs:i,hashers:this.hashers,preload:u,repo:o}),v=new QSt({dns:l,ipns:h,repo:o,codecs:i,peerId:s,isOnline:d,keychain:a,options:n}),A=WSt({repo:o,codecs:i,bases:this.bases,name:v}),R=new a3t({repo:o,codecs:i,hashers:this.hashers,preload:u}),F=Object.assign(ZSt({repo:o,codecs:i,resolve:A,preload:u}),{local:JSt({repo:r.repo})}),{add:q,addAll:N,cat:z,get:G,ls:Y}=new i3t({preload:u,repo:o,options:n.EXPERIMENTAL}),P=l3t({repo:o,preload:u,hashers:this.hashers,options:n}),b=u3t({files:P,preload:u,options:n.preload});this.preload=u,this.name=v,this.ipns=h,this.pin=m,this.resolve=A,this.block=E,this.refs=F,this.start=zSt({network:c,peerId:s,repo:o,preload:u,ipns:h,mfsPreload:b,print:e,keychain:a,options:n}),this.stop=HSt({network:c,preload:u,mfsPreload:b,ipns:h,repo:o}),this.dht=w3t({network:c,repo:o}),this.pubsub=_3t({network:c,config:n.config}),this.dns=l,this.isOnline=d,this.id=s3t({network:c,peerId:s}),this.version=n3t({repo:o}),this.bitswap=new e3t({network:c}),this.bootstrap=new t3t({repo:o}),this.config=o3t({repo:o}),this.ping=v3t({network:c}),this.add=q,this.addAll=N,this.cat=z,this.get=G,this.ls=Y,this.dag=R,this.files=P,this.key=new f3t({keychain:a}),this.object=new d3t({preload:u,codecs:i,repo:o}),this.repo=new h3t({repo:o,hashers:this.hashers}),this.stats=new p3t({repo:o,network:c}),this.swarm=new m3t({network:c}),Object.defineProperty(this,"libp2p",{get(){let C=c.try();return C?C.libp2p:void 0}});let w=()=>Promise.reject($6e(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),S=async function*(){throw $6e(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=w,this.diag={cmds:w,net:w,sys:w},this.log={level:w,ls:w,tail:S},this.mount=w,this.codecs=i}async init(){throw new jSt}static async create(e={}){e=NSt(I3t(),e);let r=e.init||{},i={name:W6e.name,code:W6e.code,encode:l=>l,decode:l=>l},n=Object.values(FSt);[G6e,MSt,i].concat(e.ipld&&e.ipld.codecs||[]).forEach(l=>n.push(l));let s=new E3t({codecs:n,loadCodec:e.ipld&&e.ipld.loadCodec}),o=e.silent?fk:console.log,a=await y3t.start(o,s,e),c=await a.repo.config.getAll(),u=new V3({storage:a,print:o,codecs:s,options:{...e,config:c}});if(await u.preload.start(),u.ipns.startOffline(a),a.isNew&&!r.emptyRepo){let l=await A3t(u);fk("adding default assets"),await KSt({addAll:u.addAll,print:o}),fk("initializing IPNS keyspace"),await u.ipns.initializeKeyspace(a.peerId.privKey,VSt(`/ipfs/${l}`))}return e.start!==!1&&await u.start(),u}};Y6e.exports=V3;var A3t=async t=>{let e=G6e.encode({Data:new BSt({type:"directory"}).marshal(),Links:[]}),r=await t.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await t.pin.add(r),r},I3t=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!DSt,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})});var Z6e=p((XUt,Q6e)=>{f();"use strict";var T3t=ox(),R3t=bx(),P3t=et(),C3t=xa(),O3t=qh(),{multiaddr:k3t}=tt(),{CID:q3t}=(Ae(),ke),{create:N3t}=X6e();Q6e.exports={create:N3t,crypto:C3t,isIPFS:O3t,CID:q3t,multiaddr:k3t,PeerId:P3t,globSource:T3t,urlSource:R3t}});var D3t=p((QUt,J6e)=>{f();"use strict";J6e.exports={...Z6e()}});return D3t();})();
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return Ipfs}));
